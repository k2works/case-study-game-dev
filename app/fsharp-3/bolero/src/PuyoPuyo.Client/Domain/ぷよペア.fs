namespace PuyoPuyo.Domain

open PuyoPuyo.Domain

/// ぷよペア
type ぷよペア =
    { X座標: int
      Y座標: int
      ぷよ1の色: ぷよの色 // 軸ぷよ
      ぷよ2の色: ぷよの色 // 2つ目のぷよ
      回転状態: int } // 0: 上, 1: 右, 2: 下, 3: 左

module ぷよペア =
    /// ぷよペアを作成
    let 作成 (列: int) (行: int) (色1: ぷよの色) (色2: ぷよの色) (回転: int) : ぷよペア =
        { X座標 = 列
          Y座標 = 行
          ぷよ1の色 = 色1
          ぷよ2の色 = 色2
          回転状態 = 回転 }

    /// ぷよペアの各ぷよの位置を取得
    let 位置取得 (ぷよペア: ぷよペア) : (int * int) * (int * int) =
        let 位置1 = (ぷよペア.X座標, ぷよペア.Y座標)

        let 位置2 =
            match ぷよペア.回転状態 with
            | 0 -> (ぷよペア.X座標, ぷよペア.Y座標 - 1) // 上
            | 1 -> (ぷよペア.X座標 + 1, ぷよペア.Y座標) // 右
            | 2 -> (ぷよペア.X座標, ぷよペア.Y座標 + 1) // 下
            | 3 -> (ぷよペア.X座標 - 1, ぷよペア.Y座標) // 左
            | _ -> (ぷよペア.X座標, ぷよペア.Y座標 - 1) // デフォルトは上

        (位置1, 位置2)

    /// ランダムなぷよペアを生成
    let ランダム作成 (列: int) (行: int) (回転: int) : ぷよペア =
        let random = System.Random()
        let 色リスト = [| 赤; 緑; 青; 黄 |]
        let 色1 = 色リスト.[random.Next(色リスト.Length)]
        let 色2 = 色リスト.[random.Next(色リスト.Length)]
        作成 列 行 色1 色2 回転
