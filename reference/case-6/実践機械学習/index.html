
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Site Description">
      
      
        <meta name="author" content="Project Team">
      
      
      
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>実践機械学習 - Site Name</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../docs/mkdocs/assets/css/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Site Name" class="md-header__button md-logo" aria-label="Site Name" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Site Name
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              実践機械学習
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/k2works/claude-code-booster" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    claude-code-booster
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Site Name" class="md-nav__button md-logo" aria-label="Site Name" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Site Name
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/k2works/claude-code-booster" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    claude-code-booster
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="_1">実践機械学習<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h1>
<p>このドキュメントでは、本プロジェクトで実装されている機械学習APIについて解説します。</p>
<h2 id="_2">概要<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<p>本プロジェクトでは、機械学習モデルの実装とAPI公開にPythonを使用しています。主要なライブラリは以下の通りです。</p>
<ul>
<li><strong><code>pandas</code></strong>: データ操作と分析のためのライブラリです。</li>
<li><strong><code>scikit-learn</code></strong>: 様々な機械学習アルゴリズムを提供するライブラリです。</li>
<li><strong><code>FastAPI</code></strong>: 高性能なWeb APIを構築するためのPythonフレームワークです。</li>
<li><strong><code>uvicorn</code></strong>: FastAPIアプリケーションを動かすためのASGIサーバーです。</li>
</ul>
<p>本プロジェクトには、分類問題と回帰問題を扱う4つの機械学習モデルが実装されています。</p>
<ul>
<li><strong>分類モデル</strong>:<ul>
<li><code>Iris API</code>: アヤメの種類を3つに分類します。</li>
<li><code>Survived API</code>: 乗客が生存したか否かを2値で分類します。</li>
</ul>
</li>
<li><strong>回帰モデル</strong>:<ul>
<li><code>Cinema API</code>: 映画の興行収入を予測します。</li>
<li><code>Boston API</code>: 住宅の平均価格を予測します。</li>
</ul>
</li>
</ul>
<p>以下のフローチャートは、どのモデルを使用すべきかを判断するための指針です。</p>
<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgZGF0YS1kaWFncmFtLXR5cGU9IkFDVElWSVRZIiBoZWlnaHQ9IjI2NHB4IiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJub25lIiBzdHlsZT0id2lkdGg6NzQ5cHg7aGVpZ2h0OjI2NHB4O2JhY2tncm91bmQ6I0ZGRkZGRjsiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDc0OSAyNjQiIHdpZHRoPSI3NDlweCIgem9vbUFuZFBhbj0ibWFnbmlmeSI+PGRlZnMvPjxnPjxlbGxpcHNlIGN4PSIzNzUuODA0MiIgY3k9IjIwIiBmaWxsPSIjMjIyMjIyIiByeD0iMTAiIHJ5PSIxMCIgc3R5bGU9InN0cm9rZTojMjIyMjIyO3N0cm9rZS13aWR0aDoxOyIvPjxwb2x5Z29uIGZpbGw9IiNGMUYxRjEiIHBvaW50cz0iMzA0LjMwNDcsNTAsNDQ3LjMwMzcsNTAsNDU5LjMwMzcsNjIsNDQ3LjMwMzcsNzQsMzA0LjMwNDcsNzQsMjkyLjMwNDcsNjIsMzA0LjMwNDcsNTAiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjExIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE0Mi45OTkiIHg9IjMwNC4zMDQ3IiB5PSI2NS44MDgxIj4mIzIwMTA0OyYjMjgyMDQ7JiMxMjM3NTsmIzEyMzgzOyYjMTIzNTY7JiMxMjM5ODsmIzEyMzk5OyYjMjU5Njg7JiMyMDUxNjsmIzEyMzkxOyYjMTIzNzc7JiMxMjM2MzsmIzY1MzExOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMSIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxOS4wMDgzIiB4PSIyNzMuMjk2NCIgeT0iNTkuNDA1OCI+eWVzPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjExIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEzLjcwMTciIHg9IjQ1OS4zMDM3IiB5PSI1OS40MDU4Ij5ubzwvdGV4dD48cG9seWdvbiBmaWxsPSIjRjFGMUYxIiBwb2ludHM9Ijk1LjI3MTYsODQsMjgyLjI3MDMsODQsMjk0LjI3MDMsOTYsMjgyLjI3MDMsMTA4LDk1LjI3MTYsMTA4LDgzLjI3MTYsOTYsOTUuMjcxNiw4NCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTEiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTg2Ljk5ODciIHg9Ijk1LjI3MTYiIHk9Ijk5LjgwODEiPiYjMjYxNDQ7JiMzMDAxMTsmIzEyMzk4OyYjMzMyODg7JiMzNDg5MjsmIzIxNDU0OyYjMjA4Mzc7JiMxMjQzNDsmIzIwMTA0OyYjMjgyMDQ7JiMxMjM3NTsmIzEyMzgzOyYjMTIzNTY7JiMxMjM5MTsmIzEyMzc3OyYjMTIzNjM7JiM2NTMxMTs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTEiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTkuMDA4MyIgeD0iNjQuMjYzMyIgeT0iOTMuNDA1OCI+eWVzPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjExIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEzLjcwMTciIHg9IjI5NC4yNzAzIiB5PSI5My40MDU4Ij5ubzwvdGV4dD48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjMzLjk2ODgiIHJ4PSIxMi41IiByeT0iMTIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iMTI0LjU0MzIiIHg9IjExIiB5PSIxMTgiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMDQuNTQzMiIgeD0iMjEiIHk9IjEzOS4xMzg3Ij5DaW5lbWEgQVBJJiMxMjQzNDsmIzIwMzUxOyYjMjk5OTI7PC90ZXh0PjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMzMuOTY4OCIgcng9IjEyLjUiIHJ5PSIxMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIxMjAuMjc3NiIgeD0iMjQ0LjEzMTUiIHk9IjExOCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEwMC4yNzc2IiB4PSIyNTQuMTMxNSIgeT0iMTM5LjEzODciPkJvc3RvbiBBUEkmIzEyNDM0OyYjMjAzNTE7JiMyOTk5Mjs8L3RleHQ+PHBvbHlnb24gZmlsbD0iI0YxRjFGMSIgcG9pbnRzPSIxODguNzcxLDE1Ny45Njg4LDIwMC43NzEsMTY5Ljk2ODgsMTg4Ljc3MSwxODEuOTY4OCwxNzYuNzcxLDE2OS45Njg4LDE4OC43NzEsMTU3Ljk2ODgiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIvPjxwb2x5Z29uIGZpbGw9IiNGMUYxRjEiIHBvaW50cz0iNDc0LjgzOCw4NCw2NTAuODM2OCw4NCw2NjIuODM2OCw5Niw2NTAuODM2OCwxMDgsNDc0LjgzOCwxMDgsNDYyLjgzOCw5Niw0NzQuODM4LDg0IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMSIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxNzUuOTk4OCIgeD0iNDc0LjgzOCIgeT0iOTkuODA4MSI+JiMxMjQ1MDsmIzEyNTE2OyYjMTI1MTM7JiMxMjM5ODsmIzMxMjc4OyYjMzkwMDY7JiMxMjQzNDsmIzIwOTk4OyYjMzkwMDY7JiMxMjM3NTsmIzEyMzgzOyYjMTIzNTY7JiMxMjM5MTsmIzEyMzc3OyYjMTIzNjM7JiM2NTMxMTs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTEiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTkuMDA4MyIgeD0iNDQzLjgyOTciIHk9IjkzLjQwNTgiPnllczwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMSIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMy43MDE3IiB4PSI2NjIuODM2OCIgeT0iOTMuNDA1OCI+bm88L3RleHQ+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSIzMy45Njg4IiByeD0iMTIuNSIgcnk9IjEyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9Ijk2Ljg1NzciIHg9IjQwNC40MDkxIiB5PSIxMTgiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI3Ni44NTc3IiB4PSI0MTQuNDA5MSIgeT0iMTM5LjEzODciPklyaXMgQVBJJiMxMjQzNDsmIzIwMzUxOyYjMjk5OTI7PC90ZXh0PjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMzMuOTY4OCIgcng9IjEyLjUiIHJ5PSIxMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIxMzEuNDkyNSIgeD0iNjA3LjA5MDUiIHk9IjExOCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjExMS40OTI1IiB4PSI2MTcuMDkwNSIgeT0iMTM5LjEzODciPlN1cnZpdmVkIEFQSSYjMTI0MzQ7JiMyMDM1MTsmIzI5OTkyOzwvdGV4dD48cG9seWdvbiBmaWxsPSIjRjFGMUYxIiBwb2ludHM9IjU2Mi44Mzc0LDE1Ny45Njg4LDU3NC44Mzc0LDE2OS45Njg4LDU2Mi44Mzc0LDE4MS45Njg4LDU1MC44Mzc0LDE2OS45Njg4LDU2Mi44Mzc0LDE1Ny45Njg4IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiLz48cG9seWdvbiBmaWxsPSIjRjFGMUYxIiBwb2ludHM9IjM3NS44MDQyLDE4Ny45Njg4LDM4Ny44MDQyLDE5OS45Njg4LDM3NS44MDQyLDIxMS45Njg4LDM2My44MDQyLDE5OS45Njg4LDM3NS44MDQyLDE4Ny45Njg4IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiLz48ZWxsaXBzZSBjeD0iMzc1LjgwNDIiIGN5PSIyNDIuOTY4OCIgZmlsbD0ibm9uZSIgcng9IjExIiByeT0iMTEiIHN0eWxlPSJzdHJva2U6IzIyMjIyMjtzdHJva2Utd2lkdGg6MTsiLz48ZWxsaXBzZSBjeD0iMzc1LjgwNDIiIGN5PSIyNDIuOTY4OCIgZmlsbD0iIzIyMjIyMiIgcng9IjYiIHJ5PSI2IiBzdHlsZT0ic3Ryb2tlOiMyMjIyMjI7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjgzLjI3MTYiIHgyPSI3My4yNzE2IiB5MT0iOTYiIHkyPSI5NiIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSI3My4yNzE2IiB4Mj0iNzMuMjcxNiIgeTE9Ijk2IiB5Mj0iMTE4Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSI2OS4yNzE2LDEwOCw3My4yNzE2LDExOCw3Ny4yNzE2LDEwOCw3My4yNzE2LDExMiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIyOTQuMjcwMyIgeDI9IjMwNC4yNzAzIiB5MT0iOTYiIHkyPSI5NiIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIzMDQuMjcwMyIgeDI9IjMwNC4yNzAzIiB5MT0iOTYiIHkyPSIxMTgiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjMwMC4yNzAzLDEwOCwzMDQuMjcwMywxMTgsMzA4LjI3MDMsMTA4LDMwNC4yNzAzLDExMiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSI3My4yNzE2IiB4Mj0iNzMuMjcxNiIgeTE9IjE1MS45Njg4IiB5Mj0iMTY5Ljk2ODgiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iNzMuMjcxNiIgeDI9IjE3Ni43NzEiIHkxPSIxNjkuOTY4OCIgeTI9IjE2OS45Njg4Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSIxNjYuNzcxLDE2NS45Njg4LDE3Ni43NzEsMTY5Ljk2ODgsMTY2Ljc3MSwxNzMuOTY4OCwxNzAuNzcxLDE2OS45Njg4IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjMwNC4yNzAzIiB4Mj0iMzA0LjI3MDMiIHkxPSIxNTEuOTY4OCIgeTI9IjE2OS45Njg4Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjMwNC4yNzAzIiB4Mj0iMjAwLjc3MSIgeTE9IjE2OS45Njg4IiB5Mj0iMTY5Ljk2ODgiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjIxMC43NzEsMTY1Ljk2ODgsMjAwLjc3MSwxNjkuOTY4OCwyMTAuNzcxLDE3My45Njg4LDIwNi43NzEsMTY5Ljk2ODgiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iNDYyLjgzOCIgeDI9IjQ1Mi44MzgiIHkxPSI5NiIgeTI9Ijk2Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjQ1Mi44MzgiIHgyPSI0NTIuODM4IiB5MT0iOTYiIHkyPSIxMTgiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjQ0OC44MzgsMTA4LDQ1Mi44MzgsMTE4LDQ1Ni44MzgsMTA4LDQ1Mi44MzgsMTEyIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjY2Mi44MzY4IiB4Mj0iNjcyLjgzNjgiIHkxPSI5NiIgeTI9Ijk2Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjY3Mi44MzY4IiB4Mj0iNjcyLjgzNjgiIHkxPSI5NiIgeTI9IjExOCIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iNjY4LjgzNjgsMTA4LDY3Mi44MzY4LDExOCw2NzYuODM2OCwxMDgsNjcyLjgzNjgsMTEyIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjQ1Mi44MzgiIHgyPSI0NTIuODM4IiB5MT0iMTUxLjk2ODgiIHkyPSIxNjkuOTY4OCIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSI0NTIuODM4IiB4Mj0iNTUwLjgzNzQiIHkxPSIxNjkuOTY4OCIgeTI9IjE2OS45Njg4Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSI1NDAuODM3NCwxNjUuOTY4OCw1NTAuODM3NCwxNjkuOTY4OCw1NDAuODM3NCwxNzMuOTY4OCw1NDQuODM3NCwxNjkuOTY4OCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSI2NzIuODM2OCIgeDI9IjY3Mi44MzY4IiB5MT0iMTUxLjk2ODgiIHkyPSIxNjkuOTY4OCIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSI2NzIuODM2OCIgeDI9IjU3NC44Mzc0IiB5MT0iMTY5Ljk2ODgiIHkyPSIxNjkuOTY4OCIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iNTg0LjgzNzQsMTY1Ljk2ODgsNTc0LjgzNzQsMTY5Ljk2ODgsNTg0LjgzNzQsMTczLjk2ODgsNTgwLjgzNzQsMTY5Ljk2ODgiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMjkyLjMwNDciIHgyPSIxODguNzcxIiB5MT0iNjIiIHkyPSI2MiIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIxODguNzcxIiB4Mj0iMTg4Ljc3MSIgeTE9IjYyIiB5Mj0iODQiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjE4NC43NzEsNzQsMTg4Ljc3MSw4NCwxOTIuNzcxLDc0LDE4OC43NzEsNzgiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iNDU5LjMwMzciIHgyPSI1NjIuODM3NCIgeTE9IjYyIiB5Mj0iNjIiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iNTYyLjgzNzQiIHgyPSI1NjIuODM3NCIgeTE9IjYyIiB5Mj0iODQiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjU1OC44Mzc0LDc0LDU2Mi44Mzc0LDg0LDU2Ni44Mzc0LDc0LDU2Mi44Mzc0LDc4IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjE4OC43NzEiIHgyPSIxODguNzcxIiB5MT0iMTgxLjk2ODgiIHkyPSIxOTkuOTY4OCIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIxODguNzcxIiB4Mj0iMzYzLjgwNDIiIHkxPSIxOTkuOTY4OCIgeTI9IjE5OS45Njg4Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSIzNTMuODA0MiwxOTUuOTY4OCwzNjMuODA0MiwxOTkuOTY4OCwzNTMuODA0MiwyMDMuOTY4OCwzNTcuODA0MiwxOTkuOTY4OCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSI1NjIuODM3NCIgeDI9IjU2Mi44Mzc0IiB5MT0iMTgxLjk2ODgiIHkyPSIxOTkuOTY4OCIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSI1NjIuODM3NCIgeDI9IjM4Ny44MDQyIiB5MT0iMTk5Ljk2ODgiIHkyPSIxOTkuOTY4OCIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iMzk3LjgwNDIsMTk1Ljk2ODgsMzg3LjgwNDIsMTk5Ljk2ODgsMzk3LjgwNDIsMjAzLjk2ODgsMzkzLjgwNDIsMTk5Ljk2ODgiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMzc1LjgwNDIiIHgyPSIzNzUuODA0MiIgeTE9IjMwIiB5Mj0iNTAiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjM3MS44MDQyLDQwLDM3NS44MDQyLDUwLDM3OS44MDQyLDQwLDM3NS44MDQyLDQ0IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjM3NS44MDQyIiB4Mj0iMzc1LjgwNDIiIHkxPSIyMTEuOTY4OCIgeTI9IjIzMS45Njg4Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSIzNzEuODA0MiwyMjEuOTY4OCwzNzUuODA0MiwyMzEuOTY4OCwzNzkuODA0MiwyMjEuOTY4OCwzNzUuODA0MiwyMjUuOTY4OCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjwhLS1TUkM9W0FvdjlCMmhYb2FuSnE3WW9nLUZQWlpNRjZ3U19SZnBfa0I3YlNVRXdudXRoZHF0VHlCSFhvVUY2dk95UlBwdmt4N3dfUHh3Y0dhYjZRZncySGNMZ2lJUE90eENQMnZ2RnNHcktfZ0FadXlOMmRnVnpWS3pSYnB2a2NlSFg3V3VwaDltcHlyOXA0bktTMHBuMWtsUmtWcHZiWEpMTlFhdm5nZTk2Tlp2R3RZY19rMkdfM3JxLUJvS3AzS2FMbzJNRmNuT3pSYnhvazdhWHEzN0ZMd254a04wVUtDRkpaWk9HV3gwcEY4aW9ZdDR4OGhZcWcyb3BCM0s1a3BGMDlEMkwxRzAwXS0tPjwvZz48L3N2Zz4=" class="uml" alt="uml diagram" title="" /></p>
<hr />
<h2 id="iris-api">Iris API<a class="headerlink" href="#iris-api" title="Permanent link">&para;</a></h2>
<h3 id="_3">目的<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
<p>アヤメ（Iris）のがく片や花弁のサイズといった特徴量から、そのアヤメがどの種類（setosa, versicolor, virginica）に分類されるかを予測します。</p>
<h3 id="_4">データ<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h3>
<p><code>src/api/data/iris.csv</code> を使用します。データには以下の4つの特徴量と1つの正解ラベルが含まれています。</p>
<table>
<thead>
<tr>
<th>列名</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>sepal_length</td>
<td>がく片の長さ</td>
</tr>
<tr>
<td>sepal_width</td>
<td>がく片の幅</td>
</tr>
<tr>
<td>petal_length</td>
<td>花弁の長さ</td>
</tr>
<tr>
<td>petal_width</td>
<td>花弁の幅</td>
</tr>
<tr>
<td>species</td>
<td>種類 (setosa, versicolor, virginica)</td>
</tr>
</tbody>
</table>
<h3 id="_5">モデル<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h3>
<p>scikit-learnの決定木（<code>DecisionTreeClassifier</code>）を使用しています。訓練済みのモデルは <code>src/api/model/iris.pkl</code> として保存されています。</p>
<h3 id="_6">モデル構築の再現手順<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p><strong>データの読み込みと前処理</strong></p>
<p>欠損値がある場合は、各列の平均値で補完します。</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn</span><span class="w"> </span><span class="kn">import</span> <span class="n">tree</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pickle</span>

<span class="c1"># データの読み込み</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;src/api/data/iris.csv&#39;</span><span class="p">)</span>

<span class="c1"># 欠損値を平均値で補完する関数</span>
<span class="k">def</span><span class="w"> </span><span class="nf">df_fillna_mean_cols</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">cols</span><span class="p">):</span>
    <span class="n">df_fill</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
        <span class="n">mean_value</span> <span class="o">=</span> <span class="n">df_fill</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">df_fill</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_fill</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">mean_value</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df_fill</span>

<span class="c1"># 特徴量列を指定して前処理を実行</span>
<span class="n">xcol</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sepal_length&#39;</span><span class="p">,</span> <span class="s1">&#39;sepal_width&#39;</span><span class="p">,</span> <span class="s1">&#39;petal_length&#39;</span><span class="p">,</span> <span class="s1">&#39;petal_width&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df_fillna_mean_cols</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">xcol</span><span class="p">)</span>
</code></pre></div>
</li>
<li>
<p><strong>特徴量と正解ラベルの分割</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">xcol</span><span class="p">]</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;species&#39;</span><span class="p">]</span>
</code></pre></div>
</li>
<li>
<p><strong>訓練データとテストデータへの分割</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">x_train</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div>
</li>
<li>
<p><strong>モデルの定義と学習</strong></p>
<p><code>max_depth=2</code> の決定木モデルを定義し、訓練データで学習させます。</p>
<div class="highlight"><pre><span></span><code><span class="n">model</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</code></pre></div>
</li>
<li>
<p><strong>モデルの評価</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">score</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;正解率: </span><span class="si">{</span><span class="n">score</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="c1"># 出力例: 正解率: 0.9778</span>
</code></pre></div>
</li>
<li>
<p><strong>モデルの保存</strong></p>
<div class="highlight"><pre><span></span><code><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;src/api/model/iris.pkl&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</code></pre></div>
</li>
</ol>
<h3 id="_7">使い方<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h3>
<p>以下に、訓練済みモデルを読み込み、予測を行うサンプルコードを示します。</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">pickle</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="c1"># モデルの読み込み</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;src/api/model/iris.pkl&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

<span class="c1"># 予測用のサンプルデータを作成</span>
<span class="c1"># (がく片の長さ, がく片の幅, 花弁の長さ, 花弁の幅)</span>
<span class="n">sample_data</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">5.1</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">]]</span>
<span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sepal_length&#39;</span><span class="p">,</span> <span class="s1">&#39;sepal_width&#39;</span><span class="p">,</span> <span class="s1">&#39;petal_length&#39;</span><span class="p">,</span> <span class="s1">&#39;petal_width&#39;</span><span class="p">]</span>
<span class="n">sample_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">sample_data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>

<span class="c1"># 予測の実行</span>
<span class="n">prediction</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">sample_df</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;予測結果: </span><span class="si">{</span><span class="n">prediction</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<h2 id="cinema-api">Cinema API<a class="headerlink" href="#cinema-api" title="Permanent link">&para;</a></h2>
<h3 id="_8">目的<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h3>
<p>映画のSNSでの言及数や主演俳優のメディア露出度といった特徴量から、その映画の最終的な興行収入を予測します。</p>
<h3 id="_9">データ<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h3>
<p><code>src/api/data/cinema.csv</code> を使用します。データには以下の特徴量と目的変数が含まれています。</p>
<table>
<thead>
<tr>
<th>列名</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>cinema_id</td>
<td>映画作品のID</td>
</tr>
<tr>
<td>SNS1</td>
<td>公開後10日以内にSNS1でつぶやかれた数</td>
</tr>
<tr>
<td>SNS2</td>
<td>公開後10日以内にSNS2でつぶやかれた数</td>
</tr>
<tr>
<td>actor</td>
<td>主演俳優の昨年のメディア露出度</td>
</tr>
<tr>
<td>original</td>
<td>原作があるかどうか（1:あり, 0:なし）</td>
</tr>
<tr>
<td>sales</td>
<td>最終的な興行収入（単位:万円）</td>
</tr>
</tbody>
</table>
<h3 id="_10">モデル<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h3>
<p>scikit-learnの線形回帰（<code>LinearRegression</code>）を使用しています。訓練済みのモデルは <code>src/api/model/cinema.pkl</code> として保存されています。</p>
<h3 id="_11">モデル構築の再現手順<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p><strong>データの読み込みと前処理</strong></p>
<p>欠損値を各列の平均値で補完し、特定の外れ値を除外します。</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">mean_absolute_error</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pickle</span>

<span class="c1"># データの読み込み</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;src/api/data/cinema.csv&#39;</span><span class="p">)</span>

<span class="c1"># 欠損値を平均値で補完</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>

<span class="c1"># 外れ値の除外</span>
<span class="n">no</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[(</span><span class="n">df2</span><span class="p">[</span><span class="s1">&#39;SNS2&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df2</span><span class="p">[</span><span class="s1">&#39;sales&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">8500</span><span class="p">)]</span><span class="o">.</span><span class="n">index</span>
<span class="n">df3</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">no</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div>
</li>
<li>
<p><strong>特徴量と目的変数の分割</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">x</span> <span class="o">=</span> <span class="n">df3</span><span class="p">[[</span><span class="s1">&#39;SNS1&#39;</span><span class="p">,</span> <span class="s1">&#39;SNS2&#39;</span><span class="p">,</span> <span class="s1">&#39;actor&#39;</span><span class="p">,</span> <span class="s1">&#39;original&#39;</span><span class="p">]]</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">df3</span><span class="p">[</span><span class="s1">&#39;sales&#39;</span><span class="p">]</span>
</code></pre></div>
</li>
<li>
<p><strong>訓練データとテストデータへの分割</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">x_train</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div>
</li>
<li>
<p><strong>モデルの定義と学習</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</code></pre></div>
</li>
<li>
<p><strong>モデルの評価</strong></p>
<p>決定係数と平均絶対誤差（MAE）でモデルの性能を評価します。</p>
<div class="highlight"><pre><span></span><code><span class="n">score</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;決定係数: </span><span class="si">{</span><span class="n">score</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>
<span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_pred</span><span class="o">=</span><span class="n">pred</span><span class="p">,</span> <span class="n">y_true</span><span class="o">=</span><span class="n">y_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;平均絶対誤差: </span><span class="si">{</span><span class="n">mae</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="c1"># 出力例:</span>
<span class="c1"># 決定係数: 0.8383</span>
<span class="c1"># 平均絶対誤差: 206.83</span>
</code></pre></div>
</li>
<li>
<p><strong>モデルの保存</strong></p>
<div class="highlight"><pre><span></span><code><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;src/api/model/cinema.pkl&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</code></pre></div>
</li>
</ol>
<h3 id="_12">使い方<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h3>
<p>以下に、訓練済みモデルを読み込み、予測を行うサンプルコードを示します。</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">pickle</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="c1"># モデルの読み込み</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;src/api/model/cinema.pkl&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

<span class="c1"># 予測用のサンプルデータを作成</span>
<span class="c1"># (SNS1, SNS2, actor, original)</span>
<span class="n">sample_data</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">150</span><span class="p">,</span> <span class="mi">700</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
<span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;SNS1&#39;</span><span class="p">,</span> <span class="s1">&#39;SNS2&#39;</span><span class="p">,</span> <span class="s1">&#39;actor&#39;</span><span class="p">,</span> <span class="s1">&#39;original&#39;</span><span class="p">]</span>
<span class="n">sample_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">sample_data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>

<span class="c1"># 予測の実行</span>
<span class="n">prediction</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">sample_df</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;予測興行収入: </span><span class="si">{</span><span class="n">prediction</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> 万円&quot;</span><span class="p">)</span>
</code></pre></div>
<h2 id="survived-api">Survived API<a class="headerlink" href="#survived-api" title="Permanent link">&para;</a></h2>
<h3 id="_13">目的<a class="headerlink" href="#_13" title="Permanent link">&para;</a></h3>
<p>客船沈没事故の乗客データに基づき、乗客が生存したか否かを予測します。</p>
<h3 id="_14">データ<a class="headerlink" href="#_14" title="Permanent link">&para;</a></h3>
<p><code>src/api/data/Survived.csv</code> を使用します。データには以下の乗客情報が含まれています。</p>
<table>
<thead>
<tr>
<th>列名</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>Pclass</td>
<td>チケットクラス（1, 2, 3）</td>
</tr>
<tr>
<td>Age</td>
<td>年齢</td>
</tr>
<tr>
<td>SibSp</td>
<td>同乗した兄弟や配偶者の総数</td>
</tr>
<tr>
<td>Parch</td>
<td>同乗した親子の総数</td>
</tr>
<tr>
<td>Fare</td>
<td>運賃</td>
</tr>
<tr>
<td>Sex</td>
<td>性別</td>
</tr>
<tr>
<td>Survived</td>
<td>生存状況（1:生存, 0:死亡）</td>
</tr>
</tbody>
</table>
<h3 id="_15">モデル<a class="headerlink" href="#_15" title="Permanent link">&para;</a></h3>
<p>scikit-learnの決定木（<code>DecisionTreeClassifier</code>）を使用しています。訓練済みのモデルは <code>src/api/model/survived.pkl</code> として保存されています。</p>
<h3 id="_16">モデル構築の再現手順<a class="headerlink" href="#_16" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p><strong>データの読み込みと前処理</strong></p>
<p><code>Age</code>の欠損値は、<code>Pclass</code>と<code>Survived</code>の組み合わせでグループ化し、その中央値で補完します。<code>Sex</code>はダミー変数に変換します。</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn</span><span class="w"> </span><span class="kn">import</span> <span class="n">tree</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pickle</span>

<span class="c1"># データの読み込み</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;src/api/data/Survived.csv&#39;</span><span class="p">)</span>

<span class="c1"># Ageの欠損値をPclassとSurvivedのグループ中央値で補完</span>
<span class="n">is_null</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Age&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Pclass&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Survived&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">is_null</span><span class="p">),</span> <span class="s1">&#39;Age&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">43</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Pclass&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Survived&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">is_null</span><span class="p">),</span> <span class="s1">&#39;Age&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">35</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Pclass&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Survived&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">is_null</span><span class="p">),</span> <span class="s1">&#39;Age&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">33</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Pclass&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Survived&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">is_null</span><span class="p">),</span> <span class="s1">&#39;Age&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">25</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Pclass&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Survived&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">is_null</span><span class="p">),</span> <span class="s1">&#39;Age&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">26</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Pclass&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Survived&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">is_null</span><span class="p">),</span> <span class="s1">&#39;Age&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">20</span>

<span class="c1"># Sexをダミー変数に変換</span>
<span class="n">male</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Sex&#39;</span><span class="p">],</span> <span class="n">drop_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df_new</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Sex&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">male</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>
</li>
<li>
<p><strong>特徴量と正解ラベルの分割</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">col</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Pclass&#39;</span><span class="p">,</span> <span class="s1">&#39;Age&#39;</span><span class="p">,</span> <span class="s1">&#39;SibSp&#39;</span><span class="p">,</span> <span class="s1">&#39;Parch&#39;</span><span class="p">,</span> <span class="s1">&#39;Fare&#39;</span><span class="p">,</span> <span class="s1">&#39;male&#39;</span><span class="p">]</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">df_new</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df_new</span><span class="p">[</span><span class="s1">&#39;Survived&#39;</span><span class="p">]</span>
</code></pre></div>
</li>
<li>
<p><strong>訓練データとテストデータへの分割</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">x_train</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div>
</li>
<li>
<p><strong>モデルの定義と学習</strong></p>
<p><code>max_depth=9</code>、<code>class_weight='balanced'</code>の決定木モデルを定義し、学習させます。</p>
<div class="highlight"><pre><span></span><code><span class="n">model</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">DecisionTreeClassifier</span><span class="p">(</span>
    <span class="n">max_depth</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">class_weight</span><span class="o">=</span><span class="s1">&#39;balanced&#39;</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</code></pre></div>
</li>
<li>
<p><strong>モデルの評価</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">score</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;正解率: </span><span class="si">{</span><span class="n">score</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="c1"># 出力例: 正解率: 0.8324</span>
</code></pre></div>
</li>
<li>
<p><strong>モデルの保存</strong></p>
<div class="highlight"><pre><span></span><code><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;src/api/model/survived.pkl&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</code></pre></div>
</li>
</ol>
<h3 id="_17">使い方<a class="headerlink" href="#_17" title="Permanent link">&para;</a></h3>
<p>以下に、訓練済みモデルを読み込み、予測を行うサンプルコードを示します。</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">pickle</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="c1"># モデルの読み込み</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;src/api/model/survived.pkl&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

<span class="c1"># 予測用のサンプルデータを作成</span>
<span class="c1"># (Pclass, Age, SibSp, Parch, Fare, male)</span>
<span class="n">sample_data</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">3</span><span class="p">,</span> <span class="mf">22.0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">7.25</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span> <span class="c1"># 3等, 22歳, 兄弟1人, 親子0人, 7.25ドル, 男性</span>
<span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Pclass&#39;</span><span class="p">,</span> <span class="s1">&#39;Age&#39;</span><span class="p">,</span> <span class="s1">&#39;SibSp&#39;</span><span class="p">,</span> <span class="s1">&#39;Parch&#39;</span><span class="p">,</span> <span class="s1">&#39;Fare&#39;</span><span class="p">,</span> <span class="s1">&#39;male&#39;</span><span class="p">]</span>
<span class="n">sample_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">sample_data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>

<span class="c1"># 予測の実行</span>
<span class="n">prediction</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">sample_df</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;予測結果: </span><span class="si">{</span><span class="s1">&#39;生存&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">prediction</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;死亡&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<h2 id="boston-api">Boston API<a class="headerlink" href="#boston-api" title="Permanent link">&para;</a></h2>
<h3 id="_18">目的<a class="headerlink" href="#_18" title="Permanent link">&para;</a></h3>
<p>ボストン市内の住宅に関する様々な特徴量から、住宅の平均価格を予測します。</p>
<h3 id="_19">データ<a class="headerlink" href="#_19" title="Permanent link">&para;</a></h3>
<p><code>src/api/data/Boston.csv</code> を使用します。データには以下のような特徴量と目的変数が含まれています。</p>
<table>
<thead>
<tr>
<th>列名</th>
<th>内容</th>
</tr>
</thead>
<tbody>
<tr>
<td>RM</td>
<td>住居の平均部屋数</td>
</tr>
<tr>
<td>LSTAT</td>
<td>人口における低所得者の割合</td>
</tr>
<tr>
<td>PTRATIO</td>
<td>町ごとの教員1人当たりの児童生徒数</td>
</tr>
<tr>
<td>PRICE</td>
<td>住宅価格の平均価格</td>
</tr>
</tbody>
</table>
<p>（※その他多数の特徴量が存在しますが、主要なものを抜粋）</p>
<h3 id="_20">モデル<a class="headerlink" href="#_20" title="Permanent link">&para;</a></h3>
<p>scikit-learnの線形回帰（<code>LinearRegression</code>）を使用しています。特徴量と目的変数は、<code>StandardScaler</code>によって標準化されています。</p>
<h3 id="_21">モデル構築の再現手順<a class="headerlink" href="#_21" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p><strong>データの読み込みと前処理</strong></p>
<p><code>CRIME</code>列をダミー変数化し、欠損値を訓練データの平均値で補完します。また、特定の外れ値を除外します。</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pickle</span>

<span class="c1"># データの読み込み</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;src/api/data/Boston.csv&#39;</span><span class="p">)</span>

<span class="c1"># CRIME列をダミー変数化</span>
<span class="n">crime</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;CRIME&#39;</span><span class="p">],</span> <span class="n">drop_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span> <span class="n">crime</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;CRIME&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># 訓練データとテストデータに分割</span>
<span class="n">train_val</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># 欠損値を訓練データの平均で補完</span>
<span class="n">train_val_mean</span> <span class="o">=</span> <span class="n">train_val</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">train_val2</span> <span class="o">=</span> <span class="n">train_val</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">train_val_mean</span><span class="p">)</span>

<span class="c1"># 外れ値の除外</span>
<span class="n">train_val3</span> <span class="o">=</span> <span class="n">train_val2</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="mi">76</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div>
</li>
<li>
<p><strong>特徴量エンジニアリング</strong></p>
<p>元の特徴量に加えて、2乗の項や交互作用項を追加して、モデルの表現力を高めます。</p>
<div class="highlight"><pre><span></span><code><span class="c1"># 使用する特徴量の選択</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">train_val3</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;RM&#39;</span><span class="p">,</span> <span class="s1">&#39;LSTAT&#39;</span><span class="p">,</span> <span class="s1">&#39;PTRATIO&#39;</span><span class="p">]]</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">train_val3</span><span class="p">[[</span><span class="s1">&#39;PRICE&#39;</span><span class="p">]]</span>

<span class="c1"># 特徴量の追加</span>
<span class="n">x</span><span class="p">[</span><span class="s1">&#39;RM2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;RM&#39;</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span>
<span class="n">x</span><span class="p">[</span><span class="s1">&#39;LSTAT2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;LSTAT&#39;</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span>
<span class="n">x</span><span class="p">[</span><span class="s1">&#39;PTRATIO2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;PTRATIO&#39;</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span>
<span class="n">x</span><span class="p">[</span><span class="s1">&#39;RM * LSTAT&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;RM&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;LSTAT&#39;</span><span class="p">]</span>
</code></pre></div>
</li>
<li>
<p><strong>データの標準化</strong></p>
<p>特徴量と目的変数をそれぞれ標準化します。</p>
<div class="highlight"><pre><span></span><code><span class="n">sc_model_x</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">sc_model_x</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">sc_x</span> <span class="o">=</span> <span class="n">sc_model_x</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">sc_model_y</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">sc_model_y</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">sc_y</span> <span class="o">=</span> <span class="n">sc_model_y</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</code></pre></div>
</li>
<li>
<p><strong>モデルの定義と学習</strong></p>
<div class="highlight"><pre><span></span><code><span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">sc_x</span><span class="p">,</span> <span class="n">sc_y</span><span class="p">)</span>
</code></pre></div>
</li>
<li>
<p><strong>モデルの評価</strong></p>
<p>テストデータを使って決定係数を評価します。</p>
<div class="highlight"><pre><span></span><code><span class="c1"># テストデータの前処理</span>
<span class="n">test2</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">train_val</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="n">x_test</span> <span class="o">=</span> <span class="n">test2</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;RM&#39;</span><span class="p">,</span> <span class="s1">&#39;LSTAT&#39;</span><span class="p">,</span> <span class="s1">&#39;PTRATIO&#39;</span><span class="p">]]</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">test2</span><span class="p">[[</span><span class="s1">&#39;PRICE&#39;</span><span class="p">]]</span>

<span class="c1"># テストデータにも同様の特徴量エンジニアリングを適用</span>
<span class="n">x_test</span><span class="p">[</span><span class="s1">&#39;RM2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_test</span><span class="p">[</span><span class="s1">&#39;RM&#39;</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span>
<span class="n">x_test</span><span class="p">[</span><span class="s1">&#39;LSTAT2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_test</span><span class="p">[</span><span class="s1">&#39;LSTAT&#39;</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span>
<span class="n">x_test</span><span class="p">[</span><span class="s1">&#39;PTRATIO2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_test</span><span class="p">[</span><span class="s1">&#39;PTRATIO&#39;</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span>
<span class="n">x_test</span><span class="p">[</span><span class="s1">&#39;RM * LSTAT&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_test</span><span class="p">[</span><span class="s1">&#39;RM&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">x_test</span><span class="p">[</span><span class="s1">&#39;LSTAT&#39;</span><span class="p">]</span>

<span class="c1"># テストデータの標準化</span>
<span class="n">sc_x_test</span> <span class="o">=</span> <span class="n">sc_model_x</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>
<span class="n">sc_y_test</span> <span class="o">=</span> <span class="n">sc_model_y</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">y_test</span><span class="p">)</span>

<span class="n">score</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">sc_x_test</span><span class="p">,</span> <span class="n">sc_y_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;決定係数: </span><span class="si">{</span><span class="n">score</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="c1"># 出力例: 決定係数: 0.8313</span>
</code></pre></div>
</li>
<li>
<p><strong>モデルとスケーラーの保存</strong></p>
<div class="highlight"><pre><span></span><code><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;src/api/model/boston.pkl&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;src/api/model/boston_scx.pkl&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">sc_model_x</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;src/api/model/boston_scy.pkl&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">sc_model_y</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</code></pre></div>
</li>
</ol>
<h3 id="_22">使い方<a class="headerlink" href="#_22" title="Permanent link">&para;</a></h3>
<p>以下に、訓練済みモデルを読み込み、予測を行うサンプルコードを示します。</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">pickle</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="c1"># モデルとスケーラーの読み込み</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;src/api/model/boston.pkl&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;src/api/model/boston_scx.pkl&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">sc_x</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;src/api/model/boston_scy.pkl&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">sc_y</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

<span class="c1"># 予測用のサンプルデータを作成</span>
<span class="c1"># (RM, LSTAT, PTRATIO)</span>
<span class="n">sample_data</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">6.5</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">]]</span>
<span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;RM&#39;</span><span class="p">,</span> <span class="s1">&#39;LSTAT&#39;</span><span class="p">,</span> <span class="s1">&#39;PTRATIO&#39;</span><span class="p">]</span>
<span class="n">sample_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">sample_data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>

<span class="c1"># 特徴量エンジニアリング</span>
<span class="n">sample_df</span><span class="p">[</span><span class="s1">&#39;RM2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sample_df</span><span class="p">[</span><span class="s1">&#39;RM&#39;</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span>
<span class="n">sample_df</span><span class="p">[</span><span class="s1">&#39;LSTAT2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sample_df</span><span class="p">[</span><span class="s1">&#39;LSTAT&#39;</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span>
<span class="n">sample_df</span><span class="p">[</span><span class="s1">&#39;PTRATIO2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sample_df</span><span class="p">[</span><span class="s1">&#39;PTRATIO&#39;</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span>
<span class="n">sample_df</span><span class="p">[</span><span class="s1">&#39;RM * LSTAT&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sample_df</span><span class="p">[</span><span class="s1">&#39;RM&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">sample_df</span><span class="p">[</span><span class="s1">&#39;LSTAT&#39;</span><span class="p">]</span>

<span class="c1"># 特徴量の標準化</span>
<span class="n">sample_df_std</span> <span class="o">=</span> <span class="n">sc_x</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">sample_df</span><span class="p">)</span>

<span class="c1"># 予測の実行</span>
<span class="n">prediction_std</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">sample_df_std</span><span class="p">)</span>

<span class="c1"># 結果を元のスケールに戻す</span>
<span class="n">prediction</span> <span class="o">=</span> <span class="n">sc_y</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">prediction_std</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;予測住宅価格: $</span><span class="si">{</span><span class="n">prediction</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1000</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<hr />
<h2 id="fastapi">FastAPIとの連携<a class="headerlink" href="#fastapi" title="Permanent link">&para;</a></h2>
<p>本プロジェクトの機械学習モデルは、FastAPIを用いてAPIとして公開されています。これにより、HTTPリクエストを通じて各モデルの予測機能を利用できます。</p>
<h3 id="_23">アーキテクチャ概要<a class="headerlink" href="#_23" title="Permanent link">&para;</a></h3>
<p>APIのアーキテクチャは以下のようになっています。クライアントからのHTTPリクエストをFastAPIアプリケーション(<code>application.py</code>)が受け取り、リクエスト内容に応じて<code>Service</code>クラス(<code>service.py</code>)のメソッドを呼び出します。<code>Service</code>クラスは、各モデルのドメインクラス(<code>domain.py</code>)を呼び出し、最終的な予測結果をクライアントに返却します。</p>
<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgZGF0YS1kaWFncmFtLXR5cGU9IkRFU0NSSVBUSU9OIiBoZWlnaHQ9IjI4MnB4IiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJub25lIiBzdHlsZT0id2lkdGg6MTEyNnB4O2hlaWdodDoyODJweDtiYWNrZ3JvdW5kOiNGRkZGRkY7IiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCAxMTI2IDI4MiIgd2lkdGg9IjExMjZweCIgem9vbUFuZFBhbj0ibWFnbmlmeSI+PGRlZnMvPjxnPjwhLS1jbHVzdGVyIEFwcC0tPjxnIGNsYXNzPSJjbHVzdGVyIiBkYXRhLWVudGl0eT0iQXBwIiBkYXRhLXNvdXJjZS1saW5lPSI1IiBkYXRhLXVpZD0iZW50MDAwMyIgaWQ9ImNsdXN0ZXJfQXBwIj48cmVjdCBmaWxsPSJub25lIiBoZWlnaHQ9IjE2MCIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjY4OC42NyIgeD0iNyIgeT0iNyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxNTQuNTEyNyIgeD0iMjc0LjA3ODciIHk9IjIxLjk5NTEiPkZhc3RBUEkgQXBwbGljYXRpb248L3RleHQ+PC9nPjwhLS1jbHVzdGVyIE1MLS0+PGcgY2xhc3M9ImNsdXN0ZXIiIGRhdGEtZW50aXR5PSJNTCIgZGF0YS1zb3VyY2UtbGluZT0iMTEiIGRhdGEtdWlkPSJlbnQwMDA3IiBpZD0iY2x1c3Rlcl9NTCI+PHJlY3QgZmlsbD0ibm9uZSIgaGVpZ2h0PSIyMTIiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHdpZHRoPSIzMTAuODQiIHg9IjgwOS42NyIgeT0iNjQiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMjAxLjM3MyIgeD0iODY0LjQwMzUiIHk9Ijc4Ljk5NTEiPk1hY2hpbmUgTGVhcm5pbmcgTW9kZWxzPC90ZXh0PjwvZz48IS0tZW50aXR5IE1haW4tLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0iTWFpbiIgZGF0YS1zb3VyY2UtbGluZT0iNiIgZGF0YS11aWQ9ImVudDAwMDQiIGlkPSJlbnRpdHlfTWFpbiI+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSI0Ni4yOTY5IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIxMzguODQ3NyIgeD0iMjMiIHk9Ijk4Ljg1Ii8+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSIxMCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iMTUiIHg9IjE0MS44NDc3IiB5PSIxMDMuODUiLz48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjIiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjQiIHg9IjEzOS44NDc3IiB5PSIxMDUuODUiLz48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjIiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjQiIHg9IjEzOS44NDc3IiB5PSIxMDkuODUiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI5OC44NDc3IiB4PSIzOCIgeT0iMTMxLjg0NTEiPmFwcGxpY2F0aW9uLnB5PC90ZXh0PjwvZz48IS0tZW50aXR5IFNlcnZpY2UtLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0iU2VydmljZSIgZGF0YS1zb3VyY2UtbGluZT0iNyIgZGF0YS11aWQ9ImVudDAwMDUiIGlkPSJlbnRpdHlfU2VydmljZSI+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSI0Ni4yOTY5IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIxMTEuNzcwNSIgeD0iMzIzLjg1IiB5PSI5Mi44NSIvPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMTAiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjE1IiB4PSI0MTUuNjIwNSIgeT0iOTcuODUiLz48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjIiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjQiIHg9IjQxMy42MjA1IiB5PSI5OS44NSIvPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iNCIgeD0iNDEzLjYyMDUiIHk9IjEwMy44NSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjcxLjc3MDUiIHg9IjMzOC44NSIgeT0iMTI1Ljg0NTEiPnNlcnZpY2UucHk8L3RleHQ+PC9nPjwhLS1lbnRpdHkgRG9tYWluLS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1lbnRpdHk9IkRvbWFpbiIgZGF0YS1zb3VyY2UtbGluZT0iOCIgZGF0YS11aWQ9ImVudDAwMDYiIGlkPSJlbnRpdHlfRG9tYWluIj48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjQ2LjI5NjkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjExNC4wNTM3IiB4PSI1NjUuNjIiIHk9IjY3Ljg1Ii8+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSIxMCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iMTUiIHg9IjY1OS42NzM3IiB5PSI3Mi44NSIvPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iNCIgeD0iNjU3LjY3MzciIHk9Ijc0Ljg1Ii8+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSIyIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSI0IiB4PSI2NTcuNjczNyIgeT0iNzguODUiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI3NC4wNTM3IiB4PSI1ODAuNjIiIHk9IjEwMC44NDUxIj5kb21haW4ucHk8L3RleHQ+PC9nPjwhLS1lbnRpdHkgaXJpcy5wa2wtLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0iaXJpcy5wa2wiIGRhdGEtc291cmNlLWxpbmU9IjEyIiBkYXRhLXVpZD0iZW50MDAwOCIgaWQ9ImVudGl0eV9pcmlzLnBrbCI+PHBhdGggZD0iTTg0OC45LDIxNi4zNSBDODQ4LjksMjA2LjM1IDg4MS45ODE1LDIwNi4zNSA4ODEuOTgxNSwyMDYuMzUgQzg4MS45ODE1LDIwNi4zNSA5MTUuMDYzMSwyMDYuMzUgOTE1LjA2MzEsMjE2LjM1IEw5MTUuMDYzMSwyNDEuNjQ2OSBDOTE1LjA2MzEsMjUxLjY0NjkgODgxLjk4MTUsMjUxLjY0NjkgODgxLjk4MTUsMjUxLjY0NjkgQzg4MS45ODE1LDI1MS42NDY5IDg0OC45LDI1MS42NDY5IDg0OC45LDI0MS42NDY5IEw4NDguOSwyMTYuMzUiIGZpbGw9IiNGMUYxRjEiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIvPjxwYXRoIGQ9Ik04NDguOSwyMTYuMzUgQzg0OC45LDIyNi4zNSA4ODEuOTgxNSwyMjYuMzUgODgxLjk4MTUsMjI2LjM1IEM4ODEuOTgxNSwyMjYuMzUgOTE1LjA2MzEsMjI2LjM1IDkxNS4wNjMxLDIxNi4zNSIgZmlsbD0ibm9uZSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNDYuMTYzMSIgeD0iODU4LjkiIHk9IjI0My4zNDUxIj5pcmlzLnBrbDwvdGV4dD48L2c+PCEtLWVudGl0eSBjaW5lbWEucGtsLS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1lbnRpdHk9ImNpbmVtYS5wa2wiIGRhdGEtc291cmNlLWxpbmU9IjEzIiBkYXRhLXVpZD0iZW50MDAwOSIgaWQ9ImVudGl0eV9jaW5lbWEucGtsIj48cGF0aCBkPSJNODMzLjY3LDEzNi4zNSBDODMzLjY3LDEyNi4zNSA4ODEuOTgyLDEyNi4zNSA4ODEuOTgyLDEyNi4zNSBDODgxLjk4MiwxMjYuMzUgOTMwLjI5NCwxMjYuMzUgOTMwLjI5NCwxMzYuMzUgTDkzMC4yOTQsMTYxLjY0NjkgQzkzMC4yOTQsMTcxLjY0NjkgODgxLjk4MiwxNzEuNjQ2OSA4ODEuOTgyLDE3MS42NDY5IEM4ODEuOTgyLDE3MS42NDY5IDgzMy42NywxNzEuNjQ2OSA4MzMuNjcsMTYxLjY0NjkgTDgzMy42NywxMzYuMzUiIGZpbGw9IiNGMUYxRjEiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIvPjxwYXRoIGQ9Ik04MzMuNjcsMTM2LjM1IEM4MzMuNjcsMTQ2LjM1IDg4MS45ODIsMTQ2LjM1IDg4MS45ODIsMTQ2LjM1IEM4ODEuOTgyLDE0Ni4zNSA5MzAuMjk0LDE0Ni4zNSA5MzAuMjk0LDEzNi4zNSIgZmlsbD0ibm9uZSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNzYuNjI0IiB4PSI4NDMuNjciIHk9IjE2My4zNDUxIj5jaW5lbWEucGtsPC90ZXh0PjwvZz48IS0tZW50aXR5IHN1cnZpdmVkLnBrbC0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJzdXJ2aXZlZC5wa2wiIGRhdGEtc291cmNlLWxpbmU9IjE0IiBkYXRhLXVpZD0iZW50MDAxMCIgaWQ9ImVudGl0eV9zdXJ2aXZlZC5wa2wiPjxwYXRoIGQ9Ik05OTEuMywyMTYuMzUgQzk5MS4zLDIwNi4zNSAxMDQzLjkwODQsMjA2LjM1IDEwNDMuOTA4NCwyMDYuMzUgQzEwNDMuOTA4NCwyMDYuMzUgMTA5Ni41MTY4LDIwNi4zNSAxMDk2LjUxNjgsMjE2LjM1IEwxMDk2LjUxNjgsMjQxLjY0NjkgQzEwOTYuNTE2OCwyNTEuNjQ2OSAxMDQzLjkwODQsMjUxLjY0NjkgMTA0My45MDg0LDI1MS42NDY5IEMxMDQzLjkwODQsMjUxLjY0NjkgOTkxLjMsMjUxLjY0NjkgOTkxLjMsMjQxLjY0NjkgTDk5MS4zLDIxNi4zNSIgZmlsbD0iI0YxRjFGMSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7Ii8+PHBhdGggZD0iTTk5MS4zLDIxNi4zNSBDOTkxLjMsMjI2LjM1IDEwNDMuOTA4NCwyMjYuMzUgMTA0My45MDg0LDIyNi4zNSBDMTA0My45MDg0LDIyNi4zNSAxMDk2LjUxNjgsMjI2LjM1IDEwOTYuNTE2OCwyMTYuMzUiIGZpbGw9Im5vbmUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9Ijg1LjIxNjgiIHg9IjEwMDEuMyIgeT0iMjQzLjM0NTEiPnN1cnZpdmVkLnBrbDwvdGV4dD48L2c+PCEtLWVudGl0eSBib3N0b24ucGtsLS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1lbnRpdHk9ImJvc3Rvbi5wa2wiIGRhdGEtc291cmNlLWxpbmU9IjE1IiBkYXRhLXVpZD0iZW50MDAxMSIgaWQ9ImVudGl0eV9ib3N0b24ucGtsIj48cGF0aCBkPSJNOTk3LjQsMTM2LjM1IEM5OTcuNCwxMjYuMzUgMTA0My45MDM5LDEyNi4zNSAxMDQzLjkwMzksMTI2LjM1IEMxMDQzLjkwMzksMTI2LjM1IDEwOTAuNDA3OCwxMjYuMzUgMTA5MC40MDc4LDEzNi4zNSBMMTA5MC40MDc4LDE2MS42NDY5IEMxMDkwLjQwNzgsMTcxLjY0NjkgMTA0My45MDM5LDE3MS42NDY5IDEwNDMuOTAzOSwxNzEuNjQ2OSBDMTA0My45MDM5LDE3MS42NDY5IDk5Ny40LDE3MS42NDY5IDk5Ny40LDE2MS42NDY5IEw5OTcuNCwxMzYuMzUiIGZpbGw9IiNGMUYxRjEiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIvPjxwYXRoIGQ9Ik05OTcuNCwxMzYuMzUgQzk5Ny40LDE0Ni4zNSAxMDQzLjkwMzksMTQ2LjM1IDEwNDMuOTAzOSwxNDYuMzUgQzEwNDMuOTAzOSwxNDYuMzUgMTA5MC40MDc4LDE0Ni4zNSAxMDkwLjQwNzgsMTM2LjM1IiBmaWxsPSJub25lIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI3My4wMDc4IiB4PSIxMDA3LjQiIHk9IjE2My4zNDUxIj5ib3N0b24ucGtsPC90ZXh0PjwvZz48IS0tZW50aXR5IENsaWVudC0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJDbGllbnQiIGRhdGEtc291cmNlLWxpbmU9IjMiIGRhdGEtdWlkPSJlbnQwMDAyIiBpZD0iZW50aXR5X0NsaWVudCI+PGVsbGlwc2UgY3g9IjM3OS43MzUxIiBjeT0iMTk1LjM1IiBmaWxsPSIjRjFGMUYxIiByeD0iOCIgcnk9IjgiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIvPjxwYXRoIGQ9Ik0zNzkuNzM1MSwyMDMuMzUgTDM3OS43MzUxLDIzMC4zNSBNMzY2LjczNTEsMjExLjM1IEwzOTIuNzM1MSwyMTEuMzUgTTM3OS43MzUxLDIzMC4zNSBMMzY2LjczNTEsMjQ1LjM1IE0zNzkuNzM1MSwyMzAuMzUgTDM5Mi43MzUxLDI0NS4zNSIgZmlsbD0ibm9uZSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNDAuNTMwMyIgeD0iMzU5LjQ3IiB5PSIyNTkuODQ1MSI+Q2xpZW50PC90ZXh0PjwvZz48IS0tbGluayBDbGllbnQgdG8gTWFpbi0tPjxnIGNsYXNzPSJsaW5rIiBkYXRhLWVudGl0eS0xPSJDbGllbnQiIGRhdGEtZW50aXR5LTI9Ik1haW4iIGRhdGEtc291cmNlLWxpbmU9IjE4IiBkYXRhLXVpZD0ibG5rMTIiIGlkPSJsaW5rX0NsaWVudF9NYWluIj48cGF0aCBkPSJNMzU5LjA5LDIzMS4zNyBDMzIzLjgxLDI0MS42NCAyNDguMTIsMjU4LjMxIDE5MS44NSwyMzMgQzE1Mi4xNSwyMTUuMTQgMTI1LjAyMzMsMTc3LjY1NSAxMDkuMTAzMywxNTAuNzI1IiBmaWxsPSJub25lIiBpZD0iQ2xpZW50LXRvLU1haW4iIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjEwNi4wNSwxNDUuNTYsMTA3LjE4NjcsMTU1LjM0MywxMDguNTk0NSwxNDkuODY0MiwxMTQuMDczMywxNTEuMjcxOSwxMDYuMDUsMTQ1LjU2IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iOTEuMDE5IiB4PSIxOTcuMzUiIHk9IjIyOS4wNjY5Ij5IVFRQIFJlcXVlc3Q8L3RleHQ+PC9nPjwhLS1saW5rIE1haW4gdG8gQ2xpZW50LS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9Ik1haW4iIGRhdGEtZW50aXR5LTI9IkNsaWVudCIgZGF0YS1zb3VyY2UtbGluZT0iMjUiIGRhdGEtdWlkPSJsbmsxOSIgaWQ9ImxpbmtfTWFpbl9DbGllbnQiPjxwYXRoIGQ9Ik0xNTguODgsMTQ1LjYzIEMyMjMuNTMsMTY4Ljk3IDMxMi44MjY2LDIwMS4yMDI0IDM1My40NTY2LDIxNS44NzI0IiBmaWxsPSJub25lIiBpZD0iTWFpbi10by1DbGllbnQiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjM1OS4xLDIxNy45MSwzNTEuOTkzMywyMTEuMDkxMywzNTQuMzk3MiwyMTYuMjEyLDM0OS4yNzY1LDIxOC42MTU4LDM1OS4xLDIxNy45MSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEwMC42NDg0IiB4PSIxOTIuODUiIHk9IjE1NC4zMjY5Ij5IVFRQIFJlc3BvbnNlPC90ZXh0PjwvZz48IS0tbGluayBNYWluIHRvIFNlcnZpY2UtLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0iTWFpbiIgZGF0YS1lbnRpdHktMj0iU2VydmljZSIgZGF0YS1zb3VyY2UtbGluZT0iMTkiIGRhdGEtdWlkPSJsbmsxMyIgaWQ9ImxpbmtfTWFpbl9TZXJ2aWNlIj48cGF0aCBkPSJNMTYyLjA3LDEyMS4zMiBDMjAwLjc4LDEyMC44NSAyNTAuMDEsMTIwLjEgMjkzLjg1LDExOSBDMzAzLjQzLDExOC43NiAzMDcuNjIzNCwxMTguNjUwNSAzMTcuNDkzNCwxMTguMzIwNSIgZmlsbD0ibm9uZSIgaWQ9Ik1haW4tdG8tU2VydmljZSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iMzIzLjQ5LDExOC4xMiwzMTQuMzYxNCwxMTQuNDIzLDMxOC40OTI4LDExOC4yODcxLDMxNC42Mjg3LDEyMi40MTg1LDMyMy40OSwxMTguMTIiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI2OC4yNDM3IiB4PSIyMDguODUiIHk9IjExNS4wNjY5Ij5wcmVkaWN0KC4uLik8L3RleHQ+PC9nPjwhLS1saW5rIFNlcnZpY2UgdG8gTWFpbi0tPjxnIGNsYXNzPSJsaW5rIiBkYXRhLWVudGl0eS0xPSJTZXJ2aWNlIiBkYXRhLWVudGl0eS0yPSJNYWluIiBkYXRhLXNvdXJjZS1saW5lPSIyNCIgZGF0YS11aWQ9ImxuazE4IiBpZD0ibGlua19TZXJ2aWNlX01haW4iPjxwYXRoIGQ9Ik0zMjMuNzUsMTAyLjYgQzMxMy44NSwxMDAuNjggMzAzLjU5LDk5LjAyIDI5My44NSw5OCBDMjQ4Ljc2LDkzLjI3IDIzNi44Niw5Mi41OSAxOTEuODUsOTggQzE4Mi4xNiw5OS4xNiAxNzcuOTEwNiw5OS43MTA2IDE2OC4wMTA2LDEwMS44MDA2IiBmaWxsPSJub25lIiBpZD0iU2VydmljZS10by1NYWluIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSIxNjIuMTQsMTAzLjA0LDE3MS43NzIxLDEwNS4wOTQ3LDE2Ny4wMzIyLDEwMi4wMDcyLDE3MC4xMTk3LDk3LjI2NzIsMTYyLjE0LDEwMy4wNCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjM3LjA2NCIgeD0iMjI0LjM1IiB5PSI5MC4yNTY5Ij5yZXN1bHQ8L3RleHQ+PC9nPjwhLS1saW5rIFNlcnZpY2UgdG8gRG9tYWluLS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9IlNlcnZpY2UiIGRhdGEtZW50aXR5LTI9IkRvbWFpbiIgZGF0YS1zb3VyY2UtbGluZT0iMjAiIGRhdGEtdWlkPSJsbmsxNCIgaWQ9ImxpbmtfU2VydmljZV9Eb21haW4iPjxwYXRoIGQ9Ik00MzUuODksMTIxLjc2IEM0NjUuNjEsMTIzLjY5IDUwMi44MSwxMjQuMiA1MzUuNjIsMTE5IEM1NDUuMzksMTE3LjQ1IDU0OS44MDIzLDExNi42NTc5IDU1OS41OTIzLDExMy43ODc5IiBmaWxsPSJub25lIiBpZD0iU2VydmljZS10by1Eb21haW4iIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjU2NS4zNSwxMTIuMSw1NTUuNTg4MiwxMTAuNzkzNCw1NjAuNTUxOSwxMTMuNTA2Niw1NTcuODM4NywxMTguNDcwMyw1NjUuMzUsMTEyLjEiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI2OC4yNDM3IiB4PSI0NjYuNjIiIHk9IjExNS4wNjY5Ij5wcmVkaWN0KC4uLik8L3RleHQ+PC9nPjwhLS1saW5rIERvbWFpbiB0byBTZXJ2aWNlLS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9IkRvbWFpbiIgZGF0YS1lbnRpdHktMj0iU2VydmljZSIgZGF0YS1zb3VyY2UtbGluZT0iMjMiIGRhdGEtdWlkPSJsbmsxNyIgaWQ9ImxpbmtfRG9tYWluX1NlcnZpY2UiPjxwYXRoIGQ9Ik01NjUuMTIsOTEuMyBDNTM1LjQxLDkyLjAzIDQ5OC40Myw5My44MSA0NjUuNjIsOTggQzQ1NS45LDk5LjI0IDQ1MS41MzY3LDk5Ljg0OTMgNDQxLjY0NjcsMTAxLjc5OTMiIGZpbGw9Im5vbmUiIGlkPSJEb21haW4tdG8tU2VydmljZSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iNDM1Ljc2LDEwMi45Niw0NDUuMzYzOCwxMDUuMTQzNCw0NDAuNjY1NiwxMDEuOTkyOCw0NDMuODE2Miw5Ny4yOTQ2LDQzNS43NiwxMDIuOTYiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzNy4wNjQiIHg9IjQ4Mi4xMiIgeT0iODguNDc2OSI+cmVzdWx0PC90ZXh0PjwvZz48IS0tbGluayBEb21haW4gdG8gTUwtLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0iRG9tYWluIiBkYXRhLWVudGl0eS0yPSJNTCIgZGF0YS1zb3VyY2UtbGluZT0iMjEiIGRhdGEtdWlkPSJsbmsxNSIgaWQ9ImxpbmtfRG9tYWluX01MIj48cGF0aCBkPSJNNjgwLjEyLDkxIEM3MTcuNDA1LDkxIDc2Ni42NDc1LDkxIDgwNy4wNDM4LDkxIEM4MDcuNjc0OSw5MSA4MDIuMzA0LDkxIDgwMi45MzA4LDkxIiBmaWxsPSJub25lIiBpZD0iRG9tYWluLXRvLU1MIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSI4MDguOTMwOCw5MSw3OTkuOTMwOCw4Nyw4MDMuOTMwOCw5MSw3OTkuOTMwOCw5NSw4MDguOTMwOCw5MSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjcyLjM5NSIgeD0iNzEyLjY3IiB5PSI4Ny4wNjY5Ij5sb2FkIG1vZGVsPC90ZXh0PjwvZz48IS0tbGluayBNTCB0byBEb21haW4tLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0iTUwiIGRhdGEtZW50aXR5LTI9IkRvbWFpbiIgZGF0YS1zb3VyY2UtbGluZT0iMjIiIGRhdGEtdWlkPSJsbmsxNiIgaWQ9ImxpbmtfTUxfRG9tYWluIj48cGF0aCBkPSJNODA5LjU0NjMsMTAzLjg1NjEgQzgwOS4zOTg2LDEwMy45MDQ2IDgwOS4yNTA5LDEwMy45NTMzIDgwOS4xMDMzLDEwNC4wMDIxIEM4MDguNTEzLDEwNC4xOTc1IDgwNy45MjQxLDEwNC4zOTU3IDgwNy4zMzY5LDEwNC41OTY4IEM4MDIuNjM4NiwxMDYuMjA1OCA3OTguMDQzOCwxMDggNzkzLjY3LDExMCBDNzg5LjYzLDExMS44NSA3ODkuODksMTE0LjU5IDc4NS42NywxMTYgQzc1NC40NywxMjYuNCA3NDQuMjUsMTIwLjU0IDcxMS42NywxMTYgQzcwMS4yOSwxMTQuNTUgNjk2LjIxNzUsMTEzLjY5NzUgNjg1Ljc3NzUsMTEwLjk4NzUiIGZpbGw9Im5vbmUiIGlkPSJNTC10by1Eb21haW4iIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjY3OS45NywxMDkuNDgsNjg3LjY3NjMsMTE1LjYxMyw2ODQuODA5NiwxMTAuNzM2Myw2ODkuNjg2MywxMDcuODY5Niw2NzkuOTcsMTA5LjQ4IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNDAuNDc5IiB4PSI3MjguNjciIHk9IjExMi4wNjY5Ij5tb2RlbDwvdGV4dD48L2c+PCEtLVNSQz1bTkw3UklpR200N3RGTG1uenFlVnMwdG1HNWFLS01iWHFWczBzNlJsMURBY1BUNDc0VnRWSVl3cnpGQlZFRVFjWnptR2ZHQkpqOU82bmFOSW9tSWs1RWVLODN5d0lKcWZiNmR0aDI4ZWR2N0d1bGkyWHh2dExjRHE1ODZTQ3RxZzdoV3pVQ2IzV1FnWndoejdKZUZMUjJyRXlNYXNCXzNSMWhTRTRKWkFCdU41NHdrVFZlR1Jybk5nMmNaMXd3cmplV1k3N3F5NVFFWGJDVTRPTWd1c01nX3gzNUhqRUl4UjNGU2szTEJjSXNWRmRtMmRsb1FwS2NEdTdvbDktdDBQdHk3bXc3VTZMRldWWWY0UEVqN2NPbzdxYU90TXdnUWhnTFlzcUVBUGJVeUZDWmYtbEhORzEzTkh2ZFg5U1JkQ0prbWNpRG9GbnVEOXdSSXF4QXlzSWNVVnloTTN2M0tvX10tLT48L2c+PC9zdmc+" class="uml" alt="uml diagram" title="" /></p>
<h3 id="api">APIの起動方法<a class="headerlink" href="#api" title="Permanent link">&para;</a></h3>
<p>以下のコマンドでAPIサーバーを起動します。<code>src/api</code>ディレクトリで実行してください。</p>
<div class="highlight"><pre><span></span><code><span class="c1"># uvicorn app.application:app --reload</span>
</code></pre></div>
<p>サーバーが起動すると、<code>http://127.0.0.1:8000</code>でAPIにアクセスできます。APIの仕様は、Swagger UI (<code>http://127.0.0.1:8000/docs</code>) または ReDoc (<code>http://127.0.0.1:8000/redoc</code>) で確認できます。</p>
<h3 id="_24">関連コードの詳細解説<a class="headerlink" href="#_24" title="Permanent link">&para;</a></h3>
<h4 id="1-srcapiappapplicationpy">1. エンドポイント定義 (<code>src/api/app/application.py</code>)<a class="headerlink" href="#1-srcapiappapplicationpy" title="Permanent link">&para;</a></h4>
<p>このファイルはAPIのエントリーポイントです。FastAPIアプリケーションを初期化し、各予測モデルへのエンドポイントを定義します。</p>
<ul>
<li>
<p><strong>Pydanticモデルによる型定義</strong>: <code>IrisModel</code>, <code>CinemaModel</code>などのクラスは、リクエストボディの構造とデータ型を定義します。これにより、FastAPIは自動的にリクエストデータのバリデーションと型変換を行います。不正なデータが送信された場合は、適切なエラーメッセージを返却します。</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">pydantic</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseModel</span>

<span class="k">class</span><span class="w"> </span><span class="nc">IrisModle</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">sepal_length</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">sepal_width</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">petal_length</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">petal_width</span><span class="p">:</span> <span class="nb">int</span>
<span class="c1"># ... 他のモデルも同様</span>
</code></pre></div>
</li>
<li>
<p><strong>エンドポイント関数</strong>: <code>@app.post(...)</code> デコレータは、関数を特定のパス（例: <code>/iris</code>）へのPOSTリクエストハンドラとして登録します。関数の引数にPydanticモデルを指定すると、FastAPIはリクエストボディをそのモデルのインスタンスに変換して渡します。</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Serviceクラスのインスタンスを作成</span>
<span class="n">service</span> <span class="o">=</span> <span class="n">Service</span><span class="p">()</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s2">&quot;/iris&quot;</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Iris&quot;</span><span class="p">],</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;分類1:アヤメの判別&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">predict_iris</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">IrisModle</span><span class="p">):</span>
    <span class="c1"># リクエストデータをモデルが予測できる形式に変換</span>
    <span class="n">x</span> <span class="o">=</span> <span class="p">[[</span>
        <span class="n">model</span><span class="o">.</span><span class="n">sepal_length</span><span class="p">,</span>
        <span class="n">model</span><span class="o">.</span><span class="n">sepal_width</span><span class="p">,</span>
        <span class="n">model</span><span class="o">.</span><span class="n">petal_length</span><span class="p">,</span>
        <span class="n">model</span><span class="o">.</span><span class="n">petal_width</span>
    <span class="p">]]</span>
    <span class="c1"># Serviceクラスに処理を委譲</span>
    <span class="n">resutl</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">predict_iris</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">resutl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div>
</li>
</ul>
<h4 id="2-srcapiappservicepy">2. ビジネスロジック (<code>src/api/app/service.py</code>)<a class="headerlink" href="#2-srcapiappservicepy" title="Permanent link">&para;</a></h4>
<p>このファイルは、APIのビジネスロジック（この場合は予測の実行）を担当します。APIのエンドポイントから呼び出され、ドメイン層のクラスを使って実際の処理を行います。</p>
<ul>
<li>
<p><strong>Serviceクラス</strong>: 各予測エンドポイントに対応するメソッドを持ちます。これにより、<code>application.py</code>はHTTP関連の処理に専念でき、ビジネスロジックが分離されます。</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">src.api.domain</span><span class="w"> </span><span class="kn">import</span> <span class="n">Boston</span><span class="p">,</span> <span class="n">Cinema</span><span class="p">,</span> <span class="n">Iris</span><span class="p">,</span> <span class="n">Survived</span>

<span class="k">class</span><span class="w"> </span><span class="nc">Service</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">predict_iris</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="c1"># Irisドメインクラスをインスタンス化</span>
        <span class="n">iris</span> <span class="o">=</span> <span class="n">Iris</span><span class="p">()</span>
        <span class="c1"># predictメソッドを呼び出し</span>
        <span class="k">return</span> <span class="n">iris</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="c1"># ... 他も同様の構造</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">predict_boston</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rm</span><span class="p">,</span> <span class="n">lstat</span><span class="p">,</span> <span class="n">ptratio</span><span class="p">):</span>
        <span class="n">boston</span> <span class="o">=</span> <span class="n">Boston</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">boston</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">rm</span><span class="p">,</span> <span class="n">lstat</span><span class="p">,</span> <span class="n">ptratio</span><span class="p">)</span>
</code></pre></div>
</li>
</ul>
<h4 id="3-srcapidomainpy">3. ドメインロジック (<code>src/api/domain.py</code>)<a class="headerlink" href="#3-srcapidomainpy" title="Permanent link">&para;</a></h4>
<p>このファイルは、各機械学習モデルに関するドメイン固有のロジックをカプセル化します。モデルの読み込みや、モデルに合わせたデータの前処理、予測の実行などが含まれます。</p>
<ul>
<li>
<p><strong>ドメインクラス</strong>: <code>Iris</code>, <code>Cinema</code>, <code>Survived</code>, <code>Boston</code>といったクラスが定義されています。各クラスは、対応する訓練済みモデル（<code>.pkl</code>ファイル）を読み込み、予測を実行する<code>predict</code>メソッドを持ちます。</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">pickle</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">))</span>

<span class="k">class</span><span class="w"> </span><span class="nc">Iris</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># コンストラクタでモデルを読み込む</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">path</span> <span class="o">+</span> <span class="s1">&#39;/model/iris.pkl&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="c1"># 読み込んだモデルで予測を実行</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="k">class</span><span class="w"> </span><span class="nc">Boston</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Bostonモデルは複数のファイル（モデルとスケーラー）を読み込む</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">path</span> <span class="o">+</span> <span class="s1">&#39;/model/boston.pkl&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">path</span> <span class="o">+</span> <span class="s1">&#39;/model/boston_scx.pkl&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model_scx</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">path</span> <span class="o">+</span> <span class="s1">&#39;/model/boston_scy.pkl&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model_scy</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rm</span><span class="p">,</span> <span class="n">lstat</span><span class="p">,</span> <span class="n">ptratio</span><span class="p">):</span>
        <span class="c1"># Bostonモデル固有の前処理（特徴量生成と標準化）を実行</span>
        <span class="n">rm2</span> <span class="o">=</span> <span class="n">rm</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="n">lstat2</span> <span class="o">=</span> <span class="n">lstat</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="n">ptratio2</span> <span class="o">=</span> <span class="n">ptratio</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="n">rm_lstat</span> <span class="o">=</span> <span class="n">rm</span> <span class="o">*</span> <span class="n">lstat</span>
        <span class="n">x_test</span> <span class="o">=</span> <span class="p">[[</span><span class="n">rm</span><span class="p">,</span> <span class="n">lstat</span><span class="p">,</span> <span class="n">ptratio</span><span class="p">,</span> <span class="n">rm2</span><span class="p">,</span> <span class="n">lstat2</span><span class="p">,</span> <span class="n">ptratio2</span><span class="p">,</span> <span class="n">rm_lstat</span><span class="p">]]</span>
        <span class="n">sc_x_test</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_scx</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">sc_x_test</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">result</span>
</code></pre></div>
</li>
</ul>
<p>このように、関心の分離（Separation of Concerns）の原則に従ってコードが構成されており、保守性と拡張性の高いアーキテクチャとなっています。</p>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
    <a href="https://github.com/k2works" target="_blank" rel="noopener" title="GitHub Repository/claude-code-booster" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.sections", "toc.integrate", "search.suggest", "search.highlight"], "search": "../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
      
        <script src="../../../docs/assets/js/extra.js"></script>
      
    
  </body>
</html>