
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Site Description">
      
      
        <meta name="author" content="Project Team">
      
      
      
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>ã·ã‚ˆã·ã‚ˆã‹ã‚‰å§‹ã‚ã‚‹ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºå…¥é–€ - Elm ç‰ˆ - Site Name</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../docs/mkdocs/assets/css/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#-elm" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Site Name" class="md-header__button md-logo" aria-label="Site Name" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Site Name
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              ã·ã‚ˆã·ã‚ˆã‹ã‚‰å§‹ã‚ã‚‹ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºå…¥é–€ - Elm ç‰ˆ
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/k2works/claude-code-booster" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    claude-code-booster
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Site Name" class="md-nav__button md-logo" aria-label="Site Name" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Site Name
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/k2works/claude-code-booster" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    claude-code-booster
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="-elm">ã·ã‚ˆã·ã‚ˆã‹ã‚‰å§‹ã‚ã‚‹ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºå…¥é–€ - Elm ç‰ˆ<a class="headerlink" href="#-elm" title="Permanent link">&para;</a></h1>
<h2 id="_1">ã¯ã˜ã‚ã«<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p>ã¿ãªã•ã‚“ã€ã“ã‚“ã«ã¡ã¯ï¼ä»Šæ—¥ã¯ç§ã¨ä¸€ç·’ã«ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºï¼ˆTDDï¼‰ã‚’ä½¿ã£ã¦ã€Elm ã§ã·ã‚ˆã·ã‚ˆã‚²ãƒ¼ãƒ ã‚’ä½œã£ã¦ã„ãã¾ã—ã‚‡ã†ã€‚</p>
<blockquote>
<p>ãƒ†ã‚¹ãƒˆã‚’æ›¸ããªãŒã‚‰é–‹ç™ºã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ã€è¨­è¨ˆãŒè‰¯ã„æ–¹å‘ã«å¤‰ã‚ã‚Šã€ã‚³ãƒ¼ãƒ‰ãŒæ”¹å–„ã•ã‚Œç¶šã‘ã€ãã‚Œã«ã‚ˆã£ã¦è‡ªåˆ†è‡ªèº«ãŒé–‹ç™ºã«å‰å‘ãã«ãªã‚‹ã“ã¨ã€ãã‚ŒãŒãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã®ç›®æŒ‡ã™ã‚´ãƒ¼ãƒ«ã§ã™ã€‚</p>
<p>â€” Kent Beck ã€ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã€ ä»˜éŒ²Cã€€è¨³è€…è§£èª¬ï¼šãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã®ç¾åœ¨</p>
</blockquote>
<p>ã“ã®è¨˜äº‹ã§ã¯ã€Elm ã‚’ä½¿ã£ã¦ã·ã‚ˆã·ã‚ˆã‚²ãƒ¼ãƒ ã‚’å®Ÿè£…ã—ãªãŒã‚‰ã€ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã®åŸºæœ¬çš„ãªæµã‚Œã¨è€ƒãˆæ–¹ã‚’å­¦ã‚“ã§ã„ãã¾ã™ã€‚</p>
<h3 id="elm">Elm ã¨ã¯ï¼Ÿ<a class="headerlink" href="#elm" title="Permanent link">&para;</a></h3>
<p>ã€ŒElm ã£ã¦ä½•ï¼Ÿã€ã¨æ€ã‚ã‚Œã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã­ã€‚Elm ã¯ã€Web ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰é–‹ç™ºã®ãŸã‚ã®é–¢æ•°å‹ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªã§ã™ã€‚</p>
<p><strong>Elm ã®ç‰¹å¾´</strong>ï¼š
- <strong>å®Ÿè¡Œæ™‚ã‚¨ãƒ©ãƒ¼ãªã—</strong>: Elm ã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ãŒå‹ãƒã‚§ãƒƒã‚¯ã§å¤šãã®ãƒã‚°ã‚’é˜²ã
- <strong>è¦ªåˆ‡ãªã‚³ãƒ³ãƒ‘ã‚¤ãƒ©</strong>: ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒåˆ†ã‹ã‚Šã‚„ã™ãã€å•é¡Œè§£æ±ºã®ãƒ’ãƒ³ãƒˆã‚’æç¤º
- <strong>The Elm Architecture</strong>: ã‚·ãƒ³ãƒ—ãƒ«ã§äºˆæ¸¬å¯èƒ½ãªã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãƒ‘ã‚¿ãƒ¼ãƒ³
- <strong>ç´”ç²‹é–¢æ•°å‹</strong>: å‰¯ä½œç”¨ãŒåˆ¶å¾¡ã•ã‚Œã€ãƒ†ã‚¹ãƒˆã—ã‚„ã™ã„ã‚³ãƒ¼ãƒ‰</p>
<h3 id="_2">ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã®ã‚µã‚¤ã‚¯ãƒ«<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h3>
<p>Elm ã§ã‚‚ã€ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã®åŸºæœ¬ã¯åŒã˜ã§ã™ï¼š</p>
<ol>
<li><strong>Redï¼ˆèµ¤ï¼‰</strong>: å¤±æ•—ã™ã‚‹ãƒ†ã‚¹ãƒˆã‚’æ›¸ã</li>
<li><strong>Greenï¼ˆç·‘ï¼‰</strong>: ãƒ†ã‚¹ãƒˆãŒé€šã‚‹æœ€å°é™ã®å®Ÿè£…</li>
<li><strong>Refactorï¼ˆãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ï¼‰</strong>: ã‚³ãƒ¼ãƒ‰ã®å“è³ªã‚’æ”¹å–„</li>
</ol>
<blockquote>
<p>ãƒ¬ãƒƒãƒ‰ãƒ»ã‚°ãƒªãƒ¼ãƒ³ãƒ»ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã€‚ãã‚ŒãŒTDDã®ãƒãƒ³ãƒˆãƒ©ã ã€‚</p>
<p>â€” Kent Beck ã€ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã€</p>
</blockquote>
<h3 id="_3">é–‹ç™ºç’°å¢ƒ<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
<p>Elm ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ã€ä»¥ä¸‹ã®ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ã¾ã™ï¼š</p>
<ul>
<li><strong>è¨€èª</strong>: Elm â€” å‹å®‰å…¨ãªé–¢æ•°å‹è¨€èª</li>
<li><strong>ãƒ“ãƒ«ãƒ‰ãƒ„ãƒ¼ãƒ«</strong>: elm make â€” Elm å…¬å¼ã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©</li>
<li><strong>é–‹ç™ºã‚µãƒ¼ãƒãƒ¼</strong>: elm reactor â€” é–‹ç™ºç”¨ã®ç°¡æ˜“ã‚µãƒ¼ãƒãƒ¼</li>
<li><strong>ãƒ†ã‚¹ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯</strong>: elm-test â€” Elm å…¬å¼ã®ãƒ†ã‚¹ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯</li>
<li><strong>ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç®¡ç†</strong>: elm install â€” Elm å…¬å¼ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼</li>
<li><strong>ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†</strong>: Git â€” ã‚³ãƒ¼ãƒ‰ç®¡ç†</li>
</ul>
<h2 id="0">ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³0: ç’°å¢ƒã®æ§‹ç¯‰<a class="headerlink" href="#0" title="Permanent link">&para;</a></h2>
<p>ã€Œç’°å¢ƒæ§‹ç¯‰ã£ã¦é›£ã—ãã†...ã€ã¨æ€ã‚ã‚Œã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒã€Elm ã®ç’°å¢ƒæ§‹ç¯‰ã¯é©šãã»ã©ã‚·ãƒ³ãƒ—ãƒ«ã§ã™ï¼</p>
<h3 id="_4">ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h3>
<blockquote>
<p>é–‹ç™ºè€…ã¨ã—ã¦ã€Elm é–‹ç™ºç’°å¢ƒã‚’ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã—ã¦ã€ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã‚’å§‹ã‚ã‚‰ã‚Œã‚‹ã‚ˆã†ã«ã—ãŸã„</p>
</blockquote>
<h3 id="_5">å¿…è¦ãªãƒ„ãƒ¼ãƒ«ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h3>
<h4 id="1-nodejs">1. Node.js ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«<a class="headerlink" href="#1-nodejs" title="Permanent link">&para;</a></h4>
<p>Elm ã¯ Node.js ã‚’å¿…è¦ã¨ã—ã¾ã™ã€‚</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Node.js ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç¢ºèª</span>
node<span class="w"> </span>--version
npm<span class="w"> </span>--version
</code></pre></div>
<p>ã¾ã ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ãªã„å ´åˆã¯ã€https://nodejs.org/ ã‹ã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãã ã•ã„ã€‚</p>
<h4 id="2-elm">2. Elm ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«<a class="headerlink" href="#2-elm" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># Elm ã‚’ã‚°ãƒ­ãƒ¼ãƒãƒ«ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</span>
npm<span class="w"> </span>install<span class="w"> </span>-g<span class="w"> </span>elm

<span class="c1"># Elm ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç¢ºèª</span>
elm<span class="w"> </span>--version
</code></pre></div>
<h4 id="3-elm-test">3. elm-test ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«<a class="headerlink" href="#3-elm-test" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># elm-test ã‚’ã‚°ãƒ­ãƒ¼ãƒãƒ«ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</span>
npm<span class="w"> </span>install<span class="w"> </span>-g<span class="w"> </span>elm-test

<span class="c1"># elm-test ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç¢ºèª</span>
elm-test<span class="w"> </span>--version
</code></pre></div>
<h3 id="_6">ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®åˆæœŸåŒ–<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h3>
<h4 id="1">1. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ä½œæˆ<a class="headerlink" href="#1" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆ</span>
mkdir<span class="w"> </span>puyo-puyo-elm
<span class="nb">cd</span><span class="w"> </span>puyo-puyo-elm

<span class="c1"># Git ãƒªãƒã‚¸ãƒˆãƒªã‚’åˆæœŸåŒ–</span>
git<span class="w"> </span>init
</code></pre></div>
<h4 id="2-elm_1">2. Elm ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®åˆæœŸåŒ–<a class="headerlink" href="#2-elm_1" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># elm.json ã‚’ä½œæˆ</span>
elm<span class="w"> </span>init
</code></pre></div>
<p><code>elm.json</code> ãŒä½œæˆã•ã‚Œã¾ã™ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;application&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;source-directories&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="s2">&quot;src&quot;</span>
<span class="w">    </span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;elm-version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;0.19.1&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;dependencies&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;direct&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;elm/browser&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1.0.2&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;elm/core&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1.0.5&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;elm/html&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1.0.0&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;indirect&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;elm/json&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1.1.3&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;elm/time&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;elm/url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;elm/virtual-dom&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1.0.3&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;test-dependencies&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;direct&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span>
<span class="w">        </span><span class="nt">&quot;indirect&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h4 id="3">3. ãƒ†ã‚¹ãƒˆç’°å¢ƒã®åˆæœŸåŒ–<a class="headerlink" href="#3" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># ãƒ†ã‚¹ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¨ã‚µãƒ³ãƒ—ãƒ«ãƒ†ã‚¹ãƒˆã‚’ä½œæˆ</span>
elm-test<span class="w"> </span>init
</code></pre></div>
<p>ã“ã‚Œã«ã‚ˆã‚Šã€<code>tests/</code> ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¨ <code>tests/Example.elm</code> ãŒä½œæˆã•ã‚Œã¾ã™ã€‚</p>
<h4 id="4">4. å¿…è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«<a class="headerlink" href="#4" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># Time ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆã‚²ãƒ¼ãƒ ãƒ«ãƒ¼ãƒ—ç”¨ï¼‰</span>
elm<span class="w"> </span>install<span class="w"> </span>elm/time

<span class="c1"># Random ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆãƒ©ãƒ³ãƒ€ãƒ ãªã·ã‚ˆç”Ÿæˆç”¨ï¼‰</span>
elm<span class="w"> </span>install<span class="w"> </span>elm/random

<span class="c1"># ãƒ†ã‚¹ãƒˆç”¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸</span>
elm-test<span class="w"> </span>install<span class="w"> </span>elm-explorations/test
</code></pre></div>
<h3 id="_7">ã‚¿ã‚¹ã‚¯ãƒ©ãƒ³ãƒŠãƒ¼ã®è¨­å®š<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h3>
<p>ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ç®¡ç†ã‚’ç°¡å˜ã«ã™ã‚‹ãŸã‚ã€npm scripts ã‚’ã‚¿ã‚¹ã‚¯ãƒ©ãƒ³ãƒŠãƒ¼ã¨ã—ã¦ä½¿ç”¨ã—ã¾ã™ã€‚</p>
<h4 id="packagejson">package.json ã®ä½œæˆ<a class="headerlink" href="#packagejson" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1"># package.json ã‚’ä½œæˆ</span>
npm<span class="w"> </span>init<span class="w"> </span>-y
</code></pre></div>
<p><code>package.json</code> ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«ç·¨é›†ã—ã¾ã™ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;puyo-puyo-elm&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Elm version of Puyo Puyo TDD tutorial&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;scripts&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;test&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;elm-test&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;dev&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;elm reactor&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;build&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;elm make src/Main.elm --output=dist/main.js --optimize&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;build:dev&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;elm make src/Main.elm --output=dist/main.js&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;watch&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;elm-test --watch&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;clean&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;rimraf dist elm-stuff&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;release&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;npm test &amp;&amp; npm run build &amp;&amp; echo Release build completed successfully!&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;serve&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;npx http-server dist -p 8080 -o&quot;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;devDependencies&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;elm&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;^0.19.1-5&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;elm-test&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;^0.19.1-revision12&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h4 id="npm-scripts">npm scripts ã®èª¬æ˜<a class="headerlink" href="#npm-scripts" title="Permanent link">&para;</a></h4>
<p>å„ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å½¹å‰²ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ï¼š</p>
<ul>
<li><strong><code>npm test</code></strong>: ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ</li>
<li><strong><code>npm run dev</code></strong>: elm reactor ã§é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•ï¼ˆhttp://localhost:8000ï¼‰</li>
<li><strong><code>npm run build</code></strong>: æœ¬ç•ªç”¨ãƒ“ãƒ«ãƒ‰ï¼ˆæœ€é©åŒ–ã‚ã‚Šï¼‰</li>
<li><strong><code>npm run build:dev</code></strong>: é–‹ç™ºç”¨ãƒ“ãƒ«ãƒ‰ï¼ˆãƒ‡ãƒãƒƒã‚°ç”¨ï¼‰</li>
<li><strong><code>npm run watch</code></strong>: ãƒ†ã‚¹ãƒˆã®ç›£è¦–ãƒ¢ãƒ¼ãƒ‰ï¼ˆãƒ•ã‚¡ã‚¤ãƒ«å¤‰æ›´æ™‚ã«è‡ªå‹•å®Ÿè¡Œï¼‰</li>
<li><strong><code>npm run clean</code></strong>: ãƒ“ãƒ«ãƒ‰æˆæœç‰©ã¨ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’å‰Šé™¤</li>
<li><strong><code>npm run release</code></strong>: ãƒªãƒªãƒ¼ã‚¹ã‚¿ã‚¹ã‚¯ï¼ˆãƒ†ã‚¹ãƒˆâ†’æœ¬ç•ªãƒ“ãƒ«ãƒ‰ï¼‰</li>
<li><strong><code>npm run serve</code></strong>: ãƒ“ãƒ«ãƒ‰ã—ãŸã‚¢ãƒ—ãƒªã‚’ãƒ–ãƒ©ã‚¦ã‚¶ã§å®Ÿè¡Œï¼ˆhttp://localhost:8080ï¼‰</li>
</ul>
<h4 id="html">ãƒªãƒªãƒ¼ã‚¹ç”¨ HTML ãƒ•ã‚¡ã‚¤ãƒ«ã®æº–å‚™<a class="headerlink" href="#html" title="Permanent link">&para;</a></h4>
<p>ãƒ“ãƒ«ãƒ‰ã—ãŸã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã® HTML ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”¨æ„ã—ã¾ã™ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="cm">&lt;!-- dist/index.html --&gt;</span>
<span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&quot;ja&quot;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&quot;UTF-8&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;viewport&quot;</span> <span class="na">content</span><span class="o">=</span><span class="s">&quot;width=device-width, initial-scale=1.0&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>ã·ã‚ˆã·ã‚ˆ - Elm ç‰ˆ<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">style</span><span class="p">&gt;</span>
<span class="w">        </span><span class="nt">body</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">margin</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">            </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">            </span><span class="k">font-family</span><span class="p">:</span><span class="w"> </span><span class="n">Arial</span><span class="p">,</span><span class="w"> </span><span class="kc">sans-serif</span><span class="p">;</span>
<span class="w">            </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#1a1a1a</span><span class="p">;</span>
<span class="w">            </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#ffffff</span><span class="p">;</span>
<span class="w">            </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="kc">flex</span><span class="p">;</span>
<span class="w">            </span><span class="k">justify-content</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span>
<span class="w">            </span><span class="k">align-items</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span>
<span class="w">            </span><span class="k">min-height</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">vh</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="p">#</span><span class="nn">app</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#2a2a2a</span><span class="p">;</span>
<span class="w">            </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
<span class="w">            </span><span class="k">border-radius</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
<span class="w">            </span><span class="k">box-shadow</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">4</span><span class="kt">px</span><span class="w"> </span><span class="mi">6</span><span class="kt">px</span><span class="w"> </span><span class="nb">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.3</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;app&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;main.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="nx">app</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">Elm</span><span class="p">.</span><span class="nx">Main</span><span class="p">.</span><span class="nx">init</span><span class="p">({</span>
<span class="w">            </span><span class="nx">node</span><span class="o">:</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;app&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="p">});</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div>
<h4 id="gitignore">.gitignore ã®æ›´æ–°<a class="headerlink" href="#gitignore" title="Permanent link">&para;</a></h4>
<p>npm é–¢é€£ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¨ãƒ“ãƒ«ãƒ‰æˆæœç‰©ã‚’é™¤å¤–ã—ã¾ã™ï¼š</p>
<div class="highlight"><pre><span></span><code># Elm
elm-stuff/

# elm-test
tests/VerifyExamples/

# npm
node_modules/

# ãƒ“ãƒ«ãƒ‰æˆæœç‰©
dist/*.js
dist/*.js.map

# ã‚¨ãƒ‡ã‚£ã‚¿
.vscode/
.idea/
*.swp
*.swo
*~

# OS
.DS_Store
Thumbs.db
</code></pre></div>
<p><strong>æ³¨æ„</strong>: <code>dist/index.html</code> ã¯é…å¸ƒç‰©ã¨ã—ã¦å¿…è¦ãªãŸã‚ã€git ã®ç®¡ç†å¯¾è±¡ã«å«ã‚ã¾ã™ã€‚</p>
<h3 id="_8">ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆ<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>puyo-puyo-elm/
â”œâ”€â”€ elm.json              # Elm ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¨­å®š
â”œâ”€â”€ package.json          # npm scripts å®šç¾©
â”œâ”€â”€ package-lock.json     # npm ä¾å­˜é–¢ä¿‚ãƒ­ãƒƒã‚¯
â”œâ”€â”€ src/                  # ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰
â”‚   â”œâ”€â”€ Main.elm          # ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
â”‚   â”œâ”€â”€ Board.elm         # ãƒœãƒ¼ãƒ‰ç®¡ç†
â”‚   â”œâ”€â”€ Cell.elm          # ã‚»ãƒ«å®šç¾©
â”‚   â”œâ”€â”€ PuyoColor.elm     # ã·ã‚ˆã®è‰²
â”‚   â”œâ”€â”€ PuyoPair.elm      # ã·ã‚ˆãƒšã‚¢
â”‚   â””â”€â”€ GameLogic.elm     # ã‚²ãƒ¼ãƒ ãƒ­ã‚¸ãƒƒã‚¯
â”œâ”€â”€ tests/                # ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰
â”‚   â”œâ”€â”€ BoardTests.elm
â”‚   â”œâ”€â”€ PuyoPairTests.elm
â”‚   â”œâ”€â”€ GameLogicTests.elm
â”‚   â””â”€â”€ MainTests.elm
â”œâ”€â”€ dist/                 # ãƒ“ãƒ«ãƒ‰æˆæœç‰©
â”‚   â”œâ”€â”€ index.html        # ã‚¨ãƒ³ãƒˆãƒªãƒ¼HTMLï¼ˆé…å¸ƒç”¨ï¼‰
â”‚   â”œâ”€â”€ main.js           # ãƒ“ãƒ«ãƒ‰ã•ã‚ŒãŸ JavaScriptï¼ˆ.gitignoreï¼‰
â”‚   â””â”€â”€ main.js.map       # ã‚½ãƒ¼ã‚¹ãƒãƒƒãƒ—ï¼ˆ.gitignoreï¼‰
â”œâ”€â”€ .gitignore            # Git é™¤å¤–è¨­å®š
â””â”€â”€ README.md             # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆèª¬æ˜
</code></pre></div>
<h3 id="the-elm-architecture">The Elm Architecture ã®åŸºæœ¬<a class="headerlink" href="#the-elm-architecture" title="Permanent link">&para;</a></h3>
<p>Elm ã§ã¯ã€ã™ã¹ã¦ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒ <strong>The Elm Architecture (TEA)</strong> ã¨ã„ã†ãƒ‘ã‚¿ãƒ¼ãƒ³ã«å¾“ã„ã¾ã™ã€‚</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- Model: ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®çŠ¶æ…‹</span>
<span class="kr">type</span><span class="w"> </span><span class="kr">alias</span><span class="w"> </span><span class="kt">Model</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nv">count</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Int</span>
<span class="w">    </span><span class="p">}</span>

<span class="c1">-- Message: çŠ¶æ…‹ã‚’å¤‰æ›´ã™ã‚‹ã‚¤ãƒ™ãƒ³ãƒˆ</span>
<span class="kr">type</span><span class="w"> </span><span class="kt">Msg</span>
<span class="w">    </span><span class="nf">=</span><span class="w"> </span><span class="kt">Increment</span>
<span class="w">    </span><span class="nf">|</span><span class="w"> </span><span class="kt">Decrement</span>

<span class="c1">-- init: åˆæœŸçŠ¶æ…‹</span>
<span class="nv">init</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Model</span>
<span class="nv">init</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nv">count</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">    </span><span class="p">}</span>

<span class="c1">-- update: ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«å¿œã˜ã¦çŠ¶æ…‹ã‚’æ›´æ–°</span>
<span class="nv">update</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Msg</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Model</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Model</span>
<span class="nv">update</span><span class="w"> </span><span class="nv">msg</span><span class="w"> </span><span class="nv">model</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="kr">case</span><span class="w"> </span><span class="nv">msg</span><span class="w"> </span><span class="kr">of</span>
<span class="w">        </span><span class="kt">Increment</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="p">{</span><span class="w"> </span><span class="nv">model</span><span class="w"> </span><span class="nf">|</span><span class="w"> </span><span class="nv">count</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">count</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">}</span>

<span class="w">        </span><span class="kt">Decrement</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="p">{</span><span class="w"> </span><span class="nv">model</span><span class="w"> </span><span class="nf">|</span><span class="w"> </span><span class="nv">count</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">count</span><span class="w"> </span><span class="nf">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">}</span>

<span class="c1">-- view: çŠ¶æ…‹ã‚’ HTML ã«å¤‰æ›</span>
<span class="nv">view</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Model</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Html</span><span class="w"> </span><span class="kt">Msg</span>
<span class="nv">view</span><span class="w"> </span><span class="nv">model</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="nv">div</span><span class="w"> </span><span class="p">[]</span>
<span class="w">        </span><span class="p">[</span><span class="w"> </span><span class="nv">button</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="nv">onClick</span><span class="w"> </span><span class="kt">Decrement</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="nv">text</span><span class="w"> </span><span class="s">&quot;-&quot;</span><span class="w"> </span><span class="p">]</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">text</span><span class="w"> </span><span class="p">(</span><span class="kt">String</span><span class="nf">.</span><span class="nv">fromInt</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">count</span><span class="p">)</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">button</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="nv">onClick</span><span class="w"> </span><span class="kt">Increment</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="nv">text</span><span class="w"> </span><span class="s">&quot;+&quot;</span><span class="w"> </span><span class="p">]</span>
<span class="w">        </span><span class="p">]</span>
</code></pre></div>
<p>ã€Œã‚·ãƒ³ãƒ—ãƒ«ã§ã™ã­ï¼ã€ãã†ãªã‚“ã§ã™ã€‚Elm ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¯ã€ä»¥ä¸‹ã® 3 ã¤ã®é–¢æ•°ã§æ§‹æˆã•ã‚Œã¾ã™ï¼š</p>
<ol>
<li><strong>Model</strong>: ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®çŠ¶æ…‹ã‚’å®šç¾©</li>
<li><strong>Update</strong>: ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å—ã‘å–ã‚Šã€æ–°ã—ã„çŠ¶æ…‹ã‚’è¿”ã™</li>
<li><strong>View</strong>: çŠ¶æ…‹ã‚’å—ã‘å–ã‚Šã€HTML ã‚’è¿”ã™</li>
</ol>
<h3 id="_9">æœ€å°é™ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h3>
<p>ã¾ãšã€å‹•ä½œç¢ºèªã®ãŸã‚ã«æœ€å°é™ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã—ã¾ã—ã‚‡ã†ã€‚</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- src/Main.elm</span>
<span class="kn">module</span><span class="w"> </span><span class="nc">Main</span><span class="w"> </span><span class="nv">exposing</span><span class="w"> </span><span class="p">(</span><span class="nv">main</span><span class="p">)</span>

<span class="kn">import</span><span class="w"> </span><span class="nc">Browser</span>
<span class="kn">import</span><span class="w"> </span><span class="nc">Html</span><span class="w"> </span><span class="nv">exposing</span><span class="w"> </span><span class="p">(</span><span class="kt">Html</span><span class="p">,</span><span class="w"> </span><span class="nv">div</span><span class="p">,</span><span class="w"> </span><span class="nv">h1</span><span class="p">,</span><span class="w"> </span><span class="nv">text</span><span class="p">)</span>


<span class="c1">-- MODEL</span>

<span class="kr">type</span><span class="w"> </span><span class="kr">alias</span><span class="w"> </span><span class="kt">Model</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="p">{}</span>


<span class="nv">init</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Model</span>
<span class="nv">init</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="p">{}</span>


<span class="c1">-- UPDATE</span>

<span class="kr">type</span><span class="w"> </span><span class="kt">Msg</span>
<span class="w">    </span><span class="nf">=</span><span class="w"> </span><span class="kt">NoOp</span>


<span class="nv">update</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Msg</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Model</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Model</span>
<span class="nv">update</span><span class="w"> </span><span class="nv">msg</span><span class="w"> </span><span class="nv">model</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="kr">case</span><span class="w"> </span><span class="nv">msg</span><span class="w"> </span><span class="kr">of</span>
<span class="w">        </span><span class="kt">NoOp</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="nv">model</span>


<span class="c1">-- VIEW</span>

<span class="nv">view</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Model</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Html</span><span class="w"> </span><span class="kt">Msg</span>
<span class="nv">view</span><span class="w"> </span><span class="nv">model</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="nv">div</span><span class="w"> </span><span class="p">[]</span>
<span class="w">        </span><span class="p">[</span><span class="w"> </span><span class="nv">h1</span><span class="w"> </span><span class="p">[]</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="nv">text</span><span class="w"> </span><span class="s">&quot;ã·ã‚ˆã·ã‚ˆ - Elm ç‰ˆ&quot;</span><span class="w"> </span><span class="p">]</span>
<span class="w">        </span><span class="p">]</span>


<span class="c1">-- MAIN</span>

<span class="kr">main </span><span class="nf">:</span><span class="w"> </span><span class="kt">Program</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="kt">Model</span><span class="w"> </span><span class="kt">Msg</span>
<span class="kr">main </span><span class="nf">=</span>
<span class="w">    </span><span class="kt">Browser</span><span class="nf">.</span><span class="nv">sandbox</span>
<span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="nv">init</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">init</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">update</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">update</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">view</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">view</span>
<span class="w">        </span><span class="p">}</span>
</code></pre></div>
<h3 id="_10">ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®å®Ÿè¡Œ<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h3>
<p>npm scripts ã‚’ä½¿ã£ã¦é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•ã—ã¾ã™ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1"># é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•</span>
npm<span class="w"> </span>run<span class="w"> </span>dev
</code></pre></div>
<p>ãƒ–ãƒ©ã‚¦ã‚¶ã§ http://localhost:8000 ã‚’é–‹ãã€<code>src/Main.elm</code> ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</p>
<h3 id="_11">ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œ<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h3>
<p>npm scripts ã‚’ä½¿ã£ã¦ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1"># ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ</span>
npm<span class="w"> </span><span class="nb">test</span>

<span class="c1"># ã¾ãŸã¯ã€ãƒ•ã‚¡ã‚¤ãƒ«å¤‰æ›´æ™‚ã«è‡ªå‹•å®Ÿè¡Œï¼ˆç›£è¦–ãƒ¢ãƒ¼ãƒ‰ï¼‰</span>
npm<span class="w"> </span>run<span class="w"> </span>watch
</code></pre></div>
<h3 id="_12">ãƒªãƒªãƒ¼ã‚¹ãƒ“ãƒ«ãƒ‰ã¨ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®å®Ÿè¡Œ<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h3>
<p>é–‹ç™ºãŒé€²ã‚“ã ã‚‰ã€æœ€é©åŒ–ã•ã‚ŒãŸãƒ“ãƒ«ãƒ‰ã‚’ä½œæˆã—ã¦å®Ÿè¡Œã§ãã¾ã™ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1"># ãƒªãƒªãƒ¼ã‚¹ãƒ“ãƒ«ãƒ‰ï¼ˆãƒ†ã‚¹ãƒˆâ†’æœ€é©åŒ–ãƒ“ãƒ«ãƒ‰ï¼‰</span>
npm<span class="w"> </span>run<span class="w"> </span>release

<span class="c1"># ãƒ“ãƒ«ãƒ‰ã—ãŸã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ãƒ–ãƒ©ã‚¦ã‚¶ã§å®Ÿè¡Œ</span>
npm<span class="w"> </span>run<span class="w"> </span>serve
</code></pre></div>
<p>ã“ã‚Œã«ã‚ˆã‚Šã€http://localhost:8080 ã§ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒèµ·å‹•ã—ã¾ã™ã€‚</p>
<h3 id="_13">æœ€åˆã®ã‚³ãƒŸãƒƒãƒˆ<a class="headerlink" href="#_13" title="Permanent link">&para;</a></h3>
<p>ç’°å¢ƒæ§‹ç¯‰ãŒå®Œäº†ã—ãŸã‚‰ã€ã‚³ãƒŸãƒƒãƒˆã—ã¾ã—ã‚‡ã†ï¼š</p>
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>add<span class="w"> </span>.
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>cat<span class="w"> </span><span class="s">&lt;&lt;&#39;EOF&#39;</span>
<span class="s">chore: initialize Elm project</span>

<span class="s">- Install Elm and elm-test</span>
<span class="s">- Create elm.json with basic dependencies</span>
<span class="s">- Set up project structure (src/ and tests/)</span>
<span class="s">- Add minimal Main.elm application</span>
<span class="s">- Add package.json with npm scripts (test, dev, build, release, serve)</span>
<span class="s">- Add dist/index.html for running built application</span>
<span class="s">- Add .gitignore for Elm and npm projects</span>
<span class="s">- Verify npm test and npm run dev work</span>

<span class="s">ğŸ¤– Generated with [Claude Code](https://claude.com/claude-code)</span>

<span class="s">Co-Authored-By: Claude &lt;noreply@anthropic.com&gt;</span>
<span class="s">EOF</span>
<span class="k">)</span><span class="s2">&quot;</span>
</code></pre></div>
<h3 id="elm_1">Elm ã®å‹ã‚·ã‚¹ãƒ†ãƒ <a class="headerlink" href="#elm_1" title="Permanent link">&para;</a></h3>
<p>Elm ã®å¼·åŠ›ãªå‹ã‚·ã‚¹ãƒ†ãƒ ã«ã¤ã„ã¦å°‘ã—èª¬æ˜ã—ã¾ã—ã‚‡ã†ã€‚</p>
<h4 id="custom-types">ã‚«ã‚¹ã‚¿ãƒ å‹ï¼ˆCustom Typesï¼‰<a class="headerlink" href="#custom-types" title="Permanent link">&para;</a></h4>
<p>Elm ã§ã¯ã€ç‹¬è‡ªã®å‹ã‚’å®šç¾©ã§ãã¾ã™ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- ã‚»ãƒ«ã®çŠ¶æ…‹ã‚’è¡¨ã™å‹</span>
<span class="kr">type</span><span class="w"> </span><span class="kt">Cell</span>
<span class="w">    </span><span class="nf">=</span><span class="w"> </span><span class="kt">Empty</span>
<span class="w">    </span><span class="nf">|</span><span class="w"> </span><span class="kt">Filled</span><span class="w"> </span><span class="kt">PuyoColor</span>

<span class="c1">-- ã·ã‚ˆã®è‰²ã‚’è¡¨ã™å‹</span>
<span class="kr">type</span><span class="w"> </span><span class="kt">PuyoColor</span>
<span class="w">    </span><span class="nf">=</span><span class="w"> </span><span class="kt">Red</span>
<span class="w">    </span><span class="nf">|</span><span class="w"> </span><span class="kt">Green</span>
<span class="w">    </span><span class="nf">|</span><span class="w"> </span><span class="kt">Blue</span>
<span class="w">    </span><span class="nf">|</span><span class="w"> </span><span class="kt">Yellow</span>
</code></pre></div>
<p>ã€Œåˆ¤åˆ¥å…±ç”¨ä½“ã¿ãŸã„ãªã‚‚ã®ã§ã™ã­ï¼ã€ãã†ã§ã™ã€‚Elm ã®ã‚«ã‚¹ã‚¿ãƒ å‹ã¯ã€F# ã®åˆ¤åˆ¥å…±ç”¨ä½“ã‚„ TypeScript ã® Union å‹ã«ä¼¼ã¦ã„ã¾ã™ã€‚</p>
<h4 id="_14">ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°<a class="headerlink" href="#_14" title="Permanent link">&para;</a></h4>
<p>ã‚«ã‚¹ã‚¿ãƒ å‹ã‚’ä½¿ã†å ´åˆã¯ã€ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°ã§åˆ†å²ã—ã¾ã™ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="nv">cellToColor</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Cell</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">String</span>
<span class="nv">cellToColor</span><span class="w"> </span><span class="nv">cell</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="kr">case</span><span class="w"> </span><span class="nv">cell</span><span class="w"> </span><span class="kr">of</span>
<span class="w">        </span><span class="kt">Empty</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="s">&quot;white&quot;</span>

<span class="w">        </span><span class="kt">Filled</span><span class="w"> </span><span class="kt">Red</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="s">&quot;red&quot;</span>

<span class="w">        </span><span class="kt">Filled</span><span class="w"> </span><span class="kt">Green</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="s">&quot;green&quot;</span>

<span class="w">        </span><span class="kt">Filled</span><span class="w"> </span><span class="kt">Blue</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="s">&quot;blue&quot;</span>

<span class="w">        </span><span class="kt">Filled</span><span class="w"> </span><span class="kt">Yellow</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="s">&quot;yellow&quot;</span>
</code></pre></div>
<p>ã€Œç¶²ç¾…æ€§ãƒã‚§ãƒƒã‚¯ãŒã‚ã‚‹ã‚“ã§ã™ã­ï¼ã€ãã†ã§ã™ã€‚ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ãŒã™ã¹ã¦ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã‚Œã‚‹ã®ã§ã€æ¼ã‚ŒãŒã‚ã‚Šã¾ã›ã‚“ã€‚</p>
<h4 id="maybe">Maybe å‹<a class="headerlink" href="#maybe" title="Permanent link">&para;</a></h4>
<p>Elm ã«ã¯ <code>null</code> ãŒã‚ã‚Šã¾ã›ã‚“ã€‚ä»£ã‚ã‚Šã« <code>Maybe</code> å‹ã‚’ä½¿ã„ã¾ã™ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="kr">type</span><span class="w"> </span><span class="kt">Maybe</span><span class="w"> </span><span class="nv">a</span>
<span class="w">    </span><span class="nf">=</span><span class="w"> </span><span class="kt">Just</span><span class="w"> </span><span class="nv">a</span>
<span class="w">    </span><span class="nf">|</span><span class="w"> </span><span class="kt">Nothing</span>

<span class="c1">-- é…åˆ—ã‹ã‚‰è¦ç´ ã‚’å–å¾—ï¼ˆå¤±æ•—ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ï¼‰</span>
<span class="kt">Array</span><span class="nf">.</span><span class="nv">get</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Array</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Maybe</span><span class="w"> </span><span class="nv">a</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1">-- Maybe å‹ã®ä½¿ç”¨ä¾‹</span>
<span class="nv">getCell</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Maybe</span><span class="w"> </span><span class="kt">Cell</span>
<span class="nv">getCell</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="kr">if</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nf">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="nf">&amp;&amp;</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nf">&lt;</span><span class="w"> </span><span class="nv">board</span><span class="nf">.</span><span class="nv">cols</span><span class="w"> </span><span class="nf">&amp;&amp;</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nf">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="nf">&amp;&amp;</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nf">&lt;</span><span class="w"> </span><span class="nv">board</span><span class="nf">.</span><span class="nv">rows</span><span class="w"> </span><span class="kr">then</span>
<span class="w">        </span><span class="kt">Array</span><span class="nf">.</span><span class="nv">get</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nv">board</span><span class="nf">.</span><span class="nv">cells</span>
<span class="w">            </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Maybe</span><span class="nf">.</span><span class="nv">andThen</span><span class="w"> </span><span class="p">(</span><span class="kt">Array</span><span class="nf">.</span><span class="nv">get</span><span class="w"> </span><span class="nv">x</span><span class="p">)</span>
<span class="w">    </span><span class="kr">else</span>
<span class="w">        </span><span class="kt">Nothing</span>
</code></pre></div>
<h4 id="_15">ãƒ¬ã‚³ãƒ¼ãƒ‰å‹<a class="headerlink" href="#_15" title="Permanent link">&para;</a></h4>
<p>Elm ã®ãƒ¬ã‚³ãƒ¼ãƒ‰ã¯ã€åå‰ä»˜ããƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’æŒã¤æ§‹é€ ä½“ã§ã™ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="kr">type</span><span class="w"> </span><span class="kr">alias</span><span class="w"> </span><span class="kt">Board</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nv">cols</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Int</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">rows</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Int</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">cells</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Array</span><span class="w"> </span><span class="p">(</span><span class="kt">Array</span><span class="w"> </span><span class="kt">Cell</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="c1">-- ãƒ¬ã‚³ãƒ¼ãƒ‰ã®ä½œæˆ</span>
<span class="nv">initialBoard</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Board</span>
<span class="nv">initialBoard</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nv">cols</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="mi">6</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">rows</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="mi">12</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">cells</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Array</span><span class="nf">.</span><span class="nv">repeat</span><span class="w"> </span><span class="mi">12</span><span class="w"> </span><span class="p">(</span><span class="kt">Array</span><span class="nf">.</span><span class="nv">repeat</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="kt">Empty</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="c1">-- ãƒ¬ã‚³ãƒ¼ãƒ‰ã®æ›´æ–°ï¼ˆã‚¤ãƒŸãƒ¥ãƒ¼ã‚¿ãƒ–ãƒ«ï¼‰</span>
<span class="nv">updateBoard</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Board</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Board</span>
<span class="nv">updateBoard</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="nf">|</span><span class="w"> </span><span class="nv">cols</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="p">}</span><span class="w">  </span><span class="c1">-- cols ã®ã¿æ›´æ–°ã—ãŸæ–°ã—ã„ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’è¿”ã™</span>
</code></pre></div>
<h3 id="elm_2">Elm ã®é–¢æ•°å‹ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°<a class="headerlink" href="#elm_2" title="Permanent link">&para;</a></h3>
<h4 id="_16">ä¸å¤‰æ€§<a class="headerlink" href="#_16" title="Permanent link">&para;</a></h4>
<p>Elm ã§ã¯ã€ã™ã¹ã¦ã®å€¤ãŒä¸å¤‰ï¼ˆã‚¤ãƒŸãƒ¥ãƒ¼ã‚¿ãƒ–ãƒ«ï¼‰ã§ã™ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- å…ƒã®ãƒªã‚¹ãƒˆã¯å¤‰æ›´ã•ã‚Œãšã€æ–°ã—ã„ãƒªã‚¹ãƒˆãŒè¿”ã•ã‚Œã‚‹</span>
<span class="nv">numbers</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">List</span><span class="w"> </span><span class="kt">Int</span>
<span class="nv">numbers</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="p">[</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="p">]</span>

<span class="c1">-- æ–°ã—ã„ãƒªã‚¹ãƒˆã‚’ä½œæˆ</span>
<span class="nv">newNumbers</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">List</span><span class="w"> </span><span class="kt">Int</span>
<span class="nv">newNumbers</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="kt">List</span><span class="nf">.</span><span class="nv">map</span><span class="w"> </span><span class="p">(</span><span class="nf">\</span><span class="nv">n</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="nv">n</span><span class="w"> </span><span class="nf">*</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="nv">numbers</span>
<span class="w">    </span><span class="c1">-- [ 2, 4, 6 ]</span>

<span class="c1">-- numbers ã¯å¤‰æ›´ã•ã‚Œã¦ã„ãªã„</span>
<span class="c1">-- [ 1, 2, 3 ]</span>
</code></pre></div>
<h4 id="_17">ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³æ¼”ç®—å­<a class="headerlink" href="#_17" title="Permanent link">&para;</a></h4>
<p>Elm ã®ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³æ¼”ç®—å­ <code>|&gt;</code> ã¯ã€é–¢æ•°ã‚’å·¦ã‹ã‚‰å³ã¸é©ç”¨ã—ã¾ã™ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ãªã—</span>
<span class="nv">result</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="kt">String</span><span class="nf">.</span><span class="nv">toUpper</span><span class="w"> </span><span class="p">(</span><span class="kt">String</span><span class="nf">.</span><span class="nv">trim</span><span class="w"> </span><span class="s">&quot;  hello  &quot;</span><span class="p">)</span>

<span class="c1">-- ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚ã‚Š</span>
<span class="nv">result</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="s">&quot;  hello  &quot;</span>
<span class="w">        </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">String</span><span class="nf">.</span><span class="nv">trim</span>
<span class="w">        </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">String</span><span class="nf">.</span><span class="nv">toUpper</span>
</code></pre></div>
<p>ã€Œå‡¦ç†ã®æµã‚ŒãŒèª­ã¿ã‚„ã™ã„ã§ã™ã­ï¼ã€ãã†ã§ã™ã€‚ãƒ‡ãƒ¼ã‚¿ã®å¤‰æ›éç¨‹ãŒæ˜ç¢ºã«ãªã‚Šã¾ã™ã€‚</p>
<h3 id="0_1">ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ã®ã¾ã¨ã‚<a class="headerlink" href="#0_1" title="Permanent link">&para;</a></h3>
<p>ã“ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ã€ä»¥ä¸‹ã‚’å­¦ã³ã¾ã—ãŸï¼š</p>
<ol>
<li><strong>Elm ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</strong>: elm ã¨ elm-test ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—</li>
<li><strong>ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆ</strong>: src/ ã¨ tests/ ã®æ§‹é€ ã€package.json ã¨ dist/ ã®é…ç½®</li>
<li><strong>ã‚¿ã‚¹ã‚¯ãƒ©ãƒ³ãƒŠãƒ¼</strong>: npm scripts ã‚’ä½¿ã£ãŸé–‹ç™ºãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ï¼ˆtest, dev, build, release, serveï¼‰</li>
<li><strong>The Elm Architecture</strong>: Model-Update-View ãƒ‘ã‚¿ãƒ¼ãƒ³</li>
<li><strong>å‹ã‚·ã‚¹ãƒ†ãƒ ã®åŸºæœ¬</strong>: ã‚«ã‚¹ã‚¿ãƒ å‹ã€Maybe å‹ã€ãƒ¬ã‚³ãƒ¼ãƒ‰å‹</li>
<li><strong>é–¢æ•°å‹ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°</strong>: ä¸å¤‰æ€§ã€ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°ã€ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³æ¼”ç®—å­</li>
<li><strong>é–‹ç™ºãƒ„ãƒ¼ãƒ«</strong>: npm run devï¼ˆelm reactorï¼‰ã¨ npm testï¼ˆelm-testï¼‰ã®ä½¿ã„æ–¹</li>
<li><strong>ãƒªãƒªãƒ¼ã‚¹ãƒ“ãƒ«ãƒ‰</strong>: æœ€é©åŒ–ãƒ“ãƒ«ãƒ‰ã¨ãƒ–ãƒ©ã‚¦ã‚¶ã§ã®å®Ÿè¡Œæ–¹æ³•</li>
</ol>
<p><strong>é–‹ç™ºãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼</strong>ï¼š
- é–‹ç™ºæ™‚: <code>npm run dev</code> ã§ elm reactor ã‚’èµ·å‹•
- ãƒ†ã‚¹ãƒˆ: <code>npm test</code> ã§ãƒ†ã‚¹ãƒˆå®Ÿè¡Œã€<code>npm run watch</code> ã§ç›£è¦–ãƒ¢ãƒ¼ãƒ‰
- ãƒªãƒªãƒ¼ã‚¹: <code>npm run release</code> ã§ãƒ†ã‚¹ãƒˆâ†’ãƒ“ãƒ«ãƒ‰ã€<code>npm run serve</code> ã§ã‚¢ãƒ—ãƒªèµ·å‹•</p>
<p>æ¬¡ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ã€å®Ÿéš›ã«ã·ã‚ˆã·ã‚ˆã‚²ãƒ¼ãƒ ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã‚’ä½œæˆã—ã¦ã„ãã¾ã™ï¼</p>
<h2 id="1_1">ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³1: ã‚²ãƒ¼ãƒ é–‹å§‹ã®å®Ÿè£…<a class="headerlink" href="#1_1" title="Permanent link">&para;</a></h2>
<p>ã•ã‚ã€ã„ã‚ˆã„ã‚ˆã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãå§‹ã‚ã¾ã—ã‚‡ã†ï¼ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã§ã¯ã€å°ã•ãªã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆåå¾©ï¼‰ã§æ©Ÿèƒ½ã‚’å°‘ã—ãšã¤è¿½åŠ ã—ã¦ã„ãã¾ã™ã€‚æœ€åˆã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ã€æœ€ã‚‚åŸºæœ¬çš„ãªæ©Ÿèƒ½ã§ã‚ã‚‹ã€Œã‚²ãƒ¼ãƒ ã®é–‹å§‹ã€ã‚’å®Ÿè£…ã—ã¾ã™ã€‚</p>
<blockquote>
<p>ã‚·ã‚¹ãƒ†ãƒ æ§‹ç¯‰ã¯ã©ã“ã‹ã‚‰å§‹ã‚ã‚‹ã¹ãã ã‚ã†ã‹ã€‚ã‚·ã‚¹ãƒ†ãƒ æ§‹ç¯‰ãŒçµ‚ã‚ã£ãŸã‚‰ã“ã†ãªã‚‹ã€ã¨ã„ã†ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚’èªã‚‹ã¨ã“ã‚ã‹ã‚‰ã ã€‚</p>
<p>â€” Kent Beck ã€ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã€</p>
</blockquote>
<h3 id="_18">ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼<a class="headerlink" href="#_18" title="Permanent link">&para;</a></h3>
<p>ã¾ãšã¯ã€ã“ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§å®Ÿè£…ã™ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚’ç¢ºèªã—ã¾ã—ã‚‡ã†ï¼š</p>
<blockquote>
<p>ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¨ã—ã¦ã€æ–°ã—ã„ã‚²ãƒ¼ãƒ ã‚’é–‹å§‹ã§ãã‚‹</p>
</blockquote>
<p>ã“ã®ã‚·ãƒ³ãƒ—ãƒ«ãªã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‹ã‚‰å§‹ã‚ã‚‹ã“ã¨ã§ã€ã‚²ãƒ¼ãƒ ã®åŸºæœ¬çš„ãªæ§‹é€ ã‚’ä½œã‚Šã€å¾Œç¶šã®æ©Ÿèƒ½è¿½åŠ ã®åœŸå°ã‚’ç¯‰ãã“ã¨ãŒã§ãã¾ã™ã€‚ã§ã¯ã€ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã®ã‚µã‚¤ã‚¯ãƒ«ã«å¾“ã£ã¦ã€ã¾ãšã¯ãƒ†ã‚¹ãƒˆã‹ã‚‰æ›¸ã„ã¦ã„ãã¾ã—ã‚‡ã†ï¼</p>
<h3 id="todo">TODOãƒªã‚¹ãƒˆ<a class="headerlink" href="#todo" title="Permanent link">&para;</a></h3>
<p>ã•ã¦ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚’å®Ÿè£…ã™ã‚‹ãŸã‚ã«ã€ã¾ãšã¯TODOãƒªã‚¹ãƒˆã‚’ä½œæˆã—ã¾ã—ã‚‡ã†ã€‚TODOãƒªã‚¹ãƒˆã¯ã€å¤§ããªæ©Ÿèƒ½ã‚’å°ã•ãªã‚¿ã‚¹ã‚¯ã«åˆ†è§£ã™ã‚‹ã®ã«å½¹ç«‹ã¡ã¾ã™ã€‚</p>
<blockquote>
<p>ä½•ã‚’ãƒ†ã‚¹ãƒˆã™ã¹ãã ã‚ã†ã‹ - ç€æ‰‹ã™ã‚‹å‰ã«ã€å¿…è¦ã«ãªã‚Šãã†ãªãƒ†ã‚¹ãƒˆã‚’ãƒªã‚¹ãƒˆã«æ›¸ãå‡ºã—ã¦ãŠã“ã†ã€‚</p>
<p>â€” Kent Beck ã€ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã€</p>
</blockquote>
<p>ç§ãŸã¡ã®ã€Œæ–°ã—ã„ã‚²ãƒ¼ãƒ ã‚’é–‹å§‹ã§ãã‚‹ã€ã¨ã„ã†ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚’å®Ÿç¾ã™ã‚‹ãŸã‚ã«ã¯ã€ã©ã®ã‚ˆã†ãªã‚¿ã‚¹ã‚¯ãŒå¿…è¦ã§ã—ã‚‡ã†ã‹ï¼Ÿè€ƒãˆã¦ã¿ã¾ã—ã‚‡ã†ï¼š</p>
<ul>
<li>ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã®å®šç¾©ï¼ˆCellã€PuyoColorã€Boardã€PuyoPair å‹ï¼‰</li>
<li>ãƒœãƒ¼ãƒ‰ã®åˆæœŸåŒ–å‡¦ç†ï¼ˆç©ºã®ãƒœãƒ¼ãƒ‰ã‚’ä½œæˆï¼‰</li>
<li>ãƒœãƒ¼ãƒ‰ã®æ“ä½œé–¢æ•°ï¼ˆã‚»ãƒ«ã®å–å¾—ã€ã‚»ãƒ«ã®è¨­å®šï¼‰</li>
<li>ã·ã‚ˆãƒšã‚¢ã®ä½œæˆã¨é…ç½®</li>
<li>The Elm Architecture ã®å®Ÿè£…ï¼ˆModelã€Msgã€updateã€viewï¼‰</li>
<li>ã‚²ãƒ¼ãƒ ã®åˆæœŸåŒ–å‡¦ç†</li>
</ul>
<p>ã“ã‚Œã‚‰ã®ã‚¿ã‚¹ã‚¯ã‚’ä¸€ã¤ãšã¤å®Ÿè£…ã—ã¦ã„ãã¾ã—ã‚‡ã†ã€‚ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã§ã¯ã€å„ã‚¿ã‚¹ã‚¯ã«å¯¾ã—ã¦ãƒ†ã‚¹ãƒˆâ†’å®Ÿè£…â†’ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã®ã‚µã‚¤ã‚¯ãƒ«ã‚’å›ã—ã¾ã™ã€‚ã¾ãšã¯ã€Œãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã®å®šç¾©ã€ã‹ã‚‰å§‹ã‚ã¾ã—ã‚‡ã†ï¼</p>
<h3 id="_19">ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã®è¨­è¨ˆ<a class="headerlink" href="#_19" title="Permanent link">&para;</a></h3>
<p>Elm ã§ã¯å‹ã‚’ä½¿ã£ã¦ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã‚’æ˜ç¢ºã«è¡¨ç¾ã§ãã¾ã™ã€‚ã¾ãšã¯ã€ã·ã‚ˆã·ã‚ˆã‚²ãƒ¼ãƒ ã®åŸºæœ¬çš„ãªæ¦‚å¿µã‚’å‹ã¨ã—ã¦å®šç¾©ã—ã¾ã—ã‚‡ã†ã€‚</p>
<h4 id="_20">ã‚»ãƒ«ã®çŠ¶æ…‹ã‚’è¡¨ã™å‹<a class="headerlink" href="#_20" title="Permanent link">&para;</a></h4>
<p>ãƒœãƒ¼ãƒ‰ã®å„ã‚»ãƒ«ã¯ã€ã€Œç©ºã€ã‹ã€Œã·ã‚ˆã§åŸ‹ã¾ã£ã¦ã„ã‚‹ã€ã®ã©ã¡ã‚‰ã‹ã®çŠ¶æ…‹ã§ã™ã€‚ã“ã‚Œã‚’ Elm ã®ã‚«ã‚¹ã‚¿ãƒ å‹ã§è¡¨ç¾ã—ã¾ã™ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- src/Cell.elm</span>
<span class="kn">module</span><span class="w"> </span><span class="nc">Cell</span><span class="w"> </span><span class="nv">exposing</span><span class="w"> </span><span class="p">(</span><span class="kt">Cell</span><span class="nf">(..)</span><span class="p">)</span>

<span class="kn">import</span><span class="w"> </span><span class="nc">PuyoColor</span><span class="w"> </span><span class="nv">exposing</span><span class="w"> </span><span class="p">(</span><span class="kt">PuyoColor</span><span class="p">)</span>


<span class="kr">type</span><span class="w"> </span><span class="kt">Cell</span>
<span class="w">    </span><span class="nf">=</span><span class="w"> </span><span class="kt">Empty</span>
<span class="w">    </span><span class="nf">|</span><span class="w"> </span><span class="kt">Filled</span><span class="w"> </span><span class="kt">PuyoColor</span>
</code></pre></div>
<p>ã€Œã‚·ãƒ³ãƒ—ãƒ«ã§ã™ã­ï¼ã€ãã†ãªã‚“ã§ã™ã€‚Elm ã®ã‚«ã‚¹ã‚¿ãƒ å‹ã¯ã€TypeScript ã® Union å‹ã‚„ F# ã®åˆ¤åˆ¥å…±ç”¨ä½“ã«ä¼¼ã¦ã„ã¾ã™ãŒã€ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã«ã‚ˆã‚‹ç¶²ç¾…æ€§ãƒã‚§ãƒƒã‚¯ãŒå¼·åŠ›ãªã®ãŒç‰¹å¾´ã§ã™ã€‚</p>
<h4 id="_21">ã·ã‚ˆã®è‰²ã‚’è¡¨ã™å‹<a class="headerlink" href="#_21" title="Permanent link">&para;</a></h4>
<p>ã·ã‚ˆã«ã¯4ã¤ã®è‰²ãŒã‚ã‚Šã¾ã™ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- src/PuyoColor.elm</span>
<span class="kn">module</span><span class="w"> </span><span class="nc">PuyoColor</span><span class="w"> </span><span class="nv">exposing</span><span class="w"> </span><span class="p">(</span><span class="kt">PuyoColor</span><span class="nf">(..)</span><span class="p">)</span>


<span class="kr">type</span><span class="w"> </span><span class="kt">PuyoColor</span>
<span class="w">    </span><span class="nf">=</span><span class="w"> </span><span class="kt">Red</span>
<span class="w">    </span><span class="nf">|</span><span class="w"> </span><span class="kt">Green</span>
<span class="w">    </span><span class="nf">|</span><span class="w"> </span><span class="kt">Blue</span>
<span class="w">    </span><span class="nf">|</span><span class="w"> </span><span class="kt">Yellow</span>
</code></pre></div>
<p>ã€Œã“ã®å‹å®šç¾©ã€ã¨ã¦ã‚‚èª­ã¿ã‚„ã™ã„ã§ã™ã­ï¼ã€ãã†ãªã‚“ã§ã™ã€‚Elm ã®å‹ã‚·ã‚¹ãƒ†ãƒ ã¯ã€ã‚³ãƒ¼ãƒ‰ã‚’è‡ªå·±æ–‡æ›¸åŒ–ã—ã¦ãã‚Œã¾ã™ã€‚</p>
<h4 id="_22">ãƒœãƒ¼ãƒ‰ã‚’è¡¨ã™å‹<a class="headerlink" href="#_22" title="Permanent link">&para;</a></h4>
<p>æ¬¡ã«ã€ã‚²ãƒ¼ãƒ ã®ãƒœãƒ¼ãƒ‰ï¼ˆç›¤é¢ï¼‰ã‚’è¡¨ã™å‹ã‚’å®šç¾©ã—ã¾ã™ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- src/Board.elm</span>
<span class="kn">module</span><span class="w"> </span><span class="nc">Board</span><span class="w"> </span><span class="nv">exposing</span>
<span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="kt">Board</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="kt">Cols</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="kt">Rows</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">create</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">getCell</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">setCell</span>
<span class="w">    </span><span class="p">)</span>

<span class="kn">import</span><span class="w"> </span><span class="nc">Array</span><span class="w"> </span><span class="nv">exposing</span><span class="w"> </span><span class="p">(</span><span class="kt">Array</span><span class="p">)</span>
<span class="kn">import</span><span class="w"> </span><span class="nc">Cell</span><span class="w"> </span><span class="nv">exposing</span><span class="w"> </span><span class="p">(</span><span class="kt">Cell</span><span class="nf">(..)</span><span class="p">)</span>


<span class="kr">type</span><span class="w"> </span><span class="kr">alias</span><span class="w"> </span><span class="kt">Cols</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="kt">Int</span>


<span class="kr">type</span><span class="w"> </span><span class="kr">alias</span><span class="w"> </span><span class="kt">Rows</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="kt">Int</span>


<span class="kr">type</span><span class="w"> </span><span class="kr">alias</span><span class="w"> </span><span class="kt">Board</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nv">cols</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Cols</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">rows</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Rows</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">cells</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Array</span><span class="w"> </span><span class="p">(</span><span class="kt">Array</span><span class="w"> </span><span class="kt">Cell</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>


<span class="c1">-- ãƒœãƒ¼ãƒ‰ã‚’ä½œæˆã™ã‚‹</span>
<span class="nv">create</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Cols</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Rows</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Board</span>
<span class="nv">create</span><span class="w"> </span><span class="nv">cols</span><span class="w"> </span><span class="nv">rows</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nv">cols</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">cols</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">rows</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">rows</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">cells</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Array</span><span class="nf">.</span><span class="nv">repeat</span><span class="w"> </span><span class="nv">rows</span><span class="w"> </span><span class="p">(</span><span class="kt">Array</span><span class="nf">.</span><span class="nv">repeat</span><span class="w"> </span><span class="nv">cols</span><span class="w"> </span><span class="kt">Empty</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>


<span class="c1">-- ã‚»ãƒ«ã‚’å–å¾—ã™ã‚‹</span>
<span class="nv">getCell</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Maybe</span><span class="w"> </span><span class="kt">Cell</span>
<span class="nv">getCell</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="kr">if</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nf">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="nf">&amp;&amp;</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nf">&lt;</span><span class="w"> </span><span class="nv">board</span><span class="nf">.</span><span class="nv">cols</span><span class="w"> </span><span class="nf">&amp;&amp;</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nf">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="nf">&amp;&amp;</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nf">&lt;</span><span class="w"> </span><span class="nv">board</span><span class="nf">.</span><span class="nv">rows</span><span class="w"> </span><span class="kr">then</span>
<span class="w">        </span><span class="kt">Array</span><span class="nf">.</span><span class="nv">get</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nv">board</span><span class="nf">.</span><span class="nv">cells</span>
<span class="w">            </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Maybe</span><span class="nf">.</span><span class="nv">andThen</span><span class="w"> </span><span class="p">(</span><span class="kt">Array</span><span class="nf">.</span><span class="nv">get</span><span class="w"> </span><span class="nv">x</span><span class="p">)</span>

<span class="w">    </span><span class="kr">else</span>
<span class="w">        </span><span class="kt">Nothing</span>


<span class="c1">-- ã‚»ãƒ«ã‚’è¨­å®šã™ã‚‹</span>
<span class="nv">setCell</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Cell</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Board</span>
<span class="nv">setCell</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nv">cell</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="kr">if</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nf">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="nf">&amp;&amp;</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nf">&lt;</span><span class="w"> </span><span class="nv">board</span><span class="nf">.</span><span class="nv">cols</span><span class="w"> </span><span class="nf">&amp;&amp;</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nf">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="nf">&amp;&amp;</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nf">&lt;</span><span class="w"> </span><span class="nv">board</span><span class="nf">.</span><span class="nv">rows</span><span class="w"> </span><span class="kr">then</span>
<span class="w">        </span><span class="kr">let</span>
<span class="w">            </span><span class="nv">newRow</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                </span><span class="kt">Array</span><span class="nf">.</span><span class="nv">get</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nv">board</span><span class="nf">.</span><span class="nv">cells</span>
<span class="w">                    </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Maybe</span><span class="nf">.</span><span class="nv">map</span><span class="w"> </span><span class="p">(</span><span class="nf">\</span><span class="nv">row</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Array</span><span class="nf">.</span><span class="nv">set</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nv">cell</span><span class="w"> </span><span class="nv">row</span><span class="p">)</span>
<span class="w">                    </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Maybe</span><span class="nf">.</span><span class="nv">withDefault</span><span class="w"> </span><span class="p">(</span><span class="kt">Array</span><span class="nf">.</span><span class="nv">repeat</span><span class="w"> </span><span class="nv">board</span><span class="nf">.</span><span class="nv">cols</span><span class="w"> </span><span class="kt">Empty</span><span class="p">)</span>

<span class="w">            </span><span class="nv">newCells</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                </span><span class="kt">Array</span><span class="nf">.</span><span class="nv">set</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nv">newRow</span><span class="w"> </span><span class="nv">board</span><span class="nf">.</span><span class="nv">cells</span>
<span class="w">        </span><span class="kr">in</span>
<span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="nf">|</span><span class="w"> </span><span class="nv">cells</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">newCells</span><span class="w"> </span><span class="p">}</span>

<span class="w">    </span><span class="kr">else</span>
<span class="w">        </span><span class="nv">board</span>
</code></pre></div>
<p>ã€Œ<code>Maybe</code> å‹ã‚’ä½¿ã£ã¦ã„ã‚‹ã‚“ã§ã™ã­ï¼ã€ãã†ã§ã™ã€‚Elm ã«ã¯ <code>null</code> ãŒãªã„ã®ã§ã€å¤±æ•—ã™ã‚‹å¯èƒ½æ€§ã®ã‚ã‚‹æ“ä½œã¯ <code>Maybe</code> å‹ã§è¡¨ç¾ã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€<code>null</code> å‚ç…§ã‚¨ãƒ©ãƒ¼ãŒèµ·ã“ã‚‰ãªã„å®‰å…¨ãªã‚³ãƒ¼ãƒ‰ãŒæ›¸ã‘ã‚‹ã‚“ã§ã™ã€‚</p>
<h4 id="_23">ã·ã‚ˆãƒšã‚¢ã‚’è¡¨ã™å‹<a class="headerlink" href="#_23" title="Permanent link">&para;</a></h4>
<p>ã·ã‚ˆã·ã‚ˆã§ã¯ã€2ã¤ã®ã·ã‚ˆãŒä¸€çµ„ã«ãªã£ã¦è½ã¡ã¦ãã¾ã™ã€‚ã“ã‚Œã‚’ã€Œã·ã‚ˆãƒšã‚¢ã€ã¨ã—ã¦å®šç¾©ã—ã¾ã™ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- src/PuyoPair.elm</span>
<span class="kn">module</span><span class="w"> </span><span class="nc">PuyoPair</span><span class="w"> </span><span class="nv">exposing</span>
<span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="kt">PuyoPair</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="kt">Position</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">create</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">getPositions</span>
<span class="w">    </span><span class="p">)</span>

<span class="kn">import</span><span class="w"> </span><span class="nc">PuyoColor</span><span class="w"> </span><span class="nv">exposing</span><span class="w"> </span><span class="p">(</span><span class="kt">PuyoColor</span><span class="p">)</span>


<span class="kr">type</span><span class="w"> </span><span class="kr">alias</span><span class="w"> </span><span class="kt">Position</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Int</span><span class="p">,</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="p">}</span>


<span class="kr">type</span><span class="w"> </span><span class="kr">alias</span><span class="w"> </span><span class="kt">PuyoPair</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nv">axis</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Position</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">child</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Position</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">axisColor</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">PuyoColor</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">childColor</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">PuyoColor</span>
<span class="w">    </span><span class="p">}</span>


<span class="c1">-- ã·ã‚ˆãƒšã‚¢ã‚’ä½œæˆã™ã‚‹</span>
<span class="nv">create</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">PuyoColor</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">PuyoColor</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">PuyoPair</span>
<span class="nv">create</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nv">axisColor</span><span class="w"> </span><span class="nv">childColor</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nv">axis</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">x</span><span class="p">,</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">child</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">x</span><span class="p">,</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nf">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">axisColor</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">axisColor</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">childColor</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">childColor</span>
<span class="w">    </span><span class="p">}</span>


<span class="c1">-- ã·ã‚ˆãƒšã‚¢ã®ä½ç½®ã‚’å–å¾—ã™ã‚‹</span>
<span class="nv">getPositions</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">PuyoPair</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="kt">Position</span><span class="p">,</span><span class="w"> </span><span class="kt">Position</span><span class="w"> </span><span class="p">)</span>
<span class="nv">getPositions</span><span class="w"> </span><span class="nv">pair</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">axis</span><span class="p">,</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">child</span><span class="w"> </span><span class="p">)</span>
</code></pre></div>
<p>ã€Œãƒ¬ã‚³ãƒ¼ãƒ‰å‹ã‚’ä½¿ã£ã¦ã„ã‚‹ã‚“ã§ã™ã­ï¼ã€ãã†ã§ã™ã€‚Elm ã®ãƒ¬ã‚³ãƒ¼ãƒ‰å‹ã¯ã€åå‰ä»˜ããƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’æŒã¤æ§‹é€ ä½“ã§ã™ã€‚å‹ã‚¨ã‚¤ãƒªã‚¢ã‚¹ï¼ˆ<code>type alias</code>ï¼‰ã‚’ä½¿ã†ã“ã¨ã§ã€è¤‡é›‘ãªå‹ã«æ„å‘³ã®ã‚ã‚‹åå‰ã‚’ä»˜ã‘ã‚‰ã‚Œã¾ã™ã€‚</p>
<h3 id="_24">ãƒ†ã‚¹ãƒˆ: ãƒœãƒ¼ãƒ‰ã®æ“ä½œ<a class="headerlink" href="#_24" title="Permanent link">&para;</a></h3>
<p>ã§ã¯ã€å®šç¾©ã—ãŸãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ãŒæ­£ã—ãå‹•ä½œã™ã‚‹ã“ã¨ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã—ã‚‡ã†ã€‚Elm ã§ã¯ <code>elm-test</code> ã‚’ä½¿ã£ã¦ãƒ†ã‚¹ãƒˆã‚’æ›¸ãã¾ã™ã€‚</p>
<h4 id="_25">ãƒœãƒ¼ãƒ‰ã®ãƒ†ã‚¹ãƒˆ<a class="headerlink" href="#_25" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1">-- tests/BoardTests.elm</span>
<span class="kn">module</span><span class="w"> </span><span class="nc">BoardTests</span><span class="w"> </span><span class="nv">exposing</span><span class="w"> </span><span class="p">(</span><span class="nv">suite</span><span class="p">)</span>

<span class="kn">import</span><span class="w"> </span><span class="nc">Array</span>
<span class="kn">import</span><span class="w"> </span><span class="nc">Board</span><span class="w"> </span><span class="nv">exposing</span><span class="w"> </span><span class="p">(</span><span class="kt">Board</span><span class="p">)</span>
<span class="kn">import</span><span class="w"> </span><span class="nc">Cell</span><span class="w"> </span><span class="nv">exposing</span><span class="w"> </span><span class="p">(</span><span class="kt">Cell</span><span class="nf">(..)</span><span class="p">)</span>
<span class="kn">import</span><span class="w"> </span><span class="nc">Expect</span>
<span class="kn">import</span><span class="w"> </span><span class="nc">PuyoColor</span><span class="w"> </span><span class="nv">exposing</span><span class="w"> </span><span class="p">(</span><span class="kt">PuyoColor</span><span class="nf">(..)</span><span class="p">)</span>
<span class="kn">import</span><span class="w"> </span><span class="nc">Test</span><span class="w"> </span><span class="nv">exposing</span><span class="w"> </span><span class="p">(</span><span class="kt">Test</span><span class="p">,</span><span class="w"> </span><span class="nv">describe</span><span class="p">,</span><span class="w"> </span><span class="nv">test</span><span class="p">)</span>


<span class="nv">suite</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Test</span>
<span class="nv">suite</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="nv">describe</span><span class="w"> </span><span class="s">&quot;Board&quot;</span>
<span class="w">        </span><span class="p">[</span><span class="w"> </span><span class="nv">describe</span><span class="w"> </span><span class="s">&quot;create&quot;</span>
<span class="w">            </span><span class="p">[</span><span class="w"> </span><span class="nv">test</span><span class="w"> </span><span class="s">&quot;æŒ‡å®šã—ãŸã‚µã‚¤ã‚ºã®ç©ºã®ãƒœãƒ¼ãƒ‰ã‚’ä½œæˆã§ãã‚‹&quot;</span><span class="w"> </span><span class="nf">&lt;|</span>
<span class="w">                </span><span class="nf">\</span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="kr">let</span>
<span class="w">                        </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="mi">12</span>
<span class="w">                    </span><span class="kr">in</span>
<span class="w">                    </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">all</span>
<span class="w">                        </span><span class="p">[</span><span class="w"> </span><span class="nf">\</span><span class="nv">b</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">equal</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="nv">b</span><span class="nf">.</span><span class="nv">cols</span>
<span class="w">                        </span><span class="p">,</span><span class="w"> </span><span class="nf">\</span><span class="nv">b</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">equal</span><span class="w"> </span><span class="mi">12</span><span class="w"> </span><span class="nv">b</span><span class="nf">.</span><span class="nv">rows</span>
<span class="w">                        </span><span class="p">,</span><span class="w"> </span><span class="nf">\</span><span class="nv">b</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">equal</span><span class="w"> </span><span class="mi">12</span><span class="w"> </span><span class="p">(</span><span class="kt">Array</span><span class="nf">.</span><span class="nv">length</span><span class="w"> </span><span class="nv">b</span><span class="nf">.</span><span class="nv">cells</span><span class="p">)</span>
<span class="w">                        </span><span class="p">]</span>
<span class="w">                        </span><span class="nv">board</span>
<span class="w">            </span><span class="p">]</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">describe</span><span class="w"> </span><span class="s">&quot;getCell&quot;</span>
<span class="w">            </span><span class="p">[</span><span class="w"> </span><span class="nv">test</span><span class="w"> </span><span class="s">&quot;ç¯„å›²å†…ã®ã‚»ãƒ«ã‚’å–å¾—ã§ãã‚‹&quot;</span><span class="w"> </span><span class="nf">&lt;|</span>
<span class="w">                </span><span class="nf">\</span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="kr">let</span>
<span class="w">                        </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="mi">12</span>
<span class="w">                    </span><span class="kr">in</span>
<span class="w">                    </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">getCell</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="nv">board</span>
<span class="w">                        </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">equal</span><span class="w"> </span><span class="p">(</span><span class="kt">Just</span><span class="w"> </span><span class="kt">Empty</span><span class="p">)</span>
<span class="w">            </span><span class="p">,</span><span class="w"> </span><span class="nv">test</span><span class="w"> </span><span class="s">&quot;ç¯„å›²å¤–ã®ã‚»ãƒ«ã¯ Nothing ã‚’è¿”ã™&quot;</span><span class="w"> </span><span class="nf">&lt;|</span>
<span class="w">                </span><span class="nf">\</span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="kr">let</span>
<span class="w">                        </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="mi">12</span>
<span class="w">                    </span><span class="kr">in</span>
<span class="w">                    </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">getCell</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="nv">board</span>
<span class="w">                        </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">equal</span><span class="w"> </span><span class="kt">Nothing</span>
<span class="w">            </span><span class="p">]</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">describe</span><span class="w"> </span><span class="s">&quot;setCell&quot;</span>
<span class="w">            </span><span class="p">[</span><span class="w"> </span><span class="nv">test</span><span class="w"> </span><span class="s">&quot;ã‚»ãƒ«ã«å€¤ã‚’è¨­å®šã§ãã‚‹&quot;</span><span class="w"> </span><span class="nf">&lt;|</span>
<span class="w">                </span><span class="nf">\</span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="kr">let</span>
<span class="w">                        </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="mi">12</span>

<span class="w">                        </span><span class="nv">updatedBoard</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">setCell</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="p">(</span><span class="kt">Filled</span><span class="w"> </span><span class="kt">Red</span><span class="p">)</span><span class="w"> </span><span class="nv">board</span>
<span class="w">                    </span><span class="kr">in</span>
<span class="w">                    </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">getCell</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="nv">updatedBoard</span>
<span class="w">                        </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">equal</span><span class="w"> </span><span class="p">(</span><span class="kt">Just</span><span class="w"> </span><span class="p">(</span><span class="kt">Filled</span><span class="w"> </span><span class="kt">Red</span><span class="p">))</span>
<span class="w">            </span><span class="p">,</span><span class="w"> </span><span class="nv">test</span><span class="w"> </span><span class="s">&quot;ç¯„å›²å¤–ã®ã‚»ãƒ«ã¸ã®è¨­å®šã¯ç„¡è¦–ã•ã‚Œã‚‹&quot;</span><span class="w"> </span><span class="nf">&lt;|</span>
<span class="w">                </span><span class="nf">\</span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="kr">let</span>
<span class="w">                        </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="mi">12</span>

<span class="w">                        </span><span class="nv">updatedBoard</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">setCell</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">(</span><span class="kt">Filled</span><span class="w"> </span><span class="kt">Red</span><span class="p">)</span><span class="w"> </span><span class="nv">board</span>
<span class="w">                    </span><span class="kr">in</span>
<span class="w">                    </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">equal</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="nv">updatedBoard</span>
<span class="w">            </span><span class="p">]</span>
<span class="w">        </span><span class="p">]</span>
</code></pre></div>
<p>ã€Œãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã‚‚èª­ã¿ã‚„ã™ã„ã§ã™ã­ï¼ã€ãã†ã§ã™ã€‚Elm ã®ãƒ†ã‚¹ãƒˆã¯ã€<code>describe</code> ã§ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ã—ã€<code>test</code> ã§å€‹åˆ¥ã®ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã‚’å®šç¾©ã—ã¾ã™ã€‚<code>\_ -&gt;</code> ã¯ãƒ©ãƒ ãƒ€å¼ï¼ˆç„¡åé–¢æ•°ï¼‰ã§ã€å¼•æ•°ã‚’ç„¡è¦–ã—ã¦ã„ã¾ã™ã€‚</p>
<h3 id="_26">ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œ<a class="headerlink" href="#_26" title="Permanent link">&para;</a></h3>
<p>ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼š</p>
<div class="highlight"><pre><span></span><code>elm-test
</code></pre></div>
<p>ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆãŒé€šã‚Œã°æˆåŠŸã§ã™ï¼</p>
<div class="highlight"><pre><span></span><code>TEST RUN PASSED

Duration: 123 ms
Passed:   7
Failed:   0
</code></pre></div>
<p>ã€ŒãŠãŠã€ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆãŒé€šã‚Šã¾ã—ãŸï¼ã€ç´ æ™´ã‚‰ã—ã„ã§ã™ã­ã€‚ã“ã‚ŒãŒãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã®ã€ŒGreenï¼ˆç·‘ï¼‰ã€ã®çŠ¶æ…‹ã§ã™ã€‚</p>
<h3 id="the-elm-architecture_1">The Elm Architecture ã®å®Ÿè£…<a class="headerlink" href="#the-elm-architecture_1" title="Permanent link">&para;</a></h3>
<p>æ¬¡ã«ã€The Elm Architecture (TEA) ã‚’ä½¿ã£ã¦ã‚²ãƒ¼ãƒ ã®ãƒ¡ã‚¤ãƒ³æ§‹é€ ã‚’å®Ÿè£…ã—ã¾ã™ã€‚</p>
<h4 id="model">Model ã®å®šç¾©<a class="headerlink" href="#model" title="Permanent link">&para;</a></h4>
<p>ã¾ãšã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®çŠ¶æ…‹ã‚’è¡¨ã™ Model ã‚’å®šç¾©ã—ã¾ã™ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- src/Main.elm</span>
<span class="kn">module</span><span class="w"> </span><span class="nc">Main</span><span class="w"> </span><span class="nv">exposing</span><span class="w"> </span><span class="p">(</span><span class="nv">main</span><span class="p">)</span>

<span class="kn">import</span><span class="w"> </span><span class="nc">Board</span><span class="w"> </span><span class="nv">exposing</span><span class="w"> </span><span class="p">(</span><span class="kt">Board</span><span class="p">)</span>
<span class="kn">import</span><span class="w"> </span><span class="nc">Browser</span>
<span class="kn">import</span><span class="w"> </span><span class="nc">Cell</span><span class="w"> </span><span class="nv">exposing</span><span class="w"> </span><span class="p">(</span><span class="kt">Cell</span><span class="nf">(..)</span><span class="p">)</span>
<span class="kn">import</span><span class="w"> </span><span class="nc">Html</span><span class="w"> </span><span class="nv">exposing</span><span class="w"> </span><span class="p">(</span><span class="kt">Html</span><span class="p">,</span><span class="w"> </span><span class="nv">div</span><span class="p">,</span><span class="w"> </span><span class="nv">h1</span><span class="p">,</span><span class="w"> </span><span class="nv">text</span><span class="p">)</span>
<span class="kn">import</span><span class="w"> </span><span class="nc">Html.Attributes</span><span class="w"> </span><span class="nv">exposing</span><span class="w"> </span><span class="p">(</span><span class="nv">style</span><span class="p">)</span>
<span class="kn">import</span><span class="w"> </span><span class="nc">PuyoColor</span><span class="w"> </span><span class="nv">exposing</span><span class="w"> </span><span class="p">(</span><span class="kt">PuyoColor</span><span class="nf">(..)</span><span class="p">)</span>
<span class="kn">import</span><span class="w"> </span><span class="nc">PuyoPair</span><span class="w"> </span><span class="nv">exposing</span><span class="w"> </span><span class="p">(</span><span class="kt">PuyoPair</span><span class="p">)</span>


<span class="c1">-- MODEL</span>


<span class="kr">type</span><span class="w"> </span><span class="kt">GameMode</span>
<span class="w">    </span><span class="nf">=</span><span class="w"> </span><span class="kt">Start</span>
<span class="w">    </span><span class="nf">|</span><span class="w"> </span><span class="kt">Playing</span>
<span class="w">    </span><span class="nf">|</span><span class="w"> </span><span class="kt">GameOver</span>


<span class="kr">type</span><span class="w"> </span><span class="kr">alias</span><span class="w"> </span><span class="kt">Model</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Board</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">currentPair</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Maybe</span><span class="w"> </span><span class="kt">PuyoPair</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">mode</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">GameMode</span>
<span class="w">    </span><span class="p">}</span>


<span class="nv">init</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Model</span>
<span class="nv">init</span><span class="w"> </span><span class="nv">_</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="mi">12</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">currentPair</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Nothing</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">mode</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Start</span>
<span class="w">    </span><span class="p">}</span>
</code></pre></div>
<p>ã€Œ<code>GameMode</code> ã¨ã„ã†ã‚«ã‚¹ã‚¿ãƒ å‹ã‚’å®šç¾©ã—ã¦ã„ã‚‹ã‚“ã§ã™ã­ï¼ã€ãã†ã§ã™ã€‚ã‚²ãƒ¼ãƒ ã®çŠ¶æ…‹ã‚’æ˜ç¢ºã«å‹ã§è¡¨ç¾ã™ã‚‹ã“ã¨ã§ã€ã©ã®çŠ¶æ…‹ã§ã©ã®æ“ä½œãŒå¯èƒ½ã‹ã‚’ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ãŒãƒã‚§ãƒƒã‚¯ã—ã¦ãã‚Œã¾ã™ã€‚</p>
<h4 id="msg">Msg ã®å®šç¾©<a class="headerlink" href="#msg" title="Permanent link">&para;</a></h4>
<p>æ¬¡ã«ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ç™ºç”Ÿã™ã‚‹ã‚¤ãƒ™ãƒ³ãƒˆã‚’è¡¨ã™ Msg ã‚’å®šç¾©ã—ã¾ã™ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- UPDATE</span>


<span class="kr">type</span><span class="w"> </span><span class="kt">Msg</span>
<span class="w">    </span><span class="nf">=</span><span class="w"> </span><span class="kt">StartGame</span>
<span class="w">    </span><span class="nf">|</span><span class="w"> </span><span class="kt">Tick</span>
<span class="w">    </span><span class="nf">|</span><span class="w"> </span><span class="kt">NoOp</span>


<span class="nv">update</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Msg</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Model</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Model</span>
<span class="nv">update</span><span class="w"> </span><span class="nv">msg</span><span class="w"> </span><span class="nv">model</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="kr">case</span><span class="w"> </span><span class="nv">msg</span><span class="w"> </span><span class="kr">of</span>
<span class="w">        </span><span class="kt">StartGame</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="p">{</span><span class="w"> </span><span class="nv">model</span>
<span class="w">                </span><span class="nf">|</span><span class="w"> </span><span class="nv">mode</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Playing</span>
<span class="w">                </span><span class="p">,</span><span class="w"> </span><span class="nv">currentPair</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Just</span><span class="w"> </span><span class="p">(</span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="kt">Red</span><span class="w"> </span><span class="kt">Blue</span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">        </span><span class="kt">Tick</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="c1">-- å¾Œã§å®Ÿè£…</span>
<span class="w">            </span><span class="nv">model</span>

<span class="w">        </span><span class="kt">NoOp</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="nv">model</span>
</code></pre></div>
<p>ã€Œ<code>StartGame</code> ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã§ã‚²ãƒ¼ãƒ ã‚’é–‹å§‹ã™ã‚‹ã‚“ã§ã™ã­ï¼ã€ãã†ã§ã™ã€‚ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å—ã‘å–ã‚‹ã¨ã€æ–°ã—ã„ Model ã‚’è¿”ã—ã¾ã™ã€‚Elm ã§ã¯ã€ã™ã¹ã¦ã®ãƒ‡ãƒ¼ã‚¿ãŒä¸å¤‰ï¼ˆã‚¤ãƒŸãƒ¥ãƒ¼ã‚¿ãƒ–ãƒ«ï¼‰ãªã®ã§ã€å…ƒã® Model ã‚’å¤‰æ›´ã›ãšã€æ–°ã—ã„ Model ã‚’ä½œæˆã—ã¦è¿”ã—ã¾ã™ã€‚</p>
<h4 id="view">View ã®å®Ÿè£…<a class="headerlink" href="#view" title="Permanent link">&para;</a></h4>
<p>æœ€å¾Œã«ã€Model ã‚’ HTML ã«å¤‰æ›ã™ã‚‹ View ã‚’å®Ÿè£…ã—ã¾ã™ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- VIEW</span>


<span class="nv">view</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Model</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Html</span><span class="w"> </span><span class="kt">Msg</span>
<span class="nv">view</span><span class="w"> </span><span class="nv">model</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="nv">div</span>
<span class="w">        </span><span class="p">[</span><span class="w"> </span><span class="nv">style</span><span class="w"> </span><span class="s">&quot;padding&quot;</span><span class="w"> </span><span class="s">&quot;20px&quot;</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">style</span><span class="w"> </span><span class="s">&quot;font-family&quot;</span><span class="w"> </span><span class="s">&quot;Arial, sans-serif&quot;</span>
<span class="w">        </span><span class="p">]</span>
<span class="w">        </span><span class="p">[</span><span class="w"> </span><span class="nv">h1</span><span class="w"> </span><span class="p">[]</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="nv">text</span><span class="w"> </span><span class="s">&quot;ã·ã‚ˆã·ã‚ˆ - Elm ç‰ˆ&quot;</span><span class="w"> </span><span class="p">]</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">div</span><span class="w"> </span><span class="p">[]</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="nv">text</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;ã‚²ãƒ¼ãƒ ãƒ¢ãƒ¼ãƒ‰: &quot;</span><span class="w"> </span><span class="nf">++</span><span class="w"> </span><span class="nv">gameModeToString</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">mode</span><span class="p">)</span><span class="w"> </span><span class="p">]</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">viewBoard</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">board</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">viewCurrentPair</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">currentPair</span>
<span class="w">        </span><span class="p">]</span>


<span class="nv">gameModeToString</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">GameMode</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">String</span>
<span class="nv">gameModeToString</span><span class="w"> </span><span class="nv">mode</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="kr">case</span><span class="w"> </span><span class="nv">mode</span><span class="w"> </span><span class="kr">of</span>
<span class="w">        </span><span class="kt">Start</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="s">&quot;ã‚¹ã‚¿ãƒ¼ãƒˆ&quot;</span>

<span class="w">        </span><span class="kt">Playing</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="s">&quot;ãƒ—ãƒ¬ã‚¤ä¸­&quot;</span>

<span class="w">        </span><span class="kt">GameOver</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="s">&quot;ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼&quot;</span>


<span class="nv">viewBoard</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Board</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Html</span><span class="w"> </span><span class="kt">Msg</span>
<span class="nv">viewBoard</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="nv">div</span>
<span class="w">        </span><span class="p">[</span><span class="w"> </span><span class="nv">style</span><span class="w"> </span><span class="s">&quot;margin-top&quot;</span><span class="w"> </span><span class="s">&quot;20px&quot;</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">style</span><span class="w"> </span><span class="s">&quot;padding&quot;</span><span class="w"> </span><span class="s">&quot;10px&quot;</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">style</span><span class="w"> </span><span class="s">&quot;background-color&quot;</span><span class="w"> </span><span class="s">&quot;#f0f0f0&quot;</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">style</span><span class="w"> </span><span class="s">&quot;display&quot;</span><span class="w"> </span><span class="s">&quot;inline-block&quot;</span>
<span class="w">        </span><span class="p">]</span>
<span class="w">        </span><span class="p">[</span><span class="w"> </span><span class="nv">text</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;ãƒœãƒ¼ãƒ‰: &quot;</span><span class="w"> </span><span class="nf">++</span><span class="w"> </span><span class="kt">String</span><span class="nf">.</span><span class="nv">fromInt</span><span class="w"> </span><span class="nv">board</span><span class="nf">.</span><span class="nv">cols</span><span class="w"> </span><span class="nf">++</span><span class="w"> </span><span class="s">&quot;x&quot;</span><span class="w"> </span><span class="nf">++</span><span class="w"> </span><span class="kt">String</span><span class="nf">.</span><span class="nv">fromInt</span><span class="w"> </span><span class="nv">board</span><span class="nf">.</span><span class="nv">rows</span><span class="p">)</span><span class="w"> </span><span class="p">]</span>


<span class="nv">viewCurrentPair</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Maybe</span><span class="w"> </span><span class="kt">PuyoPair</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Html</span><span class="w"> </span><span class="kt">Msg</span>
<span class="nv">viewCurrentPair</span><span class="w"> </span><span class="nv">maybePair</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="kr">case</span><span class="w"> </span><span class="nv">maybePair</span><span class="w"> </span><span class="kr">of</span>
<span class="w">        </span><span class="kt">Just</span><span class="w"> </span><span class="nv">pair</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="nv">div</span>
<span class="w">                </span><span class="p">[</span><span class="w"> </span><span class="nv">style</span><span class="w"> </span><span class="s">&quot;margin-top&quot;</span><span class="w"> </span><span class="s">&quot;10px&quot;</span><span class="w"> </span><span class="p">]</span>
<span class="w">                </span><span class="p">[</span><span class="w"> </span><span class="nv">text</span>
<span class="w">                    </span><span class="p">(</span><span class="s">&quot;ç¾åœ¨ã®ã·ã‚ˆãƒšã‚¢: (&quot;</span>
<span class="w">                        </span><span class="nf">++</span><span class="w"> </span><span class="kt">String</span><span class="nf">.</span><span class="nv">fromInt</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">axis</span><span class="nf">.</span><span class="nv">x</span>
<span class="w">                        </span><span class="nf">++</span><span class="w"> </span><span class="s">&quot;, &quot;</span>
<span class="w">                        </span><span class="nf">++</span><span class="w"> </span><span class="kt">String</span><span class="nf">.</span><span class="nv">fromInt</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">axis</span><span class="nf">.</span><span class="nv">y</span>
<span class="w">                        </span><span class="nf">++</span><span class="w"> </span><span class="s">&quot;)&quot;</span>
<span class="w">                    </span><span class="p">)</span>
<span class="w">                </span><span class="p">]</span>

<span class="w">        </span><span class="kt">Nothing</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="nv">div</span><span class="w"> </span><span class="p">[]</span><span class="w"> </span><span class="p">[]</span>
</code></pre></div>
<p>ã€Œ<code>Maybe</code> å‹ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°ã‚’ä½¿ã£ã¦ã„ã‚‹ã‚“ã§ã™ã­ï¼ã€ãã†ã§ã™ã€‚<code>currentPair</code> ãŒ <code>Just pair</code> ã®å ´åˆã¯ã·ã‚ˆãƒšã‚¢ã‚’è¡¨ç¤ºã—ã€<code>Nothing</code> ã®å ´åˆã¯ä½•ã‚‚è¡¨ç¤ºã—ã¾ã›ã‚“ã€‚ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ãŒä¸¡æ–¹ã®ã‚±ãƒ¼ã‚¹ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ãã‚Œã‚‹ã®ã§ã€å®‰å…¨ã§ã™ã€‚</p>
<h4 id="main">Main é–¢æ•°<a class="headerlink" href="#main" title="Permanent link">&para;</a></h4>
<p>æœ€å¾Œã«ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆã‚’å®šç¾©ã—ã¾ã™ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- MAIN</span>


<span class="kr">main </span><span class="nf">:</span><span class="w"> </span><span class="kt">Program</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="kt">Model</span><span class="w"> </span><span class="kt">Msg</span>
<span class="kr">main </span><span class="nf">=</span>
<span class="w">    </span><span class="kt">Browser</span><span class="nf">.</span><span class="nv">sandbox</span>
<span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="nv">init</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">init</span><span class="w"> </span><span class="p">()</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">update</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">update</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">view</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">view</span>
<span class="w">        </span><span class="p">}</span>
</code></pre></div>
<p>ã€Œ<code>Browser.sandbox</code> ã‚’ä½¿ã£ã¦ã„ã‚‹ã‚“ã§ã™ã­ï¼ã€ãã†ã§ã™ã€‚<code>Browser.sandbox</code> ã¯ã€ã‚³ãƒãƒ³ãƒ‰ã‚„ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ï¼ˆå¤–éƒ¨ã¨ã®é€šä¿¡ï¼‰ãŒä¸è¦ãªã€ã‚·ãƒ³ãƒ—ãƒ«ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«æœ€é©ã§ã™ã€‚</p>
<h3 id="_27">ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®å®Ÿè¡Œ<a class="headerlink" href="#_27" title="Permanent link">&para;</a></h3>
<p>ã§ã¯ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼š</p>
<div class="highlight"><pre><span></span><code>elm<span class="w"> </span>reactor
</code></pre></div>
<p>ãƒ–ãƒ©ã‚¦ã‚¶ã§ <code>http://localhost:8000</code> ã‚’é–‹ãã€<code>src/Main.elm</code> ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã€ã·ã‚ˆã·ã‚ˆã‚²ãƒ¼ãƒ ã®åˆæœŸç”»é¢ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</p>
<p>ã€Œã‚²ãƒ¼ãƒ ãŒè¡¨ç¤ºã•ã‚Œã¾ã—ãŸï¼ã€ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼ãƒªãƒªãƒ¼ã‚¹ã«å‘ã‘ã¦æœ€åˆã®ç¬¬ä¸€æ­©ã‚’è¸ã¿å‡ºã™ã“ã¨ãŒã§ãã¾ã—ãŸã€‚</p>
<blockquote>
<p>ãƒˆãƒƒãƒ—ãƒ€ã‚¦ãƒ³ã§ã‚‚ãƒœãƒˆãƒ ã‚¢ãƒƒãƒ—ã§ã‚‚ãªãã€ã‚¨ãƒ³ãƒ‰ãƒ„ãƒ¼ã‚¨ãƒ³ãƒ‰ã§æ§‹ç¯‰ã—ã¦ã„ã</p>
<p>ã‚¨ãƒ³ãƒ‰ãƒ„ãƒ¼ã‚¨ãƒ³ãƒ‰ã§å°ã•ãªæ©Ÿèƒ½ã‚’æ§‹ç¯‰ã—ã€ãã“ã‹ã‚‰ä½œæ¥­ã‚’é€²ã‚ãªãŒã‚‰å•é¡Œã«ã¤ã„ã¦å­¦ç¿’ã—ã¦ã„ãã€‚</p>
<p>â€” é”äººãƒ—ãƒ­ã‚°ãƒ©ãƒãƒ¼ ç†Ÿé”ã«å‘ã‘ãŸã‚ãªãŸã®æ—…ï¼ˆç¬¬2ç‰ˆï¼‰</p>
</blockquote>
<h3 id="1_2">ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³1ã®ã¾ã¨ã‚<a class="headerlink" href="#1_2" title="Permanent link">&para;</a></h3>
<p>ã“ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§å®Ÿè£…ã—ãŸå†…å®¹ï¼š</p>
<ol>
<li><strong>ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã®å®šç¾©</strong></li>
<li><code>Cell</code> å‹: ã‚»ãƒ«ã®çŠ¶æ…‹ï¼ˆEmpty ã¾ãŸã¯ Filledï¼‰</li>
<li><code>PuyoColor</code> å‹: ã·ã‚ˆã®è‰²ï¼ˆRed, Green, Blue, Yellowï¼‰</li>
<li><code>Board</code> å‹: ã‚²ãƒ¼ãƒ ãƒœãƒ¼ãƒ‰ï¼ˆcols, rows, cellsï¼‰</li>
<li>
<p><code>PuyoPair</code> å‹: ã·ã‚ˆãƒšã‚¢ï¼ˆaxis, child, colorsï¼‰</p>
</li>
<li>
<p><strong>ãƒœãƒ¼ãƒ‰æ“ä½œé–¢æ•°</strong></p>
</li>
<li><code>create</code>: ç©ºã®ãƒœãƒ¼ãƒ‰ã‚’ä½œæˆ</li>
<li><code>getCell</code>: ã‚»ãƒ«ã‚’å–å¾—ï¼ˆMaybe å‹ã‚’è¿”ã™ï¼‰</li>
<li>
<p><code>setCell</code>: ã‚»ãƒ«ã‚’è¨­å®šï¼ˆç¯„å›²å¤–ã¯ç„¡è¦–ï¼‰</p>
</li>
<li>
<p><strong>The Elm Architecture ã®å®Ÿè£…</strong></p>
</li>
<li><code>Model</code>: ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®çŠ¶æ…‹ï¼ˆboard, currentPair, modeï¼‰</li>
<li><code>Msg</code>: ã‚¤ãƒ™ãƒ³ãƒˆï¼ˆStartGame, Tick, NoOpï¼‰</li>
<li><code>update</code>: ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«å¿œã˜ãŸçŠ¶æ…‹æ›´æ–°</li>
<li>
<p><code>view</code>: çŠ¶æ…‹ã‚’ HTML ã«å¤‰æ›</p>
</li>
<li>
<p><strong>ãƒ†ã‚¹ãƒˆã®ä½œæˆ</strong></p>
</li>
<li>ãƒœãƒ¼ãƒ‰æ“ä½œé–¢æ•°ã®ãƒ†ã‚¹ãƒˆï¼ˆç¯„å›²ãƒã‚§ãƒƒã‚¯å«ã‚€ï¼‰</li>
<li>elm-test ã«ã‚ˆã‚‹è‡ªå‹•ãƒ†ã‚¹ãƒˆ</li>
</ol>
<h3 id="_28">å­¦ã‚“ã ã“ã¨<a class="headerlink" href="#_28" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>å‹å®‰å…¨æ€§</strong>: Elm ã®ã‚«ã‚¹ã‚¿ãƒ å‹ã§ã€ä¸æ­£ãªçŠ¶æ…‹ã‚’å‹ãƒ¬ãƒ™ãƒ«ã§é˜²ã</li>
<li><strong>Maybe å‹</strong>: null ã‚’æ’é™¤ã—ã€å¤±æ•—ã™ã‚‹å¯èƒ½æ€§ã‚’æ˜ç¤ºçš„ã«æ‰±ã†</li>
<li><strong>ä¸å¤‰æ€§</strong>: ã™ã¹ã¦ã®ãƒ‡ãƒ¼ã‚¿ãŒã‚¤ãƒŸãƒ¥ãƒ¼ã‚¿ãƒ–ãƒ«ã§ã€å‰¯ä½œç”¨ãŒãªã„</li>
<li><strong>ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°</strong>: ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã«ã‚ˆã‚‹ç¶²ç¾…æ€§ãƒã‚§ãƒƒã‚¯</li>
<li><strong>The Elm Architecture</strong>: ã‚·ãƒ³ãƒ—ãƒ«ã§äºˆæ¸¬å¯èƒ½ãªçŠ¶æ…‹ç®¡ç†</li>
</ul>
<p>æ¬¡ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ã€ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰å…¥åŠ›ã§ã·ã‚ˆã‚’ç§»å‹•ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ï¼</p>
<h2 id="2">ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³2: ã·ã‚ˆã®ç§»å‹•ã®å®Ÿè£…<a class="headerlink" href="#2" title="Permanent link">&para;</a></h2>
<p>ã•ã¦ã€å‰å›ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§ã‚²ãƒ¼ãƒ ã®åŸºæœ¬çš„ãªæ§‹é€ ãŒã§ãã¾ã—ãŸã­ã€‚ã€Œã‚²ãƒ¼ãƒ ãŒå§‹ã¾ã£ãŸã‘ã©ã€ã·ã‚ˆãŒå‹•ã‹ãªã„ã¨é¢ç™½ããªã„ã‚ˆã­ï¼Ÿã€ã¨æ€ã„ã¾ã›ã‚“ã‹ï¼Ÿãã“ã§æ¬¡ã¯ã€ã·ã‚ˆã‚’å·¦å³ã«ç§»å‹•ã§ãã‚‹ã‚ˆã†ã«ã—ã¦ã„ãã¾ã—ã‚‡ã†ï¼</p>
<h3 id="_29">ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼<a class="headerlink" href="#_29" title="Permanent link">&para;</a></h3>
<p>ã¾ãšã¯ã€ã“ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§å®Ÿè£…ã™ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚’ç¢ºèªã—ã¾ã—ã‚‡ã†ï¼š</p>
<blockquote>
<p>ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¨ã—ã¦ã€è½ã¡ã¦ãã‚‹ã·ã‚ˆã‚’å·¦å³ã«ç§»å‹•ã§ãã‚‹</p>
</blockquote>
<p>ã€Œã·ã‚ˆã·ã‚ˆã£ã¦ã€è½ã¡ã¦ãã‚‹ã·ã‚ˆã‚’å·¦å³ã«å‹•ã‹ã—ã¦ã€ã†ã¾ãç©ã¿ä¸Šã’ã‚‹ã‚²ãƒ¼ãƒ ã§ã™ã‚ˆã­ï¼Ÿã€ãã†ã§ã™ï¼ä»Šå›ã¯ãã®åŸºæœ¬æ“ä½œã§ã‚ã‚‹ã€Œå·¦å³ã®ç§»å‹•ã€ã‚’å®Ÿè£…ã—ã¦ã„ãã¾ã™ã€‚</p>
<h3 id="todo_1">TODOãƒªã‚¹ãƒˆ<a class="headerlink" href="#todo_1" title="Permanent link">&para;</a></h3>
<p>ã•ã¦ã€ã“ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚’å®Ÿç¾ã™ã‚‹ãŸã‚ã«ã€ã©ã‚“ãªã‚¿ã‚¹ã‚¯ãŒå¿…è¦ã§ã—ã‚‡ã†ã‹ï¼Ÿä¸€ç·’ã«è€ƒãˆã¦ã¿ã¾ã—ã‚‡ã†ã€‚
ã€Œã·ã‚ˆã‚’å·¦å³ã«ç§»å‹•ã™ã‚‹ã€ã¨ã„ã†æ©Ÿèƒ½ã‚’å®Ÿç¾ã™ã‚‹ãŸã‚ã«ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ãªã‚¿ã‚¹ã‚¯ãŒå¿…è¦ãã†ã§ã™ã­ï¼š</p>
<ul>
<li>ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰å…¥åŠ›ã‚’æ¤œå‡ºã™ã‚‹ï¼ˆBrowser.Events ã§ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚¤ãƒ™ãƒ³ãƒˆã‚’è³¼èª­ï¼‰</li>
<li>ã·ã‚ˆãƒšã‚¢ã®ç§»å‹•å‡¦ç†ã‚’å®Ÿè£…ã™ã‚‹ï¼ˆå·¦å³ã¸ã®ç§»å‹•ï¼‰</li>
<li>ç§»å‹•å¯èƒ½ã‹ã©ã†ã‹ã®ãƒã‚§ãƒƒã‚¯ï¼ˆãƒœãƒ¼ãƒ‰ã®ç«¯ã‚„æ—¢å­˜ã®ã·ã‚ˆã¨ã®è¡çªåˆ¤å®šï¼‰</li>
<li>The Elm Architecture ã¸ã®çµ±åˆï¼ˆMsgã€updateã€subscriptionsï¼‰</li>
</ul>
<p>ã€Œãªã‚‹ã»ã©ã€é †ç•ªã«å®Ÿè£…ã—ã¦ã„ã‘ã°ã„ã„ã‚“ã§ã™ã­ï¼ã€ãã†ã§ã™ã€ä¸€ã¤ãšã¤é€²ã‚ã¦ã„ãã¾ã—ã‚‡ã†ã€‚ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã®æµã‚Œã«æ²¿ã£ã¦ã€ã¾ãšã¯ãƒ†ã‚¹ãƒˆã‹ã‚‰æ›¸ã„ã¦ã„ãã¾ã™ã‚ˆã€‚</p>
<h3 id="_30">ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰å…¥åŠ›ã®è¨­è¨ˆ<a class="headerlink" href="#_30" title="Permanent link">&para;</a></h3>
<p>Elm ã§ã¯ã€ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰å…¥åŠ›ã‚’æ‰±ã†ãŸã‚ã« <code>Browser.Events</code> ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã® <code>onKeyDown</code> ã‚’ä½¿ã„ã¾ã™ã€‚TypeScript ç‰ˆã¨ã¯ç•°ãªã‚Šã€Elm ã§ã¯å‰¯ä½œç”¨ï¼ˆã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®ç™»éŒ²ãªã©ï¼‰ã¯ã™ã¹ã¦ The Elm Architecture ã®æ çµ„ã¿ã®ä¸­ã§ç®¡ç†ã•ã‚Œã¾ã™ã€‚</p>
<p>ã¾ãšã€å¿…è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Browser.Events ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’å«ã‚€ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯æ—¢ã« elm/browser ã«å«ã¾ã‚Œã¦ã„ã‚‹</span>
<span class="c1"># JSON ãƒ‡ã‚³ãƒ¼ãƒ€ã‚’ä½¿ã†ãŸã‚ã« elm/json ãŒå¿…è¦ï¼ˆæ—¢ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿ï¼‰</span>
</code></pre></div>
<h3 id="_31">ãƒ†ã‚¹ãƒˆ: ã·ã‚ˆãƒšã‚¢ã®ç§»å‹•<a class="headerlink" href="#_31" title="Permanent link">&para;</a></h3>
<p>ã¾ãšã¯ã€ã·ã‚ˆãƒšã‚¢ã®ç§»å‹•ãƒ­ã‚¸ãƒƒã‚¯ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã—ã‚‡ã†ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- tests/PuyoPairTests.elm</span>
<span class="kn">module</span><span class="w"> </span><span class="nc">PuyoPairTests</span><span class="w"> </span><span class="nv">exposing</span><span class="w"> </span><span class="p">(</span><span class="nv">suite</span><span class="p">)</span>

<span class="kn">import</span><span class="w"> </span><span class="nc">Board</span>
<span class="kn">import</span><span class="w"> </span><span class="nc">Cell</span><span class="w"> </span><span class="nv">exposing</span><span class="w"> </span><span class="p">(</span><span class="kt">Cell</span><span class="nf">(..)</span><span class="p">)</span>
<span class="kn">import</span><span class="w"> </span><span class="nc">Expect</span>
<span class="kn">import</span><span class="w"> </span><span class="nc">PuyoColor</span><span class="w"> </span><span class="nv">exposing</span><span class="w"> </span><span class="p">(</span><span class="kt">PuyoColor</span><span class="nf">(..)</span><span class="p">)</span>
<span class="kn">import</span><span class="w"> </span><span class="nc">PuyoPair</span>
<span class="kn">import</span><span class="w"> </span><span class="nc">Test</span><span class="w"> </span><span class="nv">exposing</span><span class="w"> </span><span class="p">(</span><span class="kt">Test</span><span class="p">,</span><span class="w"> </span><span class="nv">describe</span><span class="p">,</span><span class="w"> </span><span class="nv">test</span><span class="p">)</span>


<span class="nv">suite</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Test</span>
<span class="nv">suite</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="nv">describe</span><span class="w"> </span><span class="s">&quot;PuyoPair&quot;</span>
<span class="w">        </span><span class="p">[</span><span class="w"> </span><span class="nv">describe</span><span class="w"> </span><span class="s">&quot;moveLeft&quot;</span>
<span class="w">            </span><span class="p">[</span><span class="w"> </span><span class="nv">test</span><span class="w"> </span><span class="s">&quot;å·¦ã«ç§»å‹•ã§ãã‚‹å ´åˆã€å·¦ã«ç§»å‹•ã™ã‚‹&quot;</span><span class="w"> </span><span class="nf">&lt;|</span>
<span class="w">                </span><span class="nf">\</span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="kr">let</span>
<span class="w">                        </span><span class="nv">pair</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="kt">Red</span><span class="w"> </span><span class="kt">Blue</span>

<span class="w">                        </span><span class="nv">movedPair</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">moveLeft</span><span class="w"> </span><span class="nv">pair</span>
<span class="w">                    </span><span class="kr">in</span>
<span class="w">                    </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">equal</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="nv">movedPair</span><span class="nf">.</span><span class="nv">axis</span><span class="nf">.</span><span class="nv">x</span>
<span class="w">            </span><span class="p">,</span><span class="w"> </span><span class="nv">test</span><span class="w"> </span><span class="s">&quot;å·¦ç«¯ã«ã„ã‚‹å ´åˆã§ã‚‚ç§»å‹•ã™ã‚‹ï¼ˆè¡çªåˆ¤å®šã¯åˆ¥ã§è¡Œã†ï¼‰&quot;</span><span class="w"> </span><span class="nf">&lt;|</span>
<span class="w">                </span><span class="nf">\</span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="kr">let</span>
<span class="w">                        </span><span class="nv">pair</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="kt">Red</span><span class="w"> </span><span class="kt">Blue</span>

<span class="w">                        </span><span class="nv">movedPair</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">moveLeft</span><span class="w"> </span><span class="nv">pair</span>
<span class="w">                    </span><span class="kr">in</span>
<span class="w">                    </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">equal</span><span class="w"> </span><span class="nf">-</span><span class="mi">1</span><span class="w"> </span><span class="nv">movedPair</span><span class="nf">.</span><span class="nv">axis</span><span class="nf">.</span><span class="nv">x</span>
<span class="w">            </span><span class="p">]</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">describe</span><span class="w"> </span><span class="s">&quot;moveRight&quot;</span>
<span class="w">            </span><span class="p">[</span><span class="w"> </span><span class="nv">test</span><span class="w"> </span><span class="s">&quot;å³ã«ç§»å‹•ã§ãã‚‹å ´åˆã€å³ã«ç§»å‹•ã™ã‚‹&quot;</span><span class="w"> </span><span class="nf">&lt;|</span>
<span class="w">                </span><span class="nf">\</span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="kr">let</span>
<span class="w">                        </span><span class="nv">pair</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="kt">Red</span><span class="w"> </span><span class="kt">Blue</span>

<span class="w">                        </span><span class="nv">movedPair</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">moveRight</span><span class="w"> </span><span class="nv">pair</span>
<span class="w">                    </span><span class="kr">in</span>
<span class="w">                    </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">equal</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="nv">movedPair</span><span class="nf">.</span><span class="nv">axis</span><span class="nf">.</span><span class="nv">x</span>
<span class="w">            </span><span class="p">]</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">describe</span><span class="w"> </span><span class="s">&quot;canMove&quot;</span>
<span class="w">            </span><span class="p">[</span><span class="w"> </span><span class="nv">test</span><span class="w"> </span><span class="s">&quot;ç§»å‹•å…ˆã«ã·ã‚ˆãŒãªã‘ã‚Œã°ç§»å‹•å¯èƒ½&quot;</span><span class="w"> </span><span class="nf">&lt;|</span>
<span class="w">                </span><span class="nf">\</span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="kr">let</span>
<span class="w">                        </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="mi">12</span>

<span class="w">                        </span><span class="nv">pair</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="kt">Red</span><span class="w"> </span><span class="kt">Blue</span>
<span class="w">                    </span><span class="kr">in</span>
<span class="w">                    </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">canMove</span><span class="w"> </span><span class="nv">pair</span><span class="w"> </span><span class="nv">board</span>
<span class="w">                        </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">equal</span><span class="w"> </span><span class="kt">True</span>
<span class="w">            </span><span class="p">,</span><span class="w"> </span><span class="nv">test</span><span class="w"> </span><span class="s">&quot;è»¸ã·ã‚ˆãŒãƒœãƒ¼ãƒ‰ç¯„å›²å¤–ãªã‚‰ç§»å‹•ä¸å¯&quot;</span><span class="w"> </span><span class="nf">&lt;|</span>
<span class="w">                </span><span class="nf">\</span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="kr">let</span>
<span class="w">                        </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="mi">12</span>

<span class="w">                        </span><span class="nv">pair</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="nf">-</span><span class="mi">1</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="kt">Red</span><span class="w"> </span><span class="kt">Blue</span>
<span class="w">                    </span><span class="kr">in</span>
<span class="w">                    </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">canMove</span><span class="w"> </span><span class="nv">pair</span><span class="w"> </span><span class="nv">board</span>
<span class="w">                        </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">equal</span><span class="w"> </span><span class="kt">False</span>
<span class="w">            </span><span class="p">,</span><span class="w"> </span><span class="nv">test</span><span class="w"> </span><span class="s">&quot;å­ã·ã‚ˆãŒãƒœãƒ¼ãƒ‰ç¯„å›²å¤–ãªã‚‰ç§»å‹•ä¸å¯&quot;</span><span class="w"> </span><span class="nf">&lt;|</span>
<span class="w">                </span><span class="nf">\</span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="kr">let</span>
<span class="w">                        </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="mi">12</span>

<span class="w">                        </span><span class="nv">pair</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="nf">-</span><span class="mi">1</span><span class="w"> </span><span class="kt">Red</span><span class="w"> </span><span class="kt">Blue</span>
<span class="w">                    </span><span class="kr">in</span>
<span class="w">                    </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">canMove</span><span class="w"> </span><span class="nv">pair</span><span class="w"> </span><span class="nv">board</span>
<span class="w">                        </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">equal</span><span class="w"> </span><span class="kt">False</span>
<span class="w">            </span><span class="p">,</span><span class="w"> </span><span class="nv">test</span><span class="w"> </span><span class="s">&quot;ç§»å‹•å…ˆã«ã·ã‚ˆãŒã‚ã‚Œã°ç§»å‹•ä¸å¯&quot;</span><span class="w"> </span><span class="nf">&lt;|</span>
<span class="w">                </span><span class="nf">\</span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="kr">let</span>
<span class="w">                        </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="mi">12</span>
<span class="w">                                </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">setCell</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="p">(</span><span class="kt">Filled</span><span class="w"> </span><span class="kt">Red</span><span class="p">)</span>

<span class="w">                        </span><span class="nv">pair</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="kt">Red</span><span class="w"> </span><span class="kt">Blue</span>
<span class="w">                    </span><span class="kr">in</span>
<span class="w">                    </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">canMove</span><span class="w"> </span><span class="nv">pair</span><span class="w"> </span><span class="nv">board</span>
<span class="w">                        </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">equal</span><span class="w"> </span><span class="kt">False</span>
<span class="w">            </span><span class="p">]</span>
<span class="w">        </span><span class="p">]</span>
</code></pre></div>
<p>ã€ŒElm ã®ãƒ†ã‚¹ãƒˆã¯å‹å®‰å…¨ã§ã™ã­ï¼ã€ãã†ãªã‚“ã§ã™ã€‚Elm ã§ã¯ã€ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ãŒå‹ãƒã‚§ãƒƒã‚¯ã‚’ã—ã¦ãã‚Œã‚‹ã®ã§ã€ãƒ†ã‚¹ãƒˆã‚’æ›¸ãæ®µéšã§å¤šãã®ãƒã‚°ã‚’é˜²ã’ã¾ã™ã€‚</p>
<h3 id="_32">å®Ÿè£…: ã·ã‚ˆãƒšã‚¢ã®ç§»å‹•<a class="headerlink" href="#_32" title="Permanent link">&para;</a></h3>
<p>ã§ã¯ã€ãƒ†ã‚¹ãƒˆãŒé€šã‚‹ã‚ˆã†ã« PuyoPair ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’æ‹¡å¼µã—ã¾ã—ã‚‡ã†ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- src/PuyoPair.elm</span>
<span class="kn">module</span><span class="w"> </span><span class="nc">PuyoPair</span><span class="w"> </span><span class="nv">exposing</span>
<span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="kt">PuyoPair</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="kt">Position</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">canMove</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">create</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">getPositions</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">moveLeft</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">moveRight</span>
<span class="w">    </span><span class="p">)</span>

<span class="kn">import</span><span class="w"> </span><span class="nc">Board</span><span class="w"> </span><span class="nv">exposing</span><span class="w"> </span><span class="p">(</span><span class="kt">Board</span><span class="p">)</span>
<span class="kn">import</span><span class="w"> </span><span class="nc">Cell</span><span class="w"> </span><span class="nv">exposing</span><span class="w"> </span><span class="p">(</span><span class="kt">Cell</span><span class="nf">(..)</span><span class="p">)</span>
<span class="kn">import</span><span class="w"> </span><span class="nc">PuyoColor</span><span class="w"> </span><span class="nv">exposing</span><span class="w"> </span><span class="p">(</span><span class="kt">PuyoColor</span><span class="p">)</span>


<span class="kr">type</span><span class="w"> </span><span class="kr">alias</span><span class="w"> </span><span class="kt">Position</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Int</span><span class="p">,</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="p">}</span>


<span class="kr">type</span><span class="w"> </span><span class="kr">alias</span><span class="w"> </span><span class="kt">PuyoPair</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nv">axis</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Position</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">child</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Position</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">axisColor</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">PuyoColor</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">childColor</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">PuyoColor</span>
<span class="w">    </span><span class="p">}</span>


<span class="c1">-- ã·ã‚ˆãƒšã‚¢ã‚’ä½œæˆã™ã‚‹</span>
<span class="nv">create</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">PuyoColor</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">PuyoColor</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">PuyoPair</span>
<span class="nv">create</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nv">axisColor</span><span class="w"> </span><span class="nv">childColor</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nv">axis</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">x</span><span class="p">,</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">child</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">x</span><span class="p">,</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nf">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">axisColor</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">axisColor</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">childColor</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">childColor</span>
<span class="w">    </span><span class="p">}</span>


<span class="c1">-- ã·ã‚ˆãƒšã‚¢ã®ä½ç½®ã‚’å–å¾—ã™ã‚‹</span>
<span class="nv">getPositions</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">PuyoPair</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="kt">Position</span><span class="p">,</span><span class="w"> </span><span class="kt">Position</span><span class="w"> </span><span class="p">)</span>
<span class="nv">getPositions</span><span class="w"> </span><span class="nv">pair</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">axis</span><span class="p">,</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">child</span><span class="w"> </span><span class="p">)</span>


<span class="c1">-- å·¦ã«ç§»å‹•ã™ã‚‹</span>
<span class="nv">moveLeft</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">PuyoPair</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">PuyoPair</span>
<span class="nv">moveLeft</span><span class="w"> </span><span class="nv">pair</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nv">pair</span>
<span class="w">        </span><span class="nf">|</span><span class="w"> </span><span class="nv">axis</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">axis</span><span class="nf">.</span><span class="nv">x</span><span class="w"> </span><span class="nf">-</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">axis</span><span class="nf">.</span><span class="nv">y</span><span class="w"> </span><span class="p">}</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">child</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">child</span><span class="nf">.</span><span class="nv">x</span><span class="w"> </span><span class="nf">-</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">child</span><span class="nf">.</span><span class="nv">y</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>


<span class="c1">-- å³ã«ç§»å‹•ã™ã‚‹</span>
<span class="nv">moveRight</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">PuyoPair</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">PuyoPair</span>
<span class="nv">moveRight</span><span class="w"> </span><span class="nv">pair</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nv">pair</span>
<span class="w">        </span><span class="nf">|</span><span class="w"> </span><span class="nv">axis</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">axis</span><span class="nf">.</span><span class="nv">x</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">axis</span><span class="nf">.</span><span class="nv">y</span><span class="w"> </span><span class="p">}</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">child</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">child</span><span class="nf">.</span><span class="nv">x</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">child</span><span class="nf">.</span><span class="nv">y</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>


<span class="c1">-- ç§»å‹•å¯èƒ½ã‹ãƒã‚§ãƒƒã‚¯ã™ã‚‹</span>
<span class="nv">canMove</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">PuyoPair</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Bool</span>
<span class="nv">canMove</span><span class="w"> </span><span class="nv">pair</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="kr">let</span>
<span class="w">        </span><span class="nv">axisCell</span><span class="w"> </span><span class="nf">=</span>
<span class="w">            </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">getCell</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">axis</span><span class="nf">.</span><span class="nv">x</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">axis</span><span class="nf">.</span><span class="nv">y</span><span class="w"> </span><span class="nv">board</span>

<span class="w">        </span><span class="nv">childCell</span><span class="w"> </span><span class="nf">=</span>
<span class="w">            </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">getCell</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">child</span><span class="nf">.</span><span class="nv">x</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">child</span><span class="nf">.</span><span class="nv">y</span><span class="w"> </span><span class="nv">board</span>
<span class="w">    </span><span class="kr">in</span>
<span class="w">    </span><span class="kr">case</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nv">axisCell</span><span class="p">,</span><span class="w"> </span><span class="nv">childCell</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="kr">of</span>
<span class="w">        </span><span class="p">(</span><span class="w"> </span><span class="kt">Just</span><span class="w"> </span><span class="kt">Empty</span><span class="p">,</span><span class="w"> </span><span class="kt">Just</span><span class="w"> </span><span class="kt">Empty</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="kt">True</span>

<span class="w">        </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="kt">False</span>
</code></pre></div>
<p>ã€Œä¸å¤‰æ€§ã‚’ä¿ã¡ãªãŒã‚‰ç§»å‹•ã—ã¦ã„ã‚‹ã‚“ã§ã™ã­ï¼ã€ãã†ã§ã™ã€‚Elm ã§ã¯ã€ã™ã¹ã¦ã®ãƒ‡ãƒ¼ã‚¿ãŒä¸å¤‰ï¼ˆã‚¤ãƒŸãƒ¥ãƒ¼ã‚¿ãƒ–ãƒ«ï¼‰ãªã®ã§ã€å…ƒã®ã·ã‚ˆãƒšã‚¢ã‚’å¤‰æ›´ã›ãšã€æ–°ã—ã„ã·ã‚ˆãƒšã‚¢ã‚’ä½œæˆã—ã¦è¿”ã—ã¾ã™ã€‚ãƒ¬ã‚³ãƒ¼ãƒ‰æ›´æ–°æ§‹æ–‡ï¼ˆ<code>{ pair | ... }</code>ï¼‰ã‚’ä½¿ã†ã“ã¨ã§ã€ä¸€éƒ¨ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã ã‘ã‚’æ›´æ–°ã—ãŸæ–°ã—ã„ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ç°¡æ½”ã«ä½œã‚Œã¾ã™ã€‚</p>
<h3 id="_33">ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œ<a class="headerlink" href="#_33" title="Permanent link">&para;</a></h3>
<p>ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼š</p>
<div class="highlight"><pre><span></span><code>elm-test
</code></pre></div>
<p>ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆãŒé€šã‚Œã°æˆåŠŸã§ã™ï¼</p>
<div class="highlight"><pre><span></span><code>TEST RUN PASSED

Duration: 145 ms
Passed:   13
Failed:   0
</code></pre></div>
<p>ã€ŒãŠãŠã€ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆãŒé€šã‚Šã¾ã—ãŸï¼ã€ç´ æ™´ã‚‰ã—ã„ã§ã™ã­ã€‚ã“ã‚ŒãŒãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã®ã€ŒGreenï¼ˆç·‘ï¼‰ã€ã®çŠ¶æ…‹ã§ã™ã€‚</p>
<h3 id="the-elm-architecture_2">The Elm Architecture ã¸ã®çµ±åˆ<a class="headerlink" href="#the-elm-architecture_2" title="Permanent link">&para;</a></h3>
<p>æ¬¡ã«ã€ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰å…¥åŠ›ã‚’ The Elm Architecture ã«çµ±åˆã—ã¾ã™ã€‚Elm ã§ã¯ã€ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚¤ãƒ™ãƒ³ãƒˆã¯ã€Œã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ï¼ˆSubscriptionsï¼‰ã€ã¨ã—ã¦æ‰±ã„ã¾ã™ã€‚</p>
<p>ã¾ãšã€Main.elm ã‚’æ›´æ–°ã—ã¦ã€ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰å…¥åŠ›ã‚’å‡¦ç†ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- src/Main.elm</span>
<span class="kn">module</span><span class="w"> </span><span class="nc">Main</span><span class="w"> </span><span class="nv">exposing</span><span class="w"> </span><span class="p">(</span><span class="nv">main</span><span class="p">)</span>

<span class="kn">import</span><span class="w"> </span><span class="nc">Board</span><span class="w"> </span><span class="nv">exposing</span><span class="w"> </span><span class="p">(</span><span class="kt">Board</span><span class="p">)</span>
<span class="kn">import</span><span class="w"> </span><span class="nc">Browser</span>
<span class="kn">import</span><span class="w"> </span><span class="nc">Browser.Events</span>
<span class="kn">import</span><span class="w"> </span><span class="nc">Cell</span><span class="w"> </span><span class="nv">exposing</span><span class="w"> </span><span class="p">(</span><span class="kt">Cell</span><span class="nf">(..)</span><span class="p">)</span>
<span class="kn">import</span><span class="w"> </span><span class="nc">Html</span><span class="w"> </span><span class="nv">exposing</span><span class="w"> </span><span class="p">(</span><span class="kt">Html</span><span class="p">,</span><span class="w"> </span><span class="nv">button</span><span class="p">,</span><span class="w"> </span><span class="nv">div</span><span class="p">,</span><span class="w"> </span><span class="nv">h1</span><span class="p">,</span><span class="w"> </span><span class="nv">text</span><span class="p">)</span>
<span class="kn">import</span><span class="w"> </span><span class="nc">Html.Attributes</span><span class="w"> </span><span class="nv">exposing</span><span class="w"> </span><span class="p">(</span><span class="nv">style</span><span class="p">)</span>
<span class="kn">import</span><span class="w"> </span><span class="nc">Html.Events</span><span class="w"> </span><span class="nv">exposing</span><span class="w"> </span><span class="p">(</span><span class="nv">onClick</span><span class="p">)</span>
<span class="kn">import</span><span class="w"> </span><span class="nc">Json.Decode</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="kt">Decode</span>
<span class="kn">import</span><span class="w"> </span><span class="nc">PuyoColor</span><span class="w"> </span><span class="nv">exposing</span><span class="w"> </span><span class="p">(</span><span class="kt">PuyoColor</span><span class="nf">(..)</span><span class="p">)</span>
<span class="kn">import</span><span class="w"> </span><span class="nc">PuyoPair</span><span class="w"> </span><span class="nv">exposing</span><span class="w"> </span><span class="p">(</span><span class="kt">PuyoPair</span><span class="p">)</span>


<span class="c1">-- MODEL</span>


<span class="kr">type</span><span class="w"> </span><span class="kt">GameMode</span>
<span class="w">    </span><span class="nf">=</span><span class="w"> </span><span class="kt">Start</span>
<span class="w">    </span><span class="nf">|</span><span class="w"> </span><span class="kt">Playing</span>
<span class="w">    </span><span class="nf">|</span><span class="w"> </span><span class="kt">GameOver</span>


<span class="kr">type</span><span class="w"> </span><span class="kr">alias</span><span class="w"> </span><span class="kt">Model</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Board</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">currentPair</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Maybe</span><span class="w"> </span><span class="kt">PuyoPair</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">mode</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">GameMode</span>
<span class="w">    </span><span class="p">}</span>


<span class="nv">init</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="kt">Model</span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="w"> </span><span class="kt">Msg</span><span class="w"> </span><span class="p">)</span>
<span class="nv">init</span><span class="w"> </span><span class="nv">_</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="mi">12</span>
<span class="w">      </span><span class="p">,</span><span class="w"> </span><span class="nv">currentPair</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Nothing</span>
<span class="w">      </span><span class="p">,</span><span class="w"> </span><span class="nv">mode</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Start</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="nf">.</span><span class="nv">none</span>
<span class="w">    </span><span class="p">)</span>


<span class="c1">-- UPDATE</span>


<span class="kr">type</span><span class="w"> </span><span class="kt">Msg</span>
<span class="w">    </span><span class="nf">=</span><span class="w"> </span><span class="kt">StartGame</span>
<span class="w">    </span><span class="nf">|</span><span class="w"> </span><span class="kt">KeyPressed</span><span class="w"> </span><span class="kt">String</span>
<span class="w">    </span><span class="nf">|</span><span class="w"> </span><span class="kt">Tick</span>
<span class="w">    </span><span class="nf">|</span><span class="w"> </span><span class="kt">NoOp</span>


<span class="nv">update</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Msg</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Model</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="kt">Model</span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="w"> </span><span class="kt">Msg</span><span class="w"> </span><span class="p">)</span>
<span class="nv">update</span><span class="w"> </span><span class="nv">msg</span><span class="w"> </span><span class="nv">model</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="kr">case</span><span class="w"> </span><span class="nv">msg</span><span class="w"> </span><span class="kr">of</span>
<span class="w">        </span><span class="kt">StartGame</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="p">(</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">model</span>
<span class="w">                </span><span class="nf">|</span><span class="w"> </span><span class="nv">mode</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Playing</span>
<span class="w">                </span><span class="p">,</span><span class="w"> </span><span class="nv">currentPair</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Just</span><span class="w"> </span><span class="p">(</span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="kt">Red</span><span class="w"> </span><span class="kt">Blue</span><span class="p">)</span>
<span class="w">              </span><span class="p">}</span>
<span class="w">            </span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="nf">.</span><span class="nv">none</span>
<span class="w">            </span><span class="p">)</span>

<span class="w">        </span><span class="kt">KeyPressed</span><span class="w"> </span><span class="nv">key</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="kr">case</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">mode</span><span class="p">,</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">currentPair</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="kr">of</span>
<span class="w">                </span><span class="p">(</span><span class="w"> </span><span class="kt">Playing</span><span class="p">,</span><span class="w"> </span><span class="kt">Just</span><span class="w"> </span><span class="nv">pair</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="kr">let</span>
<span class="w">                        </span><span class="nv">newPair</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kr">case</span><span class="w"> </span><span class="nv">key</span><span class="w"> </span><span class="kr">of</span>
<span class="w">                                </span><span class="s">&quot;ArrowLeft&quot;</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                                    </span><span class="kr">let</span>
<span class="w">                                        </span><span class="nv">movedPair</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                                            </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">moveLeft</span><span class="w"> </span><span class="nv">pair</span>
<span class="w">                                    </span><span class="kr">in</span>
<span class="w">                                    </span><span class="kr">if</span><span class="w"> </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">canMove</span><span class="w"> </span><span class="nv">movedPair</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">board</span><span class="w"> </span><span class="kr">then</span>
<span class="w">                                        </span><span class="nv">movedPair</span>

<span class="w">                                    </span><span class="kr">else</span>
<span class="w">                                        </span><span class="nv">pair</span>

<span class="w">                                </span><span class="s">&quot;ArrowRight&quot;</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                                    </span><span class="kr">let</span>
<span class="w">                                        </span><span class="nv">movedPair</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                                            </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">moveRight</span><span class="w"> </span><span class="nv">pair</span>
<span class="w">                                    </span><span class="kr">in</span>
<span class="w">                                    </span><span class="kr">if</span><span class="w"> </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">canMove</span><span class="w"> </span><span class="nv">movedPair</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">board</span><span class="w"> </span><span class="kr">then</span>
<span class="w">                                        </span><span class="nv">movedPair</span>

<span class="w">                                    </span><span class="kr">else</span>
<span class="w">                                        </span><span class="nv">pair</span>

<span class="w">                                </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                                    </span><span class="nv">pair</span>
<span class="w">                    </span><span class="kr">in</span>
<span class="w">                    </span><span class="p">(</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">model</span><span class="w"> </span><span class="nf">|</span><span class="w"> </span><span class="nv">currentPair</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Just</span><span class="w"> </span><span class="nv">newPair</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="kt">Cmd</span><span class="nf">.</span><span class="nv">none</span><span class="w"> </span><span class="p">)</span>

<span class="w">                </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="p">(</span><span class="w"> </span><span class="nv">model</span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="nf">.</span><span class="nv">none</span><span class="w"> </span><span class="p">)</span>

<span class="w">        </span><span class="kt">Tick</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="c1">-- å¾Œã§å®Ÿè£…</span>
<span class="w">            </span><span class="p">(</span><span class="w"> </span><span class="nv">model</span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="nf">.</span><span class="nv">none</span><span class="w"> </span><span class="p">)</span>

<span class="w">        </span><span class="kt">NoOp</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="p">(</span><span class="w"> </span><span class="nv">model</span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="nf">.</span><span class="nv">none</span><span class="w"> </span><span class="p">)</span>


<span class="c1">-- SUBSCRIPTIONS</span>


<span class="nv">subscriptions</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Model</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Sub</span><span class="w"> </span><span class="kt">Msg</span>
<span class="nv">subscriptions</span><span class="w"> </span><span class="nv">model</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="kr">case</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">mode</span><span class="w"> </span><span class="kr">of</span>
<span class="w">        </span><span class="kt">Playing</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="kt">Browser</span><span class="nf">.</span><span class="kt">Events</span><span class="nf">.</span><span class="nv">onKeyDown</span><span class="w"> </span><span class="p">(</span><span class="kt">Decode</span><span class="nf">.</span><span class="nv">map</span><span class="w"> </span><span class="kt">KeyPressed</span><span class="w"> </span><span class="nv">keyDecoder</span><span class="p">)</span>

<span class="w">        </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="kt">Sub</span><span class="nf">.</span><span class="nv">none</span>


<span class="nv">keyDecoder</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Decode</span><span class="nf">.</span><span class="kt">Decoder</span><span class="w"> </span><span class="kt">String</span>
<span class="nv">keyDecoder</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="kt">Decode</span><span class="nf">.</span><span class="nv">field</span><span class="w"> </span><span class="s">&quot;key&quot;</span><span class="w"> </span><span class="kt">Decode</span><span class="nf">.</span><span class="nv">string</span>


<span class="c1">-- VIEW</span>


<span class="nv">view</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Model</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Html</span><span class="w"> </span><span class="kt">Msg</span>
<span class="nv">view</span><span class="w"> </span><span class="nv">model</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="nv">div</span>
<span class="w">        </span><span class="p">[</span><span class="w"> </span><span class="nv">style</span><span class="w"> </span><span class="s">&quot;padding&quot;</span><span class="w"> </span><span class="s">&quot;20px&quot;</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">style</span><span class="w"> </span><span class="s">&quot;font-family&quot;</span><span class="w"> </span><span class="s">&quot;Arial, sans-serif&quot;</span>
<span class="w">        </span><span class="p">]</span>
<span class="w">        </span><span class="p">[</span><span class="w"> </span><span class="nv">h1</span><span class="w"> </span><span class="p">[]</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="nv">text</span><span class="w"> </span><span class="s">&quot;ã·ã‚ˆã·ã‚ˆ - Elm ç‰ˆ&quot;</span><span class="w"> </span><span class="p">]</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">div</span><span class="w"> </span><span class="p">[]</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="nv">text</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;ã‚²ãƒ¼ãƒ ãƒ¢ãƒ¼ãƒ‰: &quot;</span><span class="w"> </span><span class="nf">++</span><span class="w"> </span><span class="nv">gameModeToString</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">mode</span><span class="p">)</span><span class="w"> </span><span class="p">]</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">viewGameControls</span><span class="w"> </span><span class="nv">model</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">viewBoard</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">board</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">currentPair</span>
<span class="w">        </span><span class="p">]</span>


<span class="nv">viewGameControls</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Model</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Html</span><span class="w"> </span><span class="kt">Msg</span>
<span class="nv">viewGameControls</span><span class="w"> </span><span class="nv">model</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="kr">case</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">mode</span><span class="w"> </span><span class="kr">of</span>
<span class="w">        </span><span class="kt">Start</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="nv">button</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="nv">onClick</span><span class="w"> </span><span class="kt">StartGame</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="nv">text</span><span class="w"> </span><span class="s">&quot;ã‚²ãƒ¼ãƒ é–‹å§‹&quot;</span><span class="w"> </span><span class="p">]</span>

<span class="w">        </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="nv">div</span><span class="w"> </span><span class="p">[]</span><span class="w"> </span><span class="p">[]</span>


<span class="nv">gameModeToString</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">GameMode</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">String</span>
<span class="nv">gameModeToString</span><span class="w"> </span><span class="nv">mode</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="kr">case</span><span class="w"> </span><span class="nv">mode</span><span class="w"> </span><span class="kr">of</span>
<span class="w">        </span><span class="kt">Start</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="s">&quot;ã‚¹ã‚¿ãƒ¼ãƒˆ&quot;</span>

<span class="w">        </span><span class="kt">Playing</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="s">&quot;ãƒ—ãƒ¬ã‚¤ä¸­&quot;</span>

<span class="w">        </span><span class="kt">GameOver</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="s">&quot;ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼&quot;</span>


<span class="nv">viewBoard</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Board</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Maybe</span><span class="w"> </span><span class="kt">PuyoPair</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Html</span><span class="w"> </span><span class="kt">Msg</span>
<span class="nv">viewBoard</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="nv">maybePair</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="nv">div</span>
<span class="w">        </span><span class="p">[</span><span class="w"> </span><span class="nv">style</span><span class="w"> </span><span class="s">&quot;margin-top&quot;</span><span class="w"> </span><span class="s">&quot;20px&quot;</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">style</span><span class="w"> </span><span class="s">&quot;display&quot;</span><span class="w"> </span><span class="s">&quot;inline-block&quot;</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">style</span><span class="w"> </span><span class="s">&quot;border&quot;</span><span class="w"> </span><span class="s">&quot;2px solid #444&quot;</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">style</span><span class="w"> </span><span class="s">&quot;background-color&quot;</span><span class="w"> </span><span class="s">&quot;#2a2a2a&quot;</span>
<span class="w">        </span><span class="p">]</span>
<span class="w">        </span><span class="p">(</span><span class="kt">List</span><span class="nf">.</span><span class="nv">range</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">(</span><span class="nv">board</span><span class="nf">.</span><span class="nv">rows</span><span class="w"> </span><span class="nf">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">            </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">map</span><span class="w"> </span><span class="p">(</span><span class="nf">\</span><span class="nv">y</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="nv">viewRow</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="nv">maybePair</span><span class="w"> </span><span class="nv">y</span><span class="p">)</span>
<span class="w">        </span><span class="p">)</span>


<span class="nv">viewRow</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Board</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Maybe</span><span class="w"> </span><span class="kt">PuyoPair</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Html</span><span class="w"> </span><span class="kt">Msg</span>
<span class="nv">viewRow</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="nv">maybePair</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="nv">div</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="nv">style</span><span class="w"> </span><span class="s">&quot;display&quot;</span><span class="w"> </span><span class="s">&quot;flex&quot;</span><span class="w"> </span><span class="p">]</span>
<span class="w">        </span><span class="p">(</span><span class="kt">List</span><span class="nf">.</span><span class="nv">range</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">(</span><span class="nv">board</span><span class="nf">.</span><span class="nv">cols</span><span class="w"> </span><span class="nf">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">            </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">map</span><span class="w"> </span><span class="p">(</span><span class="nf">\</span><span class="nv">x</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="nv">viewCell</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="nv">maybePair</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nv">y</span><span class="p">)</span>
<span class="w">        </span><span class="p">)</span>


<span class="nv">viewCell</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Board</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Maybe</span><span class="w"> </span><span class="kt">PuyoPair</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Html</span><span class="w"> </span><span class="kt">Msg</span>
<span class="nv">viewCell</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="nv">maybePair</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="kr">let</span>
<span class="w">        </span><span class="nv">cellContent</span><span class="w"> </span><span class="nf">=</span>
<span class="w">            </span><span class="kr">case</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">getCell</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="kr">of</span>
<span class="w">                </span><span class="kt">Just</span><span class="w"> </span><span class="nv">cell</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="nv">cell</span>

<span class="w">                </span><span class="kt">Nothing</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="kt">Empty</span>

<span class="w">        </span><span class="nv">isPairPosition</span><span class="w"> </span><span class="nf">=</span>
<span class="w">            </span><span class="kr">case</span><span class="w"> </span><span class="nv">maybePair</span><span class="w"> </span><span class="kr">of</span>
<span class="w">                </span><span class="kt">Just</span><span class="w"> </span><span class="nv">pair</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="p">(</span><span class="nv">pair</span><span class="nf">.</span><span class="nv">axis</span><span class="nf">.</span><span class="nv">x</span><span class="w"> </span><span class="nf">==</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nf">&amp;&amp;</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">axis</span><span class="nf">.</span><span class="nv">y</span><span class="w"> </span><span class="nf">==</span><span class="w"> </span><span class="nv">y</span><span class="p">)</span>
<span class="w">                        </span><span class="nf">||</span><span class="w"> </span><span class="p">(</span><span class="nv">pair</span><span class="nf">.</span><span class="nv">child</span><span class="nf">.</span><span class="nv">x</span><span class="w"> </span><span class="nf">==</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nf">&amp;&amp;</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">child</span><span class="nf">.</span><span class="nv">y</span><span class="w"> </span><span class="nf">==</span><span class="w"> </span><span class="nv">y</span><span class="p">)</span>

<span class="w">                </span><span class="kt">Nothing</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="kt">False</span>

<span class="w">        </span><span class="nv">color</span><span class="w"> </span><span class="nf">=</span>
<span class="w">            </span><span class="kr">if</span><span class="w"> </span><span class="nv">isPairPosition</span><span class="w"> </span><span class="kr">then</span>
<span class="w">                </span><span class="kr">case</span><span class="w"> </span><span class="nv">maybePair</span><span class="w"> </span><span class="kr">of</span>
<span class="w">                    </span><span class="kt">Just</span><span class="w"> </span><span class="nv">pair</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                        </span><span class="kr">if</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">axis</span><span class="nf">.</span><span class="nv">x</span><span class="w"> </span><span class="nf">==</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nf">&amp;&amp;</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">axis</span><span class="nf">.</span><span class="nv">y</span><span class="w"> </span><span class="nf">==</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="kr">then</span>
<span class="w">                            </span><span class="nv">puyoColorToString</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">axisColor</span>

<span class="w">                        </span><span class="kr">else</span>
<span class="w">                            </span><span class="nv">puyoColorToString</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">childColor</span>

<span class="w">                    </span><span class="kt">Nothing</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                        </span><span class="s">&quot;#888&quot;</span>

<span class="w">            </span><span class="kr">else</span>
<span class="w">                </span><span class="kr">case</span><span class="w"> </span><span class="nv">cellContent</span><span class="w"> </span><span class="kr">of</span>
<span class="w">                    </span><span class="kt">Empty</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                        </span><span class="s">&quot;#888&quot;</span>

<span class="w">                    </span><span class="kt">Filled</span><span class="w"> </span><span class="nv">puyoColor</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                        </span><span class="nv">puyoColorToString</span><span class="w"> </span><span class="nv">puyoColor</span>
<span class="w">    </span><span class="kr">in</span>
<span class="w">    </span><span class="nv">div</span>
<span class="w">        </span><span class="p">[</span><span class="w"> </span><span class="nv">style</span><span class="w"> </span><span class="s">&quot;width&quot;</span><span class="w"> </span><span class="s">&quot;32px&quot;</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">style</span><span class="w"> </span><span class="s">&quot;height&quot;</span><span class="w"> </span><span class="s">&quot;32px&quot;</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">style</span><span class="w"> </span><span class="s">&quot;margin&quot;</span><span class="w"> </span><span class="s">&quot;2px&quot;</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">style</span><span class="w"> </span><span class="s">&quot;border-radius&quot;</span><span class="w"> </span><span class="s">&quot;50%&quot;</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">style</span><span class="w"> </span><span class="s">&quot;background-color&quot;</span><span class="w"> </span><span class="nv">color</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">style</span><span class="w"> </span><span class="s">&quot;border&quot;</span><span class="w"> </span><span class="s">&quot;2px solid #000&quot;</span>
<span class="w">        </span><span class="p">]</span>
<span class="w">        </span><span class="p">[]</span>


<span class="nv">puyoColorToString</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">PuyoColor</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">String</span>
<span class="nv">puyoColorToString</span><span class="w"> </span><span class="nv">color</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="kr">case</span><span class="w"> </span><span class="nv">color</span><span class="w"> </span><span class="kr">of</span>
<span class="w">        </span><span class="kt">Red</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="s">&quot;#ff0000&quot;</span>

<span class="w">        </span><span class="kt">Green</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="s">&quot;#00ff00&quot;</span>

<span class="w">        </span><span class="kt">Blue</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="s">&quot;#0000ff&quot;</span>

<span class="w">        </span><span class="kt">Yellow</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="s">&quot;#ffff00&quot;</span>


<span class="c1">-- MAIN</span>


<span class="kr">main </span><span class="nf">:</span><span class="w"> </span><span class="kt">Program</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="kt">Model</span><span class="w"> </span><span class="kt">Msg</span>
<span class="kr">main </span><span class="nf">=</span>
<span class="w">    </span><span class="kt">Browser</span><span class="nf">.</span><span class="nv">element</span>
<span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="nv">init</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">init</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">update</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">update</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">view</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">view</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">subscriptions</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">subscriptions</span>
<span class="w">        </span><span class="p">}</span>
</code></pre></div>
<p>ã€Œ<code>Browser.element</code> ã«å¤‰ã‚ã£ãŸã‚“ã§ã™ã­ï¼ã€ãã†ã§ã™ã€‚<code>Browser.sandbox</code> ã¯ã€ã‚³ãƒãƒ³ãƒ‰ã‚„ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãŒä½¿ãˆãªã„ã‚·ãƒ³ãƒ—ãƒ«ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ç”¨ã§ã™ã€‚ä»Šå›ã¯ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚¤ãƒ™ãƒ³ãƒˆã‚’è³¼èª­ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã®ã§ã€<code>Browser.element</code> ã‚’ä½¿ã„ã¾ã™ã€‚</p>
<p>ã€Œã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ã£ã¦ä½•ã§ã™ã‹ï¼Ÿã€è‰¯ã„è³ªå•ã§ã™ï¼ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ã¯ã€å¤–éƒ¨ã‹ã‚‰ã®ã‚¤ãƒ™ãƒ³ãƒˆï¼ˆã‚­ãƒ¼ãƒœãƒ¼ãƒ‰å…¥åŠ›ã€ã‚¿ã‚¤ãƒãƒ¼ã€WebSocket ãªã©ï¼‰ã‚’ Elm ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«é€šçŸ¥ã™ã‚‹ä»•çµ„ã¿ã§ã™ã€‚Elm ã§ã¯ã€ã™ã¹ã¦ã®å‰¯ä½œç”¨ãŒ The Elm Architecture ã®æ çµ„ã¿ã®ä¸­ã§ç®¡ç†ã•ã‚Œã‚‹ã®ã§ã€ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®ç™»éŒ²ã‚‚ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ã¨ã—ã¦å®£è¨€çš„ã«è¨˜è¿°ã—ã¾ã™ã€‚</p>
<h3 id="_34">ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®å®Ÿè¡Œ<a class="headerlink" href="#_34" title="Permanent link">&para;</a></h3>
<p>ã§ã¯ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼š</p>
<div class="highlight"><pre><span></span><code>elm<span class="w"> </span>reactor
</code></pre></div>
<p>ãƒ–ãƒ©ã‚¦ã‚¶ã§ <code>http://localhost:8000</code> ã‚’é–‹ãã€<code>src/Main.elm</code> ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚ã€Œã‚²ãƒ¼ãƒ é–‹å§‹ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã€ã·ã‚ˆãƒšã‚¢ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã®å·¦å³çŸ¢å°ã‚­ãƒ¼ã‚’æŠ¼ã™ã¨ã€ã·ã‚ˆãŒå·¦å³ã«ç§»å‹•ã—ã¾ã™ï¼</p>
<p>ã€Œæœ¬å½“ã ï¼ã·ã‚ˆãŒå‹•ãã¾ã—ãŸï¼ã€ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰å…¥åŠ›ã§ã·ã‚ˆã‚’æ“ä½œã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã­ã€‚</p>
<h3 id="2_1">ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³2ã®ã¾ã¨ã‚<a class="headerlink" href="#2_1" title="Permanent link">&para;</a></h3>
<p>ã“ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§å®Ÿè£…ã—ãŸå†…å®¹ï¼š</p>
<ol>
<li><strong>ã·ã‚ˆãƒšã‚¢ã®ç§»å‹•æ©Ÿèƒ½</strong></li>
<li><code>moveLeft</code>: å·¦ã«ç§»å‹•</li>
<li><code>moveRight</code>: å³ã«ç§»å‹•</li>
<li>
<p><code>canMove</code>: ç§»å‹•å¯èƒ½ã‹ãƒã‚§ãƒƒã‚¯ï¼ˆãƒœãƒ¼ãƒ‰ç¯„å›²ã¨è¡çªåˆ¤å®šï¼‰</p>
</li>
<li>
<p><strong>ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰å…¥åŠ›ã®çµ±åˆ</strong></p>
</li>
<li><code>Browser.Events.onKeyDown</code>: ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚¤ãƒ™ãƒ³ãƒˆã®è³¼èª­</li>
<li><code>keyDecoder</code>: JSON ãƒ‡ã‚³ãƒ¼ãƒ€ã§ã‚­ãƒ¼åã‚’å–å¾—</li>
<li>
<p><code>subscriptions</code>: ã‚²ãƒ¼ãƒ ãƒ¢ãƒ¼ãƒ‰ã«å¿œã˜ãŸã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³</p>
</li>
<li>
<p><strong>The Elm Architecture ã®æ‹¡å¼µ</strong></p>
</li>
<li><code>Browser.element</code>: ã‚³ãƒãƒ³ãƒ‰ã¨ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ã‚’ã‚µãƒãƒ¼ãƒˆ</li>
<li><code>init</code>: ã‚¿ãƒ—ãƒ«ï¼ˆModel, Cmdï¼‰ã‚’è¿”ã™ã‚ˆã†ã«å¤‰æ›´</li>
<li><code>update</code>: ã‚¿ãƒ—ãƒ«ï¼ˆModel, Cmdï¼‰ã‚’è¿”ã™ã‚ˆã†ã«å¤‰æ›´</li>
<li>
<p><code>KeyPressed</code>: ã‚­ãƒ¼å…¥åŠ›ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®è¿½åŠ </p>
</li>
<li>
<p><strong>ãƒ“ãƒ¥ãƒ¼ã®æ”¹å–„</strong></p>
</li>
<li>ãƒœãƒ¼ãƒ‰ã¨ã·ã‚ˆãƒšã‚¢ã®è¦–è¦šçš„ãªè¡¨ç¤º</li>
<li>CSS ã‚¹ã‚¿ã‚¤ãƒ«ã§å††å½¢ã®ã·ã‚ˆã‚’è¡¨ç¾</li>
<li>ã‚²ãƒ¼ãƒ é–‹å§‹ãƒœã‚¿ãƒ³ã®è¿½åŠ </li>
</ol>
<h3 id="_35">å­¦ã‚“ã ã“ã¨<a class="headerlink" href="#_35" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³</strong>: å¤–éƒ¨ã‚¤ãƒ™ãƒ³ãƒˆã‚’å®£è¨€çš„ã«è³¼èª­ã™ã‚‹ä»•çµ„ã¿</li>
<li><strong>JSON ãƒ‡ã‚³ãƒ¼ãƒ€</strong>: å¤–éƒ¨ãƒ‡ãƒ¼ã‚¿ï¼ˆã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚¤ãƒ™ãƒ³ãƒˆï¼‰ã‚’ Elm ã®å‹ã«å¤‰æ›</li>
<li><strong>ä¸å¤‰æ€§</strong>: ãƒ¬ã‚³ãƒ¼ãƒ‰æ›´æ–°æ§‹æ–‡ã§ä¸€éƒ¨ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’æ›´æ–°</li>
<li><strong>ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°</strong>: Maybe å‹ã¨ã‚¿ãƒ—ãƒ«ã®çµ„ã¿åˆã‚ã›ã§ãƒ­ã‚¸ãƒƒã‚¯ã‚’è¡¨ç¾</li>
<li><strong>Browser.element</strong>: ã‚³ãƒãƒ³ãƒ‰ã¨ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãŒå¿…è¦ãªå ´åˆã«ä½¿ç”¨</li>
</ul>
<p>æ¬¡ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ã€ã·ã‚ˆã‚’å›è»¢ã•ã›ã‚‹æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¾ã™ï¼</p>
<h2 id="3_1">ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³3: ã·ã‚ˆã®å›è»¢ã®å®Ÿè£…<a class="headerlink" href="#3_1" title="Permanent link">&para;</a></h2>
<p>ã€Œå·¦å³ã«ç§»å‹•ã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸã‘ã©ã€ã·ã‚ˆã·ã‚ˆã£ã¦å›è»¢ã‚‚ã§ãã¾ã™ã‚ˆã­ï¼Ÿã€ãã†ã§ã™ã­ï¼ã·ã‚ˆã·ã‚ˆã®é†é†å‘³ã®ä¸€ã¤ã¯ã€ã·ã‚ˆã‚’å›è»¢ã•ã›ã¦æ€ã„é€šã‚Šã®å ´æ‰€ã«é…ç½®ã™ã‚‹ã“ã¨ã§ã™ã€‚ä»Šå›ã¯ã€ã·ã‚ˆã‚’å›è»¢ã•ã›ã‚‹æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¦ã„ãã¾ã—ã‚‡ã†ï¼</p>
<h3 id="_36">ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼<a class="headerlink" href="#_36" title="Permanent link">&para;</a></h3>
<p>ã¾ãšã¯ã€ã“ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§å®Ÿè£…ã™ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚’ç¢ºèªã—ã¾ã—ã‚‡ã†ï¼š</p>
<blockquote>
<p>ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¨ã—ã¦ã€è½ã¡ã¦ãã‚‹ã·ã‚ˆã‚’å›è»¢ã§ãã‚‹</p>
</blockquote>
<p>ã€Œå›è»¢ã£ã¦å…·ä½“çš„ã«ã©ã†ã„ã†å‹•ãã§ã™ã‹ï¼Ÿã€è‰¯ã„è³ªå•ã§ã™ã­ï¼ã·ã‚ˆã·ã‚ˆã§ã¯ã€2ã¤ã®ã·ã‚ˆãŒé€£ãªã£ãŸçŠ¶æ…‹ã§è½ã¡ã¦ãã¾ã™ã€‚å›è»¢ã¨ã¯ã€ã“ã®2ã¤ã®ã·ã‚ˆã®ç›¸å¯¾çš„ãªä½ç½®é–¢ä¿‚ã‚’å¤‰ãˆã‚‹ã“ã¨ã§ã™ã€‚ä¾‹ãˆã°ã€ç¸¦ã«ä¸¦ã‚“ã§ã„ã‚‹ã·ã‚ˆã‚’æ¨ªã«ä¸¦ã¶ã‚ˆã†ã«å¤‰ãˆãŸã‚Šã§ãã‚‹ã‚“ã§ã™ã‚ˆã€‚</p>
<h3 id="todo_2">TODOãƒªã‚¹ãƒˆ<a class="headerlink" href="#todo_2" title="Permanent link">&para;</a></h3>
<p>ã€Œã©ã‚“ãªä½œæ¥­ãŒå¿…è¦ã«ãªã‚Šã¾ã™ã‹ï¼Ÿã€ã“ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚’å®Ÿç¾ã™ã‚‹ãŸã‚ã«ã€TODOãƒªã‚¹ãƒˆã‚’ä½œæˆã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</p>
<p>ã€Œã·ã‚ˆã‚’å›è»¢ã•ã›ã‚‹ã€ã¨ã„ã†æ©Ÿèƒ½ã‚’å®Ÿç¾ã™ã‚‹ãŸã‚ã«ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ãªã‚¿ã‚¹ã‚¯ãŒå¿…è¦ãã†ã§ã™ã­ï¼š</p>
<ul>
<li>ã·ã‚ˆã®å›è»¢çŠ¶æ…‹ã‚’ç®¡ç†ã™ã‚‹ï¼ˆ0: ä¸Šã€1: å³ã€2: ä¸‹ã€3: å·¦ï¼‰</li>
<li>ã·ã‚ˆãƒšã‚¢ã®å›è»¢å‡¦ç†ã‚’å®Ÿè£…ã™ã‚‹ï¼ˆæ™‚è¨ˆå›ã‚Šãƒ»åæ™‚è¨ˆå›ã‚Šï¼‰</li>
<li>å›è»¢å¯èƒ½ã‹ã©ã†ã‹ã®ãƒã‚§ãƒƒã‚¯ã‚’å®Ÿè£…ã™ã‚‹ï¼ˆå£ã‚„æ—¢å­˜ã®ã·ã‚ˆã¨ã®è¡çªåˆ¤å®šï¼‰</li>
<li>å£ã‚­ãƒƒã‚¯å‡¦ç†ã‚’å®Ÿè£…ã™ã‚‹ï¼ˆå£éš›ã§ã®å›è»¢ã‚’å¯èƒ½ã«ã™ã‚‹ç‰¹æ®Šå‡¦ç†ï¼‰</li>
<li>The Elm Architecture ã¸ã®çµ±åˆï¼ˆå›è»¢ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®è¿½åŠ ï¼‰</li>
</ul>
<p>ã€Œå£ã‚­ãƒƒã‚¯ã£ã¦ä½•ã§ã™ã‹ï¼Ÿã€å£ã‚­ãƒƒã‚¯ã¨ã¯ã€ã·ã‚ˆãŒå£éš›ã«ã‚ã‚‹ã¨ãã«å›è»¢ã™ã‚‹ã¨å£ã«ã‚ã‚Šè¾¼ã‚“ã§ã—ã¾ã†ã®ã§ã€è‡ªå‹•çš„ã«å°‘ã—ä½ç½®ã‚’ãšã‚‰ã—ã¦å›è»¢ã‚’å¯èƒ½ã«ã™ã‚‹å‡¦ç†ã®ã“ã¨ã§ã™ã€‚ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®æ“ä½œæ€§ã‚’å‘ä¸Šã•ã›ã‚‹ãŸã‚ã®å·¥å¤«ãªã‚“ã§ã™ã‚ˆã€‚</p>
<h3 id="_37">ãƒ†ã‚¹ãƒˆ: ã·ã‚ˆãƒšã‚¢ã®å›è»¢<a class="headerlink" href="#_37" title="Permanent link">&para;</a></h3>
<p>ã€Œã¾ãšã¯ä½•ã‹ã‚‰ãƒ†ã‚¹ãƒˆã—ã¾ã™ã‹ï¼Ÿã€ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã®æµã‚Œã«æ²¿ã£ã¦ã€ã¾ãšã¯åŸºæœ¬çš„ãªå›è»¢æ©Ÿèƒ½ã®ãƒ†ã‚¹ãƒˆã‹ã‚‰æ›¸ã„ã¦ã„ãã¾ã—ã‚‡ã†ã€‚</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- tests/PuyoPairTests.elmï¼ˆç¶šãï¼‰</span>
<span class="nv">suite</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Test</span>
<span class="nv">suite</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="nv">describe</span><span class="w"> </span><span class="s">&quot;PuyoPair&quot;</span>
<span class="w">        </span><span class="p">[</span><span class="w"> </span><span class="c1">-- æ—¢å­˜ã®ãƒ†ã‚¹ãƒˆ...</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">describe</span><span class="w"> </span><span class="s">&quot;rotate&quot;</span>
<span class="w">            </span><span class="p">[</span><span class="w"> </span><span class="nv">test</span><span class="w"> </span><span class="s">&quot;æ™‚è¨ˆå›ã‚Šã«å›è»¢ã™ã‚‹ã¨ã€å­ã·ã‚ˆãŒè»¸ã·ã‚ˆã®å³ã«ç§»å‹•ã™ã‚‹&quot;</span><span class="w"> </span><span class="nf">&lt;|</span>
<span class="w">                </span><span class="nf">\</span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="kr">let</span>
<span class="w">                        </span><span class="c1">-- å­ã·ã‚ˆãŒä¸Šã«ã‚ã‚‹çŠ¶æ…‹ï¼ˆrotation = 0ï¼‰</span>
<span class="w">                        </span><span class="nv">pair</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="kt">Red</span><span class="w"> </span><span class="kt">Blue</span>

<span class="w">                        </span><span class="nv">rotatedPair</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">rotate</span><span class="w"> </span><span class="nv">pair</span>
<span class="w">                    </span><span class="kr">in</span>
<span class="w">                    </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">all</span>
<span class="w">                        </span><span class="p">[</span><span class="w"> </span><span class="nf">\</span><span class="nv">p</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">equal</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="nv">p</span><span class="nf">.</span><span class="nv">axis</span><span class="nf">.</span><span class="nv">x</span>
<span class="w">                        </span><span class="p">,</span><span class="w"> </span><span class="nf">\</span><span class="nv">p</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">equal</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="nv">p</span><span class="nf">.</span><span class="nv">axis</span><span class="nf">.</span><span class="nv">y</span>
<span class="w">                        </span><span class="p">,</span><span class="w"> </span><span class="nf">\</span><span class="nv">p</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">equal</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="nv">p</span><span class="nf">.</span><span class="nv">child</span><span class="nf">.</span><span class="nv">x</span>
<span class="w">                        </span><span class="p">,</span><span class="w"> </span><span class="nf">\</span><span class="nv">p</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">equal</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="nv">p</span><span class="nf">.</span><span class="nv">child</span><span class="nf">.</span><span class="nv">y</span>
<span class="w">                        </span><span class="p">]</span>
<span class="w">                        </span><span class="nv">rotatedPair</span>
<span class="w">            </span><span class="p">,</span><span class="w"> </span><span class="nv">test</span><span class="w"> </span><span class="s">&quot;4å›å›è»¢ã™ã‚‹ã¨å…ƒã®ä½ç½®ã«æˆ»ã‚‹&quot;</span><span class="w"> </span><span class="nf">&lt;|</span>
<span class="w">                </span><span class="nf">\</span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="kr">let</span>
<span class="w">                        </span><span class="nv">pair</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="kt">Red</span><span class="w"> </span><span class="kt">Blue</span>

<span class="w">                        </span><span class="nv">rotatedPair</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="nv">pair</span>
<span class="w">                                </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">rotate</span>
<span class="w">                                </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">rotate</span>
<span class="w">                                </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">rotate</span>
<span class="w">                                </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">rotate</span>
<span class="w">                    </span><span class="kr">in</span>
<span class="w">                    </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">all</span>
<span class="w">                        </span><span class="p">[</span><span class="w"> </span><span class="nf">\</span><span class="nv">p</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">equal</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">axis</span><span class="w"> </span><span class="nv">p</span><span class="nf">.</span><span class="nv">axis</span>
<span class="w">                        </span><span class="p">,</span><span class="w"> </span><span class="nf">\</span><span class="nv">p</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">equal</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">child</span><span class="w"> </span><span class="nv">p</span><span class="nf">.</span><span class="nv">child</span>
<span class="w">                        </span><span class="p">]</span>
<span class="w">                        </span><span class="nv">rotatedPair</span>
<span class="w">            </span><span class="p">]</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">describe</span><span class="w"> </span><span class="s">&quot;rotateWithKick&quot;</span>
<span class="w">            </span><span class="p">[</span><span class="w"> </span><span class="nv">test</span><span class="w"> </span><span class="s">&quot;å£éš›ã§å›è»¢æ™‚ã€å£ã‚­ãƒƒã‚¯ãŒç™ºç”Ÿã™ã‚‹&quot;</span><span class="w"> </span><span class="nf">&lt;|</span>
<span class="w">                </span><span class="nf">\</span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="kr">let</span>
<span class="w">                        </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="mi">12</span>

<span class="w">                        </span><span class="c1">-- å³ç«¯ã«é…ç½®ï¼ˆx = 5ï¼‰</span>
<span class="w">                        </span><span class="nv">pair</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="kt">Red</span><span class="w"> </span><span class="kt">Blue</span>

<span class="w">                        </span><span class="c1">-- å›è»¢ã™ã‚‹ã¨å­ã·ã‚ˆãŒå£å¤–ï¼ˆx = 6ï¼‰ã«ãªã‚‹ã®ã§å£ã‚­ãƒƒã‚¯</span>
<span class="w">                        </span><span class="p">(</span><span class="w"> </span><span class="nv">movedPair</span><span class="p">,</span><span class="w"> </span><span class="nv">kicked</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">rotateWithKick</span><span class="w"> </span><span class="nv">pair</span><span class="w"> </span><span class="nv">board</span>
<span class="w">                    </span><span class="kr">in</span>
<span class="w">                    </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">all</span>
<span class="w">                        </span><span class="p">[</span><span class="w"> </span><span class="nf">\</span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">equal</span><span class="w"> </span><span class="kt">True</span><span class="w"> </span><span class="nv">kicked</span>
<span class="w">                        </span><span class="p">,</span><span class="w"> </span><span class="nf">\</span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">equal</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="nv">movedPair</span><span class="nf">.</span><span class="nv">axis</span><span class="nf">.</span><span class="nv">x</span>
<span class="w">                        </span><span class="p">]</span>
<span class="w">                        </span><span class="p">()</span>
<span class="w">            </span><span class="p">,</span><span class="w"> </span><span class="nv">test</span><span class="w"> </span><span class="s">&quot;å£ã‚­ãƒƒã‚¯ãŒä¸è¦ãªå ´åˆã€ä½ç½®ã¯å¤‰ã‚ã‚‰ãªã„&quot;</span><span class="w"> </span><span class="nf">&lt;|</span>
<span class="w">                </span><span class="nf">\</span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="kr">let</span>
<span class="w">                        </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="mi">12</span>

<span class="w">                        </span><span class="c1">-- ä¸­å¤®ã«é…ç½®</span>
<span class="w">                        </span><span class="nv">pair</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="kt">Red</span><span class="w"> </span><span class="kt">Blue</span>

<span class="w">                        </span><span class="p">(</span><span class="w"> </span><span class="nv">rotatedPair</span><span class="p">,</span><span class="w"> </span><span class="nv">kicked</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">rotateWithKick</span><span class="w"> </span><span class="nv">pair</span><span class="w"> </span><span class="nv">board</span>
<span class="w">                    </span><span class="kr">in</span>
<span class="w">                    </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">all</span>
<span class="w">                        </span><span class="p">[</span><span class="w"> </span><span class="nf">\</span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">equal</span><span class="w"> </span><span class="kt">False</span><span class="w"> </span><span class="nv">kicked</span>
<span class="w">                        </span><span class="p">,</span><span class="w"> </span><span class="nf">\</span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">equal</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="nv">rotatedPair</span><span class="nf">.</span><span class="nv">axis</span><span class="nf">.</span><span class="nv">x</span>
<span class="w">                        </span><span class="p">]</span>
<span class="w">                        </span><span class="p">()</span>
<span class="w">            </span><span class="p">]</span>
<span class="w">        </span><span class="p">]</span>
</code></pre></div>
<p>ã€Œã“ã®ãƒ†ã‚¹ãƒˆã¯ä½•ã‚’ç¢ºèªã—ã¦ã„ã‚‹ã‚“ã§ã™ã‹ï¼Ÿã€ã“ã®ãƒ†ã‚¹ãƒˆã§ã¯ã€ä»¥ä¸‹ã®ã‚±ãƒ¼ã‚¹ã‚’ç¢ºèªã—ã¦ã„ã¾ã™ï¼š</p>
<ol>
<li>æ™‚è¨ˆå›ã‚Šã«å›è»¢ã™ã‚‹ã¨ã€å­ã·ã‚ˆã®ä½ç½®ãŒæ­£ã—ãå¤‰ã‚ã‚‹ã‹</li>
<li>4å›å›è»¢ã™ã‚‹ã¨å…ƒã®ä½ç½®ã«æˆ»ã‚‹ã‹ï¼ˆå¾ªç’°ã™ã‚‹ã‹ï¼‰</li>
<li>å£éš›ã§å›è»¢æ™‚ã€å£ã‚­ãƒƒã‚¯ãŒæ­£ã—ãç™ºç”Ÿã™ã‚‹ã‹</li>
<li>å£ã‚­ãƒƒã‚¯ãŒä¸è¦ãªå ´åˆã€ä½ç½®ãŒå¤‰ã‚ã‚‰ãªã„ã‹</li>
</ol>
<h3 id="_38">å®Ÿè£…: ã·ã‚ˆãƒšã‚¢ã®å›è»¢<a class="headerlink" href="#_38" title="Permanent link">&para;</a></h3>
<p>ã§ã¯ã€ãƒ†ã‚¹ãƒˆãŒé€šã‚‹ã‚ˆã†ã« PuyoPair ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’æ‹¡å¼µã—ã¾ã—ã‚‡ã†ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- src/PuyoPair.elmï¼ˆæ‹¡å¼µç‰ˆï¼‰</span>
<span class="kn">module</span><span class="w"> </span><span class="nc">PuyoPair</span><span class="w"> </span><span class="nv">exposing</span>
<span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="kt">PuyoPair</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="kt">Position</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">canMove</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">create</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">getPositions</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">moveLeft</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">moveRight</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">rotate</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">rotateWithKick</span>
<span class="w">    </span><span class="p">)</span>

<span class="kn">import</span><span class="w"> </span><span class="nc">Board</span><span class="w"> </span><span class="nv">exposing</span><span class="w"> </span><span class="p">(</span><span class="kt">Board</span><span class="p">)</span>
<span class="kn">import</span><span class="w"> </span><span class="nc">Cell</span><span class="w"> </span><span class="nv">exposing</span><span class="w"> </span><span class="p">(</span><span class="kt">Cell</span><span class="nf">(..)</span><span class="p">)</span>
<span class="kn">import</span><span class="w"> </span><span class="nc">PuyoColor</span><span class="w"> </span><span class="nv">exposing</span><span class="w"> </span><span class="p">(</span><span class="kt">PuyoColor</span><span class="p">)</span>


<span class="kr">type</span><span class="w"> </span><span class="kr">alias</span><span class="w"> </span><span class="kt">Position</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Int</span><span class="p">,</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="p">}</span>


<span class="kr">type</span><span class="w"> </span><span class="kr">alias</span><span class="w"> </span><span class="kt">PuyoPair</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nv">axis</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Position</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">child</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Position</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">axisColor</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">PuyoColor</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">childColor</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">PuyoColor</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">rotation</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Int</span>
<span class="w">    </span><span class="p">}</span>


<span class="c1">-- ã·ã‚ˆãƒšã‚¢ã‚’ä½œæˆã™ã‚‹</span>
<span class="nv">create</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">PuyoColor</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">PuyoColor</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">PuyoPair</span>
<span class="nv">create</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nv">axisColor</span><span class="w"> </span><span class="nv">childColor</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nv">axis</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">x</span><span class="p">,</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">child</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">x</span><span class="p">,</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nf">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">axisColor</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">axisColor</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">childColor</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">childColor</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">rotation</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">    </span><span class="p">}</span>


<span class="c1">-- ã·ã‚ˆãƒšã‚¢ã®ä½ç½®ã‚’å–å¾—ã™ã‚‹</span>
<span class="nv">getPositions</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">PuyoPair</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="kt">Position</span><span class="p">,</span><span class="w"> </span><span class="kt">Position</span><span class="w"> </span><span class="p">)</span>
<span class="nv">getPositions</span><span class="w"> </span><span class="nv">pair</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">axis</span><span class="p">,</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">child</span><span class="w"> </span><span class="p">)</span>


<span class="c1">-- å·¦ã«ç§»å‹•ã™ã‚‹</span>
<span class="nv">moveLeft</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">PuyoPair</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">PuyoPair</span>
<span class="nv">moveLeft</span><span class="w"> </span><span class="nv">pair</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nv">pair</span>
<span class="w">        </span><span class="nf">|</span><span class="w"> </span><span class="nv">axis</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">axis</span><span class="nf">.</span><span class="nv">x</span><span class="w"> </span><span class="nf">-</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">axis</span><span class="nf">.</span><span class="nv">y</span><span class="w"> </span><span class="p">}</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">child</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">child</span><span class="nf">.</span><span class="nv">x</span><span class="w"> </span><span class="nf">-</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">child</span><span class="nf">.</span><span class="nv">y</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>


<span class="c1">-- å³ã«ç§»å‹•ã™ã‚‹</span>
<span class="nv">moveRight</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">PuyoPair</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">PuyoPair</span>
<span class="nv">moveRight</span><span class="w"> </span><span class="nv">pair</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nv">pair</span>
<span class="w">        </span><span class="nf">|</span><span class="w"> </span><span class="nv">axis</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">axis</span><span class="nf">.</span><span class="nv">x</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">axis</span><span class="nf">.</span><span class="nv">y</span><span class="w"> </span><span class="p">}</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">child</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">child</span><span class="nf">.</span><span class="nv">x</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">child</span><span class="nf">.</span><span class="nv">y</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>


<span class="c1">-- æ™‚è¨ˆå›ã‚Šã«å›è»¢ã™ã‚‹ï¼ˆ90åº¦ï¼‰</span>
<span class="nv">rotate</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">PuyoPair</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">PuyoPair</span>
<span class="nv">rotate</span><span class="w"> </span><span class="nv">pair</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="kr">let</span>
<span class="w">        </span><span class="nv">newRotation</span><span class="w"> </span><span class="nf">=</span>
<span class="w">            </span><span class="nv">modBy</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="p">(</span><span class="nv">pair</span><span class="nf">.</span><span class="nv">rotation</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>

<span class="w">        </span><span class="nv">childPos</span><span class="w"> </span><span class="nf">=</span>
<span class="w">            </span><span class="nv">getChildPosition</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">axis</span><span class="w"> </span><span class="nv">newRotation</span>
<span class="w">    </span><span class="kr">in</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nv">pair</span>
<span class="w">        </span><span class="nf">|</span><span class="w"> </span><span class="nv">rotation</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">newRotation</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">child</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">childPos</span>
<span class="w">    </span><span class="p">}</span>


<span class="c1">-- å›è»¢çŠ¶æ…‹ã«å¿œã˜ãŸå­ã·ã‚ˆã®ä½ç½®ã‚’è¨ˆç®—</span>
<span class="nv">getChildPosition</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Position</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Position</span>
<span class="nv">getChildPosition</span><span class="w"> </span><span class="nv">axis</span><span class="w"> </span><span class="nv">rotation</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="kr">case</span><span class="w"> </span><span class="nv">rotation</span><span class="w"> </span><span class="kr">of</span>
<span class="w">        </span><span class="mi">0</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="c1">-- ä¸Š</span>
<span class="w">            </span><span class="p">{</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">axis</span><span class="nf">.</span><span class="nv">x</span><span class="p">,</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">axis</span><span class="nf">.</span><span class="nv">y</span><span class="w"> </span><span class="nf">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">}</span>

<span class="w">        </span><span class="mi">1</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="c1">-- å³</span>
<span class="w">            </span><span class="p">{</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">axis</span><span class="nf">.</span><span class="nv">x</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">axis</span><span class="nf">.</span><span class="nv">y</span><span class="w"> </span><span class="p">}</span>

<span class="w">        </span><span class="mi">2</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="c1">-- ä¸‹</span>
<span class="w">            </span><span class="p">{</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">axis</span><span class="nf">.</span><span class="nv">x</span><span class="p">,</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">axis</span><span class="nf">.</span><span class="nv">y</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">}</span>

<span class="w">        </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="c1">-- å·¦ï¼ˆ3ï¼‰</span>
<span class="w">            </span><span class="p">{</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">axis</span><span class="nf">.</span><span class="nv">x</span><span class="w"> </span><span class="nf">-</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">axis</span><span class="nf">.</span><span class="nv">y</span><span class="w"> </span><span class="p">}</span>


<span class="c1">-- å£ã‚­ãƒƒã‚¯ä»˜ãå›è»¢</span>
<span class="nv">rotateWithKick</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">PuyoPair</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="kt">PuyoPair</span><span class="p">,</span><span class="w"> </span><span class="kt">Bool</span><span class="w"> </span><span class="p">)</span>
<span class="nv">rotateWithKick</span><span class="w"> </span><span class="nv">pair</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="kr">let</span>
<span class="w">        </span><span class="nv">rotatedPair</span><span class="w"> </span><span class="nf">=</span>
<span class="w">            </span><span class="nv">rotate</span><span class="w"> </span><span class="nv">pair</span>
<span class="w">    </span><span class="kr">in</span>
<span class="w">    </span><span class="kr">if</span><span class="w"> </span><span class="nv">canMove</span><span class="w"> </span><span class="nv">rotatedPair</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="kr">then</span>
<span class="w">        </span><span class="c1">-- å›è»¢å¯èƒ½ã€å£ã‚­ãƒƒã‚¯ä¸è¦</span>
<span class="w">        </span><span class="p">(</span><span class="w"> </span><span class="nv">rotatedPair</span><span class="p">,</span><span class="w"> </span><span class="kt">False</span><span class="w"> </span><span class="p">)</span>

<span class="w">    </span><span class="kr">else</span>
<span class="w">        </span><span class="c1">-- å£ã‚­ãƒƒã‚¯ã‚’è©¦ã¿ã‚‹</span>
<span class="w">        </span><span class="nv">tryWallKick</span><span class="w"> </span><span class="nv">rotatedPair</span><span class="w"> </span><span class="nv">board</span>


<span class="c1">-- å£ã‚­ãƒƒã‚¯ã‚’è©¦ã¿ã‚‹</span>
<span class="nv">tryWallKick</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">PuyoPair</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="kt">PuyoPair</span><span class="p">,</span><span class="w"> </span><span class="kt">Bool</span><span class="w"> </span><span class="p">)</span>
<span class="nv">tryWallKick</span><span class="w"> </span><span class="nv">pair</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="kr">let</span>
<span class="w">        </span><span class="c1">-- å·¦ã«1ãƒã‚¹ç§»å‹•</span>
<span class="w">        </span><span class="nv">leftKick</span><span class="w"> </span><span class="nf">=</span>
<span class="w">            </span><span class="p">{</span><span class="w"> </span><span class="nv">pair</span><span class="w"> </span><span class="nf">|</span><span class="w"> </span><span class="nv">axis</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">axis</span><span class="nf">.</span><span class="nv">x</span><span class="w"> </span><span class="nf">-</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">axis</span><span class="nf">.</span><span class="nv">y</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span>
<span class="w">                </span><span class="nf">|&gt;</span><span class="w"> </span><span class="p">(</span><span class="nf">\</span><span class="nv">p</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">p</span><span class="w"> </span><span class="nf">|</span><span class="w"> </span><span class="nv">child</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">getChildPosition</span><span class="w"> </span><span class="nv">p</span><span class="nf">.</span><span class="nv">axis</span><span class="w"> </span><span class="nv">p</span><span class="nf">.</span><span class="nv">rotation</span><span class="w"> </span><span class="p">})</span>

<span class="w">        </span><span class="c1">-- å³ã«1ãƒã‚¹ç§»å‹•</span>
<span class="w">        </span><span class="nv">rightKick</span><span class="w"> </span><span class="nf">=</span>
<span class="w">            </span><span class="p">{</span><span class="w"> </span><span class="nv">pair</span><span class="w"> </span><span class="nf">|</span><span class="w"> </span><span class="nv">axis</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">axis</span><span class="nf">.</span><span class="nv">x</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">axis</span><span class="nf">.</span><span class="nv">y</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span>
<span class="w">                </span><span class="nf">|&gt;</span><span class="w"> </span><span class="p">(</span><span class="nf">\</span><span class="nv">p</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">p</span><span class="w"> </span><span class="nf">|</span><span class="w"> </span><span class="nv">child</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">getChildPosition</span><span class="w"> </span><span class="nv">p</span><span class="nf">.</span><span class="nv">axis</span><span class="w"> </span><span class="nv">p</span><span class="nf">.</span><span class="nv">rotation</span><span class="w"> </span><span class="p">})</span>
<span class="w">    </span><span class="kr">in</span>
<span class="w">    </span><span class="kr">if</span><span class="w"> </span><span class="nv">canMove</span><span class="w"> </span><span class="nv">leftKick</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="kr">then</span>
<span class="w">        </span><span class="p">(</span><span class="w"> </span><span class="nv">leftKick</span><span class="p">,</span><span class="w"> </span><span class="kt">True</span><span class="w"> </span><span class="p">)</span>

<span class="w">    </span><span class="kr">else</span><span class="w"> </span><span class="kr">if</span><span class="w"> </span><span class="nv">canMove</span><span class="w"> </span><span class="nv">rightKick</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="kr">then</span>
<span class="w">        </span><span class="p">(</span><span class="w"> </span><span class="nv">rightKick</span><span class="p">,</span><span class="w"> </span><span class="kt">True</span><span class="w"> </span><span class="p">)</span>

<span class="w">    </span><span class="kr">else</span>
<span class="w">        </span><span class="c1">-- å£ã‚­ãƒƒã‚¯ã‚‚å¤±æ•—ã€å›è»¢å‰ã®çŠ¶æ…‹ã«æˆ»ã™</span>
<span class="w">        </span><span class="p">(</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">pair</span><span class="w"> </span><span class="nf">|</span><span class="w"> </span><span class="nv">rotation</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">modBy</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="p">(</span><span class="nv">pair</span><span class="nf">.</span><span class="nv">rotation</span><span class="w"> </span><span class="nf">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>
<span class="w">            </span><span class="nf">|&gt;</span><span class="w"> </span><span class="p">(</span><span class="nf">\</span><span class="nv">p</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">p</span><span class="w"> </span><span class="nf">|</span><span class="w"> </span><span class="nv">child</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">getChildPosition</span><span class="w"> </span><span class="nv">p</span><span class="nf">.</span><span class="nv">axis</span><span class="w"> </span><span class="nv">p</span><span class="nf">.</span><span class="nv">rotation</span><span class="w"> </span><span class="p">})</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="kt">False</span>
<span class="w">        </span><span class="p">)</span>


<span class="c1">-- ç§»å‹•å¯èƒ½ã‹ãƒã‚§ãƒƒã‚¯ã™ã‚‹</span>
<span class="nv">canMove</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">PuyoPair</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Bool</span>
<span class="nv">canMove</span><span class="w"> </span><span class="nv">pair</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="kr">let</span>
<span class="w">        </span><span class="nv">axisCell</span><span class="w"> </span><span class="nf">=</span>
<span class="w">            </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">getCell</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">axis</span><span class="nf">.</span><span class="nv">x</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">axis</span><span class="nf">.</span><span class="nv">y</span><span class="w"> </span><span class="nv">board</span>

<span class="w">        </span><span class="nv">childCell</span><span class="w"> </span><span class="nf">=</span>
<span class="w">            </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">getCell</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">child</span><span class="nf">.</span><span class="nv">x</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">child</span><span class="nf">.</span><span class="nv">y</span><span class="w"> </span><span class="nv">board</span>
<span class="w">    </span><span class="kr">in</span>
<span class="w">    </span><span class="kr">case</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nv">axisCell</span><span class="p">,</span><span class="w"> </span><span class="nv">childCell</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="kr">of</span>
<span class="w">        </span><span class="p">(</span><span class="w"> </span><span class="kt">Just</span><span class="w"> </span><span class="kt">Empty</span><span class="p">,</span><span class="w"> </span><span class="kt">Just</span><span class="w"> </span><span class="kt">Empty</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="kt">True</span>

<span class="w">        </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="kt">False</span>
</code></pre></div>
<p>ã€Œä¸å¤‰æ€§ã‚’ä¿ã¡ãªãŒã‚‰å›è»¢ã—ã¦ã„ã‚‹ã‚“ã§ã™ã­ï¼ã€ãã†ã§ã™ã€‚<code>rotate</code> é–¢æ•°ã§ã¯ã€å›è»¢çŠ¶æ…‹ã‚’æ›´æ–°ã—ã€æ–°ã—ã„å­ã·ã‚ˆã®ä½ç½®ã‚’è¨ˆç®—ã—ã¦ã€æ–°ã—ã„ã·ã‚ˆãƒšã‚¢ã‚’è¿”ã—ã¾ã™ã€‚</p>
<p>ã€Œ<code>rotateWithKick</code> é–¢æ•°ã¯ä½•ã‚’ã—ã¦ã„ã‚‹ã‚“ã§ã™ã‹ï¼Ÿã€ã“ã®é–¢æ•°ã¯ã€ã¾ãšé€šå¸¸ã®å›è»¢ã‚’è©¦ã¿ã€å¤±æ•—ã—ãŸå ´åˆã¯å£ã‚­ãƒƒã‚¯ï¼ˆå·¦ã¾ãŸã¯å³ã«1ãƒã‚¹ç§»å‹•ï¼‰ã‚’è©¦ã¿ã¾ã™ã€‚ãã‚Œã§ã‚‚å¤±æ•—ã—ãŸå ´åˆã¯ã€å›è»¢ã‚’ä¸­æ­¢ã—ã¦å…ƒã®çŠ¶æ…‹ã‚’è¿”ã—ã¾ã™ã€‚æˆ»ã‚Šå€¤ã¯ã‚¿ãƒ—ãƒ«ã§ã€<code>(æ–°ã—ã„ã·ã‚ˆãƒšã‚¢, å£ã‚­ãƒƒã‚¯ãŒç™ºç”Ÿã—ãŸã‹)</code> ã¨ã„ã†æƒ…å ±ã‚’è¿”ã—ã¾ã™ã€‚</p>
<h3 id="_39">ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œ<a class="headerlink" href="#_39" title="Permanent link">&para;</a></h3>
<p>ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼š</p>
<div class="highlight"><pre><span></span><code>elm-test
</code></pre></div>
<p>ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆãŒé€šã‚Œã°æˆåŠŸã§ã™ï¼</p>
<h3 id="the-elm-architecture_3">The Elm Architecture ã¸ã®çµ±åˆ<a class="headerlink" href="#the-elm-architecture_3" title="Permanent link">&para;</a></h3>
<p>æ¬¡ã«ã€å›è»¢æ©Ÿèƒ½ã‚’ Main.elm ã«çµ±åˆã—ã¾ã™ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- src/Main.elmï¼ˆæ›´æ–°éƒ¨åˆ†ã®ã¿ï¼‰</span>

<span class="kr">type</span><span class="w"> </span><span class="kt">Msg</span>
<span class="w">    </span><span class="nf">=</span><span class="w"> </span><span class="kt">StartGame</span>
<span class="w">    </span><span class="nf">|</span><span class="w"> </span><span class="kt">KeyPressed</span><span class="w"> </span><span class="kt">String</span>
<span class="w">    </span><span class="nf">|</span><span class="w"> </span><span class="kt">Tick</span>
<span class="w">    </span><span class="nf">|</span><span class="w"> </span><span class="kt">NoOp</span>


<span class="nv">update</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Msg</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Model</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="kt">Model</span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="w"> </span><span class="kt">Msg</span><span class="w"> </span><span class="p">)</span>
<span class="nv">update</span><span class="w"> </span><span class="nv">msg</span><span class="w"> </span><span class="nv">model</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="kr">case</span><span class="w"> </span><span class="nv">msg</span><span class="w"> </span><span class="kr">of</span>
<span class="w">        </span><span class="kt">StartGame</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="p">(</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">model</span>
<span class="w">                </span><span class="nf">|</span><span class="w"> </span><span class="nv">mode</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Playing</span>
<span class="w">                </span><span class="p">,</span><span class="w"> </span><span class="nv">currentPair</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Just</span><span class="w"> </span><span class="p">(</span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="kt">Red</span><span class="w"> </span><span class="kt">Blue</span><span class="p">)</span>
<span class="w">              </span><span class="p">}</span>
<span class="w">            </span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="nf">.</span><span class="nv">none</span>
<span class="w">            </span><span class="p">)</span>

<span class="w">        </span><span class="kt">KeyPressed</span><span class="w"> </span><span class="nv">key</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="kr">case</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">mode</span><span class="p">,</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">currentPair</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="kr">of</span>
<span class="w">                </span><span class="p">(</span><span class="w"> </span><span class="kt">Playing</span><span class="p">,</span><span class="w"> </span><span class="kt">Just</span><span class="w"> </span><span class="nv">pair</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="kr">let</span>
<span class="w">                        </span><span class="nv">newPair</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kr">case</span><span class="w"> </span><span class="nv">key</span><span class="w"> </span><span class="kr">of</span>
<span class="w">                                </span><span class="s">&quot;ArrowLeft&quot;</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                                    </span><span class="kr">let</span>
<span class="w">                                        </span><span class="nv">movedPair</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                                            </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">moveLeft</span><span class="w"> </span><span class="nv">pair</span>
<span class="w">                                    </span><span class="kr">in</span>
<span class="w">                                    </span><span class="kr">if</span><span class="w"> </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">canMove</span><span class="w"> </span><span class="nv">movedPair</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">board</span><span class="w"> </span><span class="kr">then</span>
<span class="w">                                        </span><span class="nv">movedPair</span>

<span class="w">                                    </span><span class="kr">else</span>
<span class="w">                                        </span><span class="nv">pair</span>

<span class="w">                                </span><span class="s">&quot;ArrowRight&quot;</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                                    </span><span class="kr">let</span>
<span class="w">                                        </span><span class="nv">movedPair</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                                            </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">moveRight</span><span class="w"> </span><span class="nv">pair</span>
<span class="w">                                    </span><span class="kr">in</span>
<span class="w">                                    </span><span class="kr">if</span><span class="w"> </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">canMove</span><span class="w"> </span><span class="nv">movedPair</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">board</span><span class="w"> </span><span class="kr">then</span>
<span class="w">                                        </span><span class="nv">movedPair</span>

<span class="w">                                    </span><span class="kr">else</span>
<span class="w">                                        </span><span class="nv">pair</span>

<span class="w">                                </span><span class="s">&quot;ArrowUp&quot;</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                                    </span><span class="c1">-- å›è»¢ï¼ˆå£ã‚­ãƒƒã‚¯ä»˜ãï¼‰</span>
<span class="w">                                    </span><span class="kr">let</span>
<span class="w">                                        </span><span class="p">(</span><span class="w"> </span><span class="nv">rotatedPair</span><span class="p">,</span><span class="w"> </span><span class="nv">_</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                                            </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">rotateWithKick</span><span class="w"> </span><span class="nv">pair</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">board</span>
<span class="w">                                    </span><span class="kr">in</span>
<span class="w">                                    </span><span class="nv">rotatedPair</span>

<span class="w">                                </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                                    </span><span class="nv">pair</span>
<span class="w">                    </span><span class="kr">in</span>
<span class="w">                    </span><span class="p">(</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">model</span><span class="w"> </span><span class="nf">|</span><span class="w"> </span><span class="nv">currentPair</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Just</span><span class="w"> </span><span class="nv">newPair</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="kt">Cmd</span><span class="nf">.</span><span class="nv">none</span><span class="w"> </span><span class="p">)</span>

<span class="w">                </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="p">(</span><span class="w"> </span><span class="nv">model</span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="nf">.</span><span class="nv">none</span><span class="w"> </span><span class="p">)</span>

<span class="w">        </span><span class="kt">Tick</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="c1">-- å¾Œã§å®Ÿè£…</span>
<span class="w">            </span><span class="p">(</span><span class="w"> </span><span class="nv">model</span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="nf">.</span><span class="nv">none</span><span class="w"> </span><span class="p">)</span>

<span class="w">        </span><span class="kt">NoOp</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="p">(</span><span class="w"> </span><span class="nv">model</span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="nf">.</span><span class="nv">none</span><span class="w"> </span><span class="p">)</span>
</code></pre></div>
<p>ã€Œä¸ŠçŸ¢å°ã‚­ãƒ¼ã§å›è»¢ã™ã‚‹ã‚“ã§ã™ã­ï¼ã€ãã†ã§ã™ã€‚<code>ArrowUp</code> ãŒæŠ¼ã•ã‚Œã‚‹ã¨ã€<code>rotateWithKick</code> é–¢æ•°ã‚’å‘¼ã³å‡ºã—ã¦å›è»¢ã—ã¾ã™ã€‚å£ã‚­ãƒƒã‚¯ãŒå¿…è¦ãªå ´åˆã¯è‡ªå‹•çš„ã«å‡¦ç†ã•ã‚Œã¾ã™ã€‚</p>
<h3 id="_40">ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®å®Ÿè¡Œ<a class="headerlink" href="#_40" title="Permanent link">&para;</a></h3>
<p>ã§ã¯ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼š</p>
<div class="highlight"><pre><span></span><code>elm<span class="w"> </span>reactor
</code></pre></div>
<p>ãƒ–ãƒ©ã‚¦ã‚¶ã§ <code>http://localhost:8000</code> ã‚’é–‹ãã€<code>src/Main.elm</code> ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚ã€Œã‚²ãƒ¼ãƒ é–‹å§‹ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã€ä¸ŠçŸ¢å°ã‚­ãƒ¼ã‚’æŠ¼ã™ã¨ã€ã·ã‚ˆãŒå›è»¢ã—ã¾ã™ï¼</p>
<p>ã€Œæœ¬å½“ã ï¼ã·ã‚ˆãŒå›è»¢ã—ã¾ã—ãŸï¼ã€ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰å…¥åŠ›ã§ã·ã‚ˆã‚’å›è»¢ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã­ã€‚</p>
<h3 id="3_2">ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³3ã®ã¾ã¨ã‚<a class="headerlink" href="#3_2" title="Permanent link">&para;</a></h3>
<p>ã“ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§å®Ÿè£…ã—ãŸå†…å®¹:</p>
<ol>
<li><strong>å›è»¢çŠ¶æ…‹ã®ç®¡ç†</strong></li>
<li><code>rotation</code> ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰: 0ï¼ˆä¸Šï¼‰ã€1ï¼ˆå³ï¼‰ã€2ï¼ˆä¸‹ï¼‰ã€3ï¼ˆå·¦ï¼‰ã®4çŠ¶æ…‹</li>
<li>
<p><code>getChildPosition</code>: å›è»¢çŠ¶æ…‹ã«å¿œã˜ãŸå­ã·ã‚ˆã®ä½ç½®è¨ˆç®—</p>
</li>
<li>
<p><strong>å›è»¢æ©Ÿèƒ½</strong></p>
</li>
<li><code>rotate</code>: æ™‚è¨ˆå›ã‚Šã«90åº¦å›è»¢</li>
<li>ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°ã§å›è»¢çŠ¶æ…‹ã«å¿œã˜ãŸä½ç½®ã‚’è¨ˆç®—</li>
<li>
<p>ä¸å¤‰æ€§ã‚’ä¿ã¡ãªãŒã‚‰æ–°ã—ã„ã·ã‚ˆãƒšã‚¢ã‚’è¿”ã™</p>
</li>
<li>
<p><strong>å£ã‚­ãƒƒã‚¯å‡¦ç†</strong></p>
</li>
<li><code>rotateWithKick</code>: å›è»¢ã¨å£ã‚­ãƒƒã‚¯ã‚’çµ±åˆ</li>
<li><code>tryWallKick</code>: å·¦å³ã¸ã®ç§»å‹•ã‚’è©¦ã¿ã‚‹</li>
<li>
<p>ã‚¿ãƒ—ãƒ«å‹ã§å›è»¢çµæœã¨å£ã‚­ãƒƒã‚¯ç™ºç”Ÿãƒ•ãƒ©ã‚°ã‚’è¿”ã™</p>
</li>
<li>
<p><strong>The Elm Architecture ã®æ‹¡å¼µ</strong></p>
</li>
<li><code>KeyPressed "ArrowUp"</code>: ä¸ŠçŸ¢å°ã‚­ãƒ¼ã§å›è»¢</li>
<li>
<p><code>update</code> é–¢æ•°ã§ã®å›è»¢å‡¦ç†ã®çµ±åˆ</p>
</li>
<li>
<p><strong>ãƒ†ã‚¹ãƒˆã®ä½œæˆ</strong></p>
</li>
<li>å›è»¢æ©Ÿèƒ½ã®ãƒ†ã‚¹ãƒˆï¼ˆ2ãƒ†ã‚¹ãƒˆï¼‰</li>
<li>å£ã‚­ãƒƒã‚¯å‡¦ç†ã®ãƒ†ã‚¹ãƒˆï¼ˆ2ãƒ†ã‚¹ãƒˆï¼‰</li>
</ol>
<h3 id="_41">å­¦ã‚“ã ã“ã¨<a class="headerlink" href="#_41" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>å›è»¢çŠ¶æ…‹ã®ç®¡ç†</strong>: ã‚«ã‚¹ã‚¿ãƒ å‹ã¨ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°ã§å®‰å…¨ã«ç®¡ç†</li>
<li><strong>ã‚¿ãƒ—ãƒ«å‹</strong>: è¤‡æ•°ã®å€¤ã‚’è¿”ã™å ´åˆã«ä¾¿åˆ©ï¼ˆå›è»¢çµæœã¨å£ã‚­ãƒƒã‚¯ãƒ•ãƒ©ã‚°ï¼‰</li>
<li><strong>ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³æ¼”ç®—å­</strong>: è¤‡æ•°ã®å›è»¢ã‚’é€£é–ã•ã›ã¦ãƒ†ã‚¹ãƒˆ</li>
<li><strong>ä¸å¤‰æ€§</strong>: å›è»¢å‰ã®çŠ¶æ…‹ã‚’ä¿ã¡ãªãŒã‚‰æ–°ã—ã„çŠ¶æ…‹ã‚’ä½œæˆ</li>
<li><strong>å‹å®‰å…¨æ€§</strong>: ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ãŒå›è»¢çŠ¶æ…‹ã®ã™ã¹ã¦ã®ã‚±ãƒ¼ã‚¹ã‚’ãƒã‚§ãƒƒã‚¯</li>
</ul>
<p>æ¬¡ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ã€ã·ã‚ˆã®è‡ªç”±è½ä¸‹æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¾ã™ï¼</p>
<h2 id="4_1">ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³4: ã·ã‚ˆã®è‡ªç”±è½ä¸‹ã®å®Ÿè£…<a class="headerlink" href="#4_1" title="Permanent link">&para;</a></h2>
<p>ã€Œå›è»¢ãŒã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸã‘ã©ã€ã·ã‚ˆã·ã‚ˆã£ã¦è‡ªå‹•ã§è½ã¡ã¦ã„ãã‚ˆã­ï¼Ÿã€ãã†ã§ã™ã­ï¼ã·ã‚ˆã·ã‚ˆã§ã¯ã€ã·ã‚ˆãŒä¸€å®šé–“éš”ã§è‡ªå‹•çš„ã«ä¸‹ã«è½ã¡ã¦ã„ãã¾ã™ã€‚ä»Šå›ã¯ã€ãã®ã€Œè‡ªç”±è½ä¸‹ã€æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¦ã„ãã¾ã—ã‚‡ã†ï¼</p>
<h3 id="_42">ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼<a class="headerlink" href="#_42" title="Permanent link">&para;</a></h3>
<p>ã¾ãšã¯ã€ã“ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§å®Ÿè£…ã™ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚’ç¢ºèªã—ã¾ã—ã‚‡ã†ï¼š</p>
<blockquote>
<p>ã‚·ã‚¹ãƒ†ãƒ ã¨ã—ã¦ã·ã‚ˆã‚’è‡ªç”±è½ä¸‹ã•ã›ã‚‹ã“ã¨ãŒã§ãã‚‹</p>
</blockquote>
<p>ã€Œã·ã‚ˆãŒè‡ªå‹•çš„ã«è½ã¡ã¦ã„ãã€ã¨ã„ã†æ©Ÿèƒ½ã¯ã€ã·ã‚ˆã·ã‚ˆã®åŸºæœ¬ä¸­ã®åŸºæœ¬ã§ã™ã­ã€‚ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒä½•ã‚‚æ“ä½œã—ãªãã¦ã‚‚ã€æ™‚é–“ã¨ã¨ã‚‚ã«ã·ã‚ˆãŒä¸‹ã«è½ã¡ã¦ã„ãä»•çµ„ã¿ã‚’ä½œã‚Šã¾ã—ã‚‡ã†ã€‚</p>
<h3 id="todo_3">TODOãƒªã‚¹ãƒˆ<a class="headerlink" href="#todo_3" title="Permanent link">&para;</a></h3>
<p>ã€Œã©ã‚“ãªä½œæ¥­ãŒå¿…è¦ã«ãªã‚Šã¾ã™ã‹ï¼Ÿã€ã“ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚’å®Ÿç¾ã™ã‚‹ãŸã‚ã«ã€TODOãƒªã‚¹ãƒˆã‚’ä½œæˆã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</p>
<p>ã€Œã·ã‚ˆã‚’è‡ªç”±è½ä¸‹ã•ã›ã‚‹ã€ã¨ã„ã†æ©Ÿèƒ½ã‚’å®Ÿç¾ã™ã‚‹ãŸã‚ã«ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ãªã‚¿ã‚¹ã‚¯ãŒå¿…è¦ãã†ã§ã™ã­ï¼š</p>
<ul>
<li>æ™‚é–“ã®çµŒéã‚’ç®¡ç†ã™ã‚‹ï¼ˆTime ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ã®è¿½åŠ ï¼‰</li>
<li>è‡ªå‹•è½ä¸‹å‡¦ç†ã®å®Ÿè£…ï¼ˆä¸€å®šæ™‚é–“ã”ã¨ã«ã·ã‚ˆã‚’1ãƒã‚¹ä¸‹ã«ç§»å‹•ï¼‰</li>
<li>è½ä¸‹å¯èƒ½åˆ¤å®šã®å®Ÿè£…ï¼ˆä¸‹ã«ç§»å‹•ã§ãã‚‹ã‹ãƒã‚§ãƒƒã‚¯ï¼‰</li>
<li>ç€åœ°å‡¦ç†ã®å®Ÿè£…ï¼ˆã·ã‚ˆãŒç€åœ°ã—ãŸã¨ãã«ãƒœãƒ¼ãƒ‰ã«å›ºå®šï¼‰</li>
<li>The Elm Architecture ã¸ã®çµ±åˆï¼ˆTick ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®å‡¦ç†ï¼‰</li>
</ul>
<p>ã€Œãªã‚‹ã»ã©ã€é †ç•ªã«å®Ÿè£…ã—ã¦ã„ã‘ã°ã„ã„ã‚“ã§ã™ã­ï¼ã€ãã†ã§ã™ã€ä¸€ã¤ãšã¤é€²ã‚ã¦ã„ãã¾ã—ã‚‡ã†ã€‚ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã®æµã‚Œã«æ²¿ã£ã¦ã€ã¾ãšã¯ãƒ†ã‚¹ãƒˆã‹ã‚‰æ›¸ã„ã¦ã„ãã¾ã™ã‚ˆã€‚</p>
<h3 id="_43">ãƒ†ã‚¹ãƒˆ: ã·ã‚ˆãƒšã‚¢ã®è½ä¸‹<a class="headerlink" href="#_43" title="Permanent link">&para;</a></h3>
<p>ã¾ãšã¯ã€ã·ã‚ˆãƒšã‚¢ãŒä¸‹ã«ç§»å‹•ã™ã‚‹æ©Ÿèƒ½ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã—ã‚‡ã†ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- tests/PuyoPairTests.elmï¼ˆç¶šãï¼‰</span>
<span class="nv">suite</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Test</span>
<span class="nv">suite</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="nv">describe</span><span class="w"> </span><span class="s">&quot;PuyoPair&quot;</span>
<span class="w">        </span><span class="p">[</span><span class="w"> </span><span class="c1">-- æ—¢å­˜ã®ãƒ†ã‚¹ãƒˆ...</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">describe</span><span class="w"> </span><span class="s">&quot;moveDown&quot;</span>
<span class="w">            </span><span class="p">[</span><span class="w"> </span><span class="nv">test</span><span class="w"> </span><span class="s">&quot;ä¸‹ã«ç§»å‹•ã§ãã‚‹&quot;</span><span class="w"> </span><span class="nf">&lt;|</span>
<span class="w">                </span><span class="nf">\</span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="kr">let</span>
<span class="w">                        </span><span class="nv">pair</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="kt">Red</span><span class="w"> </span><span class="kt">Blue</span>

<span class="w">                        </span><span class="nv">movedPair</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">moveDown</span><span class="w"> </span><span class="nv">pair</span>
<span class="w">                    </span><span class="kr">in</span>
<span class="w">                    </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">all</span>
<span class="w">                        </span><span class="p">[</span><span class="w"> </span><span class="nf">\</span><span class="nv">p</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">equal</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="nv">p</span><span class="nf">.</span><span class="nv">axis</span><span class="nf">.</span><span class="nv">x</span>
<span class="w">                        </span><span class="p">,</span><span class="w"> </span><span class="nf">\</span><span class="nv">p</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">equal</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="nv">p</span><span class="nf">.</span><span class="nv">axis</span><span class="nf">.</span><span class="nv">y</span>
<span class="w">                        </span><span class="p">,</span><span class="w"> </span><span class="nf">\</span><span class="nv">p</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">equal</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="nv">p</span><span class="nf">.</span><span class="nv">child</span><span class="nf">.</span><span class="nv">x</span>
<span class="w">                        </span><span class="p">,</span><span class="w"> </span><span class="nf">\</span><span class="nv">p</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">equal</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="nv">p</span><span class="nf">.</span><span class="nv">child</span><span class="nf">.</span><span class="nv">y</span>
<span class="w">                        </span><span class="p">]</span>
<span class="w">                        </span><span class="nv">movedPair</span>
<span class="w">            </span><span class="p">]</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">describe</span><span class="w"> </span><span class="s">&quot;canMoveDown&quot;</span>
<span class="w">            </span><span class="p">[</span><span class="w"> </span><span class="nv">test</span><span class="w"> </span><span class="s">&quot;ä¸‹ã«ã‚¹ãƒšãƒ¼ã‚¹ãŒã‚ã‚Œã°ç§»å‹•å¯èƒ½&quot;</span><span class="w"> </span><span class="nf">&lt;|</span>
<span class="w">                </span><span class="nf">\</span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="kr">let</span>
<span class="w">                        </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="mi">12</span>

<span class="w">                        </span><span class="nv">pair</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="kt">Red</span><span class="w"> </span><span class="kt">Blue</span>
<span class="w">                    </span><span class="kr">in</span>
<span class="w">                    </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">canMoveDown</span><span class="w"> </span><span class="nv">pair</span><span class="w"> </span><span class="nv">board</span>
<span class="w">                        </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">equal</span><span class="w"> </span><span class="kt">True</span>
<span class="w">            </span><span class="p">,</span><span class="w"> </span><span class="nv">test</span><span class="w"> </span><span class="s">&quot;è»¸ã·ã‚ˆãŒä¸‹ç«¯ãªã‚‰ç§»å‹•ä¸å¯&quot;</span><span class="w"> </span><span class="nf">&lt;|</span>
<span class="w">                </span><span class="nf">\</span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="kr">let</span>
<span class="w">                        </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="mi">12</span>

<span class="w">                        </span><span class="nv">pair</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="kt">Red</span><span class="w"> </span><span class="kt">Blue</span>
<span class="w">                    </span><span class="kr">in</span>
<span class="w">                    </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">canMoveDown</span><span class="w"> </span><span class="nv">pair</span><span class="w"> </span><span class="nv">board</span>
<span class="w">                        </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">equal</span><span class="w"> </span><span class="kt">False</span>
<span class="w">            </span><span class="p">,</span><span class="w"> </span><span class="nv">test</span><span class="w"> </span><span class="s">&quot;å­ã·ã‚ˆãŒä¸‹ç«¯ãªã‚‰ç§»å‹•ä¸å¯&quot;</span><span class="w"> </span><span class="nf">&lt;|</span>
<span class="w">                </span><span class="nf">\</span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="kr">let</span>
<span class="w">                        </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="mi">12</span>

<span class="w">                        </span><span class="c1">-- rotation = 2ï¼ˆå­ã·ã‚ˆãŒä¸‹ï¼‰ã®çŠ¶æ…‹</span>
<span class="w">                        </span><span class="nv">pair</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="p">{</span><span class="w"> </span><span class="nv">axis</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">}</span>
<span class="w">                            </span><span class="p">,</span><span class="w"> </span><span class="nv">child</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="p">}</span>
<span class="w">                            </span><span class="p">,</span><span class="w"> </span><span class="nv">axisColor</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Red</span>
<span class="w">                            </span><span class="p">,</span><span class="w"> </span><span class="nv">childColor</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Blue</span>
<span class="w">                            </span><span class="p">,</span><span class="w"> </span><span class="nv">rotation</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="mi">2</span>
<span class="w">                            </span><span class="p">}</span>
<span class="w">                    </span><span class="kr">in</span>
<span class="w">                    </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">canMoveDown</span><span class="w"> </span><span class="nv">pair</span><span class="w"> </span><span class="nv">board</span>
<span class="w">                        </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">equal</span><span class="w"> </span><span class="kt">False</span>
<span class="w">            </span><span class="p">,</span><span class="w"> </span><span class="nv">test</span><span class="w"> </span><span class="s">&quot;ä¸‹ã«ã·ã‚ˆãŒã‚ã‚Œã°ç§»å‹•ä¸å¯&quot;</span><span class="w"> </span><span class="nf">&lt;|</span>
<span class="w">                </span><span class="nf">\</span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="kr">let</span>
<span class="w">                        </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="mi">12</span>
<span class="w">                                </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">setCell</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="p">(</span><span class="kt">Filled</span><span class="w"> </span><span class="kt">Red</span><span class="p">)</span>

<span class="w">                        </span><span class="nv">pair</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="kt">Red</span><span class="w"> </span><span class="kt">Blue</span>
<span class="w">                    </span><span class="kr">in</span>
<span class="w">                    </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">canMoveDown</span><span class="w"> </span><span class="nv">pair</span><span class="w"> </span><span class="nv">board</span>
<span class="w">                        </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">equal</span><span class="w"> </span><span class="kt">False</span>
<span class="w">            </span><span class="p">]</span>
<span class="w">        </span><span class="p">]</span>
</code></pre></div>
<p>ã€Œã“ã®ãƒ†ã‚¹ãƒˆã¯ä½•ã‚’ç¢ºèªã—ã¦ã„ã‚‹ã‚“ã§ã™ã‹ï¼Ÿã€ã“ã®ãƒ†ã‚¹ãƒˆã§ã¯ã€ä»¥ä¸‹ã®ã‚±ãƒ¼ã‚¹ã‚’ç¢ºèªã—ã¦ã„ã¾ã™ï¼š</p>
<ol>
<li>ã·ã‚ˆãƒšã‚¢ãŒä¸‹ã«ç§»å‹•ã§ãã‚‹ã‹</li>
<li>ä¸‹ã«ã‚¹ãƒšãƒ¼ã‚¹ãŒã‚ã‚Œã°ç§»å‹•å¯èƒ½</li>
<li>è»¸ã·ã‚ˆãŒä¸‹ç«¯ãªã‚‰ç§»å‹•ä¸å¯</li>
<li>å­ã·ã‚ˆãŒä¸‹ç«¯ãªã‚‰ç§»å‹•ä¸å¯</li>
<li>ä¸‹ã«ã·ã‚ˆãŒã‚ã‚Œã°ç§»å‹•ä¸å¯</li>
</ol>
<h3 id="_44">å®Ÿè£…: ã·ã‚ˆãƒšã‚¢ã®è½ä¸‹<a class="headerlink" href="#_44" title="Permanent link">&para;</a></h3>
<p>ã§ã¯ã€ãƒ†ã‚¹ãƒˆãŒé€šã‚‹ã‚ˆã†ã« PuyoPair ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’æ‹¡å¼µã—ã¾ã—ã‚‡ã†ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- src/PuyoPair.elmï¼ˆæ‹¡å¼µç‰ˆï¼‰</span>
<span class="kn">module</span><span class="w"> </span><span class="nc">PuyoPair</span><span class="w"> </span><span class="nv">exposing</span>
<span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="kt">PuyoPair</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="kt">Position</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">canMove</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">canMoveDown</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">create</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">getPositions</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">moveDown</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">moveLeft</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">moveRight</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">rotate</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">rotateWithKick</span>
<span class="w">    </span><span class="p">)</span>

<span class="c1">-- çœç•¥...</span>


<span class="c1">-- ä¸‹ã«ç§»å‹•ã™ã‚‹</span>
<span class="nv">moveDown</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">PuyoPair</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">PuyoPair</span>
<span class="nv">moveDown</span><span class="w"> </span><span class="nv">pair</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nv">pair</span>
<span class="w">        </span><span class="nf">|</span><span class="w"> </span><span class="nv">axis</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">axis</span><span class="nf">.</span><span class="nv">x</span><span class="p">,</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">axis</span><span class="nf">.</span><span class="nv">y</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">}</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">child</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">child</span><span class="nf">.</span><span class="nv">x</span><span class="p">,</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">child</span><span class="nf">.</span><span class="nv">y</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>


<span class="c1">-- ä¸‹ã«ç§»å‹•å¯èƒ½ã‹ãƒã‚§ãƒƒã‚¯ã™ã‚‹</span>
<span class="nv">canMoveDown</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">PuyoPair</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Bool</span>
<span class="nv">canMoveDown</span><span class="w"> </span><span class="nv">pair</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="kr">let</span>
<span class="w">        </span><span class="nv">nextAxisY</span><span class="w"> </span><span class="nf">=</span>
<span class="w">            </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">axis</span><span class="nf">.</span><span class="nv">y</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="mi">1</span>

<span class="w">        </span><span class="nv">nextChildY</span><span class="w"> </span><span class="nf">=</span>
<span class="w">            </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">child</span><span class="nf">.</span><span class="nv">y</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="mi">1</span>

<span class="w">        </span><span class="c1">-- ãƒœãƒ¼ãƒ‰ã®é«˜ã•</span>
<span class="w">        </span><span class="nv">boardRows</span><span class="w"> </span><span class="nf">=</span>
<span class="w">            </span><span class="nv">board</span><span class="nf">.</span><span class="nv">rows</span>

<span class="w">        </span><span class="c1">-- ä¸‹ç«¯ãƒã‚§ãƒƒã‚¯</span>
<span class="w">        </span><span class="nv">isAxisOutOfBounds</span><span class="w"> </span><span class="nf">=</span>
<span class="w">            </span><span class="nv">nextAxisY</span><span class="w"> </span><span class="nf">&gt;=</span><span class="w"> </span><span class="nv">boardRows</span>

<span class="w">        </span><span class="nv">isChildOutOfBounds</span><span class="w"> </span><span class="nf">=</span>
<span class="w">            </span><span class="nv">nextChildY</span><span class="w"> </span><span class="nf">&gt;=</span><span class="w"> </span><span class="nv">boardRows</span>

<span class="w">        </span><span class="c1">-- ç§»å‹•å…ˆã®ã‚»ãƒ«ãƒã‚§ãƒƒã‚¯</span>
<span class="w">        </span><span class="nv">axisCell</span><span class="w"> </span><span class="nf">=</span>
<span class="w">            </span><span class="kr">if</span><span class="w"> </span><span class="nv">isAxisOutOfBounds</span><span class="w"> </span><span class="kr">then</span>
<span class="w">                </span><span class="kt">Nothing</span>

<span class="w">            </span><span class="kr">else</span>
<span class="w">                </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">getCell</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">axis</span><span class="nf">.</span><span class="nv">x</span><span class="w"> </span><span class="nv">nextAxisY</span><span class="w"> </span><span class="nv">board</span>

<span class="w">        </span><span class="nv">childCell</span><span class="w"> </span><span class="nf">=</span>
<span class="w">            </span><span class="kr">if</span><span class="w"> </span><span class="nv">isChildOutOfBounds</span><span class="w"> </span><span class="kr">then</span>
<span class="w">                </span><span class="kt">Nothing</span>

<span class="w">            </span><span class="kr">else</span>
<span class="w">                </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">getCell</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">child</span><span class="nf">.</span><span class="nv">x</span><span class="w"> </span><span class="nv">nextChildY</span><span class="w"> </span><span class="nv">board</span>
<span class="w">    </span><span class="kr">in</span>
<span class="w">    </span><span class="kr">case</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nv">axisCell</span><span class="p">,</span><span class="w"> </span><span class="nv">childCell</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="kr">of</span>
<span class="w">        </span><span class="p">(</span><span class="w"> </span><span class="kt">Just</span><span class="w"> </span><span class="kt">Empty</span><span class="p">,</span><span class="w"> </span><span class="kt">Just</span><span class="w"> </span><span class="kt">Empty</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="kt">True</span>

<span class="w">        </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="kt">False</span>
</code></pre></div>
<p>ã€Œä¸å¤‰æ€§ã‚’ä¿ã¡ãªãŒã‚‰ä¸‹ã«ç§»å‹•ã—ã¦ã„ã‚‹ã‚“ã§ã™ã­ï¼ã€ãã†ã§ã™ã€‚<code>moveDown</code> é–¢æ•°ã§ã¯ã€è»¸ã·ã‚ˆã¨å­ã·ã‚ˆã®ä¸¡æ–¹ã® Y åº§æ¨™ã‚’ 1 å¢—ã‚„ã—ãŸæ–°ã—ã„ã·ã‚ˆãƒšã‚¢ã‚’è¿”ã—ã¾ã™ã€‚</p>
<p>ã€Œ<code>canMoveDown</code> é–¢æ•°ã¯ <code>canMove</code> ã¨ä¼¼ã¦ã„ã¾ã™ã­ã€ãã†ã§ã™ã­ã€‚ä¸»ãªé•ã„ã¯ã€ä¸‹æ–¹å‘ã¸ã®ç§»å‹•å¯èƒ½æ€§ã‚’å°‚ç”¨ã«ãƒã‚§ãƒƒã‚¯ã—ã¦ã„ã‚‹ç‚¹ã§ã™ã€‚ä¸‹ç«¯ãƒã‚§ãƒƒã‚¯ã‚’å…ˆã«è¡Œã†ã“ã¨ã§ã€ç¯„å›²å¤–ã‚¢ã‚¯ã‚»ã‚¹ã‚’é˜²ã„ã§ã„ã¾ã™ã€‚</p>
<h3 id="time">Time ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ã®è¿½åŠ <a class="headerlink" href="#time" title="Permanent link">&para;</a></h3>
<p>æ¬¡ã«ã€ä¸€å®šæ™‚é–“ã”ã¨ã« Tick ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç™ºè¡Œã™ã‚‹ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ ã—ã¾ã™ã€‚Elm ã§ã¯ã€<code>Browser.Events.onAnimationFrame</code> ã‚’ä½¿ã£ã¦ã€ãƒ–ãƒ©ã‚¦ã‚¶ã®æç”»ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã«åˆã‚ã›ãŸæ›´æ–°ã‚’è¡Œãˆã¾ã™ã€‚</p>
<p>ã¾ãšã€å¿…è¦ãªå‹ã‚’å®šç¾©ã—ã¾ã™ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- src/Main.elmï¼ˆæ›´æ–°éƒ¨åˆ†ï¼‰</span>
<span class="kn">import</span><span class="w"> </span><span class="nc">Browser.Events</span>
<span class="kn">import</span><span class="w"> </span><span class="nc">Time</span>


<span class="kr">type</span><span class="w"> </span><span class="kr">alias</span><span class="w"> </span><span class="kt">Model</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Board</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">currentPair</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Maybe</span><span class="w"> </span><span class="kt">PuyoPair</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">mode</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">GameMode</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">dropTimer</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Float</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">dropInterval</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Float</span>
<span class="w">    </span><span class="p">}</span>


<span class="nv">init</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="kt">Model</span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="w"> </span><span class="kt">Msg</span><span class="w"> </span><span class="p">)</span>
<span class="nv">init</span><span class="w"> </span><span class="nv">_</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="mi">12</span>
<span class="w">      </span><span class="p">,</span><span class="w"> </span><span class="nv">currentPair</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Nothing</span>
<span class="w">      </span><span class="p">,</span><span class="w"> </span><span class="nv">mode</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Start</span>
<span class="w">      </span><span class="p">,</span><span class="w"> </span><span class="nv">dropTimer</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">      </span><span class="p">,</span><span class="w"> </span><span class="nv">dropInterval</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="mi">1000</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="nf">.</span><span class="nv">none</span>
<span class="w">    </span><span class="p">)</span>


<span class="kr">type</span><span class="w"> </span><span class="kt">Msg</span>
<span class="w">    </span><span class="nf">=</span><span class="w"> </span><span class="kt">StartGame</span>
<span class="w">    </span><span class="nf">|</span><span class="w"> </span><span class="kt">KeyPressed</span><span class="w"> </span><span class="kt">String</span>
<span class="w">    </span><span class="nf">|</span><span class="w"> </span><span class="kt">Tick</span><span class="w"> </span><span class="kt">Float</span>
<span class="w">    </span><span class="nf">|</span><span class="w"> </span><span class="kt">NoOp</span>


<span class="nv">subscriptions</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Model</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Sub</span><span class="w"> </span><span class="kt">Msg</span>
<span class="nv">subscriptions</span><span class="w"> </span><span class="nv">model</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="kr">case</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">mode</span><span class="w"> </span><span class="kr">of</span>
<span class="w">        </span><span class="kt">Playing</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="kt">Sub</span><span class="nf">.</span><span class="nv">batch</span>
<span class="w">                </span><span class="p">[</span><span class="w"> </span><span class="kt">Browser</span><span class="nf">.</span><span class="kt">Events</span><span class="nf">.</span><span class="nv">onKeyDown</span><span class="w"> </span><span class="p">(</span><span class="kt">Decode</span><span class="nf">.</span><span class="nv">map</span><span class="w"> </span><span class="kt">KeyPressed</span><span class="w"> </span><span class="nv">keyDecoder</span><span class="p">)</span>
<span class="w">                </span><span class="p">,</span><span class="w"> </span><span class="kt">Browser</span><span class="nf">.</span><span class="kt">Events</span><span class="nf">.</span><span class="nv">onAnimationFrame</span><span class="w"> </span><span class="kt">Tick</span>
<span class="w">                </span><span class="p">]</span>

<span class="w">        </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="kt">Sub</span><span class="nf">.</span><span class="nv">none</span>
</code></pre></div>
<p>ã€Œ<code>onAnimationFrame</code> ã¯ä½•ã§ã™ã‹ï¼Ÿã€è‰¯ã„è³ªå•ã§ã™ï¼<code>onAnimationFrame</code> ã¯ã€ãƒ–ãƒ©ã‚¦ã‚¶ã®æç”»ã‚¿ã‚¤ãƒŸãƒ³ã‚°ï¼ˆé€šå¸¸ã¯60FPSã§ç´„16.67msï¼‰ã”ã¨ã«å‘¼ã°ã‚Œã‚‹ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ã§ã™ã€‚å¼•æ•°ã¨ã—ã¦ç¾åœ¨ã®ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ï¼ˆãƒŸãƒªç§’ï¼‰ã‚’å—ã‘å–ã‚Šã¾ã™ã€‚</p>
<h3 id="update">update é–¢æ•°ã®æ‹¡å¼µ<a class="headerlink" href="#update" title="Permanent link">&para;</a></h3>
<p>æ¬¡ã«ã€Tick ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å‡¦ç†ã—ã¦ã€ä¸€å®šæ™‚é–“ã”ã¨ã«ã·ã‚ˆã‚’è½ä¸‹ã•ã›ã¾ã™ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="nv">update</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Msg</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Model</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="kt">Model</span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="w"> </span><span class="kt">Msg</span><span class="w"> </span><span class="p">)</span>
<span class="nv">update</span><span class="w"> </span><span class="nv">msg</span><span class="w"> </span><span class="nv">model</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="kr">case</span><span class="w"> </span><span class="nv">msg</span><span class="w"> </span><span class="kr">of</span>
<span class="w">        </span><span class="kt">StartGame</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="p">(</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">model</span>
<span class="w">                </span><span class="nf">|</span><span class="w"> </span><span class="nv">mode</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Playing</span>
<span class="w">                </span><span class="p">,</span><span class="w"> </span><span class="nv">currentPair</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Just</span><span class="w"> </span><span class="p">(</span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="kt">Red</span><span class="w"> </span><span class="kt">Blue</span><span class="p">)</span>
<span class="w">                </span><span class="p">,</span><span class="w"> </span><span class="nv">dropTimer</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">              </span><span class="p">}</span>
<span class="w">            </span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="nf">.</span><span class="nv">none</span>
<span class="w">            </span><span class="p">)</span>

<span class="w">        </span><span class="kt">KeyPressed</span><span class="w"> </span><span class="nv">key</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="kr">case</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">mode</span><span class="p">,</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">currentPair</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="kr">of</span>
<span class="w">                </span><span class="p">(</span><span class="w"> </span><span class="kt">Playing</span><span class="p">,</span><span class="w"> </span><span class="kt">Just</span><span class="w"> </span><span class="nv">pair</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="kr">let</span>
<span class="w">                        </span><span class="nv">newPair</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kr">case</span><span class="w"> </span><span class="nv">key</span><span class="w"> </span><span class="kr">of</span>
<span class="w">                                </span><span class="s">&quot;ArrowLeft&quot;</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                                    </span><span class="kr">let</span>
<span class="w">                                        </span><span class="nv">movedPair</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                                            </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">moveLeft</span><span class="w"> </span><span class="nv">pair</span>
<span class="w">                                    </span><span class="kr">in</span>
<span class="w">                                    </span><span class="kr">if</span><span class="w"> </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">canMove</span><span class="w"> </span><span class="nv">movedPair</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">board</span><span class="w"> </span><span class="kr">then</span>
<span class="w">                                        </span><span class="nv">movedPair</span>

<span class="w">                                    </span><span class="kr">else</span>
<span class="w">                                        </span><span class="nv">pair</span>

<span class="w">                                </span><span class="s">&quot;ArrowRight&quot;</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                                    </span><span class="kr">let</span>
<span class="w">                                        </span><span class="nv">movedPair</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                                            </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">moveRight</span><span class="w"> </span><span class="nv">pair</span>
<span class="w">                                    </span><span class="kr">in</span>
<span class="w">                                    </span><span class="kr">if</span><span class="w"> </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">canMove</span><span class="w"> </span><span class="nv">movedPair</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">board</span><span class="w"> </span><span class="kr">then</span>
<span class="w">                                        </span><span class="nv">movedPair</span>

<span class="w">                                    </span><span class="kr">else</span>
<span class="w">                                        </span><span class="nv">pair</span>

<span class="w">                                </span><span class="s">&quot;ArrowUp&quot;</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                                    </span><span class="kr">let</span>
<span class="w">                                        </span><span class="p">(</span><span class="w"> </span><span class="nv">rotatedPair</span><span class="p">,</span><span class="w"> </span><span class="nv">_</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                                            </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">rotateWithKick</span><span class="w"> </span><span class="nv">pair</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">board</span>
<span class="w">                                    </span><span class="kr">in</span>
<span class="w">                                    </span><span class="nv">rotatedPair</span>

<span class="w">                                </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                                    </span><span class="nv">pair</span>
<span class="w">                    </span><span class="kr">in</span>
<span class="w">                    </span><span class="p">(</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">model</span><span class="w"> </span><span class="nf">|</span><span class="w"> </span><span class="nv">currentPair</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Just</span><span class="w"> </span><span class="nv">newPair</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="kt">Cmd</span><span class="nf">.</span><span class="nv">none</span><span class="w"> </span><span class="p">)</span>

<span class="w">                </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="p">(</span><span class="w"> </span><span class="nv">model</span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="nf">.</span><span class="nv">none</span><span class="w"> </span><span class="p">)</span>

<span class="w">        </span><span class="kt">Tick</span><span class="w"> </span><span class="nv">deltaTime</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="kr">case</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">mode</span><span class="p">,</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">currentPair</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="kr">of</span>
<span class="w">                </span><span class="p">(</span><span class="w"> </span><span class="kt">Playing</span><span class="p">,</span><span class="w"> </span><span class="kt">Just</span><span class="w"> </span><span class="nv">pair</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="kr">let</span>
<span class="w">                        </span><span class="nv">newTimer</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="nv">model</span><span class="nf">.</span><span class="nv">dropTimer</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="nv">deltaTime</span>
<span class="w">                    </span><span class="kr">in</span>
<span class="w">                    </span><span class="kr">if</span><span class="w"> </span><span class="nv">newTimer</span><span class="w"> </span><span class="nf">&gt;=</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">dropInterval</span><span class="w"> </span><span class="kr">then</span>
<span class="w">                        </span><span class="c1">-- è½ä¸‹ã‚¿ã‚¤ãƒãƒ¼ãŒé–“éš”ã‚’è¶…ãˆãŸã‚‰è½ä¸‹å‡¦ç†</span>
<span class="w">                        </span><span class="kr">if</span><span class="w"> </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">canMoveDown</span><span class="w"> </span><span class="nv">pair</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">board</span><span class="w"> </span><span class="kr">then</span>
<span class="w">                            </span><span class="c1">-- ä¸‹ã«ç§»å‹•å¯èƒ½</span>
<span class="w">                            </span><span class="p">(</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">model</span>
<span class="w">                                </span><span class="nf">|</span><span class="w"> </span><span class="nv">currentPair</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Just</span><span class="w"> </span><span class="p">(</span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">moveDown</span><span class="w"> </span><span class="nv">pair</span><span class="p">)</span>
<span class="w">                                </span><span class="p">,</span><span class="w"> </span><span class="nv">dropTimer</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">                              </span><span class="p">}</span>
<span class="w">                            </span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="nf">.</span><span class="nv">none</span>
<span class="w">                            </span><span class="p">)</span>

<span class="w">                        </span><span class="kr">else</span>
<span class="w">                            </span><span class="c1">-- ç€åœ°ã—ãŸï¼šãƒœãƒ¼ãƒ‰ã«å›ºå®šã—ã¦æ–°ã—ã„ã·ã‚ˆã‚’ç”Ÿæˆ</span>
<span class="w">                            </span><span class="kr">let</span>
<span class="w">                                </span><span class="nv">newBoard</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                                    </span><span class="nv">model</span><span class="nf">.</span><span class="nv">board</span>
<span class="w">                                        </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">setCell</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">axis</span><span class="nf">.</span><span class="nv">x</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">axis</span><span class="nf">.</span><span class="nv">y</span><span class="w"> </span><span class="p">(</span><span class="kt">Filled</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">axisColor</span><span class="p">)</span>
<span class="w">                                        </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">setCell</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">child</span><span class="nf">.</span><span class="nv">x</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">child</span><span class="nf">.</span><span class="nv">y</span><span class="w"> </span><span class="p">(</span><span class="kt">Filled</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">childColor</span><span class="p">)</span>
<span class="w">                            </span><span class="kr">in</span>
<span class="w">                            </span><span class="p">(</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">model</span>
<span class="w">                                </span><span class="nf">|</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">newBoard</span>
<span class="w">                                </span><span class="p">,</span><span class="w"> </span><span class="nv">currentPair</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Just</span><span class="w"> </span><span class="p">(</span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="kt">Red</span><span class="w"> </span><span class="kt">Blue</span><span class="p">)</span>
<span class="w">                                </span><span class="p">,</span><span class="w"> </span><span class="nv">dropTimer</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">                              </span><span class="p">}</span>
<span class="w">                            </span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="nf">.</span><span class="nv">none</span>
<span class="w">                            </span><span class="p">)</span>

<span class="w">                    </span><span class="kr">else</span>
<span class="w">                        </span><span class="c1">-- ã¾ã è½ä¸‹ã‚¿ã‚¤ãƒãƒ¼ãŒé–“éš”ã«é”ã—ã¦ã„ãªã„</span>
<span class="w">                        </span><span class="p">(</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">model</span><span class="w"> </span><span class="nf">|</span><span class="w"> </span><span class="nv">dropTimer</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">newTimer</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="kt">Cmd</span><span class="nf">.</span><span class="nv">none</span><span class="w"> </span><span class="p">)</span>

<span class="w">                </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="p">(</span><span class="w"> </span><span class="nv">model</span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="nf">.</span><span class="nv">none</span><span class="w"> </span><span class="p">)</span>

<span class="w">        </span><span class="kt">NoOp</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="p">(</span><span class="w"> </span><span class="nv">model</span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="nf">.</span><span class="nv">none</span><span class="w"> </span><span class="p">)</span>
</code></pre></div>
<p>ã€Œè½ä¸‹ã‚¿ã‚¤ãƒãƒ¼ã§ä¸€å®šæ™‚é–“ã”ã¨ã«è½ä¸‹å‡¦ç†ã‚’å®Ÿè¡Œã—ã¦ã„ã‚‹ã‚“ã§ã™ã­ï¼ã€ãã†ã§ã™ã€‚<code>Tick</code> ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒæ¥ã‚‹ãŸã³ã«ã‚¿ã‚¤ãƒãƒ¼ã‚’æ›´æ–°ã—ã€<code>dropInterval</code>ï¼ˆ1000ms = 1ç§’ï¼‰ã‚’è¶…ãˆãŸã‚‰ã€ã·ã‚ˆã‚’1ãƒã‚¹ä¸‹ã«ç§»å‹•ã•ã›ã¾ã™ã€‚</p>
<p>ã€Œç€åœ°ã—ãŸã‚‰ãƒœãƒ¼ãƒ‰ã«å›ºå®šã—ã¦æ–°ã—ã„ã·ã‚ˆã‚’ç”Ÿæˆã™ã‚‹ã‚“ã§ã™ã­ã€ãã®é€šã‚Šã§ã™ï¼<code>canMoveDown</code> ãŒ <code>False</code> ã‚’è¿”ã—ãŸå ´åˆã€ç¾åœ¨ã®ã·ã‚ˆãƒšã‚¢ã‚’ãƒœãƒ¼ãƒ‰ã«å›ºå®šï¼ˆ<code>setCell</code>ï¼‰ã—ã€æ–°ã—ã„ã·ã‚ˆãƒšã‚¢ã‚’ç”Ÿæˆã—ã¾ã™ã€‚</p>
<h3 id="_45">ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œ<a class="headerlink" href="#_45" title="Permanent link">&para;</a></h3>
<p>ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼š</p>
<div class="highlight"><pre><span></span><code>elm-test
</code></pre></div>
<p>ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆãŒé€šã‚Œã°æˆåŠŸã§ã™ï¼</p>
<h3 id="_46">ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®å®Ÿè¡Œ<a class="headerlink" href="#_46" title="Permanent link">&para;</a></h3>
<p>ã§ã¯ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼š</p>
<div class="highlight"><pre><span></span><code>elm<span class="w"> </span>reactor
</code></pre></div>
<p>ãƒ–ãƒ©ã‚¦ã‚¶ã§ <code>http://localhost:8000</code> ã‚’é–‹ãã€<code>src/Main.elm</code> ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚ã€Œã‚²ãƒ¼ãƒ é–‹å§‹ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã€ã·ã‚ˆãŒ1ç§’ã”ã¨ã«è‡ªå‹•çš„ã«ä¸‹ã«è½ã¡ã¦ã„ãã¾ã™ï¼</p>
<p>ã€Œæœ¬å½“ã ï¼ã·ã‚ˆãŒè‡ªå‹•ã§è½ã¡ã¦ã€ç€åœ°ã—ãŸã‚‰æ–°ã—ã„ã·ã‚ˆãŒå‡ºã¦ãã¾ã—ãŸï¼ã€ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼è‡ªç”±è½ä¸‹æ©Ÿèƒ½ãŒå®Ÿè£…ã§ãã¾ã—ãŸã­ã€‚</p>
<h3 id="4_2">ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³4ã®ã¾ã¨ã‚<a class="headerlink" href="#4_2" title="Permanent link">&para;</a></h3>
<p>ã“ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§å®Ÿè£…ã—ãŸå†…å®¹ï¼š</p>
<ol>
<li><strong>ã·ã‚ˆãƒšã‚¢ã®è½ä¸‹æ©Ÿèƒ½</strong></li>
<li><code>moveDown</code>: ä¸‹ã«ç§»å‹•</li>
<li>
<p><code>canMoveDown</code>: ä¸‹ã«ç§»å‹•å¯èƒ½ã‹ãƒã‚§ãƒƒã‚¯ï¼ˆä¸‹ç«¯ã¨è¡çªåˆ¤å®šï¼‰</p>
</li>
<li>
<p><strong>æ™‚é–“ç®¡ç†</strong></p>
</li>
<li><code>dropTimer</code>: è½ä¸‹ã‚¿ã‚¤ãƒãƒ¼</li>
<li><code>dropInterval</code>: è½ä¸‹é–“éš”ï¼ˆ1000msï¼‰</li>
<li>
<p><code>Browser.Events.onAnimationFrame</code>: ãƒ•ãƒ¬ãƒ¼ãƒ ã”ã¨ã®æ™‚é–“æ›´æ–°</p>
</li>
<li>
<p><strong>è‡ªå‹•è½ä¸‹å‡¦ç†</strong></p>
</li>
<li><code>Tick</code> ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã§ã‚¿ã‚¤ãƒãƒ¼ã‚’æ›´æ–°</li>
<li>ã‚¿ã‚¤ãƒãƒ¼ãŒé–“éš”ã‚’è¶…ãˆãŸã‚‰ã·ã‚ˆã‚’1ãƒã‚¹ä¸‹ã«ç§»å‹•</li>
<li>
<p>ç€åœ°ã—ãŸã‚‰ãƒœãƒ¼ãƒ‰ã«å›ºå®šã—ã¦æ–°ã—ã„ã·ã‚ˆã‚’ç”Ÿæˆ</p>
</li>
<li>
<p><strong>ç€åœ°å‡¦ç†</strong></p>
</li>
<li><code>canMoveDown</code> ãŒ <code>False</code> ã®å ´åˆã«ç€åœ°ã¨åˆ¤å®š</li>
<li>è»¸ã·ã‚ˆã¨å­ã·ã‚ˆã‚’ãƒœãƒ¼ãƒ‰ã« <code>setCell</code> ã§å›ºå®š</li>
<li>
<p>æ–°ã—ã„ã·ã‚ˆãƒšã‚¢ã‚’ç”Ÿæˆ</p>
</li>
<li>
<p><strong>ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ã®æ‹¡å¼µ</strong></p>
</li>
<li><code>Sub.batch</code>: è¤‡æ•°ã®ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ã‚’çµ„ã¿åˆã‚ã›</li>
<li>
<p>ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰å…¥åŠ›ã¨ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ãƒ¬ãƒ¼ãƒ ã®ä¸¡æ–¹ã‚’è³¼èª­</p>
</li>
<li>
<p><strong>ãƒ†ã‚¹ãƒˆã®ä½œæˆ</strong></p>
</li>
<li>è½ä¸‹æ©Ÿèƒ½ã®ãƒ†ã‚¹ãƒˆï¼ˆ1ãƒ†ã‚¹ãƒˆï¼‰</li>
<li>è½ä¸‹å¯èƒ½åˆ¤å®šã®ãƒ†ã‚¹ãƒˆï¼ˆ4ãƒ†ã‚¹ãƒˆï¼‰</li>
</ol>
<h3 id="_47">å­¦ã‚“ã ã“ã¨<a class="headerlink" href="#_47" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Browser.Events.onAnimationFrame</strong>: ãƒ–ãƒ©ã‚¦ã‚¶ã®æç”»ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã«åˆã‚ã›ãŸæ›´æ–°</li>
<li><strong>Sub.batch</strong>: è¤‡æ•°ã®ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ã‚’çµ„ã¿åˆã‚ã›ã‚‹</li>
<li><strong>ã‚¿ã‚¤ãƒãƒ¼ç®¡ç†</strong>: çµŒéæ™‚é–“ã‚’ç©ç®—ã—ã¦ä¸€å®šé–“éš”ã§å‡¦ç†ã‚’å®Ÿè¡Œ</li>
<li><strong>ç€åœ°åˆ¤å®š</strong>: <code>canMoveDown</code> ã§ä¸‹æ–¹å‘ã®ç§»å‹•å¯èƒ½æ€§ã‚’ãƒã‚§ãƒƒã‚¯</li>
<li><strong>ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³æ¼”ç®—å­</strong>: è¤‡æ•°ã® <code>setCell</code> ã‚’é€£é–ã•ã›ã¦ãƒœãƒ¼ãƒ‰ã‚’æ›´æ–°</li>
</ul>
<p>æ¬¡ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ã€ã·ã‚ˆã®é«˜é€Ÿè½ä¸‹æ©Ÿèƒ½ï¼ˆä¸‹çŸ¢å°ã‚­ãƒ¼ã§ç´ æ—©ãè½ã¨ã™ï¼‰ã‚’å®Ÿè£…ã—ã¾ã™ï¼</p>
<h2 id="5">ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³5: ã·ã‚ˆã®é«˜é€Ÿè½ä¸‹ã®å®Ÿè£…<a class="headerlink" href="#5" title="Permanent link">&para;</a></h2>
<p>ã€Œã·ã‚ˆãŒè‡ªå‹•ã§è½ã¡ã‚‹ã‚ˆã†ã«ãªã£ãŸã‘ã©ã€ã‚‚ã£ã¨æ—©ãè½ã¨ã—ãŸã„ã¨ãã¯ã©ã†ã™ã‚‹ã‚“ã§ã™ã‹ï¼Ÿã€è‰¯ã„è³ªå•ã§ã™ã­ï¼ã·ã‚ˆã·ã‚ˆã§ã¯ã€ä¸‹çŸ¢å°ã‚­ãƒ¼ã‚’æŠ¼ã™ã“ã¨ã§ã·ã‚ˆã‚’ç´ æ—©ãè½ã¨ã™ã“ã¨ãŒã§ãã¾ã™ã€‚ä»Šå›ã¯ã€ãã®ã€Œé«˜é€Ÿè½ä¸‹ã€æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¦ã„ãã¾ã—ã‚‡ã†ï¼</p>
<h3 id="_48">ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼<a class="headerlink" href="#_48" title="Permanent link">&para;</a></h3>
<p>ã¾ãšã¯ã€ã“ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§å®Ÿè£…ã™ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚’ç¢ºèªã—ã¾ã—ã‚‡ã†ï¼š</p>
<blockquote>
<p>ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¨ã—ã¦ã€ä¸‹çŸ¢å°ã‚­ãƒ¼ã‚’æŠ¼ã—ã¦ã·ã‚ˆã‚’ç´ æ—©ãè½ã¨ã›ã‚‹</p>
</blockquote>
<p>ã€Œæ—©ãæ¬¡ã®ã·ã‚ˆã‚’å‡ºã—ãŸã„ï¼ã€ã¨ã„ã†ã¨ãã«ã€ä¸‹ã‚­ãƒ¼ã‚’æŠ¼ã—ã¦ç´ æ—©ãè½ä¸‹ã•ã›ã‚‹æ©Ÿèƒ½ã¯ã€ã‚²ãƒ¼ãƒ ã®ãƒ†ãƒ³ãƒã‚’è‰¯ãã™ã‚‹ãŸã‚ã«é‡è¦ã§ã™ã­ã€‚</p>
<h3 id="todo_4">TODOãƒªã‚¹ãƒˆ<a class="headerlink" href="#todo_4" title="Permanent link">&para;</a></h3>
<p>ã€Œã©ã‚“ãªä½œæ¥­ãŒå¿…è¦ã«ãªã‚Šã¾ã™ã‹ï¼Ÿã€ã“ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚’å®Ÿç¾ã™ã‚‹ãŸã‚ã«ã€TODOãƒªã‚¹ãƒˆã‚’ä½œæˆã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</p>
<p>ã€Œã·ã‚ˆã‚’ç´ æ—©ãè½ä¸‹ã•ã›ã‚‹ã€ã¨ã„ã†æ©Ÿèƒ½ã‚’å®Ÿç¾ã™ã‚‹ãŸã‚ã«ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ãªã‚¿ã‚¹ã‚¯ãŒå¿…è¦ãã†ã§ã™ã­ï¼š</p>
<ul>
<li>é«˜é€Ÿè½ä¸‹ãƒ•ãƒ©ã‚°ã‚’ Model ã«è¿½åŠ ã™ã‚‹</li>
<li>ä¸‹ã‚­ãƒ¼å…¥åŠ›ã®æ¤œå‡ºã‚’å®Ÿè£…ã™ã‚‹ï¼ˆä¸‹çŸ¢å°ã‚­ãƒ¼ãŒæŠ¼ã•ã‚ŒãŸã“ã¨ã‚’æ¤œçŸ¥ã™ã‚‹ï¼‰</li>
<li>é«˜é€Ÿè½ä¸‹å‡¦ç†ã‚’å®Ÿè£…ã™ã‚‹ï¼ˆä¸‹ã‚­ãƒ¼ãŒæŠ¼ã•ã‚Œã¦ã„ã‚‹é–“ã¯è½ä¸‹é€Ÿåº¦ã‚’ä¸Šã’ã‚‹ï¼‰</li>
<li>ã‚­ãƒ¼ãŒé›¢ã•ã‚ŒãŸã¨ãã®å‡¦ç†ã‚’å®Ÿè£…ã™ã‚‹ï¼ˆå…ƒã®é€Ÿåº¦ã«æˆ»ã™ï¼‰</li>
</ul>
<p>ã€Œãªã‚‹ã»ã©ã€é †ç•ªã«å®Ÿè£…ã—ã¦ã„ã‘ã°ã„ã„ã‚“ã§ã™ã­ï¼ã€ãã†ã§ã™ã€ä¸€ã¤ãšã¤é€²ã‚ã¦ã„ãã¾ã—ã‚‡ã†ã€‚ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã®æµã‚Œã«æ²¿ã£ã¦ã€ã¾ãšã¯ãƒ†ã‚¹ãƒˆã‹ã‚‰æ›¸ã„ã¦ã„ãã¾ã™ã‚ˆã€‚</p>
<h3 id="_49">ãƒ†ã‚¹ãƒˆ: é«˜é€Ÿè½ä¸‹ãƒ•ãƒ©ã‚°<a class="headerlink" href="#_49" title="Permanent link">&para;</a></h3>
<p>ã€Œæœ€åˆã«ä½•ã‚’ãƒ†ã‚¹ãƒˆã™ã‚Œã°ã„ã„ã‚“ã§ã—ã‚‡ã†ã‹ï¼Ÿã€ã¾ãšã¯ã€é«˜é€Ÿè½ä¸‹ã®ãƒ•ãƒ©ã‚°ã‚’ç®¡ç†ã§ãã‚‹ã“ã¨ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã—ã‚‡ã†ã€‚</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- tests/MainTests.elmï¼ˆæ–°è¦ä½œæˆï¼‰</span>
<span class="kn">module</span><span class="w"> </span><span class="nc">MainTests</span><span class="w"> </span><span class="nv">exposing</span><span class="w"> </span><span class="p">(</span><span class="nv">suite</span><span class="p">)</span>

<span class="kn">import</span><span class="w"> </span><span class="nc">Board</span>
<span class="kn">import</span><span class="w"> </span><span class="nc">Expect</span>
<span class="kn">import</span><span class="w"> </span><span class="nc">Main</span><span class="w"> </span><span class="nv">exposing</span><span class="w"> </span><span class="nf">(..)</span>
<span class="kn">import</span><span class="w"> </span><span class="nc">PuyoColor</span><span class="w"> </span><span class="nv">exposing</span><span class="w"> </span><span class="p">(</span><span class="kt">PuyoColor</span><span class="nf">(..)</span><span class="p">)</span>
<span class="kn">import</span><span class="w"> </span><span class="nc">PuyoPair</span>
<span class="kn">import</span><span class="w"> </span><span class="nc">Test</span><span class="w"> </span><span class="nv">exposing</span><span class="w"> </span><span class="nf">(..)</span>


<span class="nv">suite</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Test</span>
<span class="nv">suite</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="nv">describe</span><span class="w"> </span><span class="s">&quot;Main&quot;</span>
<span class="w">        </span><span class="p">[</span><span class="w"> </span><span class="nv">describe</span><span class="w"> </span><span class="s">&quot;é«˜é€Ÿè½ä¸‹&quot;</span>
<span class="w">            </span><span class="p">[</span><span class="w"> </span><span class="nv">test</span><span class="w"> </span><span class="s">&quot;ä¸‹çŸ¢å°ã‚­ãƒ¼ã§é«˜é€Ÿè½ä¸‹ãƒ•ãƒ©ã‚°ãŒç«‹ã¤&quot;</span><span class="w"> </span><span class="nf">&lt;|</span>
<span class="w">                </span><span class="nf">\</span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="kr">let</span>
<span class="w">                        </span><span class="nv">initialModel</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="p">{</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="mi">12</span>
<span class="w">                            </span><span class="p">,</span><span class="w"> </span><span class="nv">currentPair</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Nothing</span>
<span class="w">                            </span><span class="p">,</span><span class="w"> </span><span class="nv">mode</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Start</span>
<span class="w">                            </span><span class="p">,</span><span class="w"> </span><span class="nv">dropTimer</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">                            </span><span class="p">,</span><span class="w"> </span><span class="nv">dropInterval</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="mi">1000</span>
<span class="w">                            </span><span class="p">,</span><span class="w"> </span><span class="nv">fastDropActive</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">False</span>
<span class="w">                            </span><span class="p">}</span>

<span class="w">                        </span><span class="p">(</span><span class="w"> </span><span class="nv">newModel</span><span class="p">,</span><span class="w"> </span><span class="nv">_</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="nv">update</span><span class="w"> </span><span class="p">(</span><span class="kt">KeyPressed</span><span class="w"> </span><span class="s">&quot;ArrowDown&quot;</span><span class="p">)</span><span class="w"> </span><span class="nv">initialModel</span>
<span class="w">                    </span><span class="kr">in</span>
<span class="w">                    </span><span class="nv">newModel</span><span class="nf">.</span><span class="nv">fastDropActive</span>
<span class="w">                        </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">equal</span><span class="w"> </span><span class="kt">True</span>
<span class="w">            </span><span class="p">,</span><span class="w"> </span><span class="nv">test</span><span class="w"> </span><span class="s">&quot;ä¸‹çŸ¢å°ã‚­ãƒ¼ä»¥å¤–ã§ã¯é«˜é€Ÿè½ä¸‹ãƒ•ãƒ©ã‚°ãŒç«‹ãŸãªã„&quot;</span><span class="w"> </span><span class="nf">&lt;|</span>
<span class="w">                </span><span class="nf">\</span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="kr">let</span>
<span class="w">                        </span><span class="nv">initialModel</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="p">{</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="mi">12</span>
<span class="w">                            </span><span class="p">,</span><span class="w"> </span><span class="nv">currentPair</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Nothing</span>
<span class="w">                            </span><span class="p">,</span><span class="w"> </span><span class="nv">mode</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Start</span>
<span class="w">                            </span><span class="p">,</span><span class="w"> </span><span class="nv">dropTimer</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">                            </span><span class="p">,</span><span class="w"> </span><span class="nv">dropInterval</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="mi">1000</span>
<span class="w">                            </span><span class="p">,</span><span class="w"> </span><span class="nv">fastDropActive</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">False</span>
<span class="w">                            </span><span class="p">}</span>

<span class="w">                        </span><span class="p">(</span><span class="w"> </span><span class="nv">newModel</span><span class="p">,</span><span class="w"> </span><span class="nv">_</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="nv">update</span><span class="w"> </span><span class="p">(</span><span class="kt">KeyPressed</span><span class="w"> </span><span class="s">&quot;ArrowLeft&quot;</span><span class="p">)</span><span class="w"> </span><span class="nv">initialModel</span>
<span class="w">                    </span><span class="kr">in</span>
<span class="w">                    </span><span class="nv">newModel</span><span class="nf">.</span><span class="nv">fastDropActive</span>
<span class="w">                        </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">equal</span><span class="w"> </span><span class="kt">False</span>
<span class="w">            </span><span class="p">]</span>
<span class="w">        </span><span class="p">]</span>
</code></pre></div>
<p>ã€Œã“ã®ãƒ†ã‚¹ãƒˆã§ã¯ä½•ã‚’ç¢ºèªã—ã¦ã„ã‚‹ã‚“ã§ã™ã‹ï¼Ÿã€ã“ã®ãƒ†ã‚¹ãƒˆã§ã¯ã€ä»¥ä¸‹ã®2ã¤ã®ã‚±ãƒ¼ã‚¹ã‚’ç¢ºèªã—ã¦ã„ã¾ã™ï¼š</p>
<ol>
<li>ä¸‹çŸ¢å°ã‚­ãƒ¼ãŒæŠ¼ã•ã‚ŒãŸã¨ãã« <code>fastDropActive</code> ãƒ•ãƒ©ã‚°ãŒ <code>True</code> ã«ãªã‚‹ã‹</li>
<li>ä»–ã®ã‚­ãƒ¼ãŒæŠ¼ã•ã‚ŒãŸã¨ãã«ã¯ <code>fastDropActive</code> ãƒ•ãƒ©ã‚°ãŒå¤‰ã‚ã‚‰ãªã„ã‹</li>
</ol>
<p>ã€Œãªã‚‹ã»ã©ã€é«˜é€Ÿè½ä¸‹ã®çŠ¶æ…‹ã‚’ç®¡ç†ã§ãã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹ã‚“ã§ã™ã­ï¼ã€ãã†ã§ã™ï¼ã§ã¯ã€ã“ã®ãƒ†ã‚¹ãƒˆãŒå¤±æ•—ã™ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ã‹ã‚‰ã€å®Ÿè£…ã«é€²ã¿ã¾ã—ã‚‡ã†ã€‚</p>
<h3 id="model-fastdropactive">å®Ÿè£…: Model ã¸ã® fastDropActive ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰è¿½åŠ <a class="headerlink" href="#model-fastdropactive" title="Permanent link">&para;</a></h3>
<p>ã¾ãšã€Model ã« <code>fastDropActive</code> ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’è¿½åŠ ã—ã¾ã™ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- src/Main.elm</span>
<span class="kr">type</span><span class="w"> </span><span class="kr">alias</span><span class="w"> </span><span class="kt">Model</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Board</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">currentPair</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Maybe</span><span class="w"> </span><span class="kt">PuyoPair</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">mode</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">GameMode</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">dropTimer</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Float</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">dropInterval</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Float</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">fastDropActive</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Bool</span><span class="w">  </span><span class="c1">-- è¿½åŠ </span>
<span class="w">    </span><span class="p">}</span>


<span class="nv">init</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Model</span>
<span class="nv">init</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="mi">12</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">currentPair</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Nothing</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">mode</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Start</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">dropTimer</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">dropInterval</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="mi">1000</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">fastDropActive</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">False</span><span class="w">  </span><span class="c1">-- è¿½åŠ </span>
<span class="w">    </span><span class="p">}</span>
</code></pre></div>
<h3 id="_50">å®Ÿè£…: ä¸‹çŸ¢å°ã‚­ãƒ¼ã®å‡¦ç†<a class="headerlink" href="#_50" title="Permanent link">&para;</a></h3>
<p>æ¬¡ã«ã€ä¸‹çŸ¢å°ã‚­ãƒ¼ãŒæŠ¼ã•ã‚ŒãŸã¨ãã« <code>fastDropActive</code> ãƒ•ãƒ©ã‚°ã‚’ç«‹ã¦ã‚‹å‡¦ç†ã‚’å®Ÿè£…ã—ã¾ã™ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- src/Main.elmï¼ˆupdate é–¢æ•°ã®ä¿®æ­£ï¼‰</span>
<span class="nv">update</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Msg</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Model</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="kt">Model</span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="w"> </span><span class="kt">Msg</span><span class="w"> </span><span class="p">)</span>
<span class="nv">update</span><span class="w"> </span><span class="nv">msg</span><span class="w"> </span><span class="nv">model</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="kr">case</span><span class="w"> </span><span class="nv">msg</span><span class="w"> </span><span class="kr">of</span>
<span class="w">        </span><span class="kt">StartGame</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="p">(</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">model</span>
<span class="w">                </span><span class="nf">|</span><span class="w"> </span><span class="nv">mode</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Playing</span>
<span class="w">                </span><span class="p">,</span><span class="w"> </span><span class="nv">currentPair</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Just</span><span class="w"> </span><span class="p">(</span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="kt">Red</span><span class="w"> </span><span class="kt">Blue</span><span class="p">)</span>
<span class="w">              </span><span class="p">}</span>
<span class="w">            </span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="nf">.</span><span class="nv">none</span>
<span class="w">            </span><span class="p">)</span>

<span class="w">        </span><span class="kt">KeyPressed</span><span class="w"> </span><span class="nv">key</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="kr">case</span><span class="w"> </span><span class="nv">key</span><span class="w"> </span><span class="kr">of</span>
<span class="w">                </span><span class="s">&quot;ArrowDown&quot;</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="c1">-- é«˜é€Ÿè½ä¸‹ãƒ•ãƒ©ã‚°ã‚’ç«‹ã¦ã‚‹</span>
<span class="w">                    </span><span class="p">(</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">model</span><span class="w"> </span><span class="nf">|</span><span class="w"> </span><span class="nv">fastDropActive</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">True</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="kt">Cmd</span><span class="nf">.</span><span class="nv">none</span><span class="w"> </span><span class="p">)</span>

<span class="w">                </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="c1">-- ãã®ä»–ã®ã‚­ãƒ¼å‡¦ç†</span>
<span class="w">                    </span><span class="kr">case</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">mode</span><span class="p">,</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">currentPair</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="kr">of</span>
<span class="w">                        </span><span class="p">(</span><span class="w"> </span><span class="kt">Playing</span><span class="p">,</span><span class="w"> </span><span class="kt">Just</span><span class="w"> </span><span class="nv">pair</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                            </span><span class="kr">let</span>
<span class="w">                                </span><span class="nv">newPair</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                                    </span><span class="kr">case</span><span class="w"> </span><span class="nv">key</span><span class="w"> </span><span class="kr">of</span>
<span class="w">                                        </span><span class="s">&quot;ArrowLeft&quot;</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                                            </span><span class="kr">let</span>
<span class="w">                                                </span><span class="nv">movedPair</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                                                    </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">moveLeft</span><span class="w"> </span><span class="nv">pair</span>
<span class="w">                                            </span><span class="kr">in</span>
<span class="w">                                            </span><span class="kr">if</span><span class="w"> </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">canMove</span><span class="w"> </span><span class="nv">movedPair</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">board</span><span class="w"> </span><span class="kr">then</span>
<span class="w">                                                </span><span class="nv">movedPair</span>

<span class="w">                                            </span><span class="kr">else</span>
<span class="w">                                                </span><span class="nv">pair</span>

<span class="w">                                        </span><span class="s">&quot;ArrowRight&quot;</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                                            </span><span class="kr">let</span>
<span class="w">                                                </span><span class="nv">movedPair</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                                                    </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">moveRight</span><span class="w"> </span><span class="nv">pair</span>
<span class="w">                                            </span><span class="kr">in</span>
<span class="w">                                            </span><span class="kr">if</span><span class="w"> </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">canMove</span><span class="w"> </span><span class="nv">movedPair</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">board</span><span class="w"> </span><span class="kr">then</span>
<span class="w">                                                </span><span class="nv">movedPair</span>

<span class="w">                                            </span><span class="kr">else</span>
<span class="w">                                                </span><span class="nv">pair</span>

<span class="w">                                        </span><span class="s">&quot;ArrowUp&quot;</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                                            </span><span class="kr">let</span>
<span class="w">                                                </span><span class="p">(</span><span class="w"> </span><span class="nv">rotatedPair</span><span class="p">,</span><span class="w"> </span><span class="nv">_</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                                                    </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">rotateWithKick</span><span class="w"> </span><span class="nv">pair</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">board</span>
<span class="w">                                            </span><span class="kr">in</span>
<span class="w">                                            </span><span class="nv">rotatedPair</span>

<span class="w">                                        </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                                            </span><span class="nv">pair</span>
<span class="w">                            </span><span class="kr">in</span>
<span class="w">                            </span><span class="p">(</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">model</span><span class="w"> </span><span class="nf">|</span><span class="w"> </span><span class="nv">currentPair</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Just</span><span class="w"> </span><span class="nv">newPair</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="kt">Cmd</span><span class="nf">.</span><span class="nv">none</span><span class="w"> </span><span class="p">)</span>

<span class="w">                        </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                            </span><span class="p">(</span><span class="w"> </span><span class="nv">model</span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="nf">.</span><span class="nv">none</span><span class="w"> </span><span class="p">)</span>

<span class="w">        </span><span class="c1">-- æ—¢å­˜ã® Tick å‡¦ç†...</span>
<span class="w">        </span><span class="kt">Tick</span><span class="w"> </span><span class="nv">deltaTime</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="kr">case</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">mode</span><span class="p">,</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">currentPair</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="kr">of</span>
<span class="w">                </span><span class="p">(</span><span class="w"> </span><span class="kt">Playing</span><span class="p">,</span><span class="w"> </span><span class="kt">Just</span><span class="w"> </span><span class="nv">pair</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="kr">let</span>
<span class="w">                        </span><span class="nv">newTimer</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="nv">model</span><span class="nf">.</span><span class="nv">dropTimer</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="nv">deltaTime</span>
<span class="w">                    </span><span class="kr">in</span>
<span class="w">                    </span><span class="kr">if</span><span class="w"> </span><span class="nv">newTimer</span><span class="w"> </span><span class="nf">&gt;=</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">dropInterval</span><span class="w"> </span><span class="kr">then</span>
<span class="w">                        </span><span class="kr">if</span><span class="w"> </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">canMoveDown</span><span class="w"> </span><span class="nv">pair</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">board</span><span class="w"> </span><span class="kr">then</span>
<span class="w">                            </span><span class="p">(</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">model</span>
<span class="w">                                </span><span class="nf">|</span><span class="w"> </span><span class="nv">currentPair</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Just</span><span class="w"> </span><span class="p">(</span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">moveDown</span><span class="w"> </span><span class="nv">pair</span><span class="p">)</span>
<span class="w">                                </span><span class="p">,</span><span class="w"> </span><span class="nv">dropTimer</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">                              </span><span class="p">}</span>
<span class="w">                            </span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="nf">.</span><span class="nv">none</span>
<span class="w">                            </span><span class="p">)</span>

<span class="w">                        </span><span class="kr">else</span>
<span class="w">                            </span><span class="kr">let</span>
<span class="w">                                </span><span class="nv">newBoard</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                                    </span><span class="nv">model</span><span class="nf">.</span><span class="nv">board</span>
<span class="w">                                        </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">setCell</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">axis</span><span class="nf">.</span><span class="nv">x</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">axis</span><span class="nf">.</span><span class="nv">y</span><span class="w"> </span><span class="p">(</span><span class="kt">Filled</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">axisColor</span><span class="p">)</span>
<span class="w">                                        </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">setCell</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">child</span><span class="nf">.</span><span class="nv">x</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">child</span><span class="nf">.</span><span class="nv">y</span><span class="w"> </span><span class="p">(</span><span class="kt">Filled</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">childColor</span><span class="p">)</span>
<span class="w">                            </span><span class="kr">in</span>
<span class="w">                            </span><span class="p">(</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">model</span>
<span class="w">                                </span><span class="nf">|</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">newBoard</span>
<span class="w">                                </span><span class="p">,</span><span class="w"> </span><span class="nv">currentPair</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Just</span><span class="w"> </span><span class="p">(</span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="kt">Red</span><span class="w"> </span><span class="kt">Blue</span><span class="p">)</span>
<span class="w">                                </span><span class="p">,</span><span class="w"> </span><span class="nv">dropTimer</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">                              </span><span class="p">}</span>
<span class="w">                            </span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="nf">.</span><span class="nv">none</span>
<span class="w">                            </span><span class="p">)</span>

<span class="w">                    </span><span class="kr">else</span>
<span class="w">                        </span><span class="p">(</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">model</span><span class="w"> </span><span class="nf">|</span><span class="w"> </span><span class="nv">dropTimer</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">newTimer</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="kt">Cmd</span><span class="nf">.</span><span class="nv">none</span><span class="w"> </span><span class="p">)</span>

<span class="w">                </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="p">(</span><span class="w"> </span><span class="nv">model</span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="nf">.</span><span class="nv">none</span><span class="w"> </span><span class="p">)</span>

<span class="w">        </span><span class="kt">NoOp</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="p">(</span><span class="w"> </span><span class="nv">model</span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="nf">.</span><span class="nv">none</span><span class="w"> </span><span class="p">)</span>
</code></pre></div>
<p>ã€Œãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼ã€ãã†ã§ã™ã­ã€‚ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ï¼š</p>
<div class="highlight"><pre><span></span><code>elm-test
</code></pre></div>
<p>ã€Œã‚„ã£ãŸï¼ãƒ†ã‚¹ãƒˆãŒé€šã‚Šã¾ã—ãŸï¼ã€ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼ä¸‹çŸ¢å°ã‚­ãƒ¼ã§é«˜é€Ÿè½ä¸‹ãƒ•ãƒ©ã‚°ãŒç«‹ã¤ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚</p>
<h3 id="_51">ãƒ†ã‚¹ãƒˆ: é«˜é€Ÿè½ä¸‹æ™‚ã®è½ä¸‹é€Ÿåº¦<a class="headerlink" href="#_51" title="Permanent link">&para;</a></h3>
<p>æ¬¡ã«ã€é«˜é€Ÿè½ä¸‹ãƒ•ãƒ©ã‚°ãŒç«‹ã£ã¦ã„ã‚‹ã¨ãã«å®Ÿéš›ã«è½ä¸‹é€Ÿåº¦ãŒä¸ŠãŒã‚‹ã“ã¨ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã—ã‚‡ã†ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- tests/MainTests.elmï¼ˆç¶šãï¼‰</span>
<span class="nv">suite</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Test</span>
<span class="nv">suite</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="nv">describe</span><span class="w"> </span><span class="s">&quot;Main&quot;</span>
<span class="w">        </span><span class="p">[</span><span class="w"> </span><span class="nv">describe</span><span class="w"> </span><span class="s">&quot;é«˜é€Ÿè½ä¸‹&quot;</span>
<span class="w">            </span><span class="p">[</span><span class="w"> </span><span class="c1">-- æ—¢å­˜ã®ãƒ†ã‚¹ãƒˆ...</span>
<span class="w">            </span><span class="p">,</span><span class="w"> </span><span class="nv">test</span><span class="w"> </span><span class="s">&quot;é«˜é€Ÿè½ä¸‹æ™‚ã¯è½ä¸‹é–“éš”ãŒçŸ­ããªã‚‹&quot;</span><span class="w"> </span><span class="nf">&lt;|</span>
<span class="w">                </span><span class="nf">\</span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="kr">let</span>
<span class="w">                        </span><span class="nv">model</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="p">{</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="mi">12</span>
<span class="w">                            </span><span class="p">,</span><span class="w"> </span><span class="nv">currentPair</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Just</span><span class="w"> </span><span class="p">(</span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="kt">Red</span><span class="w"> </span><span class="kt">Blue</span><span class="p">)</span>
<span class="w">                            </span><span class="p">,</span><span class="w"> </span><span class="nv">mode</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Playing</span>
<span class="w">                            </span><span class="p">,</span><span class="w"> </span><span class="nv">dropTimer</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">                            </span><span class="p">,</span><span class="w"> </span><span class="nv">dropInterval</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="mi">1000</span>
<span class="w">                            </span><span class="p">,</span><span class="w"> </span><span class="nv">fastDropActive</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">True</span>
<span class="w">                            </span><span class="p">}</span>

<span class="w">                        </span><span class="nv">effectiveInterval</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kr">if</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">fastDropActive</span><span class="w"> </span><span class="kr">then</span>
<span class="w">                                </span><span class="mi">50</span>

<span class="w">                            </span><span class="kr">else</span>
<span class="w">                                </span><span class="nv">model</span><span class="nf">.</span><span class="nv">dropInterval</span>
<span class="w">                    </span><span class="kr">in</span>
<span class="w">                    </span><span class="nv">effectiveInterval</span>
<span class="w">                        </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">equal</span><span class="w"> </span><span class="mi">50</span>
<span class="w">            </span><span class="p">]</span>
<span class="w">        </span><span class="p">]</span>
</code></pre></div>
<p>ã€Œã“ã®ãƒ†ã‚¹ãƒˆã§ã¯ä½•ã‚’ç¢ºèªã—ã¦ã„ã‚‹ã‚“ã§ã™ã‹ï¼Ÿã€ã“ã®ãƒ†ã‚¹ãƒˆã§ã¯ã€<code>fastDropActive</code> ãŒ <code>True</code> ã®ã¨ãã«ã€å®ŸåŠ¹çš„ãªè½ä¸‹é–“éš”ãŒçŸ­ãï¼ˆ50msï¼‰ãªã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ã„ã¾ã™ã€‚</p>
<h3 id="_52">å®Ÿè£…: é«˜é€Ÿè½ä¸‹æ™‚ã®è½ä¸‹é€Ÿåº¦å¤‰æ›´<a class="headerlink" href="#_52" title="Permanent link">&para;</a></h3>
<p>ã§ã¯ã€Tick ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®å‡¦ç†ã§ã€é«˜é€Ÿè½ä¸‹ãƒ•ãƒ©ã‚°ã«å¿œã˜ã¦è½ä¸‹é€Ÿåº¦ã‚’å¤‰æ›´ã—ã¾ã—ã‚‡ã†ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- src/Main.elmï¼ˆupdate é–¢æ•°ã® Tick å‡¦ç†ã‚’ä¿®æ­£ï¼‰</span>
<span class="nv">update</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Msg</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Model</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="kt">Model</span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="w"> </span><span class="kt">Msg</span><span class="w"> </span><span class="p">)</span>
<span class="nv">update</span><span class="w"> </span><span class="nv">msg</span><span class="w"> </span><span class="nv">model</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="kr">case</span><span class="w"> </span><span class="nv">msg</span><span class="w"> </span><span class="kr">of</span>
<span class="w">        </span><span class="c1">-- æ—¢å­˜ã®å‡¦ç†...</span>

<span class="w">        </span><span class="kt">Tick</span><span class="w"> </span><span class="nv">deltaTime</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="kr">case</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">mode</span><span class="p">,</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">currentPair</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="kr">of</span>
<span class="w">                </span><span class="p">(</span><span class="w"> </span><span class="kt">Playing</span><span class="p">,</span><span class="w"> </span><span class="kt">Just</span><span class="w"> </span><span class="nv">pair</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="kr">let</span>
<span class="w">                        </span><span class="c1">-- é«˜é€Ÿè½ä¸‹æ™‚ã¯è½ä¸‹é–“éš”ã‚’çŸ­ãã™ã‚‹</span>
<span class="w">                        </span><span class="nv">effectiveInterval</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kr">if</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">fastDropActive</span><span class="w"> </span><span class="kr">then</span>
<span class="w">                                </span><span class="mi">50</span>

<span class="w">                            </span><span class="kr">else</span>
<span class="w">                                </span><span class="nv">model</span><span class="nf">.</span><span class="nv">dropInterval</span>

<span class="w">                        </span><span class="nv">newTimer</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="nv">model</span><span class="nf">.</span><span class="nv">dropTimer</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="nv">deltaTime</span>
<span class="w">                    </span><span class="kr">in</span>
<span class="w">                    </span><span class="kr">if</span><span class="w"> </span><span class="nv">newTimer</span><span class="w"> </span><span class="nf">&gt;=</span><span class="w"> </span><span class="nv">effectiveInterval</span><span class="w"> </span><span class="kr">then</span>
<span class="w">                        </span><span class="kr">if</span><span class="w"> </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">canMoveDown</span><span class="w"> </span><span class="nv">pair</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">board</span><span class="w"> </span><span class="kr">then</span>
<span class="w">                            </span><span class="p">(</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">model</span>
<span class="w">                                </span><span class="nf">|</span><span class="w"> </span><span class="nv">currentPair</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Just</span><span class="w"> </span><span class="p">(</span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">moveDown</span><span class="w"> </span><span class="nv">pair</span><span class="p">)</span>
<span class="w">                                </span><span class="p">,</span><span class="w"> </span><span class="nv">dropTimer</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">                              </span><span class="p">}</span>
<span class="w">                            </span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="nf">.</span><span class="nv">none</span>
<span class="w">                            </span><span class="p">)</span>

<span class="w">                        </span><span class="kr">else</span>
<span class="w">                            </span><span class="kr">let</span>
<span class="w">                                </span><span class="nv">newBoard</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                                    </span><span class="nv">model</span><span class="nf">.</span><span class="nv">board</span>
<span class="w">                                        </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">setCell</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">axis</span><span class="nf">.</span><span class="nv">x</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">axis</span><span class="nf">.</span><span class="nv">y</span><span class="w"> </span><span class="p">(</span><span class="kt">Filled</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">axisColor</span><span class="p">)</span>
<span class="w">                                        </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">setCell</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">child</span><span class="nf">.</span><span class="nv">x</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">child</span><span class="nf">.</span><span class="nv">y</span><span class="w"> </span><span class="p">(</span><span class="kt">Filled</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">childColor</span><span class="p">)</span>
<span class="w">                            </span><span class="kr">in</span>
<span class="w">                            </span><span class="p">(</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">model</span>
<span class="w">                                </span><span class="nf">|</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">newBoard</span>
<span class="w">                                </span><span class="p">,</span><span class="w"> </span><span class="nv">currentPair</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Just</span><span class="w"> </span><span class="p">(</span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="kt">Red</span><span class="w"> </span><span class="kt">Blue</span><span class="p">)</span>
<span class="w">                                </span><span class="p">,</span><span class="w"> </span><span class="nv">dropTimer</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">                                </span><span class="p">,</span><span class="w"> </span><span class="nv">fastDropActive</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">False</span><span class="w">  </span><span class="c1">-- ç€åœ°æ™‚ã«é«˜é€Ÿè½ä¸‹ã‚’ãƒªã‚»ãƒƒãƒˆ</span>
<span class="w">                              </span><span class="p">}</span>
<span class="w">                            </span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="nf">.</span><span class="nv">none</span>
<span class="w">                            </span><span class="p">)</span>

<span class="w">                    </span><span class="kr">else</span>
<span class="w">                        </span><span class="p">(</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">model</span><span class="w"> </span><span class="nf">|</span><span class="w"> </span><span class="nv">dropTimer</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">newTimer</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="kt">Cmd</span><span class="nf">.</span><span class="nv">none</span><span class="w"> </span><span class="p">)</span>

<span class="w">                </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="p">(</span><span class="w"> </span><span class="nv">model</span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="nf">.</span><span class="nv">none</span><span class="w"> </span><span class="p">)</span>

<span class="w">        </span><span class="kt">NoOp</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="p">(</span><span class="w"> </span><span class="nv">model</span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="nf">.</span><span class="nv">none</span><span class="w"> </span><span class="p">)</span>
</code></pre></div>
<p>ã€ŒeffectiveInterval ã‚’ä½¿ã£ã¦è½ä¸‹é€Ÿåº¦ã‚’å¤‰ãˆã¦ã„ã‚‹ã‚“ã§ã™ã­ï¼ã€ãã†ã§ã™ï¼<code>fastDropActive</code> ãŒ <code>True</code> ã®å ´åˆã¯ 50msã€ãã†ã§ãªã„å ´åˆã¯é€šå¸¸ã® 1000ms ã‚’ä½¿ã„ã¾ã™ã€‚ã¾ãŸã€ã·ã‚ˆãŒç€åœ°ã—ãŸã¨ãã« <code>fastDropActive</code> ã‚’ <code>False</code> ã«ãƒªã‚»ãƒƒãƒˆã™ã‚‹ã“ã¨ã§ã€æ¬¡ã®ã·ã‚ˆã¯é€šå¸¸é€Ÿåº¦ã§è½ä¸‹ã—ã¾ã™ã€‚</p>
<h3 id="_53">ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®å®Ÿè¡Œ<a class="headerlink" href="#_53" title="Permanent link">&para;</a></h3>
<p>ã§ã¯ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼š</p>
<div class="highlight"><pre><span></span><code>elm<span class="w"> </span>reactor
</code></pre></div>
<p>ãƒ–ãƒ©ã‚¦ã‚¶ã§ <code>http://localhost:8000</code> ã‚’é–‹ãã€<code>src/Main.elm</code> ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚ã€Œã‚²ãƒ¼ãƒ é–‹å§‹ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã€ä¸‹çŸ¢å°ã‚­ãƒ¼ã‚’æŠ¼ã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼</p>
<p>ã€Œæœ¬å½“ã ï¼ä¸‹çŸ¢å°ã‚­ãƒ¼ã‚’æŠ¼ã™ã¨ã·ã‚ˆãŒã™ã”ãé€Ÿãè½ã¡ã¾ã™ï¼ã€ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼é«˜é€Ÿè½ä¸‹æ©Ÿèƒ½ãŒå®Ÿè£…ã§ãã¾ã—ãŸã­ã€‚</p>
<h3 id="5_1">ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³5ã®ã¾ã¨ã‚<a class="headerlink" href="#5_1" title="Permanent link">&para;</a></h3>
<p>ã“ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§å®Ÿè£…ã—ãŸå†…å®¹ï¼š</p>
<ol>
<li><strong>é«˜é€Ÿè½ä¸‹ãƒ•ãƒ©ã‚°ã®è¿½åŠ </strong></li>
<li><code>fastDropActive : Bool</code> ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ Model ã«è¿½åŠ </li>
<li>
<p>ä¸‹çŸ¢å°ã‚­ãƒ¼ã§ <code>True</code> ã«è¨­å®š</p>
</li>
<li>
<p><strong>é«˜é€Ÿè½ä¸‹ã®å®Ÿè£…</strong></p>
</li>
<li><code>effectiveInterval</code>: é«˜é€Ÿè½ä¸‹æ™‚ã¯ 50msã€é€šå¸¸æ™‚ã¯ 1000ms</li>
<li>Tick ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã§ <code>effectiveInterval</code> ã‚’ä½¿ã£ã¦è½ä¸‹åˆ¤å®š</li>
<li>
<p>ç€åœ°æ™‚ã« <code>fastDropActive</code> ã‚’ãƒªã‚»ãƒƒãƒˆ</p>
</li>
<li>
<p><strong>ãƒ†ã‚¹ãƒˆã®ä½œæˆ</strong></p>
</li>
<li>é«˜é€Ÿè½ä¸‹ãƒ•ãƒ©ã‚°ã®ãƒ†ã‚¹ãƒˆï¼ˆ2ãƒ†ã‚¹ãƒˆï¼‰</li>
<li>é«˜é€Ÿè½ä¸‹æ™‚ã®è½ä¸‹é–“éš”ã®ãƒ†ã‚¹ãƒˆï¼ˆ1ãƒ†ã‚¹ãƒˆï¼‰</li>
</ol>
<h3 id="_54">å­¦ã‚“ã ã“ã¨<a class="headerlink" href="#_54" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>æ¡ä»¶åˆ†å²ã«ã‚ˆã‚‹é€Ÿåº¦å¤‰æ›´</strong>: <code>if</code> å¼ã§çŠ¶æ…‹ã«å¿œã˜ãŸå€¤ã‚’é¸æŠ</li>
<li><strong>ãƒ•ãƒ©ã‚°ã®ãƒªã‚»ãƒƒãƒˆ</strong>: ç€åœ°æ™‚ã«é«˜é€Ÿè½ä¸‹ãƒ•ãƒ©ã‚°ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¦æ¬¡ã®ã·ã‚ˆã«å½±éŸ¿ã—ãªã„ã‚ˆã†ã«ã™ã‚‹</li>
<li><strong>let å¼ã§ã®å±€æ‰€å¤‰æ•°</strong>: <code>effectiveInterval</code> ã®ã‚ˆã†ãªè¨ˆç®—çµæœã‚’ä¸€æ™‚çš„ã«ä¿æŒ</li>
</ul>
<p>æ¬¡ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ã€ã·ã‚ˆã®æ¶ˆå»æ©Ÿèƒ½ï¼ˆåŒã˜è‰²ã®ã·ã‚ˆãŒ4ã¤ä»¥ä¸Šã¤ãªãŒã£ãŸã‚‰æ¶ˆãˆã‚‹ï¼‰ã‚’å®Ÿè£…ã—ã¾ã™ï¼</p>
<h2 id="6">ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³6: ã·ã‚ˆã®æ¶ˆå»ã®å®Ÿè£…<a class="headerlink" href="#6" title="Permanent link">&para;</a></h2>
<p>ã€Œã·ã‚ˆãŒè½ã¡ã¦ãã‚‹ã‚ˆã†ã«ãªã£ãŸã‘ã©ã€ã·ã‚ˆã·ã‚ˆã®é†é†å‘³ã¯ã·ã‚ˆã‚’æ¶ˆã™ã“ã¨ã§ã™ã‚ˆã­ï¼Ÿã€ãã†ã§ã™ã­ï¼ã·ã‚ˆã·ã‚ˆã®æœ€ã‚‚é‡è¦ãªè¦ç´ ã®ä¸€ã¤ã¯ã€åŒã˜è‰²ã®ã·ã‚ˆã‚’4ã¤ä»¥ä¸Šã¤ãªã’ã‚‹ã¨æ¶ˆå»ã§ãã‚‹æ©Ÿèƒ½ã§ã™ã€‚ä»Šå›ã¯ã€ãã®ã€Œã·ã‚ˆã®æ¶ˆå»ã€æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¦ã„ãã¾ã—ã‚‡ã†ï¼</p>
<h3 id="_55">ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼<a class="headerlink" href="#_55" title="Permanent link">&para;</a></h3>
<p>ã¾ãšã¯ã€ã“ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§å®Ÿè£…ã™ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚’ç¢ºèªã—ã¾ã—ã‚‡ã†ï¼š</p>
<blockquote>
<p>ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¨ã—ã¦ã€åŒã˜è‰²ã®ã·ã‚ˆã‚’4ã¤ä»¥ä¸Šã¤ãªã’ã‚‹ã¨æ¶ˆå»ã§ãã‚‹</p>
</blockquote>
<p>ã€Œã“ã‚ŒãŒã·ã‚ˆã·ã‚ˆã®åŸºæœ¬ãƒ«ãƒ¼ãƒ«ã§ã™ã­ï¼ã€ãã†ã§ã™ï¼åŒã˜è‰²ã®ã·ã‚ˆã‚’4ã¤ä»¥ä¸Šã¤ãªã’ã‚‹ã¨æ¶ˆå»ã§ãã‚‹ã¨ã„ã†ã®ãŒã€ã·ã‚ˆã·ã‚ˆã®åŸºæœ¬çš„ãªãƒ«ãƒ¼ãƒ«ã§ã™ã€‚ã“ã‚Œã‚’å®Ÿè£…ã™ã‚‹ã“ã¨ã§ã€ã‚²ãƒ¼ãƒ ã¨ã—ã¦ã®é¢ç™½ã•ãŒå¤§ããå‘ä¸Šã—ã¾ã™ã­ã€‚</p>
<h3 id="todo_5">TODOãƒªã‚¹ãƒˆ<a class="headerlink" href="#todo_5" title="Permanent link">&para;</a></h3>
<p>ã€Œã©ã‚“ãªä½œæ¥­ãŒå¿…è¦ã«ãªã‚Šã¾ã™ã‹ï¼Ÿã€ã“ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚’å®Ÿç¾ã™ã‚‹ãŸã‚ã«ã€TODOãƒªã‚¹ãƒˆã‚’ä½œæˆã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</p>
<p>ã€Œã·ã‚ˆã‚’æ¶ˆå»ã™ã‚‹ã€ã¨ã„ã†æ©Ÿèƒ½ã‚’å®Ÿç¾ã™ã‚‹ãŸã‚ã«ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ãªã‚¿ã‚¹ã‚¯ãŒå¿…è¦ãã†ã§ã™ã­ï¼š</p>
<ul>
<li>é€£çµã—ãŸã·ã‚ˆã‚’æ¢ç´¢ã™ã‚‹æ©Ÿèƒ½ã‚’å®Ÿè£…ã™ã‚‹ï¼ˆæ·±ã•å„ªå…ˆæ¢ç´¢ï¼‰</li>
<li>4ã¤ä»¥ä¸Šã¤ãªãŒã£ãŸã·ã‚ˆã‚’æ¤œå‡ºã™ã‚‹æ©Ÿèƒ½ã‚’å®Ÿè£…ã™ã‚‹</li>
<li>ã·ã‚ˆã‚’æ¶ˆå»ã™ã‚‹æ©Ÿèƒ½ã‚’å®Ÿè£…ã™ã‚‹</li>
<li>æ¶ˆå»å¾Œã«ä¸Šã®ã·ã‚ˆã‚’è½ä¸‹ã•ã›ã‚‹æ©Ÿèƒ½ã‚’å®Ÿè£…ã™ã‚‹</li>
<li>ç€åœ°å¾Œã«æ¶ˆå»åˆ¤å®šã‚’è¡Œã†</li>
</ul>
<p>ã€Œãªã‚‹ã»ã©ã€é †ç•ªã«å®Ÿè£…ã—ã¦ã„ã‘ã°ã„ã„ã‚“ã§ã™ã­ï¼ã€ãã†ã§ã™ã€ä¸€ã¤ãšã¤é€²ã‚ã¦ã„ãã¾ã—ã‚‡ã†ã€‚ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã®æµã‚Œã«æ²¿ã£ã¦ã€ã¾ãšã¯ãƒ†ã‚¹ãƒˆã‹ã‚‰æ›¸ã„ã¦ã„ãã¾ã™ã‚ˆã€‚</p>
<h3 id="_56">ãƒ†ã‚¹ãƒˆ: é€£çµã—ãŸã·ã‚ˆã®æ¢ç´¢<a class="headerlink" href="#_56" title="Permanent link">&para;</a></h3>
<p>ã€Œæœ€åˆã«ä½•ã‚’ãƒ†ã‚¹ãƒˆã™ã‚Œã°ã„ã„ã‚“ã§ã—ã‚‡ã†ã‹ï¼Ÿã€ã¾ãšã¯ã€é€£çµã—ãŸã·ã‚ˆã‚’æ¢ç´¢ã™ã‚‹æ©Ÿèƒ½ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã—ã‚‡ã†ã€‚</p>
<p>æ–°ã—ã„ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« <code>GameLogic</code> ã‚’ä½œæˆã—ã¦ã€ãã“ã«é€£çµåˆ¤å®šã®ãƒ­ã‚¸ãƒƒã‚¯ã‚’å®Ÿè£…ã—ã¾ã™ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- tests/GameLogicTests.elmï¼ˆæ–°è¦ä½œæˆï¼‰</span>
<span class="kn">module</span><span class="w"> </span><span class="nc">GameLogicTests</span><span class="w"> </span><span class="nv">exposing</span><span class="w"> </span><span class="p">(</span><span class="nv">suite</span><span class="p">)</span>

<span class="kn">import</span><span class="w"> </span><span class="nc">Board</span>
<span class="kn">import</span><span class="w"> </span><span class="nc">Cell</span><span class="w"> </span><span class="nv">exposing</span><span class="w"> </span><span class="p">(</span><span class="kt">Cell</span><span class="nf">(..)</span><span class="p">)</span>
<span class="kn">import</span><span class="w"> </span><span class="nc">Expect</span>
<span class="kn">import</span><span class="w"> </span><span class="nc">GameLogic</span>
<span class="kn">import</span><span class="w"> </span><span class="nc">PuyoColor</span><span class="w"> </span><span class="nv">exposing</span><span class="w"> </span><span class="p">(</span><span class="kt">PuyoColor</span><span class="nf">(..)</span><span class="p">)</span>
<span class="kn">import</span><span class="w"> </span><span class="nc">Set</span>
<span class="kn">import</span><span class="w"> </span><span class="nc">Test</span><span class="w"> </span><span class="nv">exposing</span><span class="w"> </span><span class="nf">(..)</span>


<span class="nv">suite</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Test</span>
<span class="nv">suite</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="nv">describe</span><span class="w"> </span><span class="s">&quot;GameLogic&quot;</span>
<span class="w">        </span><span class="p">[</span><span class="w"> </span><span class="nv">describe</span><span class="w"> </span><span class="s">&quot;findConnectedPuyos&quot;</span>
<span class="w">            </span><span class="p">[</span><span class="w"> </span><span class="nv">test</span><span class="w"> </span><span class="s">&quot;åŒã˜è‰²ã®ã·ã‚ˆãŒ4ã¤ã¤ãªãŒã£ã¦ã„ã‚‹å ´åˆã€4ã¤ã™ã¹ã¦ã‚’æ¤œå‡ºã™ã‚‹&quot;</span><span class="w"> </span><span class="nf">&lt;|</span>
<span class="w">                </span><span class="nf">\</span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="kr">let</span>
<span class="w">                        </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="mi">12</span>
<span class="w">                                </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">setCell</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">(</span><span class="kt">Filled</span><span class="w"> </span><span class="kt">Red</span><span class="p">)</span>
<span class="w">                                </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">setCell</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">(</span><span class="kt">Filled</span><span class="w"> </span><span class="kt">Red</span><span class="p">)</span>
<span class="w">                                </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">setCell</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="p">(</span><span class="kt">Filled</span><span class="w"> </span><span class="kt">Red</span><span class="p">)</span>
<span class="w">                                </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">setCell</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="p">(</span><span class="kt">Filled</span><span class="w"> </span><span class="kt">Red</span><span class="p">)</span>

<span class="w">                        </span><span class="nv">connected</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">GameLogic</span><span class="nf">.</span><span class="nv">findConnectedPuyos</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="kt">Red</span><span class="w"> </span><span class="nv">board</span>
<span class="w">                    </span><span class="kr">in</span>
<span class="w">                    </span><span class="kt">Set</span><span class="nf">.</span><span class="nv">size</span><span class="w"> </span><span class="nv">connected</span>
<span class="w">                        </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">equal</span><span class="w"> </span><span class="mi">4</span>
<span class="w">            </span><span class="p">,</span><span class="w"> </span><span class="nv">test</span><span class="w"> </span><span class="s">&quot;ç•°ãªã‚‹è‰²ã®ã·ã‚ˆã¯æ¥ç¶šã•ã‚Œãªã„&quot;</span><span class="w"> </span><span class="nf">&lt;|</span>
<span class="w">                </span><span class="nf">\</span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="kr">let</span>
<span class="w">                        </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="mi">12</span>
<span class="w">                                </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">setCell</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">(</span><span class="kt">Filled</span><span class="w"> </span><span class="kt">Red</span><span class="p">)</span>
<span class="w">                                </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">setCell</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">(</span><span class="kt">Filled</span><span class="w"> </span><span class="kt">Blue</span><span class="p">)</span>
<span class="w">                                </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">setCell</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="p">(</span><span class="kt">Filled</span><span class="w"> </span><span class="kt">Red</span><span class="p">)</span>
<span class="w">                                </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">setCell</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="p">(</span><span class="kt">Filled</span><span class="w"> </span><span class="kt">Red</span><span class="p">)</span>

<span class="w">                        </span><span class="nv">connected</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">GameLogic</span><span class="nf">.</span><span class="nv">findConnectedPuyos</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="kt">Red</span><span class="w"> </span><span class="nv">board</span>
<span class="w">                    </span><span class="kr">in</span>
<span class="w">                    </span><span class="kt">Set</span><span class="nf">.</span><span class="nv">size</span><span class="w"> </span><span class="nv">connected</span>
<span class="w">                        </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">equal</span><span class="w"> </span><span class="mi">3</span>
<span class="w">            </span><span class="p">,</span><span class="w"> </span><span class="nv">test</span><span class="w"> </span><span class="s">&quot;3ã¤ä»¥ä¸‹ã®ã¤ãªãŒã‚Šã‚‚æ­£ã—ãæ¤œå‡ºã™ã‚‹&quot;</span><span class="w"> </span><span class="nf">&lt;|</span>
<span class="w">                </span><span class="nf">\</span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="kr">let</span>
<span class="w">                        </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="mi">12</span>
<span class="w">                                </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">setCell</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">(</span><span class="kt">Filled</span><span class="w"> </span><span class="kt">Red</span><span class="p">)</span>
<span class="w">                                </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">setCell</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">(</span><span class="kt">Filled</span><span class="w"> </span><span class="kt">Red</span><span class="p">)</span>
<span class="w">                                </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">setCell</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">(</span><span class="kt">Filled</span><span class="w"> </span><span class="kt">Red</span><span class="p">)</span>

<span class="w">                        </span><span class="nv">connected</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">GameLogic</span><span class="nf">.</span><span class="nv">findConnectedPuyos</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="kt">Red</span><span class="w"> </span><span class="nv">board</span>
<span class="w">                    </span><span class="kr">in</span>
<span class="w">                    </span><span class="kt">Set</span><span class="nf">.</span><span class="nv">size</span><span class="w"> </span><span class="nv">connected</span>
<span class="w">                        </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">equal</span><span class="w"> </span><span class="mi">3</span>
<span class="w">            </span><span class="p">]</span>
<span class="w">        </span><span class="p">]</span>
</code></pre></div>
<p>ã€Œã“ã®ãƒ†ã‚¹ãƒˆã§ã¯ä½•ã‚’ç¢ºèªã—ã¦ã„ã‚‹ã‚“ã§ã™ã‹ï¼Ÿã€ã“ã®ãƒ†ã‚¹ãƒˆã§ã¯ã€ä»¥ä¸‹ã®3ã¤ã®ã‚±ãƒ¼ã‚¹ã‚’ç¢ºèªã—ã¦ã„ã¾ã™ï¼š</p>
<ol>
<li>åŒã˜è‰²ã®ã·ã‚ˆãŒ4ã¤ã¤ãªãŒã£ã¦ã„ã‚‹å ´åˆã€ã™ã¹ã¦æ¤œå‡ºã§ãã‚‹ã‹</li>
<li>ç•°ãªã‚‹è‰²ã®ã·ã‚ˆã¯æ¥ç¶šã•ã‚Œãªã„ã‹</li>
<li>3ã¤ä»¥ä¸‹ã®ã¤ãªãŒã‚Šã‚‚æ­£ã—ãæ¤œå‡ºã§ãã‚‹ã‹</li>
</ol>
<p>ã€Œãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã™ã‚‹ã¨å¤±æ•—ã—ã¾ã™ã‚ˆã­ï¼Ÿã€ãã†ã§ã™ï¼ã¾ã  <code>GameLogic</code> ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ä½œã£ã¦ã„ãªã„ã®ã§ã€ãƒ†ã‚¹ãƒˆã¯å¤±æ•—ã—ã¾ã™ã€‚ã“ã‚Œã‹ã‚‰å®Ÿè£…ã—ã¦ã„ãã¾ã—ã‚‡ã†ã€‚</p>
<h3 id="_57">å®Ÿè£…: æ·±ã•å„ªå…ˆæ¢ç´¢<a class="headerlink" href="#_57" title="Permanent link">&para;</a></h3>
<p>ã§ã¯ã€é€£çµã—ãŸã·ã‚ˆã‚’æ¢ç´¢ã™ã‚‹æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¾ã—ã‚‡ã†ã€‚æ·±ã•å„ªå…ˆæ¢ç´¢ï¼ˆDFS: Depth-First Searchï¼‰ã¨ã„ã†ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’ä½¿ã„ã¾ã™ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- src/GameLogic.elmï¼ˆæ–°è¦ä½œæˆï¼‰</span>
<span class="kn">module</span><span class="w"> </span><span class="nc">GameLogic</span><span class="w"> </span><span class="nv">exposing</span><span class="w"> </span><span class="p">(</span><span class="nv">findConnectedPuyos</span><span class="p">,</span><span class="w"> </span><span class="nv">erasePuyos</span><span class="p">,</span><span class="w"> </span><span class="nv">applyGravity</span><span class="p">)</span>

<span class="kn">import</span><span class="w"> </span><span class="nc">Board</span><span class="w"> </span><span class="nv">exposing</span><span class="w"> </span><span class="p">(</span><span class="kt">Board</span><span class="p">)</span>
<span class="kn">import</span><span class="w"> </span><span class="nc">Cell</span><span class="w"> </span><span class="nv">exposing</span><span class="w"> </span><span class="p">(</span><span class="kt">Cell</span><span class="nf">(..)</span><span class="p">)</span>
<span class="kn">import</span><span class="w"> </span><span class="nc">PuyoColor</span><span class="w"> </span><span class="nv">exposing</span><span class="w"> </span><span class="p">(</span><span class="kt">PuyoColor</span><span class="p">)</span>
<span class="kn">import</span><span class="w"> </span><span class="nc">Set</span><span class="w"> </span><span class="nv">exposing</span><span class="w"> </span><span class="p">(</span><span class="kt">Set</span><span class="p">)</span>


<span class="cm">{-| æŒ‡å®šä½ç½®ã‹ã‚‰é€£çµã—ã¦ã„ã‚‹åŒè‰²ã®ã·ã‚ˆã‚’æ¢ç´¢ã™ã‚‹</span>
<span class="cm">-}</span>
<span class="nv">findConnectedPuyos</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">PuyoColor</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Set</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="kt">Int</span><span class="p">,</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="p">)</span>
<span class="nv">findConnectedPuyos</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nv">color</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="nv">findConnectedHelper</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nv">color</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="kt">Set</span><span class="nf">.</span><span class="nv">empty</span>


<span class="cm">{-| å†å¸°çš„ã«é€£çµã·ã‚ˆã‚’æ¢ç´¢ã™ã‚‹ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°</span>
<span class="cm">-}</span>
<span class="nv">findConnectedHelper</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">PuyoColor</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Set</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="kt">Int</span><span class="p">,</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Set</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="kt">Int</span><span class="p">,</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="p">)</span>
<span class="nv">findConnectedHelper</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nv">color</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="nv">visited</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="c1">-- ã™ã§ã«è¨ªå•æ¸ˆã¿ã®å ´åˆã¯ä½•ã‚‚ã—ãªã„</span>
<span class="w">    </span><span class="kr">if</span><span class="w"> </span><span class="kt">Set</span><span class="nf">.</span><span class="nv">member</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nv">x</span><span class="p">,</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="nv">visited</span><span class="w"> </span><span class="kr">then</span>
<span class="w">        </span><span class="nv">visited</span>

<span class="w">    </span><span class="kr">else</span>
<span class="w">        </span><span class="kr">case</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">getCell</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="kr">of</span>
<span class="w">            </span><span class="kt">Just</span><span class="w"> </span><span class="p">(</span><span class="kt">Filled</span><span class="w"> </span><span class="nv">cellColor</span><span class="p">)</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                </span><span class="kr">if</span><span class="w"> </span><span class="nv">cellColor</span><span class="w"> </span><span class="nf">==</span><span class="w"> </span><span class="nv">color</span><span class="w"> </span><span class="kr">then</span>
<span class="w">                    </span><span class="kr">let</span>
<span class="w">                        </span><span class="c1">-- ç¾åœ¨ä½ç½®ã‚’è¨ªå•æ¸ˆã¿ã«è¿½åŠ </span>
<span class="w">                        </span><span class="nv">newVisited</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">Set</span><span class="nf">.</span><span class="nv">insert</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nv">x</span><span class="p">,</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="nv">visited</span>

<span class="w">                        </span><span class="c1">-- 4æ–¹å‘ï¼ˆä¸Šä¸‹å·¦å³ï¼‰ã‚’æ¢ç´¢</span>
<span class="w">                        </span><span class="nv">directions</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="p">[</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nf">-</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w">  </span><span class="c1">-- ä¸Š</span>
<span class="w">                            </span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w">   </span><span class="c1">-- ä¸‹</span>
<span class="w">                            </span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nf">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w">  </span><span class="c1">-- å·¦</span>
<span class="w">                            </span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w">   </span><span class="c1">-- å³</span>
<span class="w">                            </span><span class="p">]</span>

<span class="w">                        </span><span class="c1">-- å„æ–¹å‘ã‚’å†å¸°çš„ã«æ¢ç´¢</span>
<span class="w">                        </span><span class="nv">searchNeighbor</span><span class="w"> </span><span class="nv">visited2</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nv">dx</span><span class="p">,</span><span class="w"> </span><span class="nv">dy</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="nv">findConnectedHelper</span><span class="w"> </span><span class="p">(</span><span class="nv">x</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="nv">dx</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nv">y</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="nv">dy</span><span class="p">)</span><span class="w"> </span><span class="nv">color</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="nv">visited2</span>
<span class="w">                    </span><span class="kr">in</span>
<span class="w">                    </span><span class="kt">List</span><span class="nf">.</span><span class="nv">foldl</span><span class="w"> </span><span class="nv">searchNeighbor</span><span class="w"> </span><span class="nv">newVisited</span><span class="w"> </span><span class="nv">directions</span>

<span class="w">                </span><span class="kr">else</span>
<span class="w">                    </span><span class="c1">-- è‰²ãŒé•ã†å ´åˆã¯æ¢ç´¢ã—ãªã„</span>
<span class="w">                    </span><span class="nv">visited</span>

<span class="w">            </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                </span><span class="c1">-- ã‚»ãƒ«ãŒç©ºã‹ç¯„å›²å¤–ã®å ´åˆã¯æ¢ç´¢ã—ãªã„</span>
<span class="w">                </span><span class="nv">visited</span>
</code></pre></div>
<p>ã€Œå†å¸°çš„ãªé–¢æ•°ã§ã™ã­ï¼ã€ãã†ã§ã™ã€‚æ·±ã•å„ªå…ˆæ¢ç´¢ã¯å†å¸°ã‚’ä½¿ã£ã¦å®Ÿè£…ã™ã‚‹ã®ãŒè‡ªç„¶ã§ã™ã€‚ã“ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®ä»•çµ„ã¿ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ï¼š</p>
<ol>
<li><strong>è¨ªå•æ¸ˆã¿ãƒã‚§ãƒƒã‚¯</strong>: ã™ã§ã«è¨ªå•ã—ãŸä½ç½®ã¯å†åº¦æ¢ç´¢ã—ãªã„ï¼ˆç„¡é™ãƒ«ãƒ¼ãƒ—é˜²æ­¢ï¼‰</li>
<li><strong>è‰²ã®ãƒã‚§ãƒƒã‚¯</strong>: åŒã˜è‰²ã®ã·ã‚ˆã ã‘ã‚’æ¢ç´¢å¯¾è±¡ã«ã™ã‚‹</li>
<li><strong>4æ–¹å‘æ¢ç´¢</strong>: ä¸Šä¸‹å·¦å³ã®4æ–¹å‘ã‚’å†å¸°çš„ã«æ¢ç´¢</li>
<li><strong>Set ã§ç®¡ç†</strong>: è¨ªå•æ¸ˆã¿ä½ç½®ã‚’ Set ã§ç®¡ç†ã™ã‚‹ã“ã¨ã§ã€é‡è¤‡ã‚’è‡ªå‹•çš„ã«æ’é™¤</li>
</ol>
<p>ã€Œ<code>foldl</code> ã§4æ–¹å‘ã‚’é †ç•ªã«æ¢ç´¢ã—ã¦ã„ã‚‹ã‚“ã§ã™ã­ï¼ã€ãã†ã§ã™ï¼<code>foldl</code> ã‚’ä½¿ã†ã“ã¨ã§ã€å„æ–¹å‘ã®æ¢ç´¢çµæœã‚’ç´¯ç©ã—ã¦ã„ãã¾ã™ã€‚</p>
<h3 id="_58">ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œ<a class="headerlink" href="#_58" title="Permanent link">&para;</a></h3>
<p>ã§ã¯ã€ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼š</p>
<div class="highlight"><pre><span></span><code>elm-test
</code></pre></div>
<p>ã€Œã‚„ã£ãŸï¼ãƒ†ã‚¹ãƒˆãŒé€šã‚Šã¾ã—ãŸï¼ã€ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼é€£çµã—ãŸã·ã‚ˆã‚’æ¢ç´¢ã™ã‚‹æ©Ÿèƒ½ãŒå®Ÿè£…ã§ãã¾ã—ãŸã­ã€‚</p>
<h3 id="_59">ãƒ†ã‚¹ãƒˆ: ã·ã‚ˆã®æ¶ˆå»<a class="headerlink" href="#_59" title="Permanent link">&para;</a></h3>
<p>æ¬¡ã«ã€4ã¤ä»¥ä¸Šã¤ãªãŒã£ãŸã·ã‚ˆã‚’æ¶ˆå»ã™ã‚‹æ©Ÿèƒ½ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã—ã‚‡ã†ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- tests/GameLogicTests.elmï¼ˆç¶šãï¼‰</span>
<span class="nv">suite</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Test</span>
<span class="nv">suite</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="nv">describe</span><span class="w"> </span><span class="s">&quot;GameLogic&quot;</span>
<span class="w">        </span><span class="p">[</span><span class="w"> </span><span class="c1">-- æ—¢å­˜ã®ãƒ†ã‚¹ãƒˆ...</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">describe</span><span class="w"> </span><span class="s">&quot;erasePuyos&quot;</span>
<span class="w">            </span><span class="p">[</span><span class="w"> </span><span class="nv">test</span><span class="w"> </span><span class="s">&quot;æŒ‡å®šã—ãŸä½ç½®ã®ã·ã‚ˆã‚’æ¶ˆå»ã™ã‚‹&quot;</span><span class="w"> </span><span class="nf">&lt;|</span>
<span class="w">                </span><span class="nf">\</span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="kr">let</span>
<span class="w">                        </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="mi">12</span>
<span class="w">                                </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">setCell</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">(</span><span class="kt">Filled</span><span class="w"> </span><span class="kt">Red</span><span class="p">)</span>
<span class="w">                                </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">setCell</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">(</span><span class="kt">Filled</span><span class="w"> </span><span class="kt">Red</span><span class="p">)</span>
<span class="w">                                </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">setCell</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="p">(</span><span class="kt">Filled</span><span class="w"> </span><span class="kt">Red</span><span class="p">)</span>
<span class="w">                                </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">setCell</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="p">(</span><span class="kt">Filled</span><span class="w"> </span><span class="kt">Red</span><span class="p">)</span>

<span class="w">                        </span><span class="nv">positions</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">Set</span><span class="nf">.</span><span class="nv">fromList</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">]</span>

<span class="w">                        </span><span class="nv">newBoard</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">GameLogic</span><span class="nf">.</span><span class="nv">erasePuyos</span><span class="w"> </span><span class="nv">positions</span><span class="w"> </span><span class="nv">board</span>
<span class="w">                    </span><span class="kr">in</span>
<span class="w">                    </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">all</span>
<span class="w">                        </span><span class="p">[</span><span class="w"> </span><span class="nf">\</span><span class="nv">b</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">getCell</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="nv">b</span><span class="w"> </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">equal</span><span class="w"> </span><span class="p">(</span><span class="kt">Just</span><span class="w"> </span><span class="kt">Empty</span><span class="p">)</span>
<span class="w">                        </span><span class="p">,</span><span class="w"> </span><span class="nf">\</span><span class="nv">b</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">getCell</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="nv">b</span><span class="w"> </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">equal</span><span class="w"> </span><span class="p">(</span><span class="kt">Just</span><span class="w"> </span><span class="kt">Empty</span><span class="p">)</span>
<span class="w">                        </span><span class="p">,</span><span class="w"> </span><span class="nf">\</span><span class="nv">b</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">getCell</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="nv">b</span><span class="w"> </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">equal</span><span class="w"> </span><span class="p">(</span><span class="kt">Just</span><span class="w"> </span><span class="kt">Empty</span><span class="p">)</span>
<span class="w">                        </span><span class="p">,</span><span class="w"> </span><span class="nf">\</span><span class="nv">b</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">getCell</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="nv">b</span><span class="w"> </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">equal</span><span class="w"> </span><span class="p">(</span><span class="kt">Just</span><span class="w"> </span><span class="kt">Empty</span><span class="p">)</span>
<span class="w">                        </span><span class="p">]</span>
<span class="w">                        </span><span class="nv">newBoard</span>
<span class="w">            </span><span class="p">]</span>
<span class="w">        </span><span class="p">]</span>
</code></pre></div>
<p>ã€Œã“ã®ãƒ†ã‚¹ãƒˆã§ã¯ã€æŒ‡å®šã—ãŸä½ç½®ã®ã·ã‚ˆãŒç©ºã«ãªã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ã„ã‚‹ã‚“ã§ã™ã­ï¼ã€ãã†ã§ã™ï¼<code>Expect.all</code> ã‚’ä½¿ã£ã¦ã€4ã¤ã®ä½ç½®ã™ã¹ã¦ãŒ <code>Empty</code> ã«ãªã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ã„ã¾ã™ã€‚</p>
<h3 id="_60">å®Ÿè£…: ã·ã‚ˆã®æ¶ˆå»<a class="headerlink" href="#_60" title="Permanent link">&para;</a></h3>
<p>ã§ã¯ã€ã·ã‚ˆã‚’æ¶ˆå»ã™ã‚‹æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¾ã—ã‚‡ã†ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- src/GameLogic.elmï¼ˆç¶šãï¼‰</span>
<span class="cm">{-| æŒ‡å®šã—ãŸä½ç½®ã®ã·ã‚ˆã‚’æ¶ˆå»ã™ã‚‹</span>
<span class="cm">-}</span>
<span class="nv">erasePuyos</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Set</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="kt">Int</span><span class="p">,</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Board</span>
<span class="nv">erasePuyos</span><span class="w"> </span><span class="nv">positions</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="kt">Set</span><span class="nf">.</span><span class="nv">foldl</span>
<span class="w">        </span><span class="p">(</span><span class="nf">\</span><span class="p">(</span><span class="w"> </span><span class="nv">x</span><span class="p">,</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="nv">b</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">setCell</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="kt">Empty</span><span class="w"> </span><span class="nv">b</span><span class="p">)</span>
<span class="w">        </span><span class="nv">board</span>
<span class="w">        </span><span class="nv">positions</span>
</code></pre></div>
<p>ã€Œã‚·ãƒ³ãƒ—ãƒ«ã§ã™ã­ï¼ã€ãã†ã§ã™ã€‚<code>Set.foldl</code> ã‚’ä½¿ã£ã¦ã€å„ä½ç½®ã®ã‚»ãƒ«ã‚’ <code>Empty</code> ã«è¨­å®šã—ã¦ã„ãã¾ã™ã€‚</p>
<h3 id="_61">ãƒ†ã‚¹ãƒˆ: é‡åŠ›ã®é©ç”¨<a class="headerlink" href="#_61" title="Permanent link">&para;</a></h3>
<p>ã·ã‚ˆã‚’æ¶ˆå»ã—ãŸå¾Œã€ä¸Šã«ã‚ã‚‹ã·ã‚ˆãŒè½ä¸‹ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã‚’ã€Œé‡åŠ›ã®é©ç”¨ã€ã¨å‘¼ã³ã¾ã™ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- tests/GameLogicTests.elmï¼ˆç¶šãï¼‰</span>
<span class="nv">suite</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Test</span>
<span class="nv">suite</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="nv">describe</span><span class="w"> </span><span class="s">&quot;GameLogic&quot;</span>
<span class="w">        </span><span class="p">[</span><span class="w"> </span><span class="c1">-- æ—¢å­˜ã®ãƒ†ã‚¹ãƒˆ...</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">describe</span><span class="w"> </span><span class="s">&quot;applyGravity&quot;</span>
<span class="w">            </span><span class="p">[</span><span class="w"> </span><span class="nv">test</span><span class="w"> </span><span class="s">&quot;æµ®ã„ã¦ã„ã‚‹ã·ã‚ˆãŒè½ä¸‹ã™ã‚‹&quot;</span><span class="w"> </span><span class="nf">&lt;|</span>
<span class="w">                </span><span class="nf">\</span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="kr">let</span>
<span class="w">                        </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="mi">12</span>
<span class="w">                                </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">setCell</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="p">(</span><span class="kt">Filled</span><span class="w"> </span><span class="kt">Blue</span><span class="p">)</span>
<span class="w">                                </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">setCell</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">9</span><span class="w"> </span><span class="p">(</span><span class="kt">Filled</span><span class="w"> </span><span class="kt">Blue</span><span class="p">)</span>

<span class="w">                        </span><span class="nv">newBoard</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">GameLogic</span><span class="nf">.</span><span class="nv">applyGravity</span><span class="w"> </span><span class="nv">board</span>
<span class="w">                    </span><span class="kr">in</span>
<span class="w">                    </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">all</span>
<span class="w">                        </span><span class="p">[</span><span class="w"> </span><span class="nf">\</span><span class="nv">b</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">getCell</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="nv">b</span><span class="w"> </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">equal</span><span class="w"> </span><span class="p">(</span><span class="kt">Just</span><span class="w"> </span><span class="kt">Empty</span><span class="p">)</span>
<span class="w">                        </span><span class="p">,</span><span class="w"> </span><span class="nf">\</span><span class="nv">b</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">getCell</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">9</span><span class="w"> </span><span class="nv">b</span><span class="w"> </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">equal</span><span class="w"> </span><span class="p">(</span><span class="kt">Just</span><span class="w"> </span><span class="kt">Empty</span><span class="p">)</span>
<span class="w">                        </span><span class="p">,</span><span class="w"> </span><span class="nf">\</span><span class="nv">b</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">getCell</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="nv">b</span><span class="w"> </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">equal</span><span class="w"> </span><span class="p">(</span><span class="kt">Just</span><span class="w"> </span><span class="p">(</span><span class="kt">Filled</span><span class="w"> </span><span class="kt">Blue</span><span class="p">))</span>
<span class="w">                        </span><span class="p">,</span><span class="w"> </span><span class="nf">\</span><span class="nv">b</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">getCell</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="nv">b</span><span class="w"> </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">equal</span><span class="w"> </span><span class="p">(</span><span class="kt">Just</span><span class="w"> </span><span class="p">(</span><span class="kt">Filled</span><span class="w"> </span><span class="kt">Blue</span><span class="p">))</span>
<span class="w">                        </span><span class="p">]</span>
<span class="w">                        </span><span class="nv">newBoard</span>
<span class="w">            </span><span class="p">,</span><span class="w"> </span><span class="nv">test</span><span class="w"> </span><span class="s">&quot;æµ®ã„ã¦ã„ãªã„ã·ã‚ˆã¯å‹•ã‹ãªã„&quot;</span><span class="w"> </span><span class="nf">&lt;|</span>
<span class="w">                </span><span class="nf">\</span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="kr">let</span>
<span class="w">                        </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="mi">12</span>
<span class="w">                                </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">setCell</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="p">(</span><span class="kt">Filled</span><span class="w"> </span><span class="kt">Blue</span><span class="p">)</span>

<span class="w">                        </span><span class="nv">newBoard</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">GameLogic</span><span class="nf">.</span><span class="nv">applyGravity</span><span class="w"> </span><span class="nv">board</span>
<span class="w">                    </span><span class="kr">in</span>
<span class="w">                    </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">getCell</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="nv">newBoard</span>
<span class="w">                        </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">equal</span><span class="w"> </span><span class="p">(</span><span class="kt">Just</span><span class="w"> </span><span class="p">(</span><span class="kt">Filled</span><span class="w"> </span><span class="kt">Blue</span><span class="p">))</span>
<span class="w">            </span><span class="p">]</span>
<span class="w">        </span><span class="p">]</span>
</code></pre></div>
<p>ã€Œã“ã‚Œã¯ã€ã·ã‚ˆãŒä¸‹ã«è½ã¡ã¦ã„ãã“ã¨ã‚’ç¢ºèªã™ã‚‹ãƒ†ã‚¹ãƒˆã§ã™ã­ï¼ã€ãã†ã§ã™ï¼ã·ã‚ˆæ¶ˆå»å¾Œã«ç©ºã„ãŸã‚¹ãƒšãƒ¼ã‚¹ã«ã€ä¸Šã®ã·ã‚ˆãŒè½ã¡ã¦ãã‚‹æ©Ÿèƒ½ã‚’ãƒ†ã‚¹ãƒˆã—ã¦ã„ã¾ã™ã€‚</p>
<h3 id="_62">å®Ÿè£…: é‡åŠ›ã®é©ç”¨<a class="headerlink" href="#_62" title="Permanent link">&para;</a></h3>
<p>ã§ã¯ã€é‡åŠ›ã‚’é©ç”¨ã™ã‚‹æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¾ã—ã‚‡ã†ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- src/GameLogic.elmï¼ˆç¶šãï¼‰</span>
<span class="cm">{-| é‡åŠ›ã‚’é©ç”¨ã—ã¦æµ®ã„ã¦ã„ã‚‹ã·ã‚ˆã‚’è½ä¸‹ã•ã›ã‚‹</span>
<span class="cm">-}</span>
<span class="nv">applyGravity</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Board</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Board</span>
<span class="nv">applyGravity</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="kr">let</span>
<span class="w">        </span><span class="nv">cols</span><span class="w"> </span><span class="nf">=</span>
<span class="w">            </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">getCols</span><span class="w"> </span><span class="nv">board</span>

<span class="w">        </span><span class="nv">rows</span><span class="w"> </span><span class="nf">=</span>
<span class="w">            </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">getRows</span><span class="w"> </span><span class="nv">board</span>

<span class="w">        </span><span class="c1">-- å„åˆ—ã«å¯¾ã—ã¦é‡åŠ›ã‚’é©ç”¨</span>
<span class="w">        </span><span class="nv">applyGravityToColumn</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Board</span>
<span class="w">        </span><span class="nv">applyGravityToColumn</span><span class="w"> </span><span class="nv">col</span><span class="w"> </span><span class="nv">b</span><span class="w"> </span><span class="nf">=</span>
<span class="w">            </span><span class="c1">-- ä¸‹ã‹ã‚‰ä¸Šã«å‘ã‹ã£ã¦å‡¦ç†</span>
<span class="w">            </span><span class="kr">let</span>
<span class="w">                </span><span class="nv">applyToRow</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Board</span>
<span class="w">                </span><span class="nv">applyToRow</span><span class="w"> </span><span class="nv">row</span><span class="w"> </span><span class="nv">currentBoard</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                    </span><span class="kr">if</span><span class="w"> </span><span class="nv">row</span><span class="w"> </span><span class="nf">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="kr">then</span>
<span class="w">                        </span><span class="nv">currentBoard</span>

<span class="w">                    </span><span class="kr">else</span>
<span class="w">                        </span><span class="kr">case</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">getCell</span><span class="w"> </span><span class="nv">col</span><span class="w"> </span><span class="nv">row</span><span class="w"> </span><span class="nv">currentBoard</span><span class="w"> </span><span class="kr">of</span>
<span class="w">                            </span><span class="kt">Just</span><span class="w"> </span><span class="p">(</span><span class="kt">Filled</span><span class="w"> </span><span class="nv">color</span><span class="p">)</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                                </span><span class="c1">-- ä¸‹ã«è½ã¨ã›ã‚‹ã ã‘è½ã¨ã™</span>
<span class="w">                                </span><span class="kr">let</span>
<span class="w">                                    </span><span class="nv">finalRow</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                                        </span><span class="nv">findBottomRow</span><span class="w"> </span><span class="nv">col</span><span class="w"> </span><span class="nv">row</span><span class="w"> </span><span class="nv">currentBoard</span>
<span class="w">                                </span><span class="kr">in</span>
<span class="w">                                </span><span class="kr">if</span><span class="w"> </span><span class="nv">finalRow</span><span class="w"> </span><span class="nf">/=</span><span class="w"> </span><span class="nv">row</span><span class="w"> </span><span class="kr">then</span>
<span class="w">                                    </span><span class="nv">currentBoard</span>
<span class="w">                                        </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">setCell</span><span class="w"> </span><span class="nv">col</span><span class="w"> </span><span class="nv">row</span><span class="w"> </span><span class="kt">Empty</span>
<span class="w">                                        </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">setCell</span><span class="w"> </span><span class="nv">col</span><span class="w"> </span><span class="nv">finalRow</span><span class="w"> </span><span class="p">(</span><span class="kt">Filled</span><span class="w"> </span><span class="nv">color</span><span class="p">)</span>
<span class="w">                                        </span><span class="nf">|&gt;</span><span class="w"> </span><span class="nv">applyToRow</span><span class="w"> </span><span class="p">(</span><span class="nv">row</span><span class="w"> </span><span class="nf">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>

<span class="w">                                </span><span class="kr">else</span>
<span class="w">                                    </span><span class="nv">applyToRow</span><span class="w"> </span><span class="p">(</span><span class="nv">row</span><span class="w"> </span><span class="nf">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="nv">currentBoard</span>

<span class="w">                            </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                                </span><span class="nv">applyToRow</span><span class="w"> </span><span class="p">(</span><span class="nv">row</span><span class="w"> </span><span class="nf">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="nv">currentBoard</span>
<span class="w">            </span><span class="kr">in</span>
<span class="w">            </span><span class="nv">applyToRow</span><span class="w"> </span><span class="p">(</span><span class="nv">rows</span><span class="w"> </span><span class="nf">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="nv">b</span>

<span class="w">        </span><span class="c1">-- ä¸‹ã«è½ã¨ã›ã‚‹æœ€çµ‚è¡Œã‚’è¦‹ã¤ã‘ã‚‹</span>
<span class="w">        </span><span class="nv">findBottomRow</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Int</span>
<span class="w">        </span><span class="nv">findBottomRow</span><span class="w"> </span><span class="nv">col</span><span class="w"> </span><span class="nv">row</span><span class="w"> </span><span class="nv">currentBoard</span><span class="w"> </span><span class="nf">=</span>
<span class="w">            </span><span class="kr">if</span><span class="w"> </span><span class="nv">row</span><span class="w"> </span><span class="nf">&gt;=</span><span class="w"> </span><span class="nv">rows</span><span class="w"> </span><span class="nf">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="kr">then</span>
<span class="w">                </span><span class="nv">row</span>

<span class="w">            </span><span class="kr">else</span>
<span class="w">                </span><span class="kr">case</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">getCell</span><span class="w"> </span><span class="nv">col</span><span class="w"> </span><span class="p">(</span><span class="nv">row</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="nv">currentBoard</span><span class="w"> </span><span class="kr">of</span>
<span class="w">                    </span><span class="kt">Just</span><span class="w"> </span><span class="kt">Empty</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                        </span><span class="nv">findBottomRow</span><span class="w"> </span><span class="nv">col</span><span class="w"> </span><span class="p">(</span><span class="nv">row</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="nv">currentBoard</span>

<span class="w">                    </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                        </span><span class="nv">row</span>
<span class="w">    </span><span class="kr">in</span>
<span class="w">    </span><span class="kt">List</span><span class="nf">.</span><span class="nv">foldl</span><span class="w"> </span><span class="nv">applyGravityToColumn</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="p">(</span><span class="kt">List</span><span class="nf">.</span><span class="nv">range</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">(</span><span class="nv">cols</span><span class="w"> </span><span class="nf">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span>
</code></pre></div>
<p>ã€Œå°‘ã—è¤‡é›‘ã§ã™ã­...ã€ãã†ã§ã™ã­ã€‚é‡åŠ›ã®é©ç”¨ã¯å°‘ã—è¤‡é›‘ã§ã™ã€‚å‡¦ç†ã®æµã‚Œã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ï¼š</p>
<ol>
<li><strong>åˆ—ã”ã¨ã«å‡¦ç†</strong>: å„åˆ—ã«å¯¾ã—ã¦ç‹¬ç«‹ã«é‡åŠ›ã‚’é©ç”¨</li>
<li><strong>ä¸‹ã‹ã‚‰ä¸Šã¸</strong>: å„åˆ—ã‚’ä¸‹ã‹ã‚‰ä¸Šã«å‘ã‹ã£ã¦å‡¦ç†</li>
<li><strong>è½ä¸‹å…ˆã‚’æ¢ç´¢</strong>: å„ã·ã‚ˆã«ã¤ã„ã¦ã€ã©ã“ã¾ã§è½ã¨ã›ã‚‹ã‹ã‚’æ¢ã™</li>
<li><strong>ç§»å‹•</strong>: å…ƒã®ä½ç½®ã‚’ <code>Empty</code> ã«ã—ã¦ã€è½ä¸‹å…ˆã« ã·ã‚ˆã‚’é…ç½®</li>
</ol>
<p>ã€ŒBoard ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã« <code>getCols</code> ã¨ <code>getRows</code> é–¢æ•°ãŒå¿…è¦ã§ã™ã­ï¼ã€ãã®é€šã‚Šã§ã™ï¼Board ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«è¿½åŠ ã—ã¾ã—ã‚‡ã†ã€‚</p>
<h3 id="board">Board ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®æ‹¡å¼µ<a class="headerlink" href="#board" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">-- src/Board.elmï¼ˆè¿½åŠ ï¼‰</span>
<span class="nv">getCols</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Board</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Int</span>
<span class="nv">getCols</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="nv">board</span><span class="nf">.</span><span class="nv">cols</span>


<span class="nv">getRows</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Board</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Int</span>
<span class="nv">getRows</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="nv">board</span><span class="nf">.</span><span class="nv">rows</span>
</code></pre></div>
<p>ã“ã‚Œã§ã€ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼š</p>
<div class="highlight"><pre><span></span><code>elm-test
</code></pre></div>
<p>ã€Œãƒ†ã‚¹ãƒˆãŒé€šã‚Šã¾ã—ãŸï¼ã€ç´ æ™´ã‚‰ã—ã„ï¼é‡åŠ›ã®é©ç”¨æ©Ÿèƒ½ãŒå®Ÿè£…ã§ãã¾ã—ãŸã­ã€‚</p>
<h3 id="_63"><a class="headerlink" href="#_63" title="Permanent link">&para;</a></h3>
<p>ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³6ã®ã¾ã¨ã‚</p>
<p>ã“ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§å®Ÿè£…ã—ãŸå†…å®¹ï¼š</p>
<ol>
<li><strong>é€£çµã·ã‚ˆã®æ¢ç´¢</strong></li>
<li><code>findConnectedPuyos</code>: æ·±ã•å„ªå…ˆæ¢ç´¢ï¼ˆDFSï¼‰ã§é€£çµã·ã‚ˆã‚’æ¤œå‡º</li>
<li><code>Set</code> å‹ã§è¨ªå•æ¸ˆã¿ä½ç½®ã‚’ç®¡ç†</li>
<li>
<p>å†å¸°çš„ãªæ¢ç´¢ã§ä¸Šä¸‹å·¦å³ã‚’èµ°æŸ»</p>
</li>
<li>
<p><strong>ã·ã‚ˆã®æ¶ˆå»</strong></p>
</li>
<li><code>erasePuyos</code>: æŒ‡å®šä½ç½®ã®ã·ã‚ˆã‚’ <code>Empty</code> ã«è¨­å®š</li>
<li>
<p><code>Set.foldl</code> ã§è¤‡æ•°ä½ç½®ã‚’ä¸€æ‹¬å‡¦ç†</p>
</li>
<li>
<p><strong>é‡åŠ›ã®é©ç”¨</strong></p>
</li>
<li><code>applyGravity</code>: æµ®ã„ã¦ã„ã‚‹ã·ã‚ˆã‚’è½ä¸‹ã•ã›ã‚‹</li>
<li>åˆ—ã”ã¨ã«ç‹¬ç«‹ã—ã¦å‡¦ç†</li>
<li>
<p>ä¸‹ã‹ã‚‰ä¸Šã«å‘ã‹ã£ã¦ã‚¹ã‚­ãƒ£ãƒ³</p>
</li>
<li>
<p><strong>ãƒ†ã‚¹ãƒˆã®ä½œæˆ</strong></p>
</li>
<li>é€£çµåˆ¤å®šã®ãƒ†ã‚¹ãƒˆï¼ˆ3ãƒ†ã‚¹ãƒˆï¼‰</li>
<li>æ¶ˆå»æ©Ÿèƒ½ã®ãƒ†ã‚¹ãƒˆï¼ˆ1ãƒ†ã‚¹ãƒˆï¼‰</li>
<li>é‡åŠ›é©ç”¨ã®ãƒ†ã‚¹ãƒˆï¼ˆ2ãƒ†ã‚¹ãƒˆï¼‰</li>
</ol>
<h3 id="_64">å­¦ã‚“ã ã“ã¨<a class="headerlink" href="#_64" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>æ·±ã•å„ªå…ˆæ¢ç´¢ï¼ˆDFSï¼‰</strong>: å†å¸°ã‚’ä½¿ã£ãŸæ¢ç´¢ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ </li>
<li><strong>Set å‹ã®æ´»ç”¨</strong>: é‡è¤‡ã®ãªã„ä½ç½®ç®¡ç†ã«ä¾¿åˆ©</li>
<li><strong>foldl ã«ã‚ˆã‚‹é›†ç´„</strong>: è¤‡æ•°ã®æ“ä½œã‚’é †æ¬¡é©ç”¨</li>
<li><strong>ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°</strong>: è¤‡é›‘ãªãƒ­ã‚¸ãƒƒã‚¯ã‚’å°ã•ãªé–¢æ•°ã«åˆ†å‰²</li>
</ul>
<p>æ¬¡ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ã€é€£é–åå¿œã®å®Ÿè£…ã«é€²ã¿ã¾ã™ï¼</p>
<h2 id="7">ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³7: é€£é–åå¿œã®å®Ÿè£…<a class="headerlink" href="#7" title="Permanent link">&para;</a></h2>
<p>ã€Œã·ã‚ˆã‚’æ¶ˆã›ã‚‹ã‚ˆã†ã«ãªã£ãŸã‘ã©ã€ã·ã‚ˆã·ã‚ˆã®é†é†å‘³ã¯é€£é–ã˜ã‚ƒãªã„ã§ã™ã‹ï¼Ÿã€ãã†ã§ã™ã­ï¼ã·ã‚ˆã·ã‚ˆã®æœ€ã‚‚é­…åŠ›çš„ãªè¦ç´ ã®ä¸€ã¤ã¯ã€é€£é–åå¿œã§ã™ã€‚ã·ã‚ˆãŒæ¶ˆãˆã¦è½ä¸‹ã—ãŸçµæœã€æ–°ãŸãªæ¶ˆå»ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒç”Ÿã¾ã‚Œã€é€£ç¶šã—ã¦æ¶ˆå»ãŒç™ºç”Ÿã™ã‚‹ã€Œé€£é–ã€ã‚’å®Ÿè£…ã—ã¦ã„ãã¾ã—ã‚‡ã†ï¼</p>
<h3 id="_65">ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼<a class="headerlink" href="#_65" title="Permanent link">&para;</a></h3>
<p>ã¾ãšã¯ã€ã“ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§å®Ÿè£…ã™ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚’ç¢ºèªã—ã¾ã—ã‚‡ã†ï¼š</p>
<blockquote>
<p>ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¨ã—ã¦ã€é€£é–åå¿œã‚’èµ·ã“ã—ã¦ã‚ˆã‚Šé«˜ã„ã‚¹ã‚³ã‚¢ã‚’ç²å¾—ã§ãã‚‹</p>
</blockquote>
<p>ã€Œã‚Œã€œã‚“ã•ã€œã‚“ï¼ã€ã¨å«ã³ãŸããªã‚‹ã‚ˆã†ãªé€£é–åå¿œã‚’å®Ÿè£…ã—ã¦ã€ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒã‚ˆã‚Šé«˜ã„ã‚¹ã‚³ã‚¢ã‚’ç›®æŒ‡ã›ã‚‹ã‚ˆã†ã«ã—ã¾ã—ã‚‡ã†ã€‚</p>
<h3 id="todo_6">TODOãƒªã‚¹ãƒˆ<a class="headerlink" href="#todo_6" title="Permanent link">&para;</a></h3>
<p>ã€Œã©ã‚“ãªä½œæ¥­ãŒå¿…è¦ã«ãªã‚Šã¾ã™ã‹ï¼Ÿã€ã“ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚’å®Ÿç¾ã™ã‚‹ãŸã‚ã«ã€TODOãƒªã‚¹ãƒˆã‚’ä½œæˆã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</p>
<p>ã€Œé€£é–åå¿œã‚’å®Ÿè£…ã™ã‚‹ã€ã¨ã„ã†æ©Ÿèƒ½ã‚’å®Ÿç¾ã™ã‚‹ãŸã‚ã«ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ãªã‚¿ã‚¹ã‚¯ãŒå¿…è¦ãã†ã§ã™ã­ï¼š</p>
<ul>
<li>ã‚²ãƒ¼ãƒ ãƒ¢ãƒ¼ãƒ‰ã«æ¶ˆå»åˆ¤å®šãƒ»æ¶ˆå»ä¸­ãƒ»è½ä¸‹ä¸­ã®çŠ¶æ…‹ã‚’è¿½åŠ ã™ã‚‹</li>
<li>ç€åœ°å¾Œã«æ¶ˆå»åˆ¤å®šãƒ¢ãƒ¼ãƒ‰ã«é·ç§»ã™ã‚‹</li>
<li>æ¶ˆå»å¾Œã«é‡åŠ›ã‚’é©ç”¨ã—ã¦å†åº¦æ¶ˆå»åˆ¤å®šã‚’è¡Œã†</li>
<li>é€£é–æ•°ã‚’ã‚«ã‚¦ãƒ³ãƒˆã™ã‚‹</li>
<li>é€£é–ãŒçµ‚äº†ã—ãŸã‚‰æ¬¡ã®ã·ã‚ˆã‚’å‡ºã™</li>
</ul>
<p>ã€Œãªã‚‹ã»ã©ã€ã‚²ãƒ¼ãƒ ãƒ¢ãƒ¼ãƒ‰ã§çŠ¶æ…‹ã‚’ç®¡ç†ã™ã‚‹ã‚“ã§ã™ã­ï¼ã€ãã†ã§ã™ï¼Elmã®ã‚«ã‚¹ã‚¿ãƒ å‹ã‚’ä½¿ã£ã¦ã€ã‚²ãƒ¼ãƒ ã®çŠ¶æ…‹é·ç§»ã‚’æ˜ç¢ºã«è¡¨ç¾ã—ã¾ã™ã€‚</p>
<h3 id="_66">ãƒ†ã‚¹ãƒˆ: ã‚²ãƒ¼ãƒ ãƒ¢ãƒ¼ãƒ‰ã®è¿½åŠ <a class="headerlink" href="#_66" title="Permanent link">&para;</a></h3>
<p>ã¾ãšã€æ–°ã—ã„ã‚²ãƒ¼ãƒ ãƒ¢ãƒ¼ãƒ‰ã‚’è¿½åŠ ã—ã¾ã™ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- src/Main.elmï¼ˆGameMode ã®æ‹¡å¼µï¼‰</span>
<span class="kr">type</span><span class="w"> </span><span class="kt">GameMode</span>
<span class="w">    </span><span class="nf">=</span><span class="w"> </span><span class="kt">Start</span>
<span class="w">    </span><span class="nf">|</span><span class="w"> </span><span class="kt">Playing</span>
<span class="w">    </span><span class="nf">|</span><span class="w"> </span><span class="kt">Checking</span><span class="w">      </span><span class="c1">-- æ¶ˆå»åˆ¤å®šä¸­</span>
<span class="w">    </span><span class="nf">|</span><span class="w"> </span><span class="kt">Erasing</span><span class="w">       </span><span class="c1">-- æ¶ˆå»ä¸­</span>
<span class="w">    </span><span class="nf">|</span><span class="w"> </span><span class="kt">Falling</span><span class="w">       </span><span class="c1">-- è½ä¸‹ä¸­</span>
<span class="w">    </span><span class="nf">|</span><span class="w"> </span><span class="kt">GameOver</span>
</code></pre></div>
<p>ã€ŒPlaying ã ã‘ã˜ã‚ƒãªãã¦ã€ç´°ã‹ããƒ¢ãƒ¼ãƒ‰ã‚’åˆ†ã‘ã‚‹ã‚“ã§ã™ã­ï¼ã€ãã†ã§ã™ã€‚å„ãƒ¢ãƒ¼ãƒ‰ã§ç•°ãªã‚‹å‡¦ç†ã‚’è¡Œã†ã“ã¨ã§ã€ã‚²ãƒ¼ãƒ ã®æµã‚Œã‚’æ˜ç¢ºã«åˆ¶å¾¡ã§ãã¾ã™ã€‚</p>
<h3 id="_67">ãƒ†ã‚¹ãƒˆ: é€£é–åˆ¤å®š<a class="headerlink" href="#_67" title="Permanent link">&para;</a></h3>
<p>é€£é–ãŒç™ºç”Ÿã™ã‚‹ã‚±ãƒ¼ã‚¹ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã—ã‚‡ã†ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- tests/MainTests.elmï¼ˆç¶šãï¼‰</span>
<span class="nv">suite</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Test</span>
<span class="nv">suite</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="nv">describe</span><span class="w"> </span><span class="s">&quot;Main&quot;</span>
<span class="w">        </span><span class="p">[</span><span class="w"> </span><span class="c1">-- æ—¢å­˜ã®ãƒ†ã‚¹ãƒˆ...</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">describe</span><span class="w"> </span><span class="s">&quot;é€£é–åå¿œ&quot;</span>
<span class="w">            </span><span class="p">[</span><span class="w"> </span><span class="nv">test</span><span class="w"> </span><span class="s">&quot;ã·ã‚ˆæ¶ˆå»å¾Œã€ä¸Šã®ã·ã‚ˆãŒè½ã¡ã¦å†ã³4ã¤ã¤ãªãŒã‚Œã°é€£é–ã™ã‚‹&quot;</span><span class="w"> </span><span class="nf">&lt;|</span>
<span class="w">                </span><span class="nf">\</span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="kr">let</span>
<span class="w">                        </span><span class="c1">-- åˆæœŸé…ç½®:</span>
<span class="w">                        </span><span class="c1">-- èµ¤ã·ã‚ˆ4ã¤ï¼ˆ2Ã—2ï¼‰ã®ä¸Šã«é’ã·ã‚ˆãŒç¸¦ã«3ã¤ã€æ¨ªã«1ã¤</span>
<span class="w">                        </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="mi">12</span>
<span class="w">                                </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">setCell</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">(</span><span class="kt">Filled</span><span class="w"> </span><span class="kt">Red</span><span class="p">)</span>
<span class="w">                                </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">setCell</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">(</span><span class="kt">Filled</span><span class="w"> </span><span class="kt">Red</span><span class="p">)</span>
<span class="w">                                </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">setCell</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="p">(</span><span class="kt">Filled</span><span class="w"> </span><span class="kt">Red</span><span class="p">)</span>
<span class="w">                                </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">setCell</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span><span class="p">(</span><span class="kt">Filled</span><span class="w"> </span><span class="kt">Red</span><span class="p">)</span>
<span class="w">                                </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">setCell</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">(</span><span class="kt">Filled</span><span class="w"> </span><span class="kt">Blue</span><span class="p">)</span>
<span class="w">                                </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">setCell</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">7</span><span class="w"> </span><span class="p">(</span><span class="kt">Filled</span><span class="w"> </span><span class="kt">Blue</span><span class="p">)</span>
<span class="w">                                </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">setCell</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="p">(</span><span class="kt">Filled</span><span class="w"> </span><span class="kt">Blue</span><span class="p">)</span>
<span class="w">                                </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">setCell</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">9</span><span class="w"> </span><span class="p">(</span><span class="kt">Filled</span><span class="w"> </span><span class="kt">Blue</span><span class="p">)</span>

<span class="w">                        </span><span class="c1">-- 1. èµ¤ã·ã‚ˆã‚’æ¢ç´¢</span>
<span class="w">                        </span><span class="nv">redConnected</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">GameLogic</span><span class="nf">.</span><span class="nv">findConnectedPuyos</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="kt">Red</span><span class="w"> </span><span class="nv">board</span>

<span class="w">                        </span><span class="c1">-- 2. èµ¤ã·ã‚ˆã‚’æ¶ˆå»</span>
<span class="w">                        </span><span class="nv">boardAfterErase</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">GameLogic</span><span class="nf">.</span><span class="nv">erasePuyos</span><span class="w"> </span><span class="nv">redConnected</span><span class="w"> </span><span class="nv">board</span>

<span class="w">                        </span><span class="c1">-- 3. é‡åŠ›ã‚’é©ç”¨</span>
<span class="w">                        </span><span class="nv">boardAfterGravity</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">GameLogic</span><span class="nf">.</span><span class="nv">applyGravity</span><span class="w"> </span><span class="nv">boardAfterErase</span>

<span class="w">                        </span><span class="c1">-- 4. é’ã·ã‚ˆã®é€£é–åˆ¤å®š</span>
<span class="w">                        </span><span class="nv">blueConnected</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">GameLogic</span><span class="nf">.</span><span class="nv">findConnectedPuyos</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="kt">Blue</span><span class="w"> </span><span class="nv">boardAfterGravity</span>
<span class="w">                    </span><span class="kr">in</span>
<span class="w">                    </span><span class="kt">Set</span><span class="nf">.</span><span class="nv">size</span><span class="w"> </span><span class="nv">blueConnected</span>
<span class="w">                        </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">equal</span><span class="w"> </span><span class="mi">4</span>
<span class="w">            </span><span class="p">]</span>
<span class="w">        </span><span class="p">]</span>
</code></pre></div>
<p>ã€Œã“ã®ãƒ†ã‚¹ãƒˆã§ã¯ã€èµ¤ã·ã‚ˆãŒæ¶ˆãˆãŸå¾Œã«é’ã·ã‚ˆãŒè½ã¡ã¦4ã¤ã¤ãªãŒã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ã„ã‚‹ã‚“ã§ã™ã­ï¼ã€ãã†ã§ã™ï¼ã“ã‚ŒãŒé€£é–ã®åŸºæœ¬ãƒ‘ã‚¿ãƒ¼ãƒ³ã§ã™ã€‚</p>
<h3 id="model_1">å®Ÿè£…: Model ã®æ‹¡å¼µ<a class="headerlink" href="#model_1" title="Permanent link">&para;</a></h3>
<p>é€£é–æ•°ã¨ã‚¹ã‚³ã‚¢ã‚’ç®¡ç†ã™ã‚‹ãŸã‚ã« Model ã‚’æ‹¡å¼µã—ã¾ã™ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- src/Main.elmï¼ˆModel ã®æ‹¡å¼µï¼‰</span>
<span class="kr">type</span><span class="w"> </span><span class="kr">alias</span><span class="w"> </span><span class="kt">Model</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Board</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">currentPair</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Maybe</span><span class="w"> </span><span class="kt">PuyoPair</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">mode</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">GameMode</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">dropTimer</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Float</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">dropInterval</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Float</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">fastDropActive</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Bool</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">chainCount</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Int</span><span class="w">      </span><span class="c1">-- è¿½åŠ </span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">score</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Int</span><span class="w">           </span><span class="c1">-- è¿½åŠ </span>
<span class="w">    </span><span class="p">}</span>


<span class="nv">init</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Model</span>
<span class="nv">init</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="mi">12</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">currentPair</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Nothing</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">mode</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Start</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">dropTimer</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">dropInterval</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="mi">1000</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">fastDropActive</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">False</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">chainCount</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="mi">0</span><span class="w">        </span><span class="c1">-- è¿½åŠ </span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">score</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="mi">0</span><span class="w">             </span><span class="c1">-- è¿½åŠ </span>
<span class="w">    </span><span class="p">}</span>
</code></pre></div>
<h3 id="_68">å®Ÿè£…: æ¶ˆå»åˆ¤å®šã¨é€£é–ã®ãƒ•ãƒ­ãƒ¼<a class="headerlink" href="#_68" title="Permanent link">&para;</a></h3>
<p>æ¬¡ã«ã€ç€åœ°å¾Œã®å‡¦ç†ã‚’å¤‰æ›´ã—ã¦ã€æ¶ˆå»åˆ¤å®šâ†’æ¶ˆå»â†’é‡åŠ›â†’æ¶ˆå»åˆ¤å®šã®ã‚µã‚¤ã‚¯ãƒ«ã‚’å®Ÿè£…ã—ã¾ã™ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- src/Main.elmï¼ˆupdate é–¢æ•°ã® Tick å‡¦ç†ã‚’å¤§å¹…ã«å¤‰æ›´ï¼‰</span>
<span class="nv">update</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Msg</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Model</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="kt">Model</span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="w"> </span><span class="kt">Msg</span><span class="w"> </span><span class="p">)</span>
<span class="nv">update</span><span class="w"> </span><span class="nv">msg</span><span class="w"> </span><span class="nv">model</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="kr">case</span><span class="w"> </span><span class="nv">msg</span><span class="w"> </span><span class="kr">of</span>
<span class="w">        </span><span class="c1">-- æ—¢å­˜ã®å‡¦ç†...</span>

<span class="w">        </span><span class="kt">Tick</span><span class="w"> </span><span class="nv">deltaTime</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="kr">case</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">mode</span><span class="w"> </span><span class="kr">of</span>
<span class="w">                </span><span class="kt">Playing</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="c1">-- ãƒ—ãƒ¬ã‚¤ä¸­ã®è‡ªå‹•è½ä¸‹å‡¦ç†</span>
<span class="w">                    </span><span class="kr">case</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">currentPair</span><span class="w"> </span><span class="kr">of</span>
<span class="w">                        </span><span class="kt">Just</span><span class="w"> </span><span class="nv">pair</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                            </span><span class="kr">let</span>
<span class="w">                                </span><span class="nv">effectiveInterval</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                                    </span><span class="kr">if</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">fastDropActive</span><span class="w"> </span><span class="kr">then</span>
<span class="w">                                        </span><span class="mi">50</span>

<span class="w">                                    </span><span class="kr">else</span>
<span class="w">                                        </span><span class="nv">model</span><span class="nf">.</span><span class="nv">dropInterval</span>

<span class="w">                                </span><span class="nv">newTimer</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                                    </span><span class="nv">model</span><span class="nf">.</span><span class="nv">dropTimer</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="nv">deltaTime</span>
<span class="w">                            </span><span class="kr">in</span>
<span class="w">                            </span><span class="kr">if</span><span class="w"> </span><span class="nv">newTimer</span><span class="w"> </span><span class="nf">&gt;=</span><span class="w"> </span><span class="nv">effectiveInterval</span><span class="w"> </span><span class="kr">then</span>
<span class="w">                                </span><span class="kr">if</span><span class="w"> </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">canMoveDown</span><span class="w"> </span><span class="nv">pair</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">board</span><span class="w"> </span><span class="kr">then</span>
<span class="w">                                    </span><span class="p">(</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">model</span>
<span class="w">                                        </span><span class="nf">|</span><span class="w"> </span><span class="nv">currentPair</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Just</span><span class="w"> </span><span class="p">(</span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">moveDown</span><span class="w"> </span><span class="nv">pair</span><span class="p">)</span>
<span class="w">                                        </span><span class="p">,</span><span class="w"> </span><span class="nv">dropTimer</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">                                      </span><span class="p">}</span>
<span class="w">                                    </span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="nf">.</span><span class="nv">none</span>
<span class="w">                                    </span><span class="p">)</span>

<span class="w">                                </span><span class="kr">else</span>
<span class="w">                                    </span><span class="c1">-- ç€åœ°ï¼ãƒœãƒ¼ãƒ‰ã«å›ºå®šã—ã¦æ¶ˆå»åˆ¤å®šãƒ¢ãƒ¼ãƒ‰ã¸</span>
<span class="w">                                    </span><span class="kr">let</span>
<span class="w">                                        </span><span class="nv">newBoard</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                                            </span><span class="nv">model</span><span class="nf">.</span><span class="nv">board</span>
<span class="w">                                                </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">setCell</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">axis</span><span class="nf">.</span><span class="nv">x</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">axis</span><span class="nf">.</span><span class="nv">y</span><span class="w"> </span><span class="p">(</span><span class="kt">Filled</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">axisColor</span><span class="p">)</span>
<span class="w">                                                </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">setCell</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">child</span><span class="nf">.</span><span class="nv">x</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">child</span><span class="nf">.</span><span class="nv">y</span><span class="w"> </span><span class="p">(</span><span class="kt">Filled</span><span class="w"> </span><span class="nv">pair</span><span class="nf">.</span><span class="nv">childColor</span><span class="p">)</span>
<span class="w">                                    </span><span class="kr">in</span>
<span class="w">                                    </span><span class="p">(</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">model</span>
<span class="w">                                        </span><span class="nf">|</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">newBoard</span>
<span class="w">                                        </span><span class="p">,</span><span class="w"> </span><span class="nv">currentPair</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Nothing</span>
<span class="w">                                        </span><span class="p">,</span><span class="w"> </span><span class="nv">mode</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Checking</span>
<span class="w">                                        </span><span class="p">,</span><span class="w"> </span><span class="nv">dropTimer</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">                                        </span><span class="p">,</span><span class="w"> </span><span class="nv">fastDropActive</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">False</span>
<span class="w">                                        </span><span class="p">,</span><span class="w"> </span><span class="nv">chainCount</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="c1">-- é€£é–ã‚«ã‚¦ãƒ³ãƒˆã‚’ãƒªã‚»ãƒƒãƒˆ</span>
<span class="w">                                      </span><span class="p">}</span>
<span class="w">                                    </span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="nf">.</span><span class="nv">none</span>
<span class="w">                                    </span><span class="p">)</span>

<span class="w">                            </span><span class="kr">else</span>
<span class="w">                                </span><span class="p">(</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">model</span><span class="w"> </span><span class="nf">|</span><span class="w"> </span><span class="nv">dropTimer</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">newTimer</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="kt">Cmd</span><span class="nf">.</span><span class="nv">none</span><span class="w"> </span><span class="p">)</span>

<span class="w">                        </span><span class="kt">Nothing</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                            </span><span class="p">(</span><span class="w"> </span><span class="nv">model</span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="nf">.</span><span class="nv">none</span><span class="w"> </span><span class="p">)</span>

<span class="w">                </span><span class="kt">Checking</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="c1">-- æ¶ˆå»åˆ¤å®šãƒ¢ãƒ¼ãƒ‰</span>
<span class="w">                    </span><span class="kr">let</span>
<span class="w">                        </span><span class="nv">erasableGroups</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="nv">findAllErasableGroups</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">board</span>
<span class="w">                    </span><span class="kr">in</span>
<span class="w">                    </span><span class="kr">if</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">isEmpty</span><span class="w"> </span><span class="nv">erasableGroups</span><span class="w"> </span><span class="kr">then</span>
<span class="w">                        </span><span class="c1">-- æ¶ˆå»ãªã— â†’ æ¬¡ã®ã·ã‚ˆã‚’å‡ºã™</span>
<span class="w">                        </span><span class="p">(</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">model</span>
<span class="w">                            </span><span class="nf">|</span><span class="w"> </span><span class="nv">mode</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Playing</span>
<span class="w">                            </span><span class="p">,</span><span class="w"> </span><span class="nv">currentPair</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Just</span><span class="w"> </span><span class="p">(</span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="kt">Red</span><span class="w"> </span><span class="kt">Blue</span><span class="p">)</span>
<span class="w">                          </span><span class="p">}</span>
<span class="w">                        </span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="nf">.</span><span class="nv">none</span>
<span class="w">                        </span><span class="p">)</span>

<span class="w">                    </span><span class="kr">else</span>
<span class="w">                        </span><span class="c1">-- æ¶ˆå»ã‚ã‚Š â†’ æ¶ˆå»ãƒ¢ãƒ¼ãƒ‰ã¸</span>
<span class="w">                        </span><span class="kr">let</span>
<span class="w">                            </span><span class="nv">newChainCount</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                                </span><span class="nv">model</span><span class="nf">.</span><span class="nv">chainCount</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="mi">1</span>

<span class="w">                            </span><span class="c1">-- æ¶ˆå»ã™ã‚‹ã·ã‚ˆã®æ•°</span>
<span class="w">                            </span><span class="nv">erasedCount</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                                </span><span class="kt">List</span><span class="nf">.</span><span class="nv">sum</span><span class="w"> </span><span class="p">(</span><span class="kt">List</span><span class="nf">.</span><span class="nv">map</span><span class="w"> </span><span class="kt">Set</span><span class="nf">.</span><span class="nv">size</span><span class="w"> </span><span class="nv">erasableGroups</span><span class="p">)</span>

<span class="w">                            </span><span class="c1">-- ã‚¹ã‚³ã‚¢è¨ˆç®—: æ¶ˆå»æ•° Ã— é€£é–ãƒœãƒ¼ãƒŠã‚¹</span>
<span class="w">                            </span><span class="nv">chainBonus</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                                </span><span class="kr">case</span><span class="w"> </span><span class="nv">newChainCount</span><span class="w"> </span><span class="kr">of</span>
<span class="w">                                    </span><span class="mi">1</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                                    </span><span class="mi">2</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="mi">8</span>
<span class="w">                                    </span><span class="mi">3</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="mi">16</span>
<span class="w">                                    </span><span class="mi">4</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="mi">32</span>
<span class="w">                                    </span><span class="mi">5</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="mi">64</span>
<span class="w">                                    </span><span class="mi">6</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="mi">96</span>
<span class="w">                                    </span><span class="mi">7</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="mi">128</span>
<span class="w">                                    </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="mi">160</span>

<span class="w">                            </span><span class="nv">points</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                                </span><span class="nv">erasedCount</span><span class="w"> </span><span class="nf">*</span><span class="w"> </span><span class="nv">chainBonus</span>

<span class="w">                            </span><span class="c1">-- ã™ã¹ã¦ã®ã‚°ãƒ«ãƒ¼ãƒ—ã‚’æ¶ˆå»</span>
<span class="w">                            </span><span class="nv">newBoard</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                                </span><span class="kt">List</span><span class="nf">.</span><span class="nv">foldl</span><span class="w"> </span><span class="kt">GameLogic</span><span class="nf">.</span><span class="nv">erasePuyos</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">board</span><span class="w"> </span><span class="nv">erasableGroups</span>
<span class="w">                        </span><span class="kr">in</span>
<span class="w">                        </span><span class="p">(</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">model</span>
<span class="w">                            </span><span class="nf">|</span><span class="w"> </span><span class="nv">mode</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Erasing</span>
<span class="w">                            </span><span class="p">,</span><span class="w"> </span><span class="nv">chainCount</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">newChainCount</span>
<span class="w">                            </span><span class="p">,</span><span class="w"> </span><span class="nv">score</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">score</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="nv">points</span>
<span class="w">                            </span><span class="p">,</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">newBoard</span>
<span class="w">                          </span><span class="p">}</span>
<span class="w">                        </span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="nf">.</span><span class="nv">none</span>
<span class="w">                        </span><span class="p">)</span>

<span class="w">                </span><span class="kt">Erasing</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="c1">-- æ¶ˆå»ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆç°¡ç•¥åŒ–ã®ãŸã‚ã™ãã«è½ä¸‹ãƒ¢ãƒ¼ãƒ‰ã¸ï¼‰</span>
<span class="w">                    </span><span class="p">(</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">model</span><span class="w"> </span><span class="nf">|</span><span class="w"> </span><span class="nv">mode</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Falling</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="kt">Cmd</span><span class="nf">.</span><span class="nv">none</span><span class="w"> </span><span class="p">)</span>

<span class="w">                </span><span class="kt">Falling</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="c1">-- é‡åŠ›é©ç”¨å¾Œã€å†åº¦æ¶ˆå»åˆ¤å®šã¸</span>
<span class="w">                    </span><span class="kr">let</span>
<span class="w">                        </span><span class="nv">newBoard</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">GameLogic</span><span class="nf">.</span><span class="nv">applyGravity</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">board</span>
<span class="w">                    </span><span class="kr">in</span>
<span class="w">                    </span><span class="p">(</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">model</span>
<span class="w">                        </span><span class="nf">|</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">newBoard</span>
<span class="w">                        </span><span class="p">,</span><span class="w"> </span><span class="nv">mode</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Checking</span>
<span class="w">                      </span><span class="p">}</span>
<span class="w">                    </span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="nf">.</span><span class="nv">none</span>
<span class="w">                    </span><span class="p">)</span>

<span class="w">                </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="p">(</span><span class="w"> </span><span class="nv">model</span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="nf">.</span><span class="nv">none</span><span class="w"> </span><span class="p">)</span>

<span class="w">        </span><span class="c1">-- ãã®ä»–ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å‡¦ç†...</span>
<span class="w">        </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="p">(</span><span class="w"> </span><span class="nv">model</span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="nf">.</span><span class="nv">none</span><span class="w"> </span><span class="p">)</span>


<span class="cm">{-| ãƒœãƒ¼ãƒ‰å…¨ä½“ã‹ã‚‰æ¶ˆå»å¯èƒ½ãªã‚°ãƒ«ãƒ¼ãƒ—ã‚’æ¢ã™</span>
<span class="cm">-}</span>
<span class="nv">findAllErasableGroups</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Board</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">List</span><span class="w"> </span><span class="p">(</span><span class="kt">Set</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="kt">Int</span><span class="p">,</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="p">))</span>
<span class="nv">findAllErasableGroups</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="kr">let</span>
<span class="w">        </span><span class="nv">cols</span><span class="w"> </span><span class="nf">=</span>
<span class="w">            </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">getCols</span><span class="w"> </span><span class="nv">board</span>

<span class="w">        </span><span class="nv">rows</span><span class="w"> </span><span class="nf">=</span>
<span class="w">            </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">getRows</span><span class="w"> </span><span class="nv">board</span>

<span class="w">        </span><span class="c1">-- ã™ã¹ã¦ã®ã‚»ãƒ«ã‚’ãƒã‚§ãƒƒã‚¯</span>
<span class="w">        </span><span class="nv">allPositions</span><span class="w"> </span><span class="nf">=</span>
<span class="w">            </span><span class="kt">List</span><span class="nf">.</span><span class="nv">concatMap</span>
<span class="w">                </span><span class="p">(</span><span class="nf">\</span><span class="nv">y</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">map</span><span class="w"> </span><span class="p">(</span><span class="nf">\</span><span class="nv">x</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nv">x</span><span class="p">,</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="p">))</span><span class="w"> </span><span class="p">(</span><span class="kt">List</span><span class="nf">.</span><span class="nv">range</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">(</span><span class="nv">cols</span><span class="w"> </span><span class="nf">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)))</span>
<span class="w">                </span><span class="p">(</span><span class="kt">List</span><span class="nf">.</span><span class="nv">range</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">(</span><span class="nv">rows</span><span class="w"> </span><span class="nf">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span>

<span class="w">        </span><span class="c1">-- è¨ªå•æ¸ˆã¿ä½ç½®ã‚’ç®¡ç†</span>
<span class="w">        </span><span class="nv">findGroups</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">List</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="kt">Int</span><span class="p">,</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Set</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="kt">Int</span><span class="p">,</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">List</span><span class="w"> </span><span class="p">(</span><span class="kt">Set</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="kt">Int</span><span class="p">,</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="p">))</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">List</span><span class="w"> </span><span class="p">(</span><span class="kt">Set</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="kt">Int</span><span class="p">,</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="p">))</span>
<span class="w">        </span><span class="nv">findGroups</span><span class="w"> </span><span class="nv">positions</span><span class="w"> </span><span class="nv">visited</span><span class="w"> </span><span class="nv">groups</span><span class="w"> </span><span class="nf">=</span>
<span class="w">            </span><span class="kr">case</span><span class="w"> </span><span class="nv">positions</span><span class="w"> </span><span class="kr">of</span>
<span class="w">                </span><span class="p">[]</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="nv">groups</span>

<span class="w">                </span><span class="p">(</span><span class="w"> </span><span class="nv">x</span><span class="p">,</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="nf">::</span><span class="w"> </span><span class="nv">rest</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="kr">if</span><span class="w"> </span><span class="kt">Set</span><span class="nf">.</span><span class="nv">member</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nv">x</span><span class="p">,</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="nv">visited</span><span class="w"> </span><span class="kr">then</span>
<span class="w">                        </span><span class="nv">findGroups</span><span class="w"> </span><span class="nv">rest</span><span class="w"> </span><span class="nv">visited</span><span class="w"> </span><span class="nv">groups</span>

<span class="w">                    </span><span class="kr">else</span>
<span class="w">                        </span><span class="kr">case</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">getCell</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="kr">of</span>
<span class="w">                            </span><span class="kt">Just</span><span class="w"> </span><span class="p">(</span><span class="kt">Filled</span><span class="w"> </span><span class="nv">color</span><span class="p">)</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                                </span><span class="kr">let</span>
<span class="w">                                    </span><span class="nv">connected</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                                        </span><span class="kt">GameLogic</span><span class="nf">.</span><span class="nv">findConnectedPuyos</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nv">color</span><span class="w"> </span><span class="nv">board</span>

<span class="w">                                    </span><span class="nv">newVisited</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                                        </span><span class="kt">Set</span><span class="nf">.</span><span class="nv">union</span><span class="w"> </span><span class="nv">visited</span><span class="w"> </span><span class="nv">connected</span>
<span class="w">                                </span><span class="kr">in</span>
<span class="w">                                </span><span class="kr">if</span><span class="w"> </span><span class="kt">Set</span><span class="nf">.</span><span class="nv">size</span><span class="w"> </span><span class="nv">connected</span><span class="w"> </span><span class="nf">&gt;=</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="kr">then</span>
<span class="w">                                    </span><span class="nv">findGroups</span><span class="w"> </span><span class="nv">rest</span><span class="w"> </span><span class="nv">newVisited</span><span class="w"> </span><span class="p">(</span><span class="nv">connected</span><span class="w"> </span><span class="nf">::</span><span class="w"> </span><span class="nv">groups</span><span class="p">)</span>

<span class="w">                                </span><span class="kr">else</span>
<span class="w">                                    </span><span class="nv">findGroups</span><span class="w"> </span><span class="nv">rest</span><span class="w"> </span><span class="nv">newVisited</span><span class="w"> </span><span class="nv">groups</span>

<span class="w">                            </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                                </span><span class="nv">findGroups</span><span class="w"> </span><span class="nv">rest</span><span class="w"> </span><span class="nv">visited</span><span class="w"> </span><span class="nv">groups</span>
<span class="w">    </span><span class="kr">in</span>
<span class="w">    </span><span class="nv">findGroups</span><span class="w"> </span><span class="nv">allPositions</span><span class="w"> </span><span class="kt">Set</span><span class="nf">.</span><span class="nv">empty</span><span class="w"> </span><span class="p">[]</span>
</code></pre></div>
<p>ã€Œã™ã”ãé•·ããªã‚Šã¾ã—ãŸã­ï¼ã€ãã†ã§ã™ã­ã€‚ã§ã‚‚ã€å„ãƒ¢ãƒ¼ãƒ‰ã§ã‚„ã‚‹ã“ã¨ã¯æ˜ç¢ºã§ã™ï¼š</p>
<ol>
<li><strong>Playing</strong>: è‡ªå‹•è½ä¸‹ã€ç€åœ°ã—ãŸã‚‰ <code>Checking</code> ã¸</li>
<li><strong>Checking</strong>: æ¶ˆå»åˆ¤å®šã€æ¶ˆã™ã‚‚ã®ãŒã‚ã‚Œã° <code>Erasing</code> ã¸ã€ãªã‘ã‚Œã°æ¬¡ã®ã·ã‚ˆ</li>
<li><strong>Erasing</strong>: æ¶ˆå»å®Ÿè¡Œã€<code>Falling</code> ã¸</li>
<li><strong>Falling</strong>: é‡åŠ›é©ç”¨ã€<code>Checking</code> ã¸ï¼ˆã“ã“ã§é€£é–ãƒ«ãƒ¼ãƒ—ï¼‰</li>
</ol>
<p>ã€Œ<code>Checking â†’ Erasing â†’ Falling â†’ Checking</code> ã®ãƒ«ãƒ¼ãƒ—ãŒé€£é–ã‚’ä½œã£ã¦ã„ã‚‹ã‚“ã§ã™ã­ï¼ã€ãã®é€šã‚Šã§ã™ï¼æ¶ˆå»â†’é‡åŠ›â†’æ¶ˆå»åˆ¤å®šã®ã‚µã‚¤ã‚¯ãƒ«ãŒã€æ¶ˆã™ã‚‚ã®ãŒãªããªã‚‹ã¾ã§ç¹°ã‚Šè¿”ã•ã‚Œã¾ã™ã€‚</p>
<h3 id="view_1">View ã®æ›´æ–°<a class="headerlink" href="#view_1" title="Permanent link">&para;</a></h3>
<p>ã‚¹ã‚³ã‚¢ã¨é€£é–æ•°ã‚’è¡¨ç¤ºã—ã¾ã—ã‚‡ã†ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- src/Main.elmï¼ˆview é–¢æ•°ã®æ›´æ–°ï¼‰</span>
<span class="nv">view</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Model</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Html</span><span class="w"> </span><span class="kt">Msg</span>
<span class="nv">view</span><span class="w"> </span><span class="nv">model</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="nv">div</span><span class="w"> </span><span class="p">[]</span>
<span class="w">        </span><span class="p">[</span><span class="w"> </span><span class="nv">h1</span><span class="w"> </span><span class="p">[]</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="nv">text</span><span class="w"> </span><span class="s">&quot;ã·ã‚ˆã·ã‚ˆ - Elm ç‰ˆ&quot;</span><span class="w"> </span><span class="p">]</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">div</span><span class="w"> </span><span class="p">[]</span>
<span class="w">            </span><span class="p">[</span><span class="w"> </span><span class="nv">text</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;ã‚¹ã‚³ã‚¢: &quot;</span><span class="w"> </span><span class="nf">++</span><span class="w"> </span><span class="kt">String</span><span class="nf">.</span><span class="nv">fromInt</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">score</span><span class="p">)</span>
<span class="w">            </span><span class="p">,</span><span class="w"> </span><span class="nv">text</span><span class="w"> </span><span class="s">&quot; | &quot;</span>
<span class="w">            </span><span class="p">,</span><span class="w"> </span><span class="nv">text</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;é€£é–æ•°: &quot;</span><span class="w"> </span><span class="nf">++</span><span class="w"> </span><span class="kt">String</span><span class="nf">.</span><span class="nv">fromInt</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">chainCount</span><span class="p">)</span>
<span class="w">            </span><span class="p">]</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="kr">case</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">mode</span><span class="w"> </span><span class="kr">of</span>
<span class="w">            </span><span class="kt">Start</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                </span><span class="nv">button</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="nv">onClick</span><span class="w"> </span><span class="kt">StartGame</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="nv">text</span><span class="w"> </span><span class="s">&quot;ã‚²ãƒ¼ãƒ é–‹å§‹&quot;</span><span class="w"> </span><span class="p">]</span>

<span class="w">            </span><span class="kt">GameOver</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                </span><span class="nv">div</span><span class="w"> </span><span class="p">[]</span>
<span class="w">                    </span><span class="p">[</span><span class="w"> </span><span class="nv">div</span><span class="w"> </span><span class="p">[]</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="nv">text</span><span class="w"> </span><span class="s">&quot;ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ï¼&quot;</span><span class="w"> </span><span class="p">]</span>
<span class="w">                    </span><span class="p">,</span><span class="w"> </span><span class="nv">div</span><span class="w"> </span><span class="p">[]</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="nv">text</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;æœ€çµ‚ã‚¹ã‚³ã‚¢: &quot;</span><span class="w"> </span><span class="nf">++</span><span class="w"> </span><span class="kt">String</span><span class="nf">.</span><span class="nv">fromInt</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">score</span><span class="p">)</span><span class="w"> </span><span class="p">]</span>
<span class="w">                    </span><span class="p">]</span>

<span class="w">            </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                </span><span class="nv">div</span><span class="w"> </span><span class="p">[]</span>
<span class="w">                    </span><span class="p">[</span><span class="w"> </span><span class="nv">viewBoard</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">board</span>
<span class="w">                    </span><span class="p">,</span><span class="w"> </span><span class="nv">viewCurrentPair</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">currentPair</span>
<span class="w">                    </span><span class="p">]</span>
<span class="w">        </span><span class="p">]</span>


<span class="nv">viewBoard</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Board</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Html</span><span class="w"> </span><span class="kt">Msg</span>
<span class="nv">viewBoard</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="nv">div</span>
<span class="w">        </span><span class="p">[</span><span class="w"> </span><span class="nv">style</span><span class="w"> </span><span class="s">&quot;display&quot;</span><span class="w"> </span><span class="s">&quot;grid&quot;</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">style</span><span class="w"> </span><span class="s">&quot;grid-template-columns&quot;</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;repeat(&quot;</span><span class="w"> </span><span class="nf">++</span><span class="w"> </span><span class="kt">String</span><span class="nf">.</span><span class="nv">fromInt</span><span class="w"> </span><span class="p">(</span><span class="kt">Board</span><span class="nf">.</span><span class="nv">getCols</span><span class="w"> </span><span class="nv">board</span><span class="p">)</span><span class="w"> </span><span class="nf">++</span><span class="w"> </span><span class="s">&quot;, 30px)&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">style</span><span class="w"> </span><span class="s">&quot;gap&quot;</span><span class="w"> </span><span class="s">&quot;2px&quot;</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">style</span><span class="w"> </span><span class="s">&quot;background-color&quot;</span><span class="w"> </span><span class="s">&quot;#333&quot;</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">style</span><span class="w"> </span><span class="s">&quot;padding&quot;</span><span class="w"> </span><span class="s">&quot;10px&quot;</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">style</span><span class="w"> </span><span class="s">&quot;border-radius&quot;</span><span class="w"> </span><span class="s">&quot;5px&quot;</span>
<span class="w">        </span><span class="p">]</span>
<span class="w">        </span><span class="p">(</span><span class="kt">List</span><span class="nf">.</span><span class="nv">concatMap</span><span class="w"> </span><span class="p">(</span><span class="nv">viewRow</span><span class="w"> </span><span class="nv">board</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="kt">List</span><span class="nf">.</span><span class="nv">range</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">(</span><span class="kt">Board</span><span class="nf">.</span><span class="nv">getRows</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="nf">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)))</span>


<span class="nv">viewRow</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Board</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">List</span><span class="w"> </span><span class="p">(</span><span class="kt">Html</span><span class="w"> </span><span class="kt">Msg</span><span class="p">)</span>
<span class="nv">viewRow</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="kt">List</span><span class="nf">.</span><span class="nv">map</span><span class="w"> </span><span class="p">(</span><span class="nv">viewCell</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="nv">y</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="kt">List</span><span class="nf">.</span><span class="nv">range</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">(</span><span class="kt">Board</span><span class="nf">.</span><span class="nv">getCols</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="nf">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span>


<span class="nv">viewCell</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Board</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Html</span><span class="w"> </span><span class="kt">Msg</span>
<span class="nv">viewCell</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="kr">let</span>
<span class="w">        </span><span class="nv">cellColor</span><span class="w"> </span><span class="nf">=</span>
<span class="w">            </span><span class="kr">case</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">getCell</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="kr">of</span>
<span class="w">                </span><span class="kt">Just</span><span class="w"> </span><span class="p">(</span><span class="kt">Filled</span><span class="w"> </span><span class="kt">Red</span><span class="p">)</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="s">&quot;#ff4444&quot;</span>

<span class="w">                </span><span class="kt">Just</span><span class="w"> </span><span class="p">(</span><span class="kt">Filled</span><span class="w"> </span><span class="kt">Blue</span><span class="p">)</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="s">&quot;#4444ff&quot;</span>

<span class="w">                </span><span class="kt">Just</span><span class="w"> </span><span class="p">(</span><span class="kt">Filled</span><span class="w"> </span><span class="kt">Green</span><span class="p">)</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="s">&quot;#44ff44&quot;</span>

<span class="w">                </span><span class="kt">Just</span><span class="w"> </span><span class="p">(</span><span class="kt">Filled</span><span class="w"> </span><span class="kt">Yellow</span><span class="p">)</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="s">&quot;#ffff44&quot;</span>

<span class="w">                </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="s">&quot;#222&quot;</span>
<span class="w">    </span><span class="kr">in</span>
<span class="w">    </span><span class="nv">div</span>
<span class="w">        </span><span class="p">[</span><span class="w"> </span><span class="nv">style</span><span class="w"> </span><span class="s">&quot;width&quot;</span><span class="w"> </span><span class="s">&quot;30px&quot;</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">style</span><span class="w"> </span><span class="s">&quot;height&quot;</span><span class="w"> </span><span class="s">&quot;30px&quot;</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">style</span><span class="w"> </span><span class="s">&quot;background-color&quot;</span><span class="w"> </span><span class="nv">cellColor</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">style</span><span class="w"> </span><span class="s">&quot;border-radius&quot;</span><span class="w"> </span><span class="s">&quot;50%&quot;</span>
<span class="w">        </span><span class="p">]</span>
<span class="w">        </span><span class="p">[]</span>


<span class="nv">viewCurrentPair</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Maybe</span><span class="w"> </span><span class="kt">PuyoPair</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Html</span><span class="w"> </span><span class="kt">Msg</span>
<span class="nv">viewCurrentPair</span><span class="w"> </span><span class="nv">maybePair</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="kr">case</span><span class="w"> </span><span class="nv">maybePair</span><span class="w"> </span><span class="kr">of</span>
<span class="w">        </span><span class="kt">Just</span><span class="w"> </span><span class="nv">pair</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="nv">div</span>
<span class="w">                </span><span class="p">[</span><span class="w"> </span><span class="nv">style</span><span class="w"> </span><span class="s">&quot;position&quot;</span><span class="w"> </span><span class="s">&quot;absolute&quot;</span>
<span class="w">                </span><span class="p">,</span><span class="w"> </span><span class="nv">style</span><span class="w"> </span><span class="s">&quot;top&quot;</span><span class="w"> </span><span class="s">&quot;50px&quot;</span>
<span class="w">                </span><span class="p">,</span><span class="w"> </span><span class="nv">style</span><span class="w"> </span><span class="s">&quot;left&quot;</span><span class="w"> </span><span class="s">&quot;50px&quot;</span>
<span class="w">                </span><span class="p">]</span>
<span class="w">                </span><span class="p">[</span><span class="w"> </span><span class="nv">text</span><span class="w"> </span><span class="s">&quot;Current Pair (å®Ÿè£…ä¸­)&quot;</span><span class="w"> </span><span class="p">]</span>

<span class="w">        </span><span class="kt">Nothing</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="nv">text</span><span class="w"> </span><span class="s">&quot;&quot;</span>
</code></pre></div>
<h3 id="_69">ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®å®Ÿè¡Œ<a class="headerlink" href="#_69" title="Permanent link">&para;</a></h3>
<p>ã§ã¯ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼š</p>
<div class="highlight"><pre><span></span><code>elm<span class="w"> </span>reactor
</code></pre></div>
<p>ãƒ–ãƒ©ã‚¦ã‚¶ã§ <code>http://localhost:8000</code> ã‚’é–‹ãã€<code>src/Main.elm</code> ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚ã€Œã‚²ãƒ¼ãƒ é–‹å§‹ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã€ã·ã‚ˆã‚’è½ã¨ã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼</p>
<p>ã€Œæœ¬å½“ã ï¼é€£é–ãŒèµ·ãã‚‹ã¨ã‚¹ã‚³ã‚¢ãŒå¢—ãˆã¦ã„ãã¾ã™ï¼ã€ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼é€£é–åå¿œãŒå®Ÿè£…ã§ãã¾ã—ãŸã­ã€‚</p>
<h3 id="7_1">ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³7ã®ã¾ã¨ã‚<a class="headerlink" href="#7_1" title="Permanent link">&para;</a></h3>
<p>ã“ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§å®Ÿè£…ã—ãŸå†…å®¹ï¼š</p>
<ol>
<li><strong>ã‚²ãƒ¼ãƒ ãƒ¢ãƒ¼ãƒ‰ã®æ‹¡å¼µ</strong></li>
<li><code>Checking</code>: æ¶ˆå»åˆ¤å®šãƒ¢ãƒ¼ãƒ‰</li>
<li><code>Erasing</code>: æ¶ˆå»å®Ÿè¡Œãƒ¢ãƒ¼ãƒ‰</li>
<li><code>Falling</code>: é‡åŠ›é©ç”¨ãƒ¢ãƒ¼ãƒ‰</li>
<li>
<p>ãƒ¢ãƒ¼ãƒ‰é·ç§»ã«ã‚ˆã‚‹æ˜ç¢ºãªçŠ¶æ…‹ç®¡ç†</p>
</li>
<li>
<p><strong>é€£é–ã®ä»•çµ„ã¿</strong></p>
</li>
<li><code>Checking â†’ Erasing â†’ Falling â†’ Checking</code> ã®ãƒ«ãƒ¼ãƒ—</li>
<li>æ¶ˆå»å¯¾è±¡ãŒãªããªã‚‹ã¾ã§ç¹°ã‚Šè¿”ã—</li>
<li>
<p>é€£é–æ•°ã®ã‚«ã‚¦ãƒ³ãƒˆ</p>
</li>
<li>
<p><strong>ã‚¹ã‚³ã‚¢è¨ˆç®—</strong></p>
</li>
<li>æ¶ˆå»æ•° Ã— é€£é–ãƒœãƒ¼ãƒŠã‚¹</li>
<li>
<p>é€£é–æ•°ã«å¿œã˜ãŸãƒœãƒ¼ãƒŠã‚¹å€ç‡ï¼ˆ1, 8, 16, 32, ...ï¼‰</p>
</li>
<li>
<p><strong>å…¨ä½“æ¢ç´¢</strong></p>
</li>
<li><code>findAllErasableGroups</code>: ãƒœãƒ¼ãƒ‰å…¨ä½“ã‹ã‚‰æ¶ˆå»å¯èƒ½ãªã‚°ãƒ«ãƒ¼ãƒ—ã‚’æ¢ç´¢</li>
<li>
<p>è¨ªå•æ¸ˆã¿ç®¡ç†ã§é‡è¤‡ãƒã‚§ãƒƒã‚¯ã‚’å›é¿</p>
</li>
<li>
<p><strong>View ã®æ›´æ–°</strong></p>
</li>
<li>ã‚¹ã‚³ã‚¢ã¨é€£é–æ•°ã®è¡¨ç¤º</li>
<li>ãƒœãƒ¼ãƒ‰ã®æç”»</li>
<li>ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ç”»é¢</li>
</ol>
<h3 id="_70">å­¦ã‚“ã ã“ã¨<a class="headerlink" href="#_70" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>çŠ¶æ…‹é·ç§»ãƒ‘ã‚¿ãƒ¼ãƒ³</strong>: ã‚«ã‚¹ã‚¿ãƒ å‹ã¨ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°ã§çŠ¶æ…‹ç®¡ç†</li>
<li><strong>é€£é–ã®è‡ªç„¶ãªå®Ÿç¾</strong>: æ¶ˆå»â†’é‡åŠ›â†’æ¶ˆå»ã®ã‚µã‚¤ã‚¯ãƒ«ã§è‡ªå‹•çš„ã«é€£é–</li>
<li><strong>è¨ªå•æ¸ˆã¿ç®¡ç†</strong>: Set ã‚’ä½¿ã£ãŸæ¢ç´¢ã®æœ€é©åŒ–</li>
<li><strong>ã‚¹ã‚³ã‚¢è¨ˆç®—</strong>: é€£é–æ•°ã«å¿œã˜ãŸæŒ‡æ•°çš„ãªãƒœãƒ¼ãƒŠã‚¹</li>
</ul>
<p>æ¬¡ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ã€å…¨æ¶ˆã—ãƒœãƒ¼ãƒŠã‚¹ã®å®Ÿè£…ã«é€²ã¿ã¾ã™ï¼</p>
<h2 id="8">ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³8: å…¨æ¶ˆã—ãƒœãƒ¼ãƒŠã‚¹ã®å®Ÿè£…<a class="headerlink" href="#8" title="Permanent link">&para;</a></h2>
<p>ã€Œé€£é–ãŒã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸã‘ã©ã€ã·ã‚ˆã·ã‚ˆã«ã¯å…¨æ¶ˆã—ãƒœãƒ¼ãƒŠã‚¹ã‚‚ã‚ã‚Šã¾ã™ã‚ˆã­ï¼Ÿã€ãã†ã§ã™ã­ï¼ã·ã‚ˆã·ã‚ˆã«ã¯ã€ç›¤é¢ä¸Šã®ã·ã‚ˆã‚’ã™ã¹ã¦æ¶ˆã™ã¨å¾—ã‚‰ã‚Œã‚‹ã€Œå…¨æ¶ˆã—ï¼ˆãœã‚“ã‘ã—ï¼‰ãƒœãƒ¼ãƒŠã‚¹ã€ã¨ã„ã†ç‰¹åˆ¥ãªå ±é…¬ãŒã‚ã‚Šã¾ã™ã€‚ä»Šå›ã¯ã€ãã®å…¨æ¶ˆã—ãƒœãƒ¼ãƒŠã‚¹ã‚’å®Ÿè£…ã—ã¦ã„ãã¾ã—ã‚‡ã†ï¼</p>
<h3 id="_71">ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼<a class="headerlink" href="#_71" title="Permanent link">&para;</a></h3>
<p>ã¾ãšã¯ã€ã“ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§å®Ÿè£…ã™ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚’ç¢ºèªã—ã¾ã—ã‚‡ã†ï¼š</p>
<blockquote>
<p>ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¨ã—ã¦ã€ç›¤é¢ä¸Šã®ã·ã‚ˆã‚’ã™ã¹ã¦æ¶ˆã—ãŸã¨ãã«å…¨æ¶ˆã—ãƒœãƒ¼ãƒŠã‚¹ã‚’ç²å¾—ã§ãã‚‹</p>
</blockquote>
<p>ã€Œã‚„ã£ãŸï¼å…¨éƒ¨æ¶ˆãˆãŸï¼ã€ã¨ã„ã†é”æˆæ„Ÿã¨å…±ã«ã€ç‰¹åˆ¥ãªãƒœãƒ¼ãƒŠã‚¹ãƒã‚¤ãƒ³ãƒˆã‚’ç²å¾—ã§ãã‚‹æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¯å…¨æ¶ˆã—ã‚’ç‹™ã£ãŸæˆ¦ç•¥ã‚’è€ƒãˆã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã­ã€‚</p>
<h3 id="todo_7">TODOãƒªã‚¹ãƒˆ<a class="headerlink" href="#todo_7" title="Permanent link">&para;</a></h3>
<p>ã€Œã©ã‚“ãªä½œæ¥­ãŒå¿…è¦ã«ãªã‚Šã¾ã™ã‹ï¼Ÿã€ã“ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚’å®Ÿç¾ã™ã‚‹ãŸã‚ã«ã€TODOãƒªã‚¹ãƒˆã‚’ä½œæˆã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</p>
<p>ã€Œå…¨æ¶ˆã—ãƒœãƒ¼ãƒŠã‚¹ã‚’å®Ÿè£…ã™ã‚‹ã€ã¨ã„ã†æ©Ÿèƒ½ã‚’å®Ÿç¾ã™ã‚‹ãŸã‚ã«ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ãªã‚¿ã‚¹ã‚¯ãŒå¿…è¦ãã†ã§ã™ã­ï¼š</p>
<ul>
<li>å…¨æ¶ˆã—åˆ¤å®šã‚’å®Ÿè£…ã™ã‚‹ï¼ˆç›¤é¢ä¸Šã®ã·ã‚ˆãŒã™ã¹ã¦ç©ºã«ãªã£ãŸã‹ã‚’åˆ¤å®šã™ã‚‹ï¼‰</li>
<li>å…¨æ¶ˆã—ãƒœãƒ¼ãƒŠã‚¹ã®è¨ˆç®—ã‚’å®Ÿè£…ã™ã‚‹ï¼ˆå…¨æ¶ˆã—æ™‚ã«åŠ ç®—ã™ã‚‹ãƒœãƒ¼ãƒŠã‚¹ç‚¹ã‚’è¨ˆç®—ã™ã‚‹ï¼‰</li>
<li>Checking ãƒ¢ãƒ¼ãƒ‰ã§å…¨æ¶ˆã—åˆ¤å®šã‚’è¡Œã†</li>
</ul>
<p>ã€Œãªã‚‹ã»ã©ã€é †ç•ªã«å®Ÿè£…ã—ã¦ã„ã‘ã°ã„ã„ã‚“ã§ã™ã­ï¼ã€ãã†ã§ã™ã€ä¸€ã¤ãšã¤é€²ã‚ã¦ã„ãã¾ã—ã‚‡ã†ã€‚ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã®æµã‚Œã«æ²¿ã£ã¦ã€ã¾ãšã¯ãƒ†ã‚¹ãƒˆã‹ã‚‰æ›¸ã„ã¦ã„ãã¾ã™ã‚ˆã€‚</p>
<h3 id="_72">ãƒ†ã‚¹ãƒˆ: å…¨æ¶ˆã—åˆ¤å®š<a class="headerlink" href="#_72" title="Permanent link">&para;</a></h3>
<p>ã¾ãšã€å…¨æ¶ˆã—åˆ¤å®šã®æ©Ÿèƒ½ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã—ã‚‡ã†ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- tests/GameLogicTests.elmï¼ˆç¶šãï¼‰</span>
<span class="nv">suite</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Test</span>
<span class="nv">suite</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="nv">describe</span><span class="w"> </span><span class="s">&quot;GameLogic&quot;</span>
<span class="w">        </span><span class="p">[</span><span class="w"> </span><span class="c1">-- æ—¢å­˜ã®ãƒ†ã‚¹ãƒˆ...</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">describe</span><span class="w"> </span><span class="s">&quot;isEmpty&quot;</span>
<span class="w">            </span><span class="p">[</span><span class="w"> </span><span class="nv">test</span><span class="w"> </span><span class="s">&quot;ç›¤é¢ãŒã™ã¹ã¦ç©ºãªã‚‰ True ã‚’è¿”ã™&quot;</span><span class="w"> </span><span class="nf">&lt;|</span>
<span class="w">                </span><span class="nf">\</span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="kr">let</span>
<span class="w">                        </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="mi">12</span>
<span class="w">                    </span><span class="kr">in</span>
<span class="w">                    </span><span class="kt">GameLogic</span><span class="nf">.</span><span class="nv">isEmpty</span><span class="w"> </span><span class="nv">board</span>
<span class="w">                        </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">equal</span><span class="w"> </span><span class="kt">True</span>
<span class="w">            </span><span class="p">,</span><span class="w"> </span><span class="nv">test</span><span class="w"> </span><span class="s">&quot;ç›¤é¢ã«ã·ã‚ˆãŒã‚ã‚Œã° False ã‚’è¿”ã™&quot;</span><span class="w"> </span><span class="nf">&lt;|</span>
<span class="w">                </span><span class="nf">\</span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="kr">let</span>
<span class="w">                        </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="mi">12</span>
<span class="w">                                </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">setCell</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">(</span><span class="kt">Filled</span><span class="w"> </span><span class="kt">Red</span><span class="p">)</span>
<span class="w">                    </span><span class="kr">in</span>
<span class="w">                    </span><span class="kt">GameLogic</span><span class="nf">.</span><span class="nv">isEmpty</span><span class="w"> </span><span class="nv">board</span>
<span class="w">                        </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">equal</span><span class="w"> </span><span class="kt">False</span>
<span class="w">            </span><span class="p">]</span>
<span class="w">        </span><span class="p">]</span>
</code></pre></div>
<p>ã€Œã“ã®ãƒ†ã‚¹ãƒˆã§ã¯ä½•ã‚’ç¢ºèªã—ã¦ã„ã‚‹ã‚“ã§ã™ã‹ï¼Ÿã€ã“ã®ãƒ†ã‚¹ãƒˆã§ã¯ã€ä»¥ä¸‹ã®2ã¤ã®ã‚±ãƒ¼ã‚¹ã‚’ç¢ºèªã—ã¦ã„ã¾ã™ï¼š</p>
<ol>
<li>ç›¤é¢ãŒã™ã¹ã¦ç©ºã®å ´åˆã€<code>True</code> ã‚’è¿”ã™ã‹</li>
<li>ç›¤é¢ã«ã·ã‚ˆãŒ1ã¤ã§ã‚‚ã‚ã‚Œã°ã€<code>False</code> ã‚’è¿”ã™ã‹</li>
</ol>
<p>ã€Œã‚·ãƒ³ãƒ—ãƒ«ã§ã™ã­ï¼ã€ãã†ã§ã™ã€‚å…¨æ¶ˆã—åˆ¤å®šã¯ã‚·ãƒ³ãƒ—ãƒ«ãªæ¡ä»¶ã§ã™ã€‚ã§ã¯å®Ÿè£…ã—ã¾ã—ã‚‡ã†ã€‚</p>
<h3 id="_73">å®Ÿè£…: å…¨æ¶ˆã—åˆ¤å®š<a class="headerlink" href="#_73" title="Permanent link">&para;</a></h3>
<p>å…¨æ¶ˆã—åˆ¤å®šã®æ©Ÿèƒ½ã‚’ <code>GameLogic</code> ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«è¿½åŠ ã—ã¾ã™ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- src/GameLogic.elmï¼ˆç¶šãï¼‰</span>
<span class="cm">{-| ç›¤é¢ãŒã™ã¹ã¦ç©ºã‹ã©ã†ã‹ã‚’åˆ¤å®šã™ã‚‹ï¼ˆå…¨æ¶ˆã—åˆ¤å®šï¼‰</span>
<span class="cm">-}</span>
<span class="nv">isEmpty</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Board</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Bool</span>
<span class="nv">isEmpty</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="kr">let</span>
<span class="w">        </span><span class="nv">cols</span><span class="w"> </span><span class="nf">=</span>
<span class="w">            </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">getCols</span><span class="w"> </span><span class="nv">board</span>

<span class="w">        </span><span class="nv">rows</span><span class="w"> </span><span class="nf">=</span>
<span class="w">            </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">getRows</span><span class="w"> </span><span class="nv">board</span>

<span class="w">        </span><span class="c1">-- ã™ã¹ã¦ã®ã‚»ãƒ«ã‚’ãƒã‚§ãƒƒã‚¯</span>
<span class="w">        </span><span class="nv">allPositions</span><span class="w"> </span><span class="nf">=</span>
<span class="w">            </span><span class="kt">List</span><span class="nf">.</span><span class="nv">concatMap</span>
<span class="w">                </span><span class="p">(</span><span class="nf">\</span><span class="nv">y</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">map</span><span class="w"> </span><span class="p">(</span><span class="nf">\</span><span class="nv">x</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nv">x</span><span class="p">,</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="p">))</span><span class="w"> </span><span class="p">(</span><span class="kt">List</span><span class="nf">.</span><span class="nv">range</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">(</span><span class="nv">cols</span><span class="w"> </span><span class="nf">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)))</span>
<span class="w">                </span><span class="p">(</span><span class="kt">List</span><span class="nf">.</span><span class="nv">range</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">(</span><span class="nv">rows</span><span class="w"> </span><span class="nf">-</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span>

<span class="w">        </span><span class="c1">-- 1ã¤ã§ã‚‚Filled ãŒã‚ã‚Œã° False</span>
<span class="w">        </span><span class="nv">hasAnyPuyo</span><span class="w"> </span><span class="nf">=</span>
<span class="w">            </span><span class="kt">List</span><span class="nf">.</span><span class="nv">any</span>
<span class="w">                </span><span class="p">(</span><span class="nf">\</span><span class="p">(</span><span class="w"> </span><span class="nv">x</span><span class="p">,</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="kr">case</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">getCell</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="kr">of</span>
<span class="w">                        </span><span class="kt">Just</span><span class="w"> </span><span class="p">(</span><span class="kt">Filled</span><span class="w"> </span><span class="nv">_</span><span class="p">)</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                            </span><span class="kt">True</span>

<span class="w">                        </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                            </span><span class="kt">False</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">                </span><span class="nv">allPositions</span>
<span class="w">    </span><span class="kr">in</span>
<span class="w">    </span><span class="nv">not</span><span class="w"> </span><span class="nv">hasAnyPuyo</span>
</code></pre></div>
<p>ã€Œ<code>List.any</code> ã‚’ä½¿ã£ã¦ã„ã‚‹ã‚“ã§ã™ã­ï¼ã€ãã†ã§ã™ã€‚<code>List.any</code> ã¯ã€ãƒªã‚¹ãƒˆã®ä¸­ã«æ¡ä»¶ã‚’æº€ãŸã™è¦ç´ ãŒ1ã¤ã§ã‚‚ã‚ã‚Œã° <code>True</code> ã‚’è¿”ã—ã¾ã™ã€‚ã“ã“ã§ã¯ã€ŒFilled ã‚»ãƒ«ãŒã‚ã‚‹ã‹ã€ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ã„ã¾ã™ã€‚</p>
<h3 id="_74">ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œ<a class="headerlink" href="#_74" title="Permanent link">&para;</a></h3>
<p>ã§ã¯ã€ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼š</p>
<div class="highlight"><pre><span></span><code>elm-test
</code></pre></div>
<p>ã€Œã‚„ã£ãŸï¼ãƒ†ã‚¹ãƒˆãŒé€šã‚Šã¾ã—ãŸï¼ã€ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼å…¨æ¶ˆã—åˆ¤å®šãŒå®Ÿè£…ã§ãã¾ã—ãŸã­ã€‚</p>
<h3 id="_75">å®Ÿè£…: å…¨æ¶ˆã—ãƒœãƒ¼ãƒŠã‚¹ã®çµ±åˆ<a class="headerlink" href="#_75" title="Permanent link">&para;</a></h3>
<p>æ¬¡ã«ã€<code>Checking</code> ãƒ¢ãƒ¼ãƒ‰ã§å…¨æ¶ˆã—åˆ¤å®šã‚’è¡Œã„ã€å…¨æ¶ˆã—ã®å ´åˆã¯ãƒœãƒ¼ãƒŠã‚¹ã‚’åŠ ç®—ã™ã‚‹ã‚ˆã†ã«å®Ÿè£…ã—ã¾ã™ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- src/Main.elmï¼ˆupdate é–¢æ•°ã® Checking ãƒ¢ãƒ¼ãƒ‰éƒ¨åˆ†ã‚’ä¿®æ­£ï¼‰</span>
<span class="nv">update</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Msg</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Model</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="kt">Model</span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="w"> </span><span class="kt">Msg</span><span class="w"> </span><span class="p">)</span>
<span class="nv">update</span><span class="w"> </span><span class="nv">msg</span><span class="w"> </span><span class="nv">model</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="kr">case</span><span class="w"> </span><span class="nv">msg</span><span class="w"> </span><span class="kr">of</span>
<span class="w">        </span><span class="c1">-- æ—¢å­˜ã®å‡¦ç†...</span>

<span class="w">        </span><span class="kt">Tick</span><span class="w"> </span><span class="nv">deltaTime</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="kr">case</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">mode</span><span class="w"> </span><span class="kr">of</span>
<span class="w">                </span><span class="c1">-- æ—¢å­˜ã® Playing, Erasing, Falling ãƒ¢ãƒ¼ãƒ‰...</span>

<span class="w">                </span><span class="kt">Checking</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="c1">-- æ¶ˆå»åˆ¤å®šãƒ¢ãƒ¼ãƒ‰</span>
<span class="w">                    </span><span class="kr">let</span>
<span class="w">                        </span><span class="nv">erasableGroups</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="nv">findAllErasableGroups</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">board</span>
<span class="w">                    </span><span class="kr">in</span>
<span class="w">                    </span><span class="kr">if</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">isEmpty</span><span class="w"> </span><span class="nv">erasableGroups</span><span class="w"> </span><span class="kr">then</span>
<span class="w">                        </span><span class="c1">-- æ¶ˆå»ãªã— â†’ å…¨æ¶ˆã—ãƒã‚§ãƒƒã‚¯</span>
<span class="w">                        </span><span class="kr">let</span>
<span class="w">                            </span><span class="nv">isAllClear</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                                </span><span class="kt">GameLogic</span><span class="nf">.</span><span class="nv">isEmpty</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">board</span>

<span class="w">                            </span><span class="nv">zenkeshiBonus</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                                </span><span class="kr">if</span><span class="w"> </span><span class="nv">isAllClear</span><span class="w"> </span><span class="kr">then</span>
<span class="w">                                    </span><span class="mi">3600</span><span class="w">  </span><span class="c1">-- å…¨æ¶ˆã—ãƒœãƒ¼ãƒŠã‚¹</span>

<span class="w">                                </span><span class="kr">else</span>
<span class="w">                                    </span><span class="mi">0</span>
<span class="w">                        </span><span class="kr">in</span>
<span class="w">                        </span><span class="c1">-- æ¬¡ã®ã·ã‚ˆã‚’å‡ºã™</span>
<span class="w">                        </span><span class="p">(</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">model</span>
<span class="w">                            </span><span class="nf">|</span><span class="w"> </span><span class="nv">mode</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Playing</span>
<span class="w">                            </span><span class="nf">|</span><span class="w"> </span><span class="nv">currentPair</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Just</span><span class="w"> </span><span class="p">(</span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="kt">Red</span><span class="w"> </span><span class="kt">Blue</span><span class="p">)</span>
<span class="w">                            </span><span class="nf">|</span><span class="w"> </span><span class="nv">score</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">score</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="nv">zenkeshiBonus</span>
<span class="w">                          </span><span class="p">}</span>
<span class="w">                        </span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="nf">.</span><span class="nv">none</span>
<span class="w">                        </span><span class="p">)</span>

<span class="w">                    </span><span class="kr">else</span>
<span class="w">                        </span><span class="c1">-- æ¶ˆå»ã‚ã‚Š â†’ æ¶ˆå»ãƒ¢ãƒ¼ãƒ‰ã¸</span>
<span class="w">                        </span><span class="kr">let</span>
<span class="w">                            </span><span class="nv">newChainCount</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                                </span><span class="nv">model</span><span class="nf">.</span><span class="nv">chainCount</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="mi">1</span>

<span class="w">                            </span><span class="nv">erasedCount</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                                </span><span class="kt">List</span><span class="nf">.</span><span class="nv">sum</span><span class="w"> </span><span class="p">(</span><span class="kt">List</span><span class="nf">.</span><span class="nv">map</span><span class="w"> </span><span class="kt">Set</span><span class="nf">.</span><span class="nv">size</span><span class="w"> </span><span class="nv">erasableGroups</span><span class="p">)</span>

<span class="w">                            </span><span class="nv">chainBonus</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                                </span><span class="kr">case</span><span class="w"> </span><span class="nv">newChainCount</span><span class="w"> </span><span class="kr">of</span>
<span class="w">                                    </span><span class="mi">1</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                                    </span><span class="mi">2</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="mi">8</span>
<span class="w">                                    </span><span class="mi">3</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="mi">16</span>
<span class="w">                                    </span><span class="mi">4</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="mi">32</span>
<span class="w">                                    </span><span class="mi">5</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="mi">64</span>
<span class="w">                                    </span><span class="mi">6</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="mi">96</span>
<span class="w">                                    </span><span class="mi">7</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="mi">128</span>
<span class="w">                                    </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="mi">160</span>

<span class="w">                            </span><span class="nv">points</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                                </span><span class="nv">erasedCount</span><span class="w"> </span><span class="nf">*</span><span class="w"> </span><span class="nv">chainBonus</span>

<span class="w">                            </span><span class="nv">newBoard</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                                </span><span class="kt">List</span><span class="nf">.</span><span class="nv">foldl</span><span class="w"> </span><span class="kt">GameLogic</span><span class="nf">.</span><span class="nv">erasePuyos</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">board</span><span class="w"> </span><span class="nv">erasableGroups</span>
<span class="w">                        </span><span class="kr">in</span>
<span class="w">                        </span><span class="p">(</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">model</span>
<span class="w">                            </span><span class="nf">|</span><span class="w"> </span><span class="nv">mode</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Erasing</span>
<span class="w">                            </span><span class="nf">|</span><span class="w"> </span><span class="nv">chainCount</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">newChainCount</span>
<span class="w">                            </span><span class="nf">|</span><span class="w"> </span><span class="nv">score</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">score</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="nv">points</span>
<span class="w">                            </span><span class="nf">|</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">newBoard</span>
<span class="w">                          </span><span class="p">}</span>
<span class="w">                        </span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="nf">.</span><span class="nv">none</span>
<span class="w">                        </span><span class="p">)</span>

<span class="w">                </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="p">(</span><span class="w"> </span><span class="nv">model</span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="nf">.</span><span class="nv">none</span><span class="w"> </span><span class="p">)</span>

<span class="w">        </span><span class="c1">-- ãã®ä»–ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å‡¦ç†...</span>
<span class="w">        </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="p">(</span><span class="w"> </span><span class="nv">model</span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="nf">.</span><span class="nv">none</span><span class="w"> </span><span class="p">)</span>
</code></pre></div>
<p>ã€Œ<code>Checking</code> ãƒ¢ãƒ¼ãƒ‰ã§å…¨æ¶ˆã—ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ã€è©²å½“ã™ã‚Œã°ãƒœãƒ¼ãƒŠã‚¹ã‚’åŠ ç®—ã—ã¦ã„ã‚‹ã‚“ã§ã™ã­ï¼ã€ãã†ã§ã™ï¼å‡¦ç†ã®æµã‚Œã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ï¼š</p>
<ol>
<li><strong>æ¶ˆå»å¯¾è±¡ãªã—</strong>ã®å ´åˆï¼š</li>
<li>å…¨æ¶ˆã—åˆ¤å®šã‚’è¡Œã†ï¼ˆ<code>GameLogic.isEmpty</code>ï¼‰</li>
<li>å…¨æ¶ˆã—ãªã‚‰ 3600 ç‚¹ã®ãƒœãƒ¼ãƒŠã‚¹ã‚’åŠ ç®—</li>
<li>
<p>æ¬¡ã®ã·ã‚ˆã‚’å‡ºã—ã¦ <code>Playing</code> ãƒ¢ãƒ¼ãƒ‰ã¸</p>
</li>
<li>
<p><strong>æ¶ˆå»å¯¾è±¡ã‚ã‚Š</strong>ã®å ´åˆï¼š</p>
</li>
<li>é€£é–ã‚«ã‚¦ãƒ³ãƒˆã‚’å¢—ã‚„ã™</li>
<li>ã‚¹ã‚³ã‚¢ã‚’è¨ˆç®—ã—ã¦åŠ ç®—</li>
<li><code>Erasing</code> ãƒ¢ãƒ¼ãƒ‰ã¸</li>
</ol>
<h3 id="view_2">View ã®æ›´æ–°<a class="headerlink" href="#view_2" title="Permanent link">&para;</a></h3>
<p>å…¨æ¶ˆã—ãŒç™ºç”Ÿã—ãŸã“ã¨ã‚’è¦–è¦šçš„ã«åˆ†ã‹ã‚Šã‚„ã™ãã™ã‚‹ãŸã‚ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã—ã¾ã—ã‚‡ã†ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- src/Main.elmï¼ˆModel ã®æ‹¡å¼µï¼‰</span>
<span class="kr">type</span><span class="w"> </span><span class="kr">alias</span><span class="w"> </span><span class="kt">Model</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Board</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">currentPair</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Maybe</span><span class="w"> </span><span class="kt">PuyoPair</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">mode</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">GameMode</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">dropTimer</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Float</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">dropInterval</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Float</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">fastDropActive</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Bool</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">chainCount</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Int</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">score</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Int</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">message</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">String</span><span class="w">      </span><span class="c1">-- è¿½åŠ : ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤ºç”¨</span>
<span class="w">    </span><span class="p">}</span>


<span class="nv">init</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Model</span>
<span class="nv">init</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="mi">12</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">currentPair</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Nothing</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">mode</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Start</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">dropTimer</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">dropInterval</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="mi">1000</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">fastDropActive</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">False</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">chainCount</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">score</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="nv">message</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w">          </span><span class="c1">-- è¿½åŠ </span>
<span class="w">    </span><span class="p">}</span>


<span class="c1">-- update é–¢æ•°ã® Checking ãƒ¢ãƒ¼ãƒ‰éƒ¨åˆ†ã‚’ä¿®æ­£</span>
<span class="kt">Checking</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">    </span><span class="kr">let</span>
<span class="w">        </span><span class="nv">erasableGroups</span><span class="w"> </span><span class="nf">=</span>
<span class="w">            </span><span class="nv">findAllErasableGroups</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">board</span>
<span class="w">    </span><span class="kr">in</span>
<span class="w">    </span><span class="kr">if</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">isEmpty</span><span class="w"> </span><span class="nv">erasableGroups</span><span class="w"> </span><span class="kr">then</span>
<span class="w">        </span><span class="kr">let</span>
<span class="w">            </span><span class="nv">isAllClear</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                </span><span class="kt">GameLogic</span><span class="nf">.</span><span class="nv">isEmpty</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">board</span>

<span class="w">            </span><span class="nv">zenkeshiBonus</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                </span><span class="kr">if</span><span class="w"> </span><span class="nv">isAllClear</span><span class="w"> </span><span class="kr">then</span>
<span class="w">                    </span><span class="mi">3600</span>

<span class="w">                </span><span class="kr">else</span>
<span class="w">                    </span><span class="mi">0</span>

<span class="w">            </span><span class="nv">message</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                </span><span class="kr">if</span><span class="w"> </span><span class="nv">isAllClear</span><span class="w"> </span><span class="kr">then</span>
<span class="w">                    </span><span class="s">&quot;å…¨æ¶ˆã—ï¼+3600&quot;</span>

<span class="w">                </span><span class="kr">else</span>
<span class="w">                    </span><span class="s">&quot;&quot;</span>
<span class="w">        </span><span class="kr">in</span>
<span class="w">        </span><span class="p">(</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">model</span>
<span class="w">            </span><span class="nf">|</span><span class="w"> </span><span class="nv">mode</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Playing</span>
<span class="w">            </span><span class="nf">|</span><span class="w"> </span><span class="nv">currentPair</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Just</span><span class="w"> </span><span class="p">(</span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="kt">Red</span><span class="w"> </span><span class="kt">Blue</span><span class="p">)</span>
<span class="w">            </span><span class="nf">|</span><span class="w"> </span><span class="nv">score</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">score</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="nv">zenkeshiBonus</span>
<span class="w">            </span><span class="nf">|</span><span class="w"> </span><span class="nv">message</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">message</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="nf">.</span><span class="nv">none</span>
<span class="w">        </span><span class="p">)</span>

<span class="w">    </span><span class="kr">else</span>
<span class="w">        </span><span class="c1">-- æ—¢å­˜ã®å‡¦ç†...</span>


<span class="c1">-- view é–¢æ•°ã§ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º</span>
<span class="nv">view</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Model</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Html</span><span class="w"> </span><span class="kt">Msg</span>
<span class="nv">view</span><span class="w"> </span><span class="nv">model</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="nv">div</span><span class="w"> </span><span class="p">[]</span>
<span class="w">        </span><span class="p">[</span><span class="w"> </span><span class="nv">h1</span><span class="w"> </span><span class="p">[]</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="nv">text</span><span class="w"> </span><span class="s">&quot;ã·ã‚ˆã·ã‚ˆ - Elm ç‰ˆ&quot;</span><span class="w"> </span><span class="p">]</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">div</span><span class="w"> </span><span class="p">[]</span>
<span class="w">            </span><span class="p">[</span><span class="w"> </span><span class="nv">text</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;ã‚¹ã‚³ã‚¢: &quot;</span><span class="w"> </span><span class="nf">++</span><span class="w"> </span><span class="kt">String</span><span class="nf">.</span><span class="nv">fromInt</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">score</span><span class="p">)</span>
<span class="w">            </span><span class="p">,</span><span class="w"> </span><span class="nv">text</span><span class="w"> </span><span class="s">&quot; | &quot;</span>
<span class="w">            </span><span class="p">,</span><span class="w"> </span><span class="nv">text</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;é€£é–æ•°: &quot;</span><span class="w"> </span><span class="nf">++</span><span class="w"> </span><span class="kt">String</span><span class="nf">.</span><span class="nv">fromInt</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">chainCount</span><span class="p">)</span>
<span class="w">            </span><span class="p">]</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="kr">if</span><span class="w"> </span><span class="kt">String</span><span class="nf">.</span><span class="nv">isEmpty</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">message</span><span class="w"> </span><span class="kr">then</span>
<span class="w">            </span><span class="nv">text</span><span class="w"> </span><span class="s">&quot;&quot;</span>

<span class="w">          </span><span class="kr">else</span>
<span class="w">            </span><span class="nv">div</span>
<span class="w">                </span><span class="p">[</span><span class="w"> </span><span class="nv">style</span><span class="w"> </span><span class="s">&quot;color&quot;</span><span class="w"> </span><span class="s">&quot;gold&quot;</span>
<span class="w">                </span><span class="p">,</span><span class="w"> </span><span class="nv">style</span><span class="w"> </span><span class="s">&quot;font-weight&quot;</span><span class="w"> </span><span class="s">&quot;bold&quot;</span>
<span class="w">                </span><span class="p">,</span><span class="w"> </span><span class="nv">style</span><span class="w"> </span><span class="s">&quot;font-size&quot;</span><span class="w"> </span><span class="s">&quot;24px&quot;</span>
<span class="w">                </span><span class="p">,</span><span class="w"> </span><span class="nv">style</span><span class="w"> </span><span class="s">&quot;margin&quot;</span><span class="w"> </span><span class="s">&quot;10px 0&quot;</span>
<span class="w">                </span><span class="p">]</span>
<span class="w">                </span><span class="p">[</span><span class="w"> </span><span class="nv">text</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">message</span><span class="w"> </span><span class="p">]</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="kr">case</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">mode</span><span class="w"> </span><span class="kr">of</span>
<span class="w">            </span><span class="kt">Start</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                </span><span class="nv">button</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="nv">onClick</span><span class="w"> </span><span class="kt">StartGame</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="nv">text</span><span class="w"> </span><span class="s">&quot;ã‚²ãƒ¼ãƒ é–‹å§‹&quot;</span><span class="w"> </span><span class="p">]</span>

<span class="w">            </span><span class="kt">GameOver</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                </span><span class="nv">div</span><span class="w"> </span><span class="p">[]</span>
<span class="w">                    </span><span class="p">[</span><span class="w"> </span><span class="nv">div</span><span class="w"> </span><span class="p">[]</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="nv">text</span><span class="w"> </span><span class="s">&quot;ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ï¼&quot;</span><span class="w"> </span><span class="p">]</span>
<span class="w">                    </span><span class="p">,</span><span class="w"> </span><span class="nv">div</span><span class="w"> </span><span class="p">[]</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="nv">text</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;æœ€çµ‚ã‚¹ã‚³ã‚¢: &quot;</span><span class="w"> </span><span class="nf">++</span><span class="w"> </span><span class="kt">String</span><span class="nf">.</span><span class="nv">fromInt</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">score</span><span class="p">)</span><span class="w"> </span><span class="p">]</span>
<span class="w">                    </span><span class="p">]</span>

<span class="w">            </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                </span><span class="nv">div</span><span class="w"> </span><span class="p">[]</span>
<span class="w">                    </span><span class="p">[</span><span class="w"> </span><span class="nv">viewBoard</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">board</span>
<span class="w">                    </span><span class="p">,</span><span class="w"> </span><span class="nv">viewCurrentPair</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">currentPair</span>
<span class="w">                    </span><span class="p">]</span>
<span class="w">        </span><span class="p">]</span>
</code></pre></div>
<p>ã€Œå…¨æ¶ˆã—ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒé‡‘è‰²ã§è¡¨ç¤ºã•ã‚Œã‚‹ã‚“ã§ã™ã­ï¼ã€ãã†ã§ã™ï¼<code>style</code> å±æ€§ã§è‰²ã‚„ã‚µã‚¤ã‚ºã‚’æŒ‡å®šã—ã¦ã€ç›®ç«‹ã¤ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚</p>
<h3 id="_76">ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®å®Ÿè¡Œ<a class="headerlink" href="#_76" title="Permanent link">&para;</a></h3>
<p>ã§ã¯ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼š</p>
<div class="highlight"><pre><span></span><code>elm<span class="w"> </span>reactor
</code></pre></div>
<p>ãƒ–ãƒ©ã‚¦ã‚¶ã§ <code>http://localhost:8000</code> ã‚’é–‹ãã€<code>src/Main.elm</code> ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚ç›¤é¢ã®ã·ã‚ˆã‚’ã™ã¹ã¦æ¶ˆã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼</p>
<p>ã€Œæœ¬å½“ã ï¼å…¨æ¶ˆã—ã™ã‚‹ã¨ã€å…¨æ¶ˆã—ï¼+3600ã€ã£ã¦è¡¨ç¤ºã•ã‚Œã¾ã™ï¼ã€ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼å…¨æ¶ˆã—ãƒœãƒ¼ãƒŠã‚¹ãŒå®Ÿè£…ã§ãã¾ã—ãŸã­ã€‚</p>
<h3 id="8_1">ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³8ã®ã¾ã¨ã‚<a class="headerlink" href="#8_1" title="Permanent link">&para;</a></h3>
<p>ã“ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§å®Ÿè£…ã—ãŸå†…å®¹ï¼š</p>
<ol>
<li><strong>å…¨æ¶ˆã—åˆ¤å®š</strong></li>
<li><code>GameLogic.isEmpty</code>: ç›¤é¢ãŒã™ã¹ã¦ç©ºã‹ã‚’åˆ¤å®š</li>
<li>
<p><code>List.any</code> ã§ Filled ã‚»ãƒ«ã®å­˜åœ¨ã‚’ãƒã‚§ãƒƒã‚¯</p>
</li>
<li>
<p><strong>å…¨æ¶ˆã—ãƒœãƒ¼ãƒŠã‚¹</strong></p>
</li>
<li>æ¶ˆå»å¯¾è±¡ãŒãªã„æ™‚ã«å…¨æ¶ˆã—åˆ¤å®š</li>
<li>å…¨æ¶ˆã—ã®å ´åˆã¯ 3600 ç‚¹ã®ãƒœãƒ¼ãƒŠã‚¹</li>
<li>
<p>ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã§å…¨æ¶ˆã—ã‚’é€šçŸ¥</p>
</li>
<li>
<p><strong>View ã®æ‹¡å¼µ</strong></p>
</li>
<li><code>message</code> ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã§ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º</li>
<li>
<p>å…¨æ¶ˆã—æ™‚ã¯é‡‘è‰²ã§ç›®ç«‹ã¤è¡¨ç¤º</p>
</li>
<li>
<p><strong>ãƒ†ã‚¹ãƒˆã®ä½œæˆ</strong></p>
</li>
<li>å…¨æ¶ˆã—åˆ¤å®šã®ãƒ†ã‚¹ãƒˆï¼ˆ2ãƒ†ã‚¹ãƒˆï¼‰</li>
</ol>
<h3 id="_77">å­¦ã‚“ã ã“ã¨<a class="headerlink" href="#_77" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>List.any ã®æ´»ç”¨</strong>: ãƒªã‚¹ãƒˆã®ä¸­ã«æ¡ä»¶ã‚’æº€ãŸã™è¦ç´ ãŒã‚ã‚‹ã‹ã‚’ç°¡æ½”ã«ãƒã‚§ãƒƒã‚¯</li>
<li><strong>æ¡ä»¶åˆ†å²ã«ã‚ˆã‚‹ãƒœãƒ¼ãƒŠã‚¹</strong>: if å¼ã§ãƒœãƒ¼ãƒŠã‚¹ã®æœ‰ç„¡ã‚’åˆ‡ã‚Šæ›¿ãˆ</li>
<li><strong>è¦–è¦šçš„ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯</strong>: style å±æ€§ã§å‹•çš„ã«ã‚¹ã‚¿ã‚¤ãƒ«ã‚’å¤‰æ›´</li>
<li><strong>ä¸€æ™‚çš„ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸</strong>: Model ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’è¿½åŠ </li>
</ul>
<p>æ¬¡ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ã€ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼åˆ¤å®šã®å®Ÿè£…ã«é€²ã¿ã¾ã™ï¼</p>
<h2 id="9">ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³9: ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ã®å®Ÿè£…<a class="headerlink" href="#9" title="Permanent link">&para;</a></h2>
<p>ã€Œã‚²ãƒ¼ãƒ ãŒçµ‚ã‚ã‚‹æ¡ä»¶ã‚‚å¿…è¦ã§ã™ã‚ˆã­ï¼Ÿã€ãã†ã§ã™ã­ï¼ã©ã‚“ãªã‚²ãƒ¼ãƒ ã«ã‚‚çµ‚ã‚ã‚ŠãŒã‚ã‚Šã¾ã™ã€‚ã·ã‚ˆã·ã‚ˆã§ã¯ã€æ–°ã—ã„ã·ã‚ˆã‚’é…ç½®ã§ããªããªã£ãŸã¨ãã«ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ã¨ãªã‚Šã¾ã™ã€‚ä»Šå›ã¯ã€ãã®ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼åˆ¤å®šã¨æ¼”å‡ºã‚’å®Ÿè£…ã—ã¦ã„ãã¾ã—ã‚‡ã†ï¼</p>
<h3 id="_78">ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼<a class="headerlink" href="#_78" title="Permanent link">&para;</a></h3>
<p>ã¾ãšã¯ã€ã“ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§å®Ÿè£…ã™ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚’ç¢ºèªã—ã¾ã—ã‚‡ã†ï¼š</p>
<blockquote>
<p>ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¨ã—ã¦ã€ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ã«ãªã‚‹ã¨ã‚²ãƒ¼ãƒ çµ‚äº†ã®æ¼”å‡ºã‚’è¦‹ã‚‹ã“ã¨ãŒã§ãã‚‹</p>
</blockquote>
<p>ã€Œã‚²ãƒ¼ãƒ ãŒçµ‚ã‚ã£ãŸã“ã¨ãŒæ˜ç¢ºã«åˆ†ã‹ã‚‹ã¨ã„ã„ã§ã™ã­ï¼ã€ãã†ã§ã™ã­ã€‚ã‚²ãƒ¼ãƒ ã®çµ‚ã‚ã‚ŠãŒæ˜ç¢ºã§ãªã„ã¨ã€ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¯ãƒ¢ãƒ¤ãƒ¢ãƒ¤ã—ãŸæ°—æŒã¡ã«ãªã£ã¦ã—ã¾ã„ã¾ã™ã€‚</p>
<h3 id="todo_8">TODOãƒªã‚¹ãƒˆ<a class="headerlink" href="#todo_8" title="Permanent link">&para;</a></h3>
<p>ã€Œã©ã‚“ãªä½œæ¥­ãŒå¿…è¦ã«ãªã‚Šã¾ã™ã‹ï¼Ÿã€ã“ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚’å®Ÿç¾ã™ã‚‹ãŸã‚ã«ã€TODOãƒªã‚¹ãƒˆã‚’ä½œæˆã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</p>
<p>ã€Œã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ã‚’å®Ÿè£…ã™ã‚‹ã€ã¨ã„ã†æ©Ÿèƒ½ã‚’å®Ÿç¾ã™ã‚‹ãŸã‚ã«ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ãªã‚¿ã‚¹ã‚¯ãŒå¿…è¦ãã†ã§ã™ã­ï¼š</p>
<ul>
<li>ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼åˆ¤å®šã‚’å®Ÿè£…ã™ã‚‹ï¼ˆæ–°ã—ã„ã·ã‚ˆã‚’é…ç½®ã§ããªã„çŠ¶æ…‹ã‚’æ¤œå‡ºã™ã‚‹ï¼‰</li>
<li>ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼æ¼”å‡ºã‚’å®Ÿè£…ã™ã‚‹ï¼ˆGameOver ãƒ¢ãƒ¼ãƒ‰ã¸ã®é·ç§»ï¼‰</li>
<li>ãƒªã‚¹ã‚¿ãƒ¼ãƒˆæ©Ÿèƒ½ã‚’å®Ÿè£…ã™ã‚‹ï¼ˆã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼å¾Œã«æ–°ã—ã„ã‚²ãƒ¼ãƒ ã‚’å§‹ã‚ã‚‰ã‚Œã‚‹ã‚ˆã†ã«ã™ã‚‹ï¼‰</li>
</ul>
<p>ã€Œãªã‚‹ã»ã©ã€é †ç•ªã«å®Ÿè£…ã—ã¦ã„ã‘ã°ã„ã„ã‚“ã§ã™ã­ï¼ã€ãã†ã§ã™ã€ä¸€ã¤ãšã¤é€²ã‚ã¦ã„ãã¾ã—ã‚‡ã†ã€‚</p>
<h3 id="_79">ãƒ†ã‚¹ãƒˆ: ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼åˆ¤å®š<a class="headerlink" href="#_79" title="Permanent link">&para;</a></h3>
<p>ã¾ãšã€æ–°ã—ã„ã·ã‚ˆãŒé…ç½®ã§ãã‚‹ã‹ã©ã†ã‹ã‚’åˆ¤å®šã™ã‚‹æ©Ÿèƒ½ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã—ã‚‡ã†ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- tests/PuyoPairTests.elmï¼ˆç¶šãï¼‰</span>
<span class="nv">suite</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Test</span>
<span class="nv">suite</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="nv">describe</span><span class="w"> </span><span class="s">&quot;PuyoPair&quot;</span>
<span class="w">        </span><span class="p">[</span><span class="w"> </span><span class="c1">-- æ—¢å­˜ã®ãƒ†ã‚¹ãƒˆ...</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">describe</span><span class="w"> </span><span class="s">&quot;canSpawn&quot;</span>
<span class="w">            </span><span class="p">[</span><span class="w"> </span><span class="nv">test</span><span class="w"> </span><span class="s">&quot;é…ç½®ä½ç½®ãŒç©ºãªã‚‰ç”Ÿæˆå¯èƒ½&quot;</span><span class="w"> </span><span class="nf">&lt;|</span>
<span class="w">                </span><span class="nf">\</span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="kr">let</span>
<span class="w">                        </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="mi">12</span>

<span class="w">                        </span><span class="nv">pair</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="kt">Red</span><span class="w"> </span><span class="kt">Blue</span>
<span class="w">                    </span><span class="kr">in</span>
<span class="w">                    </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">canMove</span><span class="w"> </span><span class="nv">pair</span><span class="w"> </span><span class="nv">board</span>
<span class="w">                        </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">equal</span><span class="w"> </span><span class="kt">True</span>
<span class="w">            </span><span class="p">,</span><span class="w"> </span><span class="nv">test</span><span class="w"> </span><span class="s">&quot;è»¸ã·ã‚ˆã®ä½ç½®ãŒåŸ‹ã¾ã£ã¦ã„ãŸã‚‰ç”Ÿæˆä¸å¯&quot;</span><span class="w"> </span><span class="nf">&lt;|</span>
<span class="w">                </span><span class="nf">\</span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="kr">let</span>
<span class="w">                        </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="mi">12</span>
<span class="w">                                </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">setCell</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">(</span><span class="kt">Filled</span><span class="w"> </span><span class="kt">Blue</span><span class="p">)</span>

<span class="w">                        </span><span class="nv">pair</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="kt">Red</span><span class="w"> </span><span class="kt">Blue</span>
<span class="w">                    </span><span class="kr">in</span>
<span class="w">                    </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">canMove</span><span class="w"> </span><span class="nv">pair</span><span class="w"> </span><span class="nv">board</span>
<span class="w">                        </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">equal</span><span class="w"> </span><span class="kt">False</span>
<span class="w">            </span><span class="p">,</span><span class="w"> </span><span class="nv">test</span><span class="w"> </span><span class="s">&quot;å­ã·ã‚ˆã®ä½ç½®ãŒåŸ‹ã¾ã£ã¦ã„ãŸã‚‰ç”Ÿæˆä¸å¯&quot;</span><span class="w"> </span><span class="nf">&lt;|</span>
<span class="w">                </span><span class="nf">\</span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="kr">let</span>
<span class="w">                        </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="mi">12</span>
<span class="w">                                </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Board</span><span class="nf">.</span><span class="nv">setCell</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">(</span><span class="kt">Filled</span><span class="w"> </span><span class="kt">Blue</span><span class="p">)</span>

<span class="w">                        </span><span class="nv">pair</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="kt">Red</span><span class="w"> </span><span class="kt">Blue</span>
<span class="w">                    </span><span class="kr">in</span>
<span class="w">                    </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">canMove</span><span class="w"> </span><span class="nv">pair</span><span class="w"> </span><span class="nv">board</span>
<span class="w">                        </span><span class="nf">|&gt;</span><span class="w"> </span><span class="kt">Expect</span><span class="nf">.</span><span class="nv">equal</span><span class="w"> </span><span class="kt">False</span>
<span class="w">            </span><span class="p">]</span>
<span class="w">        </span><span class="p">]</span>
</code></pre></div>
<p>ã€Œæ—¢å­˜ã® <code>canMove</code> é–¢æ•°ãŒä½¿ãˆã‚‹ã‚“ã§ã™ã­ï¼ã€ãã†ã§ã™ï¼æ–°ã—ã„ã·ã‚ˆãŒé…ç½®ã§ãã‚‹ã‹ã©ã†ã‹ã‚‚ã€æ—¢å­˜ã® <code>canMove</code> é–¢æ•°ã§åˆ¤å®šã§ãã¾ã™ã€‚</p>
<h3 id="_80">å®Ÿè£…: ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼åˆ¤å®š<a class="headerlink" href="#_80" title="Permanent link">&para;</a></h3>
<p>æ¬¡ã«ã€æ–°ã—ã„ã·ã‚ˆã‚’ç”Ÿæˆã—ã‚ˆã†ã¨ã—ãŸã¨ãã«ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ã‹ã©ã†ã‹ã‚’åˆ¤å®šã™ã‚‹å‡¦ç†ã‚’å®Ÿè£…ã—ã¾ã™ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- src/Main.elmï¼ˆupdate é–¢æ•°ã® Checking ãƒ¢ãƒ¼ãƒ‰ã‚’ä¿®æ­£ï¼‰</span>
<span class="nv">update</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Msg</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Model</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="kt">Model</span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="w"> </span><span class="kt">Msg</span><span class="w"> </span><span class="p">)</span>
<span class="nv">update</span><span class="w"> </span><span class="nv">msg</span><span class="w"> </span><span class="nv">model</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="kr">case</span><span class="w"> </span><span class="nv">msg</span><span class="w"> </span><span class="kr">of</span>
<span class="w">        </span><span class="c1">-- æ—¢å­˜ã®å‡¦ç†...</span>

<span class="w">        </span><span class="kt">Tick</span><span class="w"> </span><span class="nv">deltaTime</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="kr">case</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">mode</span><span class="w"> </span><span class="kr">of</span>
<span class="w">                </span><span class="c1">-- æ—¢å­˜ã® Playing, Erasing, Falling ãƒ¢ãƒ¼ãƒ‰...</span>

<span class="w">                </span><span class="kt">Checking</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="kr">let</span>
<span class="w">                        </span><span class="nv">erasableGroups</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                            </span><span class="nv">findAllErasableGroups</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">board</span>
<span class="w">                    </span><span class="kr">in</span>
<span class="w">                    </span><span class="kr">if</span><span class="w"> </span><span class="kt">List</span><span class="nf">.</span><span class="nv">isEmpty</span><span class="w"> </span><span class="nv">erasableGroups</span><span class="w"> </span><span class="kr">then</span>
<span class="w">                        </span><span class="c1">-- æ¶ˆå»ãªã— â†’ å…¨æ¶ˆã—ãƒã‚§ãƒƒã‚¯ã—ã¦æ¬¡ã®ã·ã‚ˆã‚’å‡ºã™</span>
<span class="w">                        </span><span class="kr">let</span>
<span class="w">                            </span><span class="nv">isAllClear</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                                </span><span class="kt">GameLogic</span><span class="nf">.</span><span class="nv">isEmpty</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">board</span>

<span class="w">                            </span><span class="nv">zenkeshiBonus</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                                </span><span class="kr">if</span><span class="w"> </span><span class="nv">isAllClear</span><span class="w"> </span><span class="kr">then</span>
<span class="w">                                    </span><span class="mi">3600</span>

<span class="w">                                </span><span class="kr">else</span>
<span class="w">                                    </span><span class="mi">0</span>

<span class="w">                            </span><span class="nv">message</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                                </span><span class="kr">if</span><span class="w"> </span><span class="nv">isAllClear</span><span class="w"> </span><span class="kr">then</span>
<span class="w">                                    </span><span class="s">&quot;å…¨æ¶ˆã—ï¼+3600&quot;</span>

<span class="w">                                </span><span class="kr">else</span>
<span class="w">                                    </span><span class="s">&quot;&quot;</span>

<span class="w">                            </span><span class="c1">-- æ–°ã—ã„ã·ã‚ˆã‚’ç”Ÿæˆ</span>
<span class="w">                            </span><span class="nv">newPair</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                                </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">create</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="kt">Red</span><span class="w"> </span><span class="kt">Blue</span>

<span class="w">                            </span><span class="c1">-- é…ç½®å¯èƒ½ã‹ãƒã‚§ãƒƒã‚¯</span>
<span class="w">                            </span><span class="nv">canSpawn</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                                </span><span class="kt">PuyoPair</span><span class="nf">.</span><span class="nv">canMove</span><span class="w"> </span><span class="nv">newPair</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">board</span>
<span class="w">                        </span><span class="kr">in</span>
<span class="w">                        </span><span class="kr">if</span><span class="w"> </span><span class="nv">canSpawn</span><span class="w"> </span><span class="kr">then</span>
<span class="w">                            </span><span class="c1">-- é…ç½®å¯èƒ½ â†’ é€šå¸¸ã®ã‚²ãƒ¼ãƒ ç¶šè¡Œ</span>
<span class="w">                            </span><span class="p">(</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">model</span>
<span class="w">                                </span><span class="nf">|</span><span class="w"> </span><span class="nv">mode</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Playing</span>
<span class="w">                                </span><span class="nf">|</span><span class="w"> </span><span class="nv">currentPair</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Just</span><span class="w"> </span><span class="nv">newPair</span>
<span class="w">                                </span><span class="nf">|</span><span class="w"> </span><span class="nv">score</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">score</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="nv">zenkeshiBonus</span>
<span class="w">                                </span><span class="nf">|</span><span class="w"> </span><span class="nv">message</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">message</span>
<span class="w">                              </span><span class="p">}</span>
<span class="w">                            </span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="nf">.</span><span class="nv">none</span>
<span class="w">                            </span><span class="p">)</span>

<span class="w">                        </span><span class="kr">else</span>
<span class="w">                            </span><span class="c1">-- é…ç½®ä¸å¯ â†’ ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼</span>
<span class="w">                            </span><span class="p">(</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">model</span>
<span class="w">                                </span><span class="nf">|</span><span class="w"> </span><span class="nv">mode</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">GameOver</span>
<span class="w">                                </span><span class="nf">|</span><span class="w"> </span><span class="nv">score</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">score</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="nv">zenkeshiBonus</span>
<span class="w">                                </span><span class="nf">|</span><span class="w"> </span><span class="nv">message</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="s">&quot;ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ï¼&quot;</span>
<span class="w">                              </span><span class="p">}</span>
<span class="w">                            </span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="nf">.</span><span class="nv">none</span>
<span class="w">                            </span><span class="p">)</span>

<span class="w">                    </span><span class="kr">else</span>
<span class="w">                        </span><span class="c1">-- æ—¢å­˜ã®æ¶ˆå»å‡¦ç†...</span>
<span class="w">                        </span><span class="kr">let</span>
<span class="w">                            </span><span class="nv">newChainCount</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                                </span><span class="nv">model</span><span class="nf">.</span><span class="nv">chainCount</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="mi">1</span>

<span class="w">                            </span><span class="nv">erasedCount</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                                </span><span class="kt">List</span><span class="nf">.</span><span class="nv">sum</span><span class="w"> </span><span class="p">(</span><span class="kt">List</span><span class="nf">.</span><span class="nv">map</span><span class="w"> </span><span class="kt">Set</span><span class="nf">.</span><span class="nv">size</span><span class="w"> </span><span class="nv">erasableGroups</span><span class="p">)</span>

<span class="w">                            </span><span class="nv">chainBonus</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                                </span><span class="kr">case</span><span class="w"> </span><span class="nv">newChainCount</span><span class="w"> </span><span class="kr">of</span>
<span class="w">                                    </span><span class="mi">1</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                                    </span><span class="mi">2</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="mi">8</span>
<span class="w">                                    </span><span class="mi">3</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="mi">16</span>
<span class="w">                                    </span><span class="mi">4</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="mi">32</span>
<span class="w">                                    </span><span class="mi">5</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="mi">64</span>
<span class="w">                                    </span><span class="mi">6</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="mi">96</span>
<span class="w">                                    </span><span class="mi">7</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="mi">128</span>
<span class="w">                                    </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="mi">160</span>

<span class="w">                            </span><span class="nv">points</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                                </span><span class="nv">erasedCount</span><span class="w"> </span><span class="nf">*</span><span class="w"> </span><span class="nv">chainBonus</span>

<span class="w">                            </span><span class="nv">newBoard</span><span class="w"> </span><span class="nf">=</span>
<span class="w">                                </span><span class="kt">List</span><span class="nf">.</span><span class="nv">foldl</span><span class="w"> </span><span class="kt">GameLogic</span><span class="nf">.</span><span class="nv">erasePuyos</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">board</span><span class="w"> </span><span class="nv">erasableGroups</span>
<span class="w">                        </span><span class="kr">in</span>
<span class="w">                        </span><span class="p">(</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nv">model</span>
<span class="w">                            </span><span class="nf">|</span><span class="w"> </span><span class="nv">mode</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="kt">Erasing</span>
<span class="w">                            </span><span class="nf">|</span><span class="w"> </span><span class="nv">chainCount</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">newChainCount</span>
<span class="w">                            </span><span class="nf">|</span><span class="w"> </span><span class="nv">score</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">score</span><span class="w"> </span><span class="nf">+</span><span class="w"> </span><span class="nv">points</span>
<span class="w">                            </span><span class="nf">|</span><span class="w"> </span><span class="nv">board</span><span class="w"> </span><span class="nf">=</span><span class="w"> </span><span class="nv">newBoard</span>
<span class="w">                          </span><span class="p">}</span>
<span class="w">                        </span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="nf">.</span><span class="nv">none</span>
<span class="w">                        </span><span class="p">)</span>

<span class="w">                </span><span class="kt">GameOver</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="c1">-- ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼æ™‚ã¯ä½•ã‚‚ã—ãªã„</span>
<span class="w">                    </span><span class="p">(</span><span class="w"> </span><span class="nv">model</span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="nf">.</span><span class="nv">none</span><span class="w"> </span><span class="p">)</span>

<span class="w">                </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                    </span><span class="p">(</span><span class="w"> </span><span class="nv">model</span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="nf">.</span><span class="nv">none</span><span class="w"> </span><span class="p">)</span>

<span class="w">        </span><span class="c1">-- ãã®ä»–ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å‡¦ç†...</span>
<span class="w">        </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="p">(</span><span class="w"> </span><span class="nv">model</span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="nf">.</span><span class="nv">none</span><span class="w"> </span><span class="p">)</span>
</code></pre></div>
<p>ã€Œæ–°ã—ã„ã·ã‚ˆã‚’ç”Ÿæˆã™ã‚‹å‰ã« <code>canMove</code> ã§ãƒã‚§ãƒƒã‚¯ã—ã¦ã€é…ç½®ã§ããªã‘ã‚Œã°ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ã«ãªã‚‹ã‚“ã§ã™ã­ï¼ã€ãã®é€šã‚Šã§ã™ï¼</p>
<h3 id="_81">å®Ÿè£…: ãƒªã‚¹ã‚¿ãƒ¼ãƒˆæ©Ÿèƒ½<a class="headerlink" href="#_81" title="Permanent link">&para;</a></h3>
<p>ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼å¾Œã«æ–°ã—ã„ã‚²ãƒ¼ãƒ ã‚’å§‹ã‚ã‚‰ã‚Œã‚‹ã‚ˆã†ã«ãƒªã‚¹ã‚¿ãƒ¼ãƒˆæ©Ÿèƒ½ã‚’è¿½åŠ ã—ã¾ã™ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- src/Main.elmï¼ˆMsg ã¨ update ã®æ‹¡å¼µï¼‰</span>
<span class="kr">type</span><span class="w"> </span><span class="kt">Msg</span>
<span class="w">    </span><span class="nf">=</span><span class="w"> </span><span class="kt">StartGame</span>
<span class="w">    </span><span class="nf">|</span><span class="w"> </span><span class="kt">KeyPressed</span><span class="w"> </span><span class="kt">String</span>
<span class="w">    </span><span class="nf">|</span><span class="w"> </span><span class="kt">Tick</span><span class="w"> </span><span class="kt">Float</span>
<span class="w">    </span><span class="nf">|</span><span class="w"> </span><span class="kt">Restart</span><span class="w">      </span><span class="c1">-- è¿½åŠ </span>
<span class="w">    </span><span class="nf">|</span><span class="w"> </span><span class="kt">NoOp</span>


<span class="nv">update</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Msg</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Model</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="kt">Model</span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="w"> </span><span class="kt">Msg</span><span class="w"> </span><span class="p">)</span>
<span class="nv">update</span><span class="w"> </span><span class="nv">msg</span><span class="w"> </span><span class="nv">model</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="kr">case</span><span class="w"> </span><span class="nv">msg</span><span class="w"> </span><span class="kr">of</span>
<span class="w">        </span><span class="c1">-- æ—¢å­˜ã®å‡¦ç†...</span>

<span class="w">        </span><span class="kt">Restart</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="c1">-- ã‚²ãƒ¼ãƒ ã‚’åˆæœŸçŠ¶æ…‹ã«ãƒªã‚»ãƒƒãƒˆ</span>
<span class="w">            </span><span class="p">(</span><span class="w"> </span><span class="nv">init</span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="nf">.</span><span class="nv">none</span><span class="w"> </span><span class="p">)</span>

<span class="w">        </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">            </span><span class="p">(</span><span class="w"> </span><span class="nv">model</span><span class="p">,</span><span class="w"> </span><span class="kt">Cmd</span><span class="nf">.</span><span class="nv">none</span><span class="w"> </span><span class="p">)</span>
</code></pre></div>
<h3 id="view_3">View ã®æ›´æ–°<a class="headerlink" href="#view_3" title="Permanent link">&para;</a></h3>
<p>ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ç”»é¢ã‚’è¡¨ç¤ºã—ã€ãƒªã‚¹ã‚¿ãƒ¼ãƒˆãƒœã‚¿ãƒ³ã‚’è¿½åŠ ã—ã¾ã™ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- src/Main.elmï¼ˆview é–¢æ•°ã® GameOver éƒ¨åˆ†ã‚’æ›´æ–°ï¼‰</span>
<span class="nv">view</span><span class="w"> </span><span class="nf">:</span><span class="w"> </span><span class="kt">Model</span><span class="w"> </span><span class="nf">-&gt;</span><span class="w"> </span><span class="kt">Html</span><span class="w"> </span><span class="kt">Msg</span>
<span class="nv">view</span><span class="w"> </span><span class="nv">model</span><span class="w"> </span><span class="nf">=</span>
<span class="w">    </span><span class="nv">div</span><span class="w"> </span><span class="p">[]</span>
<span class="w">        </span><span class="p">[</span><span class="w"> </span><span class="nv">h1</span><span class="w"> </span><span class="p">[]</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="nv">text</span><span class="w"> </span><span class="s">&quot;ã·ã‚ˆã·ã‚ˆ - Elm ç‰ˆ&quot;</span><span class="w"> </span><span class="p">]</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="nv">div</span><span class="w"> </span><span class="p">[]</span>
<span class="w">            </span><span class="p">[</span><span class="w"> </span><span class="nv">text</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;ã‚¹ã‚³ã‚¢: &quot;</span><span class="w"> </span><span class="nf">++</span><span class="w"> </span><span class="kt">String</span><span class="nf">.</span><span class="nv">fromInt</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">score</span><span class="p">)</span>
<span class="w">            </span><span class="p">,</span><span class="w"> </span><span class="nv">text</span><span class="w"> </span><span class="s">&quot; | &quot;</span>
<span class="w">            </span><span class="p">,</span><span class="w"> </span><span class="nv">text</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;é€£é–æ•°: &quot;</span><span class="w"> </span><span class="nf">++</span><span class="w"> </span><span class="kt">String</span><span class="nf">.</span><span class="nv">fromInt</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">chainCount</span><span class="p">)</span>
<span class="w">            </span><span class="p">]</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="kr">if</span><span class="w"> </span><span class="kt">String</span><span class="nf">.</span><span class="nv">isEmpty</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">message</span><span class="w"> </span><span class="kr">then</span>
<span class="w">            </span><span class="nv">text</span><span class="w"> </span><span class="s">&quot;&quot;</span>

<span class="w">          </span><span class="kr">else</span>
<span class="w">            </span><span class="nv">div</span>
<span class="w">                </span><span class="p">[</span><span class="w"> </span><span class="nv">style</span><span class="w"> </span><span class="s">&quot;color&quot;</span><span class="w"> </span><span class="s">&quot;gold&quot;</span>
<span class="w">                </span><span class="p">,</span><span class="w"> </span><span class="nv">style</span><span class="w"> </span><span class="s">&quot;font-weight&quot;</span><span class="w"> </span><span class="s">&quot;bold&quot;</span>
<span class="w">                </span><span class="p">,</span><span class="w"> </span><span class="nv">style</span><span class="w"> </span><span class="s">&quot;font-size&quot;</span><span class="w"> </span><span class="s">&quot;24px&quot;</span>
<span class="w">                </span><span class="p">,</span><span class="w"> </span><span class="nv">style</span><span class="w"> </span><span class="s">&quot;margin&quot;</span><span class="w"> </span><span class="s">&quot;10px 0&quot;</span>
<span class="w">                </span><span class="p">]</span>
<span class="w">                </span><span class="p">[</span><span class="w"> </span><span class="nv">text</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">message</span><span class="w"> </span><span class="p">]</span>
<span class="w">        </span><span class="p">,</span><span class="w"> </span><span class="kr">case</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">mode</span><span class="w"> </span><span class="kr">of</span>
<span class="w">            </span><span class="kt">Start</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                </span><span class="nv">button</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="nv">onClick</span><span class="w"> </span><span class="kt">StartGame</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="nv">text</span><span class="w"> </span><span class="s">&quot;ã‚²ãƒ¼ãƒ é–‹å§‹&quot;</span><span class="w"> </span><span class="p">]</span>

<span class="w">            </span><span class="kt">GameOver</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                </span><span class="nv">div</span><span class="w"> </span><span class="p">[]</span>
<span class="w">                    </span><span class="p">[</span><span class="w"> </span><span class="nv">div</span>
<span class="w">                        </span><span class="p">[</span><span class="w"> </span><span class="nv">style</span><span class="w"> </span><span class="s">&quot;color&quot;</span><span class="w"> </span><span class="s">&quot;red&quot;</span>
<span class="w">                        </span><span class="p">,</span><span class="w"> </span><span class="nv">style</span><span class="w"> </span><span class="s">&quot;font-weight&quot;</span><span class="w"> </span><span class="s">&quot;bold&quot;</span>
<span class="w">                        </span><span class="p">,</span><span class="w"> </span><span class="nv">style</span><span class="w"> </span><span class="s">&quot;font-size&quot;</span><span class="w"> </span><span class="s">&quot;32px&quot;</span>
<span class="w">                        </span><span class="p">,</span><span class="w"> </span><span class="nv">style</span><span class="w"> </span><span class="s">&quot;margin&quot;</span><span class="w"> </span><span class="s">&quot;20px 0&quot;</span>
<span class="w">                        </span><span class="p">]</span>
<span class="w">                        </span><span class="p">[</span><span class="w"> </span><span class="nv">text</span><span class="w"> </span><span class="s">&quot;ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ï¼&quot;</span><span class="w"> </span><span class="p">]</span>
<span class="w">                    </span><span class="p">,</span><span class="w"> </span><span class="nv">div</span>
<span class="w">                        </span><span class="p">[</span><span class="w"> </span><span class="nv">style</span><span class="w"> </span><span class="s">&quot;font-size&quot;</span><span class="w"> </span><span class="s">&quot;24px&quot;</span>
<span class="w">                        </span><span class="p">,</span><span class="w"> </span><span class="nv">style</span><span class="w"> </span><span class="s">&quot;margin&quot;</span><span class="w"> </span><span class="s">&quot;10px 0&quot;</span>
<span class="w">                        </span><span class="p">]</span>
<span class="w">                        </span><span class="p">[</span><span class="w"> </span><span class="nv">text</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;æœ€çµ‚ã‚¹ã‚³ã‚¢: &quot;</span><span class="w"> </span><span class="nf">++</span><span class="w"> </span><span class="kt">String</span><span class="nf">.</span><span class="nv">fromInt</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">score</span><span class="p">)</span><span class="w"> </span><span class="p">]</span>
<span class="w">                    </span><span class="p">,</span><span class="w"> </span><span class="nv">button</span>
<span class="w">                        </span><span class="p">[</span><span class="w"> </span><span class="nv">onClick</span><span class="w"> </span><span class="kt">Restart</span>
<span class="w">                        </span><span class="p">,</span><span class="w"> </span><span class="nv">style</span><span class="w"> </span><span class="s">&quot;font-size&quot;</span><span class="w"> </span><span class="s">&quot;18px&quot;</span>
<span class="w">                        </span><span class="p">,</span><span class="w"> </span><span class="nv">style</span><span class="w"> </span><span class="s">&quot;padding&quot;</span><span class="w"> </span><span class="s">&quot;10px 20px&quot;</span>
<span class="w">                        </span><span class="p">,</span><span class="w"> </span><span class="nv">style</span><span class="w"> </span><span class="s">&quot;margin-top&quot;</span><span class="w"> </span><span class="s">&quot;20px&quot;</span>
<span class="w">                        </span><span class="p">,</span><span class="w"> </span><span class="nv">style</span><span class="w"> </span><span class="s">&quot;cursor&quot;</span><span class="w"> </span><span class="s">&quot;pointer&quot;</span>
<span class="w">                        </span><span class="p">]</span>
<span class="w">                        </span><span class="p">[</span><span class="w"> </span><span class="nv">text</span><span class="w"> </span><span class="s">&quot;ã‚‚ã†ä¸€åº¦éŠã¶&quot;</span><span class="w"> </span><span class="p">]</span>
<span class="w">                    </span><span class="p">]</span>

<span class="w">            </span><span class="nv">_</span><span class="w"> </span><span class="nf">-&gt;</span>
<span class="w">                </span><span class="nv">div</span><span class="w"> </span><span class="p">[]</span>
<span class="w">                    </span><span class="p">[</span><span class="w"> </span><span class="nv">viewBoard</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">board</span>
<span class="w">                    </span><span class="p">,</span><span class="w"> </span><span class="nv">viewCurrentPair</span><span class="w"> </span><span class="nv">model</span><span class="nf">.</span><span class="nv">currentPair</span>
<span class="w">                    </span><span class="p">]</span>
<span class="w">        </span><span class="p">]</span>
</code></pre></div>
<p>ã€Œã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ç”»é¢ã«ã€ã‚‚ã†ä¸€åº¦éŠã¶ã€ãƒœã‚¿ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã‚“ã§ã™ã­ï¼ã€ãã†ã§ã™ï¼ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã€<code>Restart</code> ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒé€ã‚‰ã‚Œã¦ã€ã‚²ãƒ¼ãƒ ãŒåˆæœŸçŠ¶æ…‹ã«ãƒªã‚»ãƒƒãƒˆã•ã‚Œã¾ã™ã€‚</p>
<h3 id="_82">ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®å®Ÿè¡Œ<a class="headerlink" href="#_82" title="Permanent link">&para;</a></h3>
<p>ã§ã¯ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼š</p>
<div class="highlight"><pre><span></span><code>elm<span class="w"> </span>reactor
</code></pre></div>
<p>ãƒ–ãƒ©ã‚¦ã‚¶ã§ <code>http://localhost:8000</code> ã‚’é–‹ãã€<code>src/Main.elm</code> ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚ã‚ã–ã¨ã·ã‚ˆã‚’ç©ã¿ä¸Šã’ã¦ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ã«ã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼</p>
<p>ã€Œæœ¬å½“ã ï¼æ–°ã—ã„ã·ã‚ˆãŒå‡ºã›ãªããªã‚‹ã¨ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ã«ãªã‚Šã¾ã™ï¼ã€ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼æ©Ÿèƒ½ãŒå®Ÿè£…ã§ãã¾ã—ãŸã­ã€‚</p>
<h3 id="9_1">ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³9ã®ã¾ã¨ã‚<a class="headerlink" href="#9_1" title="Permanent link">&para;</a></h3>
<p>ã“ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§å®Ÿè£…ã—ãŸå†…å®¹ï¼š</p>
<ol>
<li><strong>ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼åˆ¤å®š</strong></li>
<li>æ–°ã—ã„ã·ã‚ˆã®é…ç½®ä½ç½®ã«æ—¢ã«ã·ã‚ˆãŒã‚ã‚‹ã‹ãƒã‚§ãƒƒã‚¯</li>
<li><code>canMove</code> é–¢æ•°ã‚’å†åˆ©ç”¨</li>
<li>
<p>é…ç½®ä¸å¯ãªã‚‰ GameOver ãƒ¢ãƒ¼ãƒ‰ã¸é·ç§»</p>
</li>
<li>
<p><strong>ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼æ¼”å‡º</strong></p>
</li>
<li>GameOver ãƒ¢ãƒ¼ãƒ‰æ™‚ã®å°‚ç”¨ç”»é¢</li>
<li>æœ€çµ‚ã‚¹ã‚³ã‚¢ã®è¡¨ç¤º</li>
<li>
<p>èµ¤å­—ã§ç›®ç«‹ã¤ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸</p>
</li>
<li>
<p><strong>ãƒªã‚¹ã‚¿ãƒ¼ãƒˆæ©Ÿèƒ½</strong></p>
</li>
<li><code>Restart</code> ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã§åˆæœŸçŠ¶æ…‹ã«æˆ»ã™</li>
<li>ã€Œã‚‚ã†ä¸€åº¦éŠã¶ã€ãƒœã‚¿ãƒ³</li>
<li>
<p>init é–¢æ•°ã‚’å†åˆ©ç”¨</p>
</li>
<li>
<p><strong>ãƒ†ã‚¹ãƒˆã®ä½œæˆ</strong></p>
</li>
<li>é…ç½®å¯èƒ½åˆ¤å®šã®ãƒ†ã‚¹ãƒˆï¼ˆ3ãƒ†ã‚¹ãƒˆï¼‰</li>
</ol>
<h3 id="_83">å­¦ã‚“ã ã“ã¨<a class="headerlink" href="#_83" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>æ—¢å­˜é–¢æ•°ã®å†åˆ©ç”¨</strong>: <code>canMove</code> ã‚’ç”Ÿæˆåˆ¤å®šã«ã‚‚æ´»ç”¨</li>
<li><strong>çŠ¶æ…‹é·ç§»ã®å®Œæˆ</strong>: Start â†’ Playing â†’ Checking â†’ Erasing â†’ Falling â†’ GameOver</li>
<li><strong>init ã®å†åˆ©ç”¨</strong>: ãƒªã‚¹ã‚¿ãƒ¼ãƒˆæ™‚ã« init ã‚’å‘¼ã³å‡ºã™ã ã‘ã§ãƒªã‚»ãƒƒãƒˆå®Œäº†</li>
<li><strong>è¦–è¦šçš„ãªå·®åˆ¥åŒ–</strong>: ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼æ™‚ã¯èµ¤å­—ã€å…¨æ¶ˆã—ã¯é‡‘è‰²ãªã©çŠ¶æ…‹ã”ã¨ã«è‰²ã‚’å¤‰ãˆã‚‹</li>
</ul>
<h2 id="_84">ã¾ã¨ã‚<a class="headerlink" href="#_84" title="Permanent link">&para;</a></h2>
<p>ã“ã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã§ã¯ã€Elm ã§ã·ã‚ˆã·ã‚ˆã‚²ãƒ¼ãƒ ã‚’ä½œã‚ŠãªãŒã‚‰ã€ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºï¼ˆTDDï¼‰ã®å®Ÿè·µæ–¹æ³•ã‚’å­¦ã³ã¾ã—ãŸã€‚</p>
<h3 id="elm_3">Elm ã§å­¦ã‚“ã ã“ã¨<a class="headerlink" href="#elm_3" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>å‹ã‚·ã‚¹ãƒ†ãƒ ã®åŠ›</strong></li>
<li>ã‚«ã‚¹ã‚¿ãƒ å‹ã«ã‚ˆã‚‹æ˜ç¢ºãªçŠ¶æ…‹è¡¨ç¾ï¼ˆGameMode, Cell, PuyoColorï¼‰</li>
<li>Maybe å‹ã§ null ã‚¨ãƒ©ãƒ¼ã‚’å®Œå…¨ã«å›é¿</li>
<li>
<p>ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã«ã‚ˆã‚‹ç¶²ç¾…æ€§ãƒã‚§ãƒƒã‚¯ï¼ˆãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°ï¼‰</p>
</li>
<li>
<p><strong>The Elm Architecture</strong></p>
</li>
<li>Model - Update - View ã®æ˜ç¢ºãªåˆ†é›¢</li>
<li>å˜æ–¹å‘ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼</li>
<li>
<p>Subscription ã«ã‚ˆã‚‹å®£è¨€çš„ãªå‰¯ä½œç”¨ç®¡ç†ï¼ˆã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã€ã‚¿ã‚¤ãƒãƒ¼ï¼‰</p>
</li>
<li>
<p><strong>é–¢æ•°å‹ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°</strong></p>
</li>
<li>ä¸å¤‰æ€§ã«ã‚ˆã‚‹ãƒã‚°ã®å‰Šæ¸›</li>
<li>ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°ã«ã‚ˆã‚‹åˆ†å²ã®æ˜ç¢ºåŒ–</li>
<li>ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³æ¼”ç®—å­ <code>|&gt;</code> ã«ã‚ˆã‚‹å‡¦ç†ã®é€£é–</li>
<li>
<p>å†å¸°ã«ã‚ˆã‚‹æ·±ã•å„ªå…ˆæ¢ç´¢ï¼ˆDFSï¼‰</p>
</li>
<li>
<p><strong>ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™º</strong></p>
</li>
<li>Red-Green-Refactor ã‚µã‚¤ã‚¯ãƒ«</li>
<li>å°ã•ãªã‚¹ãƒ†ãƒƒãƒ—ã§ã®ç€å®Ÿãªé€²æ­©</li>
<li>ãƒ†ã‚¹ãƒˆã«ã‚ˆã‚‹å®‰å…¨ãªãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°</li>
<li>elm-test ã«ã‚ˆã‚‹å‹å®‰å…¨ãªãƒ†ã‚¹ãƒˆ</li>
</ol>
<h3 id="elm_4">Elm ã®åˆ©ç‚¹<a class="headerlink" href="#elm_4" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã‚¨ãƒ©ãƒ¼ãŒãªã„</strong>: Elm ã®å‹ã‚·ã‚¹ãƒ†ãƒ ã¯ã€nullã€undefinedã€å‹ã‚¨ãƒ©ãƒ¼ã‚’å®Œå…¨ã«æ’é™¤ã—ã¾ã™</li>
<li><strong>è¦ªåˆ‡ãªã‚³ãƒ³ãƒ‘ã‚¤ãƒ©</strong>: ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒéå¸¸ã«è¦ªåˆ‡ã§ã€åˆå¿ƒè€…ã§ã‚‚ç†è§£ã—ã‚„ã™ã„</li>
<li><strong>ä¿å®ˆã—ã‚„ã™ã„ã‚³ãƒ¼ãƒ‰</strong>: ä¸å¤‰æ€§ã¨å‹ã‚·ã‚¹ãƒ†ãƒ ã«ã‚ˆã‚Šã€ã‚³ãƒ¼ãƒ‰ãŒäºˆæ¸¬å¯èƒ½ã§ç†è§£ã—ã‚„ã™ã„</li>
<li><strong>äºˆæ¸¬å¯èƒ½ãªæŒ¯ã‚‹èˆã„</strong>: å‰¯ä½œç”¨ãŒåˆ¶å¾¡ã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€ãƒ‡ãƒãƒƒã‚°ãŒå®¹æ˜“</li>
<li><strong>å°ã•ãªãƒãƒ³ãƒ‰ãƒ«ã‚µã‚¤ã‚º</strong>: æœ€é©åŒ–ã•ã‚ŒãŸJavaScriptã‚³ãƒ¼ãƒ‰ã‚’ç”Ÿæˆ</li>
</ul>
<h3 id="typescriptf">TypeScript/F# ã¨ã®æ¯”è¼ƒ<a class="headerlink" href="#typescriptf" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ç‰¹å¾´</th>
<th>TypeScript</th>
<th>F# (Bolero)</th>
<th>Elm</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>å‹å®‰å…¨æ€§</strong></td>
<td>ä»»æ„ï¼ˆstrict ãƒ¢ãƒ¼ãƒ‰æ¨å¥¨ï¼‰</td>
<td>å¼·åŠ›</td>
<td>æœ€å¼·ï¼ˆãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã‚¨ãƒ©ãƒ¼ãªã—ï¼‰</td>
</tr>
<tr>
<td><strong>å­¦ç¿’æ›²ç·š</strong></td>
<td>ç·©ã‚„ã‹ï¼ˆJS çµŒé¨“è€…ï¼‰</td>
<td>ä¸­ç¨‹åº¦</td>
<td>ç·©ã‚„ã‹</td>
</tr>
<tr>
<td><strong>ã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ </strong></td>
<td>éå¸¸ã«è±Šå¯Œ</td>
<td>.NET ã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ </td>
<td>é™å®šçš„ã ãŒé«˜å“è³ª</td>
</tr>
<tr>
<td><strong>ãƒãƒ³ãƒ‰ãƒ«ã‚µã‚¤ã‚º</strong></td>
<td>ä¸­ç¨‹åº¦</td>
<td>å¤§ãã„</td>
<td>éå¸¸ã«å°ã•ã„</td>
</tr>
<tr>
<td><strong>é–‹ç™ºä½“é¨“</strong></td>
<td>è‰¯å¥½</td>
<td>è‰¯å¥½</td>
<td>å„ªã‚Œã¦ã„ã‚‹</td>
</tr>
<tr>
<td><strong>ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸</strong></td>
<td>è‰¯å¥½</td>
<td>è‰¯å¥½</td>
<td>éå¸¸ã«è¦ªåˆ‡</td>
</tr>
<tr>
<td><strong>å‰¯ä½œç”¨ç®¡ç†</strong></td>
<td>é–‹ç™ºè€…ä»»ã›</td>
<td>Elmish ã§ç®¡ç†</td>
<td>å®Œå…¨ã«åˆ¶å¾¡</td>
</tr>
</tbody>
</table>
<h3 id="_85">å®Ÿè£…ã—ãŸã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ä¸€è¦§<a class="headerlink" href="#_85" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³0</strong>: ç’°å¢ƒæ§‹ç¯‰ã¨ The Elm Architecture ã®åŸºç¤</li>
<li><strong>ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³1</strong>: ã‚²ãƒ¼ãƒ é–‹å§‹ã¨ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã®å®Ÿè£…</li>
<li><strong>ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³2</strong>: ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰å…¥åŠ›ã¨ã·ã‚ˆã®ç§»å‹•</li>
<li><strong>ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³3</strong>: å›è»¢ã¨å£ã‚­ãƒƒã‚¯</li>
<li><strong>ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³4</strong>: è‡ªç”±è½ä¸‹ã¨ç€åœ°åˆ¤å®š</li>
<li><strong>ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³5</strong>: é«˜é€Ÿè½ä¸‹ï¼ˆä¸‹çŸ¢å°ã‚­ãƒ¼ï¼‰</li>
<li><strong>ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³6</strong>: ã·ã‚ˆã®æ¶ˆå»ï¼ˆæ·±ã•å„ªå…ˆæ¢ç´¢ï¼‰</li>
<li><strong>ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³7</strong>: é€£é–åå¿œã¨ã‚¹ã‚³ã‚¢è¨ˆç®—</li>
<li><strong>ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³8</strong>: å…¨æ¶ˆã—ãƒœãƒ¼ãƒŠã‚¹</li>
<li><strong>ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³9</strong>: ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ã¨ãƒªã‚¹ã‚¿ãƒ¼ãƒˆ</li>
</ul>
<h3 id="_86">æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—<a class="headerlink" href="#_86" title="Permanent link">&para;</a></h3>
<p>ã“ã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã§åŸºç¤ã‚’å­¦ã‚“ã å¾Œã€ä»¥ä¸‹ã®ã‚ˆã†ãªæ‹¡å¼µã‚’è©¦ã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼š</p>
<ol>
<li><strong>é›£æ˜“åº¦èª¿æ•´</strong></li>
<li>è½ä¸‹é€Ÿåº¦ã®æ®µéšçš„ãªå¢—åŠ </li>
<li>è‰²æ•°ã®å¢—åŠ ï¼ˆ5è‰²ã€6è‰²ï¼‰</li>
<li>
<p>ãƒ¬ãƒ™ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã®å°å…¥</p>
</li>
<li>
<p><strong>ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³</strong></p>
</li>
<li>ã·ã‚ˆã®æ¶ˆå»ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆCSS Transitions/Animationsï¼‰</li>
<li>é€£é–æ™‚ã®ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ</li>
<li>
<p>ã·ã‚ˆã®è½ä¸‹æ™‚ã®ã‚¹ãƒ ãƒ¼ã‚ºãªç§»å‹•</p>
</li>
<li>
<p><strong>ã‚µã‚¦ãƒ³ãƒ‰</strong></p>
</li>
<li>åŠ¹æœéŸ³ã®è¿½åŠ ï¼ˆWeb Audio APIï¼‰</li>
<li>BGM ã®å®Ÿè£…</li>
<li>
<p>é€£é–æ•°ã«å¿œã˜ãŸåŠ¹æœéŸ³ã®å¤‰åŒ–</p>
</li>
<li>
<p><strong>AI å¯¾æˆ¦</strong></p>
</li>
<li>ã‚·ãƒ³ãƒ—ãƒ«ãª AI ã®å®Ÿè£…</li>
<li>ãƒŸãƒ‹ãƒãƒƒã‚¯ã‚¹æ³•ãªã©ã®æ¢ç´¢ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ </li>
<li>
<p>é›£æ˜“åº¦èª¿æ•´</p>
</li>
<li>
<p><strong>ãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ–</strong></p>
</li>
<li>ãƒã‚¤ã‚¹ã‚³ã‚¢ã®ä¿å­˜ï¼ˆLocalStorage, Portsï¼‰</li>
<li>ã‚²ãƒ¼ãƒ é€”ä¸­ã®ã‚»ãƒ¼ãƒ–æ©Ÿèƒ½</li>
<li>ãƒªãƒ—ãƒ¬ã‚¤æ©Ÿèƒ½</li>
</ol>
<h3 id="_87">ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã®ä¾¡å€¤<a class="headerlink" href="#_87" title="Permanent link">&para;</a></h3>
<blockquote>
<p>ãƒ†ã‚¹ãƒˆã‚’æ›¸ããªãŒã‚‰é–‹ç™ºã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ã€è¨­è¨ˆãŒè‰¯ã„æ–¹å‘ã«å¤‰ã‚ã‚Šã€ã‚³ãƒ¼ãƒ‰ãŒæ”¹å–„ã•ã‚Œç¶šã‘ã€ãã‚Œã«ã‚ˆã£ã¦è‡ªåˆ†è‡ªèº«ãŒé–‹ç™ºã«å‰å‘ãã«ãªã‚‹ã“ã¨ã€ãã‚ŒãŒãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã®ç›®æŒ‡ã™ã‚´ãƒ¼ãƒ«ã§ã™ã€‚</p>
<p>â€” Kent Beck ã€ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã€ ä»˜éŒ²Cã€€è¨³è€…è§£èª¬ï¼šãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã®ç¾åœ¨</p>
</blockquote>
<p>ã“ã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã‚’é€šã˜ã¦ã€ä»¥ä¸‹ã‚’ä½“é¨“ã§ããŸã¯ãšã§ã™ï¼š</p>
<ul>
<li><strong>å°ã•ãªã‚¹ãƒ†ãƒƒãƒ—</strong>: TODOãƒªã‚¹ãƒˆã§ä½œæ¥­ã‚’åˆ†è§£ã—ã€ä¸€ã¤ãšã¤ç¢ºå®Ÿã«é€²ã‚ã‚‹</li>
<li><strong>å®‰å…¨ãªãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°</strong>: ãƒ†ã‚¹ãƒˆãŒã‚ã‚‹ã‹ã‚‰ã€è‡ªä¿¡ã‚’æŒã£ã¦ã‚³ãƒ¼ãƒ‰ã‚’æ”¹å–„ã§ãã‚‹</li>
<li><strong>è¨­è¨ˆã®æ”¹å–„</strong>: ãƒ†ã‚¹ãƒˆã—ã‚„ã™ã„ã‚³ãƒ¼ãƒ‰ã¯ã€è‡ªç„¶ã¨è‰¯ã„è¨­è¨ˆã«ãªã‚‹</li>
<li><strong>é–‹ç™ºã®æ¥½ã—ã•</strong>: ãƒ†ã‚¹ãƒˆãŒé€šã‚‹ç¬é–“ã®é”æˆæ„Ÿ</li>
</ul>
<h3 id="elm-tdd">Elm ã¨ TDD ã®ç›¸ä¹—åŠ¹æœ<a class="headerlink" href="#elm-tdd" title="Permanent link">&para;</a></h3>
<p>Elm ã¨ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã®çµ„ã¿åˆã‚ã›ã¯ã€åˆå¿ƒè€…ã«ã‚‚å„ªã—ãã€ãã‚Œã§ã„ã¦å¼·åŠ›ã§ã™ï¼š</p>
<ul>
<li><strong>å‹ã‚·ã‚¹ãƒ†ãƒ ãŒãƒ†ã‚¹ãƒˆã®ä¸€éƒ¨ã‚’æ‹…ã†</strong>: null ãƒã‚§ãƒƒã‚¯ã‚„å‹ã‚¨ãƒ©ãƒ¼ã®ãƒ†ã‚¹ãƒˆã¯ä¸è¦</li>
<li><strong>ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ãŒæœ€åˆã®å“è³ªä¿è¨¼</strong>: ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ãŒé€šã‚Œã°ã€å¤šãã®ãƒã‚°ãŒæ—¢ã«æ’é™¤ã•ã‚Œã¦ã„ã‚‹</li>
<li><strong>é‡è¦ãªãƒ­ã‚¸ãƒƒã‚¯ã«é›†ä¸­</strong>: ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã®ãƒ†ã‚¹ãƒˆã«é›†ä¸­ã§ãã‚‹</li>
<li><strong>ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ãŒå®‰å…¨</strong>: å‹ã¨ãƒ†ã‚¹ãƒˆã®äºŒé‡ä¿è­·</li>
</ul>
<h3 id="_88">çµã³ã«<a class="headerlink" href="#_88" title="Permanent link">&para;</a></h3>
<p>Elm ã¯ã€ã€Œãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã‚¨ãƒ©ãƒ¼ã®ãªã„ã€ã¨ã„ã†å¤§èƒ†ãªç´„æŸã‚’å®ˆã‚‹ã€æ•°å°‘ãªã„è¨€èªã®ä¸€ã¤ã§ã™ã€‚å‹ã‚·ã‚¹ãƒ†ãƒ ã¨ The Elm Architecture ã®çµ„ã¿åˆã‚ã›ã«ã‚ˆã‚Šã€å …ç‰¢ã§ä¿å®ˆã—ã‚„ã™ã„ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ§‹ç¯‰ã§ãã¾ã™ã€‚</p>
<p>ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã¨çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã§ã€ã•ã‚‰ã«é«˜ã„å“è³ªã®ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚’ã€è‡ªä¿¡ã‚’æŒã£ã¦é–‹ç™ºã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚</p>
<p>ãœã²ã€å­¦ã‚“ã çŸ¥è­˜ã‚’æ´»ã‹ã—ã¦ã€è‡ªåˆ†ã ã‘ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œã£ã¦ã¿ã¦ãã ã•ã„ã€‚Elm ã®ä¸–ç•Œã¸ã‚ˆã†ã“ãï¼</p>
<h2 id="_89">å‚è€ƒè³‡æ–™<a class="headerlink" href="#_89" title="Permanent link">&para;</a></h2>
<h3 id="elm_5">Elm å…¬å¼ãƒªã‚½ãƒ¼ã‚¹<a class="headerlink" href="#elm_5" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Elm å…¬å¼ã‚¬ã‚¤ãƒ‰</strong>: https://guide.elm-lang.org/</li>
<li><strong>Elm ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸</strong>: https://package.elm-lang.org/</li>
<li><strong>elm-test ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ</strong>: https://package.elm-lang.org/packages/elm-explorations/test/latest/</li>
<li><strong>Elm Discourse</strong>: https://discourse.elm-lang.org/</li>
</ul>
<h3 id="_90">ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™º<a class="headerlink" href="#_90" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™º</strong>: Kent Beck è‘—</li>
<li><strong>ãƒªãƒ¼ãƒ€ãƒ–ãƒ«ã‚³ãƒ¼ãƒ‰</strong>: Dustin Boswell, Trevor Foucher è‘—</li>
<li><strong>Clean Code</strong>: Robert C. Martin è‘—</li>
</ul>
<h3 id="_91">ã‚²ãƒ¼ãƒ é–‹ç™º<a class="headerlink" href="#_91" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>ã‚²ãƒ¼ãƒ ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ãƒ‘ã‚¿ãƒ¼ãƒ³</strong>: Robert Nystrom è‘—</li>
<li><strong>Game Programming Patterns</strong>: https://gameprogrammingpatterns.com/</li>
</ul>
<p>Happy Coding! ğŸ‰</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
    <a href="https://github.com/k2works" target="_blank" rel="noopener" title="GitHub Repository/claude-code-booster" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.sections", "toc.integrate", "search.suggest", "search.highlight"], "search": "../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
      
        <script src="../../../docs/assets/js/extra.js"></script>
      
    
  </body>
</html>