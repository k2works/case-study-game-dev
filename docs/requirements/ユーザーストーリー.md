# ユーザーストーリー

## 概要

ぷよぷよゲームのユーザーストーリーを定義します。ユーザーの視点から、どのような機能が必要かを明確にします。

## エピック

### エピック1: ゲーム基盤
基本的なゲーム機能を提供する

### エピック2: AIによるオートプレイ
実験的なゲーム機能を提供する

### エピック3: ゲーム体験向上
より楽しいゲーム体験を提供する

### エピック4: プレイヤー満足度向上
長期間楽しめる機能を提供する

## ユーザーストーリー

```plantuml
@startuml "ユーザーストーリーマップ"
!define EPIC1_COLOR #FFE6CC
!define EPIC2_COLOR #E6F3FF
!define EPIC3_COLOR #E6FFE6
!define EPIC4_COLOR #FFE6E6

skinparam shadowing false

package "ぷよぷよゲーム" {
    package "エピック1: ゲーム基盤" EPIC1_COLOR {
        [基本ゲームプレイ]
        [操作システム]
        [消去システム]
        [ゲーム状態管理]
    }
    
    package "エピック2: AIによるオートプレイ" EPIC2_COLOR {
        [AI自動プレイ] 
        [機械学習システム]
        [AIパフォーマンス分析]
        [AI戦略設定]
    }
    
    package "エピック3: ゲーム体験向上" EPIC3_COLOR {
        [視覚効果]
        [音響効果]
        [UI/UX改善]
        [アニメーション]
    }
    
    package "エピック4: プレイヤー満足度向上" EPIC4_COLOR {
        [記録管理]
        [設定機能]
        [モバイル対応]
        [パフォーマンス最適化]
    }
}

[基本ゲームプレイ] ..> [操作システム] : depends on
[消去システム] ..> [基本ゲームプレイ] : depends on
[ゲーム状態管理] ..> [消去システム] : depends on
[視覚効果] ..> [基本ゲームプレイ] : enhances
[音響効果] ..> [視覚効果] : complements
[UI/UX改善] ..> [ゲーム状態管理] : enhances
[アニメーション] ..> [消去システム] : enhances
[記録管理] ..> [ゲーム状態管理] : extends
[設定機能] ..> [音響効果] : controls
[モバイル対応] ..> [UI/UX改善] : extends
[パフォーマンス最適化] ..> [アニメーション] : optimizes
[AI自動プレイ] ..> [基本ゲームプレイ] : enhances
[機械学習システム] ..> [AI自動プレイ] : supports
[AIパフォーマンス分析] ..> [AI自動プレイ] : analyzes
[AI戦略設定] ..> [機械学習システム] : configures

@enduml
```

### エピック1: ゲーム基盤

#### US-001: 基本ゲームプレイ
- **As a** プレイヤー
- **I want to** ぷよを操作してゲームをプレイしたい
- **So that** ぷよぷよゲームを楽しむことができる

**受け入れ基準:**

- フィールド(6x12)が表示される
- 上から2個セットのぷよが落下する
- ぷよには複数の色がある
- ぷよは床やother ぷよに衝突すると固定される

**優先度:** 最高  
**見積り:** 8 story points

#### US-002: 操作システム
- **As a** プレイヤー
- **I want to** ぷよを移動・回転させたい
- **So that** 思い通りの位置に配置できる

**受け入れ基準:**

- キーボードで左右移動できる
- キーボードで回転できる
- キーボードで高速落下できる
- 壁や他のぷよとの衝突判定が正しい

**優先度:** 最高  
**見積り:** 5 story points

#### US-003: 消去システム
- **As a** プレイヤー
- **I want to** 同じ色のぷよを4つ以上つなげて消したい
- **So that** 得点を獲得できる

**受け入れ基準:**

- 同じ色のぷよが4つ以上隣接すると消える
- 消去後に上のぷよが落下する
- 連鎖反応が発生する
- 連鎖回数に応じてボーナス得点がある

**優先度:** 最高  
**見積り:** 8 story points

#### US-004: ゲーム状態管理
- **As a** プレイヤー
- **I want to** ゲームの進行状況を把握したい
- **So that** 現在の状態を理解できる

**受け入れ基準:**

- スコアが表示される
- 次に落下するぷよが予告される
- ゲームオーバー判定がある
- ゲーム開始・リスタート機能がある

**優先度:** 高  
**見積り:** 5 story points

### エピック2: AIによるオートプレイ

#### US-005: AI自動プレイ機能
- **As a** プレイヤー
- **I want to** AIによる自動プレイを観戦したい
- **So that** 高度なプレイテクニックを学習できる

**受け入れ基準:**

- AIが自動でぷよを操作する
- AIの思考過程が可視化される
- 手動プレイとAIプレイの切り替えができる
- AIのプレイ速度を調整できる

**優先度:** 高  
**見積り:** 13 story points

#### US-006: AI学習システム
- **As a** 開発者
- **I want to** AIが学習により上達する仕組みを実装したい
- **So that** より興味深いAIプレイを提供できる

**受け入れ基準:**

- 機械学習アルゴリズムが実装されている
- プレイデータから学習パターンを抽出する
- 学習結果がパフォーマンス向上に反映される
- 学習進捗が可視化される

**優先度:** 中  
**見積り:** 21 story points

#### US-007: AIパフォーマンス分析
- **As a** プレイヤー
- **I want to** AIのパフォーマンスを分析したい
- **So that** 自分のプレイスタイルとの比較ができる

**受け入れ基準:**

- AIの連鎖成功率が表示される
- 平均スコアの統計が取得できる
- 人間プレイヤーとの比較データがある
- パフォーマンス改善の履歴が確認できる

**優先度:** 中  
**見積り:** 8 story points

#### US-008: AI戦略設定
- **As a** プレイヤー
- **I want to** AIの戦略を選択・カスタマイズしたい
- **So that** 異なるプレイスタイルのAIと対戦できる

**受け入れ基準:**

- 複数のAI戦略（攻撃型、防御型、連鎖重視等）が選択できる
- AI戦略のパラメータを調整できる
- カスタム戦略を保存・読み込みできる
- 戦略の特徴が説明されている

**優先度:** 中  
**見積り:** 8 story points

### エピック3: ゲーム体験向上

#### US-009: 視覚効果
- **As a** プレイヤー
- **I want to** 美しい視覚効果を見たい
- **So that** より楽しくゲームをプレイできる

**受け入れ基準:**

- ぷよ消去時にエフェクトがある
- 連鎖時に特別なエフェクトがある
- 色分けが明確でわかりやすい
- レスポンシブデザインである

**優先度:** 中  
**見積り:** 5 story points

#### US-010: 音響効果
- **As a** プレイヤー
- **I want to** ゲームの効果音やBGMを聞きたい
- **So that** より没入感のあるゲーム体験ができる

**受け入れ基準:**

- ぷよ落下音がある
- 消去音がある
- 連鎖音がある
- BGMがある
- 音量調節ができる

**優先度:** 中  
**見積り:** 3 story points

#### US-011: UI/UX改善
- **As a** プレイヤー
- **I want to** 使いやすいインターフェースでゲームしたい
- **So that** ストレスなくゲームを楽しめる

**受け入れ基準:**

- 直感的な操作方法の説明がある
- キーボードショートカットが利用できる
- ゲーム中にポーズできる
- メニューがわかりやすい

**優先度:** 中  
**見積り:** 3 story points

#### US-012: アニメーション
- **As a** プレイヤー
- **I want to** スムーズなアニメーションを見たい
- **So that** 自然なゲーム体験ができる

**受け入れ基準:**

- ぷよ落下アニメーションがある
- 消去アニメーションがある
- 連鎖アニメーションがある
- アニメーションの速度が適切である

**優先度:** 中  
**見積り:** 5 story points

### エピック4: プレイヤー満足度向上

#### US-013: 記録管理
- **As a** プレイヤー
- **I want to** ハイスコアを記録したい
- **So that** 過去の成績と比較できる

**受け入れ基準:**

- ハイスコアが保存される
- ローカルストレージに記録される
- 最高連鎖数も記録される
- 記録のリセット機能がある

**優先度:** 低  
**見積り:** 3 story points

#### US-014: 設定機能
- **As a** プレイヤー
- **I want to** ゲーム設定をカスタマイズしたい
- **So that** 自分の好みに合わせられる

**受け入れ基準:**

- 音量設定ができる
- キー設定ができる
- 難易度設定ができる
- 設定が保存される

**優先度:** 低  
**見積り:** 3 story points

#### US-015: モバイル対応
- **As a** モバイルユーザー
- **I want to** スマートフォンでゲームをプレイしたい
- **So that** 場所を選ばずゲームを楽しめる

**受け入れ基準:**

- タッチ操作ができる
- 画面サイズに適応する
- 縦・横画面両方に対応する
- PWA機能がある

**優先度:** 低  
**見積り:** 5 story points

#### US-016: パフォーマンス最適化
- **As a** プレイヤー
- **I want to** 軽快にゲームをプレイしたい
- **So that** ストレスなく長時間楽しめる

**受け入れ基準:**

- 60FPS以上で動作する
- メモリ使用量が最適化されている
- バンドルサイズが小さい
- 初回ロード時間が短い

**優先度:** 低  
**見積り:** 5 story points

## ストーリー優先順位マトリックス

```plantuml
@startuml "優先順位マトリックス"
!define HIGH_VALUE_COLOR #FF6B6B
!define MEDIUM_VALUE_COLOR #FFE66D
!define LOW_VALUE_COLOR #4ECDC4

rectangle "高価値・低工数" HIGH_VALUE_COLOR {
    note as n1
        US-002: 操作システム
        US-004: ゲーム状態管理
        US-005: AI自動プレイ機能
        US-007: AIパフォーマンス分析
        US-008: AI戦略設定
        US-011: UI/UX改善
        US-013: 記録管理
        US-014: 設定機能
    end note
}

rectangle "高価値・高工数" MEDIUM_VALUE_COLOR {
    note as n2
        US-001: 基本ゲームプレイ
        US-003: 消去システム
        US-006: AI学習システム
    end note
}

rectangle "低価値・低工数" LOW_VALUE_COLOR {
    note as n3
        US-010: 音響効果
    end note
}

rectangle "低価値・高工数" #F7F7F7 {
    note as n4
        US-009: 視覚効果
        US-012: アニメーション
        US-015: モバイル対応
        US-016: パフォーマンス最適化
    end note
}

@enduml
```

## リリース計画の基準

### MVP (Minimum Viable Product)
- US-001: 基本ゲームプレイ
- US-002: 操作システム
- US-003: 消去システム
- US-004: ゲーム状態管理

### v1.1 (AI機能追加)
- US-005: AI自動プレイ機能
- US-007: AIパフォーマンス分析
- US-008: AI戦略設定

### v1.2 (AI学習機能)
- US-006: AI学習システム

### v1.3 (ユーザー体験向上)
- US-009: 視覚効果
- US-010: 音響効果
- US-011: UI/UX改善
- US-012: アニメーション

### v1.4 (機能拡張)
- US-013: 記録管理
- US-014: 設定機能
- US-015: モバイル対応
- US-016: パフォーマンス最適化

## 完了の定義 (Definition of Done)

すべてのユーザーストーリーは以下の基準を満たした時に完了とする：

1. **開発完了:**

    - 受け入れ基準をすべて満たしている
    - 単体テストが書かれ、すべて通過している
    - コードレビューが完了している
    - 統合テストが通過している

2. **品質確保:**

    - ESLintルールに準拠している
    - TypeScriptエラーがない
    - ビルドが成功する
    - パフォーマンステストが通過している

3. **ドキュメント:**

    - README.mdが更新されている
    - 必要に応じてAPIドキュメントが更新されている
    - 変更内容がコミットメッセージに記載されている

4. **デプロイメント:**

    - ステージング環境でのテストが完了している
    - 本番環境へのデプロイが可能な状態である
    - ロールバック手順が確認されている

