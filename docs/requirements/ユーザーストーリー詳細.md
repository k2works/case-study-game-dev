# ユーザーストーリー詳細

## エピック: ぷよぷよゲーム

### ユーザーストーリー1: ゲーム開始

**ストーリー**: プレイヤーとして、新しいゲームを開始できる

**受け入れ基準**:

- [ ] 「新しいゲーム」ボタンをクリックするとゲームが開始される
- [ ] ゲームフィールド（6列×13行）が表示される
- [ ] スコア表示エリアが初期化される（スコア: 0）
- [ ] 最初のぷよペアが生成される
- [ ] ゲームループが開始される

**Definition of Done**:

- [ ] 機能のテストが作成され、すべて通過する
- [ ] コードレビューが完了している
- [ ] ドキュメントが更新されている

---

### ユーザーストーリー2: ぷよの移動

**ストーリー**: プレイヤーとして、落ちてくるぷよを左右に移動できる

**受け入れ基準**:

- [ ] 左矢印キーまたは'A'キーでぷよが左に移動する
- [ ] 右矢印キーまたは'D'キーでぷよが右に移動する
- [ ] フィールドの左端にいる場合、左に移動できない
- [ ] フィールドの右端にいる場合、右に移動できない
- [ ] 他のぷよがある場合、そこに移動できない
- [ ] 移動時に適切な音効が再生される（オプション）

**Definition of Done**:

- [ ] 機能のテストが作成され、すべて通過する
- [ ] エッジケースのテストが完了している
- [ ] コードレビューが完了している

---

### ユーザーストーリー3: ぷよの回転

**ストーリー**: プレイヤーとして、落ちてくるぷよを回転できる

**受け入れ基準**:

- [ ] 上矢印キーまたは'W'キーでぷよが時計回りに回転する
- [ ] 'X'キーまたは'スペース'キーでぷよが反時計回りに回転する
- [ ] 回転後の位置に障害物がある場合は回転しない
- [ ] 壁際では壁キック処理により可能な限り回転する
- [ ] 回転時に適切な音効が再生される（オプション）

**Definition of Done**:

- [ ] 機能のテストが作成され、すべて通過する
- [ ] 壁キックのテストが完了している
- [ ] コードレビューが完了している

---

### ユーザーストーリー4: ぷよの高速落下

**ストーリー**: プレイヤーとして、ぷよを素早く落下させることができる

**受け入れ基準**:

- [ ] 下矢印キーまたは'S'キーを押している間、ぷよが高速で落下する
- [ ] 通常落下速度の約10倍の速度で落下する
- [ ] 高速落下中も移動・回転操作が可能
- [ ] 着地時は通常の着地処理と同じ動作をする

**Definition of Done**:

- [ ] 機能のテストが作成され、すべて通過する
- [ ] パフォーマンステストが完了している
- [ ] コードレビューが完了している

---

### ユーザーストーリー5: ぷよの消去

**ストーリー**: プレイヤーとして、同じ色のぷよを4つ以上つなげると消去できる

**受け入れ基準**:

- [ ] 隣接する同じ色のぷよが4つ以上つながった場合に消去される
- [ ] 消去対象のぷよが視覚的にハイライトされる（オプション）
- [ ] 消去処理により上にあるぷよが落下する
- [ ] 消去されたぷよの数に応じてスコアが加算される
- [ ] 消去音効が再生される（オプション）

**Definition of Done**:

- [ ] 機能のテストが作成され、すべて通過する
- [ ] 複雑な消去パターンのテストが完了している
- [ ] コードレビューが完了している

---

### ユーザーストーリー6: 連鎖反応

**ストーリー**: プレイヤーとして、連鎖反応を起こしてより高いスコアを獲得できる

**受け入れ基準**:

- [ ] ぷよ消去後の落下により新たな消去が発生した場合、連鎖となる
- [ ] 連鎖数が表示される
- [ ] 連鎖ボーナスが適用される（1連鎖: 1倍, 2連鎖: 2倍, 3連鎖: 4倍, 4連鎖: 8倍...）
- [ ] 連鎖中は新しいぷよが生成されない
- [ ] 連鎖終了後に新しいぷよが生成される
- [ ] 連鎖音効が再生される（オプション）

**Definition of Done**:

- [ ] 機能のテストが作成され、すべて通過する
- [ ] 長連鎖のテストが完了している
- [ ] スコア計算のテストが完了している
- [ ] コードレビューが完了している

---

### ユーザーストーリー7: 全消しボーナス

**ストーリー**: プレイヤーとして、全消し（ぜんけし）ボーナスを獲得できる

**受け入れ基準**:

- [ ] フィールド上のすべてのぷよが消えた場合に全消しボーナス（2000点）が加算される
- [ ] 全消し発生時に特別なエフェクトが表示される（オプション）
- [ ] 全消し音効が再生される（オプション）
- [ ] 連鎖と全消しが同時発生した場合、両方のボーナスが適用される

**Definition of Done**:

- [ ] 機能のテストが作成され、すべて通過する
- [ ] スコア計算のテストが完了している
- [ ] コードレビューが完了している

---

### ユーザーストーリー8: ゲームオーバー

**ストーリー**: プレイヤーとして、ゲームオーバーになるとゲーム終了の演出を見ることができる

**受け入れ基準**:

- [ ] 新しいぷよが初期位置（列2、行1）に配置できない場合にゲームオーバーとなる
- [ ] ゲームオーバー時に画面にオーバーレイが表示される
- [ ] 最終スコアが表示される
- [ ] 「もう一度」ボタンが表示される
- [ ] 操作が無効になる
- [ ] ゲームオーバー音効が再生される（オプション）

**Definition of Done**:

- [ ] 機能のテストが作成され、すべて通過する
- [ ] UI/UXテストが完了している
- [ ] コードレビューが完了している

---

### ユーザーストーリー9: スコア表示

**ストーリー**: プレイヤーとして、現在のスコアを確認できる

**受け入れ基準**:

- [ ] 画面にスコアが常時表示される
- [ ] ぷよ消去時にスコアがリアルタイムで更新される
- [ ] 連鎖ボーナスや全消しボーナスが反映される
- [ ] スコアは読みやすい形式で表示される（カンマ区切りなど）

**Definition of Done**:

- [ ] 機能のテストが作成され、すべて通過する
- [ ] 表示のテストが完了している
- [ ] コードレビューが完了している

---

### ユーザーストーリー10: キーボード操作

**ストーリー**: プレイヤーとして、キーボードでぷよを操作できる

**受け入れ基準**:

- [ ] 矢印キー（←→↑↓）でぷよを操作できる
- [ ] WASDキーでぷよを操作できる
- [ ] スペースキーまたはXキーで反時計回りに回転できる
- [ ] リセットキー（Rキー）でゲームをリセットできる
- [ ] 無効なキー入力は無視される

**Definition of Done**:

- [ ] 機能のテストが作成され、すべて通過する
- [ ] アクセシビリティテストが完了している
- [ ] コードレビューが完了している

---

### ユーザーストーリー11: タッチ操作

**ストーリー**: プレイヤーとして、タッチ操作でぷよを操作できる

**受け入れ基準**:

- [ ] タップでぷよを回転できる
- [ ] スワイプ（左右）でぷよを移動できる
- [ ] 下スワイプでぷよを高速落下できる
- [ ] タッチ操作とキーボード操作が同時に動作する
- [ ] モバイルデバイスで適切に動作する

**Definition of Done**:

- [ ] 機能のテストが作成され、すべて通過する
- [ ] モバイルデバイステストが完了している
- [ ] タッチイベントのテストが完了している
- [ ] コードレビューが完了している

## 優先順位

1. **高優先度**: ユーザーストーリー1-8 （ゲームの基本機能）
2. **中優先度**: ユーザーストーリー9-10 （表示とキーボード操作）
3. **低優先度**: ユーザーストーリー11 （タッチ操作）

## 見積り

各ユーザーストーリーの見積り（ストーリーポイント）:

- ユーザーストーリー1: 3pt
- ユーザーストーリー2: 3pt  
- ユーザーストーリー3: 5pt
- ユーザーストーリー4: 2pt
- ユーザーストーリー5: 8pt
- ユーザーストーリー6: 13pt
- ユーザーストーリー7: 3pt
- ユーザーストーリー8: 5pt
- ユーザーストーリー9: 2pt
- ユーザーストーリー10: 3pt
- ユーザーストーリー11: 8pt

**合計**: 55ストーリーポイント