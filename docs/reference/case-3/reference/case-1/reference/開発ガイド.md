# 開発ガイド

## ライフサイクル

要件では、アプリケーションの機能や性能、品質、セキュリティ、運用、保守などの要件をまとめる活動を行います。開発では要件を満たすための設計、実装、テストなどの活動を行います。運用では、アプリケーションの運用、保守、改善などの活動を行います。構築では、アプリケーションの環境設定を行います。配置では、アプリケーションのビルドとデプロイを行います。これらの活動は相互に影響し合い、連携して行われるため、それぞれの活動において、開発者が守るべき規則やガイドラインをまとめたドキュメントを参照してください。

```plantuml
@startuml
[*] --> 要件
要件 --> 開発
要件 -right-> 運用
運用 -left-> 要件
開発 -left-> 要件
開発 --> 運用
運用 --> 開発
運用 --> 配置
運用 -up-> 構築
構築 --> 配置
運用 ---> [*]

state 要件 #red
state 構築 #limegreen
state 運用 #orange
state 開発 #purple
state 配置 #lightblue
@enduml
```
## 開発プロセス

アプリケーション開発は、アジャイル開発手法（XP）に基づいて進めます。

詳細は [エクストリームプログラミング](エクストリームプログラミング) を参照。

### 開発サイクル

```plantuml
@startuml

[*] --> リリース

state リリース {
  満足条件1: （ユーザーストーリー、予算、スケジュール)
  満足条件1 -->リリースプランニング
  リリースプランニング --> 満足条件1 
}

state イテレーション {
  リリースプランニング --> 満足条件2
  満足条件2: （ユーザーストーリー、予算、スケジュール)
  満足条件2 --> イテレーションプランニング
  イテレーションプランニング --> 満足条件2
  イテレーションプランニング --> 開発
  開発 --> フィーチャが追加された状態
  フィーチャが追加された状態 --> 満足条件2 : フィードバック
  フィーチャが追加された状態 --> 満足条件1 : フィードバック
}

リリース --> [*]

@enduml
```

計画づくりの詳細は [アジャイルな見積と計画づくり](アジャイルな見積と計画づくり)	 を参照。

### 開発フロー

```plantuml
@startuml
[*] --> リリース計画
リリース計画 --> イテレーション計画
イテレーション計画 --> コーディングとテスト
コーディングとテスト --> イテレーションレビュー
イテレーションレビュー --> イテレーション計画
イテレーションレビュー --> [*]
@enduml
```

```plantuml
@startuml

[*] --> イテレーション計画
イテレーション計画 --> ユーザーストーリー作成
ユーザーストーリー作成 --> ユースケース作成
ユースケース作成 --> データモデル設計
アーキテクチャ設計 --> コーディングとテスト
コーディングとテスト --> アーキテクチャ設計
データモデル設計 --> コーディングとテスト
コーディングとテスト --> データモデル設計
ドメインモデル設計 --> コーディングとテスト
コーディングとテスト --> ドメインモデル設計
コーディングとテスト --> ユーザーインターフェース設計
ユーザーインターフェース設計 --> コーディングとテスト
コーディングとテスト --> ユースケース作成
コーディングとテスト --> イテレーションレビュー
イテレーションレビュー --> イテレーション計画
イテレーションレビュー --> [*]

@enduml
```

## コーディングとテスト

実装は、以下の2つのアプローチを状況に応じて使い分けます：

1. インサイドアウトアプローチ
- データモデルから実装を開始
- ドメイン駆動設計に適合
- テストファーストな開発

2. アウトサイドインアプローチ
- UIから実装を開始
- プロトタイプ駆動開発に適合
- モックを活用した開発


```plantuml
@startuml
start
:ユーザーストーリー;
if (CRUD実装済み?) then (はい)
  :ドメインモデル;
  :アウトサイドイン;
else (いいえ)
  :貧血ドメインモデル;
  :インサイドサイドアウト;
endif
if (API実装済み?) then (はい)
  :インサイドサイドアウト;
else (いいえ)
  :アウトサイドイン;
endif
stop
@enduml
```
#### インサイドアウト

```plantuml
@startuml
start
:データベース;
:インフラストラクチャ層;
:ドメイン層;
:サービス層;
:プレゼンテーション層;
stop
@enduml
```

```plantuml
@startuml
[*] --> コーディングとテスト
コーディングとテスト --> TODO : TODOリストを作成
TODO --> Red : 最小限の実装
Red --> Green : テストを書く
Green --> Refactor : リファクタリング
Refactor --> Red : 次の実装
Red : 動作の確認
Green : テストが成功
Refactor : コードの重複を除去してリファクタリング
Refactor --> TODO : リファクタリングが完了したらTODOリストに戻る
TODO --> コーディングとテスト : TODOリストが空になるまで繰り返す
コーディングとテスト --> イテレーションレビュー
@enduml
```

#### アウトサイドイン

```plantuml
@startuml
start
:プレゼンテーション層;
:サービス層;
:ドメイン層;
:インフラストラクチャ層;
:データベース;
stop
@enduml
```

```plantuml
@startuml
[*] --> コーディングとテスト
コーディングとテスト --> TODO : TODOリストを作成
TODO --> Red : テストを書く
Red --> Green : 最小限の実装
Green --> Refactor : リファクタリング
Refactor --> Red : 次のテストを書く
Red : テストに失敗
Green : テストに通る最小限の実装
Refactor : コードの重複を除去してリファクタリング
Refactor --> TODO : リファクタリングが完了したらTODOリストに戻る
TODO --> コーディングとテスト : TODOリストが空になるまで繰り返す
コーディングとテスト --> イテレーションレビュー
@enduml
```