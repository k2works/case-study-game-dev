# ã·ã‚ˆã·ã‚ˆã‹ã‚‰å§‹ã‚ã‚‹ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºå…¥é–€ï¼ˆC#/Unity ç‰ˆï¼‰

## ã¯ã˜ã‚ã«

ã¿ãªã•ã‚“ã€ã“ã‚“ã«ã¡ã¯ï¼ä»Šæ—¥ã¯ç§ã¨ä¸€ç·’ã«ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºï¼ˆTDDï¼‰ã‚’ä½¿ã£ã¦ã€C# ã¨ Unity ã§ã·ã‚ˆã·ã‚ˆã‚²ãƒ¼ãƒ ã‚’ä½œã£ã¦ã„ãã¾ã—ã‚‡ã†ã€‚ã•ã¦ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã®æ—…ã«å‡ºã‚‹å‰ã«ã€çš†ã•ã‚“ã¯ã€Œãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã€ã«ã¤ã„ã¦èã„ãŸã“ã¨ãŒã‚ã‚Šã¾ã™ã‹ï¼Ÿã‚‚ã—ã‹ã—ãŸã‚‰ã€Œãƒ†ã‚¹ãƒˆã£ã¦ã€ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ãŸå¾Œã«ã™ã‚‹ã‚‚ã®ã˜ã‚ƒãªã„ã®ï¼Ÿã€ã¨æ€ã‚ã‚Œã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã­ã€‚

> ãƒ†ã‚¹ãƒˆã‚’æ›¸ããªãŒã‚‰é–‹ç™ºã™ã‚‹ã“ã¨ã«ã‚ˆã£ã¦ã€è¨­è¨ˆãŒè‰¯ã„æ–¹å‘ã«å¤‰ã‚ã‚Šã€ã‚³ãƒ¼ãƒ‰ãŒæ”¹å–„ã•ã‚Œç¶šã‘ã€ãã‚Œã«ã‚ˆã£ã¦è‡ªåˆ†è‡ªèº«ãŒé–‹ç™ºã«å‰å‘ãã«ãªã‚‹ã“ã¨ã€ãã‚ŒãŒãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã®ç›®æŒ‡ã™ã‚´ãƒ¼ãƒ«ã§ã™ã€‚
>
> â€” Kent Beck ã€ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã€ ä»˜éŒ²Cã€€è¨³è€…è§£èª¬ï¼šãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã®ç¾åœ¨

ã“ã®è¨˜äº‹ã§ã¯ã€ç§ãŸã¡ãŒä¸€ç·’ã«ã·ã‚ˆã·ã‚ˆã‚²ãƒ¼ãƒ ã‚’å®Ÿè£…ã—ãªãŒã‚‰ã€ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã®åŸºæœ¬çš„ãªæµã‚Œã¨è€ƒãˆæ–¹ã‚’å­¦ã‚“ã§ã„ãã¾ã™ã€‚ã¾ã‚‹ã§ãƒ¢ãƒ–ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®ã‚ˆã†ã«ã€ã‚ãªãŸã¨ç§ãŒä¸€ç·’ã«è€ƒãˆã€ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãã€æ”¹å–„ã—ã¦ã„ãéç¨‹ã‚’ä½“é¨“ã—ã¾ã—ã‚‡ã†ã€‚ã€Œã§ã‚‚ã€ã·ã‚ˆã·ã‚ˆã£ã¦çµæ§‹è¤‡é›‘ãªã‚²ãƒ¼ãƒ ã˜ã‚ƒãªã„ã®ï¼Ÿã€ã¨æ€ã‚ã‚Œã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒã€å¿ƒé…ã„ã‚Šã¾ã›ã‚“ã€‚å„ç« ã§ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã«åŸºã¥ã„ãŸæ©Ÿèƒ½ã‚’ã€ãƒ†ã‚¹ãƒˆã€å®Ÿè£…ã€è§£èª¬ã®é †ã«å°‘ã—ãšã¤é€²ã‚ã¦ã„ãã¾ã™ã‚ˆã€‚ä¸€æ­©ä¸€æ­©ã€ç€å®Ÿã«é€²ã‚“ã§ã„ãã¾ã—ã‚‡ã†ï¼

### ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã®ã‚µã‚¤ã‚¯ãƒ«

ã•ã¦ã€ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã§ã¯ã€ã©ã®ã‚ˆã†ã«é€²ã‚ã¦ã„ã‘ã°ã„ã„ã®ã§ã—ã‚‡ã†ã‹ï¼Ÿã€Œãƒ†ã‚¹ãƒˆã‚’æ›¸ã„ã¦ã‹ã‚‰å®Ÿè£…ã™ã‚‹ã€ã¨ã„ã†ã®ã¯åˆ†ã‹ã‚Šã¾ã—ãŸãŒã€å…·ä½“çš„ã«ã¯ã©ã‚“ãªæ‰‹é †ã§é€²ã‚ã‚‹ã®ã§ã—ã‚‡ã†ã‹ï¼Ÿ

ç§ãŒã„ã¤ã‚‚å®Ÿè·µã—ã¦ã„ã‚‹ã®ã¯ã€ä»¥ä¸‹ã® 3 ã¤ã®ã‚¹ãƒ†ãƒƒãƒ—ã‚’ç¹°ã‚Šè¿”ã™ã‚µã‚¤ã‚¯ãƒ«ã§ã™ã€‚çš†ã•ã‚“ã‚‚ä¸€ç·’ã«ã‚„ã£ã¦ã¿ã¾ã—ã‚‡ã†ï¼š

1. **Redï¼ˆèµ¤ï¼‰**: ã¾ãšå¤±æ•—ã™ã‚‹ãƒ†ã‚¹ãƒˆã‚’æ›¸ãã¾ã™ã€‚ã€Œãˆï¼Ÿã‚ã–ã¨å¤±æ•—ã™ã‚‹ãƒ†ã‚¹ãƒˆã‚’ï¼Ÿã€ã¨æ€ã‚ã‚Œã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒã€ã“ã‚Œã«ã¯é‡è¦ãªæ„å‘³ãŒã‚ã‚‹ã‚“ã§ã™ã€‚ã“ã‚Œã‹ã‚‰å®Ÿè£…ã™ã‚‹æ©Ÿèƒ½ãŒä½•ã‚’ã™ã¹ãã‹ã‚’æ˜ç¢ºã«ã™ã‚‹ãŸã‚ãªã‚“ã§ã™ã‚ˆã€‚
2. **Greenï¼ˆç·‘ï¼‰**: æ¬¡ã«ã€ãƒ†ã‚¹ãƒˆãŒé€šã‚‹ã‚ˆã†ã«ã€æœ€å°é™ã®ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè£…ã—ã¾ã™ã€‚ã“ã®æ®µéšã§ã¯ã€ãã‚Œã„ãªã‚³ãƒ¼ãƒ‰ã‚ˆã‚Šã‚‚ã€Œã¨ã«ã‹ãå‹•ãã“ã¨ã€ã‚’å„ªå…ˆã—ã¾ã™ã€‚ã€Œæœ€å°é™ã€ã¨ã„ã†ã®ãŒãƒã‚¤ãƒ³ãƒˆã§ã™ã€‚å¿…è¦ä»¥ä¸Šã®ã“ã¨ã¯ã—ãªã„ã‚ˆã†ã«ã—ã¾ã—ã‚‡ã†ã€‚
3. **Refactorï¼ˆãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ï¼‰**: æœ€å¾Œã«ã€ã‚³ãƒ¼ãƒ‰ã®å“è³ªã‚’æ”¹å–„ã—ã¾ã™ã€‚ãƒ†ã‚¹ãƒˆãŒé€šã‚‹ã“ã¨ã‚’ç¢ºèªã—ãªãŒã‚‰ã€é‡è¤‡ã‚’å–ã‚Šé™¤ã„ãŸã‚Šã€ã‚ã‹ã‚Šã‚„ã™ã„åå‰ã‚’ã¤ã‘ãŸã‚Šã—ã¾ã™ã€‚ã€Œå‹•ãã‘ã©æ±šã„ã‚³ãƒ¼ãƒ‰ã€ã‹ã‚‰ã€Œå‹•ã„ã¦ãã‚Œã„ãªã‚³ãƒ¼ãƒ‰ã€ã¸ã¨é€²åŒ–ã•ã›ã‚‹ã‚“ã§ã™ã€‚

> ãƒ¬ãƒƒãƒ‰ãƒ»ã‚°ãƒªãƒ¼ãƒ³ãƒ»ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã€‚ãã‚ŒãŒ TDD ã®ãƒãƒ³ãƒˆãƒ©ã ã€‚
>
> â€” Kent Beck ã€ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã€

ã“ã®ã‚µã‚¤ã‚¯ãƒ«ã‚’ã€ŒRed-Green-Refactorã€ã‚µã‚¤ã‚¯ãƒ«ã¨å‘¼ã³ã¾ã™ã€‚ã€Œèµ¤ãƒ»ç·‘ãƒ»ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã€ã®ãƒªã‚ºãƒ ã‚’åˆ»ã‚€ã‚ˆã†ã«ã€ã“ã®ã‚µã‚¤ã‚¯ãƒ«ã‚’ç¹°ã‚Šè¿”ã—ã¦ã„ãã‚“ã§ã™ã€‚ã“ã‚Œã«ã‚ˆã£ã¦ã€å°‘ã—ãšã¤æ©Ÿèƒ½ã‚’è¿½åŠ ã—ã€ã‚³ãƒ¼ãƒ‰ã®å“è³ªã‚’é«˜ã‚ã¦ã„ãã¾ã—ã‚‡ã†ã€‚çš†ã•ã‚“ã‚‚ä¸€ç·’ã«ã“ã®ãƒªã‚ºãƒ ã‚’ä½“æ„Ÿã—ã¦ã¿ã¦ãã ã•ã„ï¼

```plantuml
@startuml
[*] --> ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã¨ãƒ†ã‚¹ãƒˆ
ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã¨ãƒ†ã‚¹ãƒˆ --> TODO : TODOãƒªã‚¹ãƒˆã‚’ä½œæˆ
TODO --> Red : ãƒ†ã‚¹ãƒˆã‚’æ›¸ã
Red --> Green : æœ€å°é™ã®å®Ÿè£…
Green --> Refactor : ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°
Refactor --> Red : æ¬¡ã®ãƒ†ã‚¹ãƒˆã‚’æ›¸ã
Red : ãƒ†ã‚¹ãƒˆã«å¤±æ•—
Green : ãƒ†ã‚¹ãƒˆã«é€šã‚‹æœ€å°é™ã®å®Ÿè£…
Refactor : ã‚³ãƒ¼ãƒ‰ã®é‡è¤‡ã‚’é™¤å»ã—ã¦ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°
Refactor --> TODO : ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ãŒå®Œäº†ã—ãŸã‚‰TODOãƒªã‚¹ãƒˆã«æˆ»ã‚‹
TODO --> ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã¨ãƒ†ã‚¹ãƒˆ : TODOãƒªã‚¹ãƒˆãŒç©ºã«ãªã‚‹ã¾ã§ç¹°ã‚Šè¿”ã™
ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã¨ãƒ†ã‚¹ãƒˆ --> ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¬ãƒ“ãƒ¥ãƒ¼
@enduml
```

### é–‹ç™ºç’°å¢ƒ

ã•ã¦ã€å®Ÿéš›ã«ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãå‰ã«ã€ç§ãŸã¡ãŒä½¿ç”¨ã™ã‚‹é–‹ç™ºç’°å¢ƒã«ã¤ã„ã¦å°‘ã—ãŠè©±ã—ã—ã¦ãŠãã¾ã—ã‚‡ã†ã€‚çš†ã•ã‚“ã¯ã€Œé“å…·é¸ã³ã¯ä»•äº‹ã®åŠåˆ†ã€ã¨ã„ã†è¨€è‘‰ã‚’èã„ãŸã“ã¨ãŒã‚ã‚Šã¾ã™ã‹ï¼Ÿãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã§ã‚‚åŒã˜ã“ã¨ãŒè¨€ãˆã‚‹ã‚“ã§ã™ã€‚

> é“å…·ã¯ã‚ãªãŸã®èƒ½åŠ›ã‚’å¢—å¹…ã—ã¾ã™ã€‚é“å…·ã®ã§ããŒå„ªã‚Œã¦ãŠã‚Šã€ç°¡å˜ã«ä½¿ã„ã“ãªã›ã‚‹ã‚ˆã†ã«ãªã£ã¦ã„ã‚Œã°ã€ã‚ˆã‚Šç”Ÿç”£çš„ã«ãªã‚Œã‚‹ã®ã§ã™ã€‚
>
> â€” é”äººãƒ—ãƒ­ã‚°ãƒ©ãƒãƒ¼ ç†Ÿé”ã«å‘ã‘ãŸã‚ãªãŸã®æ—…ï¼ˆç¬¬ 2 ç‰ˆï¼‰

ã€Œã©ã‚“ãªãƒ„ãƒ¼ãƒ«ã‚’ä½¿ãˆã°ã„ã„ã®ï¼Ÿã€ã¨æ€ã‚ã‚Œã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã­ã€‚ä»Šå›ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ã€ä»¥ä¸‹ã®ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ã¦ã„ãã¾ã™ï¼š

- **è¨€èª**: C# â€” Unity ã®æ¨™æº–è¨€èªã§ã€é™çš„å‹ä»˜ã‘ã«ã‚ˆã‚Šå®‰å…¨ãªã‚³ãƒ¼ãƒ‰ãŒæ›¸ã‘ã¾ã™ã€‚
- **ã‚²ãƒ¼ãƒ ã‚¨ãƒ³ã‚¸ãƒ³**: Unity â€” 2D/3D ã‚²ãƒ¼ãƒ é–‹ç™ºã«åºƒãä½¿ã‚ã‚Œã¦ã„ã‚‹å¼·åŠ›ãªã‚¨ãƒ³ã‚¸ãƒ³ã§ã™ã€‚
- **ãƒ†ã‚¹ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯**: Unity Test Framework (NUnit ãƒ™ãƒ¼ã‚¹) â€” Unity ã«çµ„ã¿è¾¼ã¾ã‚ŒãŸãƒ†ã‚¹ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã§ã™ã€‚
- **ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†**: Git â€” ã‚³ãƒ¼ãƒ‰ã®å¤‰æ›´å±¥æ­´ã‚’è¿½è·¡ã—ã€ã€Œã‚ã‚Œï¼Ÿæ˜¨æ—¥ã¾ã§ã¡ã‚ƒã‚“ã¨å‹•ã„ã¦ãŸã®ã«...ã€ã¨ã„ã†ã¨ãã«éå»ã®çŠ¶æ…‹ã«æˆ»ã‚Œã‚‹é­”æ³•ã®ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚
- **ã‚¨ãƒ‡ã‚£ã‚¿**: Visual Studio ã¾ãŸã¯ Rider â€” C# é–‹ç™ºã«æœ€é©åŒ–ã•ã‚ŒãŸ IDE ã§ã™ã€‚

ã“ã‚Œã‚‰ã®ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ã£ã¦ã€ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã®æµã‚Œã«æ²¿ã£ã¦ã·ã‚ˆã·ã‚ˆã‚²ãƒ¼ãƒ ã‚’å®Ÿè£…ã—ã¦ã„ãã¾ã—ã‚‡ã†ã€‚ã€Œç’°å¢ƒæ§‹ç¯‰ã£ã¦é›£ã—ãã†...ã€ã¨å¿ƒé…ã•ã‚Œã‚‹æ–¹ã‚‚ã„ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒæ‰‹é †ã«å¾“ã£ã¦é€²ã‚ã‚Œã°ãã‚“ãªã«é›£ã—ã„ã“ã¨ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚è©³ç´°ã¯ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ 0: ç’°å¢ƒã®æ§‹ç¯‰ã§è§£èª¬ã—ã¾ã™ã€‚

## ãƒªãƒªãƒ¼ã‚¹è¨ˆç”»

ã•ã¦ã€ã€Œã„ããªã‚Šå…¨éƒ¨ã®æ©Ÿèƒ½ã‚’ä½œã‚‹ã®ã¯å¤§å¤‰ãã†...ã€ã¨æ€ã‚ã‚Œã¾ã™ã‚ˆã­ï¼Ÿãã®é€šã‚Šã§ã™ï¼ã‚¢ã‚¸ãƒ£ã‚¤ãƒ«é–‹ç™ºã§ã¯ã€å¤§ããªç›®æ¨™ã‚’å°ã•ãªåå¾©ï¼ˆã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰ã«åˆ†å‰²ã—ã¦ã€å°‘ã—ãšã¤é€²ã‚ã¦ã„ãã¾ã™ã€‚

ç§ãŸã¡ã®ã·ã‚ˆã·ã‚ˆã‚²ãƒ¼ãƒ é–‹ç™ºã‚‚ã€ä»¥ä¸‹ã®ã‚ˆã†ãªã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã«åˆ†ã‘ã¦é€²ã‚ã¦ã„ãã¾ã—ã‚‡ã†ï¼š

### ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ 0: ç’°å¢ƒã®æ§‹ç¯‰

ã€Œã¾ãšä½•ã‹ã‚‰å§‹ã‚ã‚Œã°ã„ã„ã®ï¼Ÿã€ãã†ã€æœ€åˆã¯é–‹ç™ºç’°å¢ƒã‚’æ•´ãˆã‚‹ã“ã¨ã‹ã‚‰ã§ã™ã­ã€‚Unity ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆã€ãƒ†ã‚¹ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã€ãã—ã¦é–‹ç™ºã®ä¸‰ç¨®ã®ç¥å™¨ï¼ˆãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ãƒ»ãƒ†ã‚¹ãƒ†ã‚£ãƒ³ã‚°ãƒ»è‡ªå‹•åŒ–ï¼‰ã‚’æº–å‚™ã—ã¾ã™ã€‚

### ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ 1: ãƒœãƒ¼ãƒ‰ã®å®Ÿè£…

ã·ã‚ˆã·ã‚ˆã‚²ãƒ¼ãƒ ã®åŸºç›¤ã¨ãªã‚‹ãƒœãƒ¼ãƒ‰ï¼ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ï¼‰ã‚’ä½œã‚Šã¾ã™ã€‚ã€Œã©ã‚“ãªå¤§ãã•ãŒã„ã„ã‹ãªï¼Ÿã€æ¨™æº–çš„ãª 6 åˆ—Ã—12 è¡Œã®ãƒœãƒ¼ãƒ‰ã‚’å®Ÿè£…ã—ã€ã·ã‚ˆã‚’é…ç½®ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã—ã‚‡ã†ã€‚

### ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ 2: ã·ã‚ˆãƒšã‚¢ã®å®Ÿè£…

ã€Œã·ã‚ˆã£ã¦ 2 ã¤ãƒšã‚¢ã§è½ã¡ã¦ãã‚‹ã‚ˆã­ï¼Ÿã€ãã†ã§ã™ï¼è»¸ã·ã‚ˆã¨å­ã·ã‚ˆã‹ã‚‰ãªã‚‹ãƒšã‚¢ã‚’å®Ÿè£…ã—ã€å›è»¢æ©Ÿèƒ½ã‚‚è¿½åŠ ã—ã¾ã™ã€‚

### ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ 3: ç§»å‹•ã¨å›è»¢

ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒã·ã‚ˆãƒšã‚¢ã‚’æ“ä½œã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚å·¦å³ç§»å‹•ã€å›è»¢ã€ãã—ã¦å£ã‚­ãƒƒã‚¯ï¼ˆå£éš›ã§ã‚‚å›è»¢ã§ãã‚‹æ©Ÿèƒ½ï¼‰ã‚’å®Ÿè£…ã—ã¾ã—ã‚‡ã†ã€‚

### ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ 4: è½ä¸‹å‡¦ç†

ã·ã‚ˆãŒè‡ªå‹•çš„ã«è½ä¸‹ã™ã‚‹ä»•çµ„ã¿ã‚’ä½œã‚Šã¾ã™ã€‚ã€Œé‡åŠ›ãŒã‚ã‚‹ã‚²ãƒ¼ãƒ ã ã‚‚ã‚“ã­ï¼ã€ãã†ã§ã™ã€è‡ªç„¶ãªè½ä¸‹ã‚’å®Ÿç¾ã—ã¾ã—ã‚‡ã†ã€‚

### ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ 5: æ¶ˆå»åˆ¤å®š

åŒã˜è‰²ã®ã·ã‚ˆãŒ 4 ã¤ä»¥ä¸Šã¤ãªãŒã£ãŸã‚‰æ¶ˆãˆã‚‹ä»•çµ„ã¿ã‚’å®Ÿè£…ã—ã¾ã™ã€‚æ·±ã•å„ªå…ˆæ¢ç´¢ï¼ˆDFSï¼‰ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’ä½¿ã„ã¾ã™ã‚ˆã€‚

### ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ 6: é€£é–ã‚·ã‚¹ãƒ†ãƒ 

ã€Œã‚Œã€œã‚“ã•ã€œã‚“ï¼ã€ã·ã‚ˆã·ã‚ˆã®é†é†å‘³ã€é€£é–åå¿œã‚’å®Ÿè£…ã—ã¾ã™ã€‚é€£é–ãƒœãƒ¼ãƒŠã‚¹ã§ã‚¹ã‚³ã‚¢ãŒã©ã‚“ã©ã‚“ä¸ŠãŒã‚‹æ¥½ã—ã•ã‚’å®Ÿç¾ã—ã¾ã—ã‚‡ã†ã€‚

### ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ 7: ã‚¹ã‚³ã‚¢ã¨é€£é–æ•°ã®è¡¨ç¤º

ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒç¾åœ¨ã®ã‚¹ã‚³ã‚¢ã¨é€£é–æ•°ã‚’ç¢ºèªã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚ã€Œä»Šä½•ç‚¹å–ã‚Œã¦ã‚‹ã‹ãªï¼Ÿã€ã¨ã„ã†ç–‘å•ã«ç­”ãˆã¾ã™ã€‚

### ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ 8: ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼åˆ¤å®š

ã·ã‚ˆãŒç”»é¢ä¸Šéƒ¨ã¾ã§ç©ã¿ä¸ŠãŒã£ãŸã‚‰ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ã€‚ãƒªã‚¹ã‚¿ãƒ¼ãƒˆæ©Ÿèƒ½ã‚‚å®Ÿè£…ã—ã¾ã—ã‚‡ã†ã€‚

### ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ 9: å…¨æ¶ˆã—ãƒœãƒ¼ãƒŠã‚¹ã¨æœ€çµ‚èª¿æ•´

ã€Œå…¨éƒ¨æ¶ˆãˆãŸï¼ã€ã¨ã„ã†æ°—æŒã¡ã‚ˆã•ã‚’å‘³ã‚ãˆã‚‹å…¨æ¶ˆã—ãƒœãƒ¼ãƒŠã‚¹ã‚’å®Ÿè£…ã—ã€ã‚²ãƒ¼ãƒ ã‚’å®Œæˆã•ã›ã¾ã™ã€‚

ãã‚Œã§ã¯ã€ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ 0 ã‹ã‚‰å§‹ã‚ã¦ã„ãã¾ã—ã‚‡ã†ï¼

---

## ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ 0: ç’°å¢ƒã®æ§‹ç¯‰

ã•ã¦ã€ã„ã‚ˆã„ã‚ˆã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãå§‹ã‚ã‚‹æº–å‚™ã‚’ã—ã¾ã—ã‚‡ã†ï¼ã€Œç’°å¢ƒæ§‹ç¯‰ã£ã¦é¢å€’ãã•ãã†...ã€ã¨æ€ã†ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒã€ä¸€åº¦ã—ã£ã‹ã‚Šã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã—ã¦ãŠã‘ã°ã€ã“ã®å¾Œã®é–‹ç™ºãŒã¨ã¦ã‚‚æ¥½ã«ãªã‚Šã¾ã™ã‚ˆã€‚

ã“ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ã€å…ˆã»ã©è§¦ã‚ŒãŸã€Œã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢é–‹ç™ºã®ä¸‰ç¨®ã®ç¥å™¨ã€ã‚’æº–å‚™ã—ã¾ã™ã€‚

> ä»Šæ—¥ã®ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢é–‹ç™ºã®ä¸–ç•Œã«ãŠã„ã¦çµ¶å¯¾ã«ãªã‘ã‚Œã°ãªã‚‰ãªã„ 3 ã¤ã®æŠ€è¡“çš„ãªæŸ±ãŒã‚ã‚Šã¾ã™ã€‚
> ä¸‰æœ¬æŸ±ã¨è¨€ã£ãŸã‚Šã€ä¸‰ç¨®ã®ç¥å™¨ã¨è¨€ã£ãŸã‚Šã—ã¦ã„ã¾ã™ãŒã€ãã‚Œã‚‰ã¯
>
>   - ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†
>   - ãƒ†ã‚¹ãƒ†ã‚£ãƒ³ã‚°
>   - è‡ªå‹•åŒ–
>
> ã® 3 ã¤ã§ã™ã€‚
>
> â€” https://t-wada.hatenablog.jp/entry/clean-code-that-works

### Unity ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ

ã¾ãšã¯ Unity ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã¾ã—ã‚‡ã†ã€‚ã€ŒUnity ã£ã¦åˆã‚ã¦ã ã‘ã©å¤§ä¸ˆå¤«ã‹ãªï¼Ÿã€å¿ƒé…ã„ã‚Šã¾ã›ã‚“ã€ä¸€ç·’ã«é€²ã‚ã¦ã„ãã¾ã—ã‚‡ã†ã€‚

1. **Unity Hub ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«**

   Unity Hub ã¯ Unity ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã‚„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç®¡ç†ã‚’è¡Œã†ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚[Unity Hub ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒšãƒ¼ã‚¸](https://unity.com/download)ã‹ã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã—ã‚‡ã†ã€‚

2. **Unity ã‚¨ãƒ‡ã‚£ã‚¿ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«**

   Unity Hub ã‚’é–‹ãã€ã€ŒInstallsã€ã‚¿ãƒ–ã‹ã‚‰ Unity ã‚¨ãƒ‡ã‚£ã‚¿ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚ä»Šå›ã¯ Unity 2022.3 LTSï¼ˆLong Term Supportï¼‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚ã€ŒLTS ã£ã¦ä½•ï¼Ÿã€é•·æœŸã‚µãƒãƒ¼ãƒˆç‰ˆã®ã“ã¨ã§ã€å®‰å®šæ€§ãŒä¿è¨¼ã•ã‚Œã¦ã„ã‚‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ã™ã€‚

3. **æ–°ã—ã„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ**

   Unity Hub ã®ã€ŒProjectsã€ã‚¿ãƒ–ã‹ã‚‰ã€ŒNew projectã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚

   - ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ: **2D (Built-in Render Pipeline)** ã‚’é¸æŠ
   - ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå: `PuyoPuyoTDD`
   - ä¿å­˜å ´æ‰€: ãŠå¥½ããªå ´æ‰€ã‚’é¸æŠ

   ã€ŒCreate projectã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚

4. **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ ã®ç¢ºèª**

   Unity ã‚¨ãƒ‡ã‚£ã‚¿ãŒé–‹ã„ãŸã‚‰ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ ã‚’ç¢ºèªã—ã¾ã—ã‚‡ã†ã€‚Project ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã« `Assets` ãƒ•ã‚©ãƒ«ãƒ€ãŒè¦‹ãˆã¾ã™ã­ã€‚ã“ã“ã«ç§ãŸã¡ã®ã‚³ãƒ¼ãƒ‰ã‚„ãƒªã‚½ãƒ¼ã‚¹ã‚’é…ç½®ã—ã¦ã„ãã¾ã™ã€‚

### Git ã«ã‚ˆã‚‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†

ã€Œã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãå‰ã«ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ï¼Ÿã€ãã†ã§ã™ï¼æœ€åˆã‹ã‚‰ Git ã‚’ä½¿ã†ã“ã¨ã§ã€å¤‰æ›´å±¥æ­´ã‚’è¿½è·¡ã—ã€ã„ã¤ã§ã‚‚éå»ã®çŠ¶æ…‹ã«æˆ»ã‚Œã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚

1. **Git ãƒªãƒã‚¸ãƒˆãƒªã®åˆæœŸåŒ–**

   ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼ˆ`PuyoPuyoTDD` ãƒ•ã‚©ãƒ«ãƒ€ï¼‰ã§ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ï¼š

   ```bash
   cd PuyoPuyoTDD
   git init
   ```

2. **.gitignore ã®ä½œæˆ**

   Unity ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ã€ã„ãã¤ã‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚„ãƒ•ã‚©ãƒ«ãƒ€ã‚’ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã‹ã‚‰é™¤å¤–ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã€Œãªã‚“ã§å…¨éƒ¨ç®¡ç†ã—ãªã„ã®ï¼Ÿã€ã¨æ€ã†ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒã€è‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã‚„å€‹äººè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã¯é™¤å¤–ã—ãŸæ–¹ãŒè‰¯ã„ã‚“ã§ã™ã€‚

   `.gitignore` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¦ã€ä»¥ä¸‹ã®å†…å®¹ã‚’è¨˜è¿°ã—ã¾ã™ï¼š

   ```gitignore
   # Unity generated
   [Ll]ibrary/
   [Tt]emp/
   [Oo]bj/
   [Bb]uild/
   [Bb]uilds/
   [Ll]ogs/
   [Uu]ser[Ss]ettings/

   # Visual Studio cache/options
   .vs/
   *.csproj
   *.unityproj
   *.sln
   *.suo
   *.tmp
   *.user
   *.userprefs
   *.pidb
   *.booproj
   *.svd
   *.pdb
   *.mdb
   *.opendb
   *.VC.db

   # Rider
   .idea/

   # OS generated
   .DS_Store
   .DS_Store?
   ._*
   .Spotlight-V100
   .Trashes
   ehthumbs.db
   Thumbs.db
   ```

3. **åˆå›ã‚³ãƒŸãƒƒãƒˆ**

   ã•ã¦ã€æœ€åˆã®ã‚³ãƒŸãƒƒãƒˆã‚’ã—ã¾ã—ã‚‡ã†ï¼

   ```bash
   git add .
   git commit -m 'chore: Unity ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®åˆæœŸåŒ–'
   ```

   ã€Œ`chore` ã£ã¦ä½•ï¼Ÿã€è‰¯ã„è³ªå•ã§ã™ã­ï¼ã“ã‚Œã¯ Conventional Commits ã¨ã„ã†è¦ç´„ã«å¾“ã£ãŸã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ãƒ—ãƒªãƒ•ã‚£ãƒƒã‚¯ã‚¹ã§ã™ã€‚`chore` ã¯ã€Œé›‘å‹™ãƒ»è¨­å®šå¤‰æ›´ã€ã‚’æ„å‘³ã—ã¾ã™ã€‚

### ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®è¦ç´„

ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ãªè¦ç´„ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã«å¾“ã†ã¨ã€å¾Œã§å¤‰æ›´å±¥æ­´ã‚’è¿½ã„ã‚„ã™ããªã‚‹ã‚“ã§ã™ã€‚

```
<ã‚¿ã‚¤ãƒ—>(<ã‚¹ã‚³ãƒ¼ãƒ—>): <ã‚¿ã‚¤ãƒˆãƒ«>
```

ä¸»ãªã‚¿ã‚¤ãƒ—ï¼š

- `feat`: æ–°æ©Ÿèƒ½ã®è¿½åŠ 
- `fix`: ãƒã‚°ä¿®æ­£
- `docs`: ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ã¿ã®å¤‰æ›´
- `style`: ã‚³ãƒ¼ãƒ‰ã®æ„å‘³ã«å½±éŸ¿ã—ãªã„å¤‰æ›´ï¼ˆç©ºç™½ã€ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆãªã©ï¼‰
- `refactor`: ãƒã‚°ä¿®æ­£ã‚„æ©Ÿèƒ½è¿½åŠ ã‚’ä¼´ã‚ãªã„ã‚³ãƒ¼ãƒ‰å¤‰æ›´
- `test`: ãƒ†ã‚¹ãƒˆã®è¿½åŠ ã‚„ä¿®æ­£
- `chore`: ãƒ“ãƒ«ãƒ‰ãƒ—ãƒ­ã‚»ã‚¹ã‚„è£œåŠ©ãƒ„ãƒ¼ãƒ«ã®å¤‰æ›´

### Unity Test Framework ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

æ¬¡ã¯ã€Œãƒ†ã‚¹ãƒ†ã‚£ãƒ³ã‚°ã€ã®æº–å‚™ã§ã™ã€‚Unity ã«ã¯ Unity Test Framework ã¨ã„ã†å…¬å¼ã®ãƒ†ã‚¹ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ãŒçµ„ã¿è¾¼ã¾ã‚Œã¦ã„ã¾ã™ã€‚

1. **Test Runner ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’é–‹ã**

   Unity ã‚¨ãƒ‡ã‚£ã‚¿ã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰ `Window > General > Test Runner` ã‚’é¸æŠã—ã¾ã™ã€‚

2. **ãƒ†ã‚¹ãƒˆã‚¢ã‚»ãƒ³ãƒ–ãƒªã®ä½œæˆ**

   Test Runner ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§ã€ŒCreate EditMode Test Assembly Folderã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€`Assets/Tests` ãƒ•ã‚©ãƒ«ãƒ€ãŒä½œæˆã•ã‚Œã¾ã™ã€‚

   ã€ŒEditMode ã¨ PlayMode ã£ã¦ä½•ãŒé•ã†ã®ï¼Ÿã€è‰¯ã„è³ªå•ã§ã™ã­ï¼š

   - **EditMode**: Unity ã‚¨ãƒ‡ã‚£ã‚¿ä¸Šã§å®Ÿè¡Œã•ã‚Œã‚‹ãƒ†ã‚¹ãƒˆã€‚ã‚²ãƒ¼ãƒ ãƒ­ã‚¸ãƒƒã‚¯ã®å˜ä½“ãƒ†ã‚¹ãƒˆã«ä½¿ç”¨ã€‚
   - **PlayMode**: Unity ã®ã‚²ãƒ¼ãƒ ãƒ¢ãƒ¼ãƒ‰ã§å®Ÿè¡Œã•ã‚Œã‚‹ãƒ†ã‚¹ãƒˆã€‚å®Ÿéš›ã®ã‚²ãƒ¼ãƒ å‹•ä½œã‚’çµ±åˆãƒ†ã‚¹ãƒˆã€‚

   ä»Šå›ã¯ä¸»ã« EditMode ãƒ†ã‚¹ãƒˆã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

3. **ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ã‚³ãƒ¼ãƒ‰ç”¨ã®ãƒ•ã‚©ãƒ«ãƒ€æ§‹æˆ**

   ãƒ†ã‚¹ãƒˆã¨ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ã‚³ãƒ¼ãƒ‰ã‚’åˆ†ã‘ã¦ç®¡ç†ã—ã¾ã—ã‚‡ã†ã€‚`Assets` ãƒ•ã‚©ãƒ«ãƒ€å†…ã«ä»¥ä¸‹ã®æ§‹é€ ã‚’ä½œã‚Šã¾ã™ï¼š

   ```
   Assets/
   â”œâ”€â”€ Scripts/
   â”‚   â”œâ”€â”€ Core/          # ã‚³ã‚¢ã‚²ãƒ¼ãƒ ãƒ­ã‚¸ãƒƒã‚¯
   â”‚   â”œâ”€â”€ UI/            # ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
   â”‚   â””â”€â”€ Utilities/     # ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã‚¯ãƒ©ã‚¹
   â””â”€â”€ Tests/             # ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰
       â””â”€â”€ EditMode/
   ```

4. **ã‚¢ã‚»ãƒ³ãƒ–ãƒªå®šç¾©ã®ä½œæˆ**

   Unity ã§ã¯ã€ã‚¢ã‚»ãƒ³ãƒ–ãƒªå®šç¾©ã‚’ä½¿ã£ã¦ã‚³ãƒ¼ãƒ‰ã‚’ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åŒ–ã—ã¾ã™ã€‚ã€Œã‚¢ã‚»ãƒ³ãƒ–ãƒªã£ã¦ä½•ï¼Ÿã€ã‚³ãƒ¼ãƒ‰ã®ã¾ã¨ã¾ã‚Šã®ã“ã¨ã§ã€ã“ã‚Œã‚’åˆ†ã‘ã‚‹ã“ã¨ã§ãƒ“ãƒ«ãƒ‰æ™‚é–“ãŒçŸ­ç¸®ã•ã‚Œã¾ã™ã€‚

   `Assets/Scripts` ãƒ•ã‚©ãƒ«ãƒ€å†…ã§å³ã‚¯ãƒªãƒƒã‚¯ â†’ `Create > Assembly Definition` ã‚’é¸æŠã—ã€`PuyoPuyo.asmdef` ã¨ã„ã†åå‰ã§ä½œæˆã—ã¾ã™ã€‚

   `Assets/Tests/EditMode` ãƒ•ã‚©ãƒ«ãƒ€ã«ã‚‚åŒæ§˜ã« `PuyoPuyo.Tests.asmdef` ã‚’ä½œæˆã—ã€Inspector ã§ä»¥ä¸‹ã®ã‚ˆã†ã«è¨­å®šã—ã¾ã™ï¼š

   - Platform: `Editor` ã®ã¿ãƒã‚§ãƒƒã‚¯
   - Assembly Definition References: `PuyoPuyo` ã‚’è¿½åŠ 
   - `Test Assemblies` ã«ãƒã‚§ãƒƒã‚¯

### æœ€åˆã®ãƒ†ã‚¹ãƒˆã‚’æ›¸ã„ã¦ã¿ã‚‹

ç’°å¢ƒãŒæ•´ã£ãŸã®ã§ã€æœ¬å½“ã«ãƒ†ã‚¹ãƒˆãŒå‹•ãã‹ç¢ºèªã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼

`Assets/Tests/EditMode` ãƒ•ã‚©ãƒ«ãƒ€ã« `SampleTest.cs` ã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ï¼š

```csharp
using NUnit.Framework;

namespace PuyoPuyo.Tests
{
    public class SampleTest
    {
        [Test]
        public void TestExample()
        {
            // Arrangeï¼ˆæº–å‚™ï¼‰
            int expected = 4;

            // Actï¼ˆå®Ÿè¡Œï¼‰
            int actual = 2 + 2;

            // Assertï¼ˆæ¤œè¨¼ï¼‰
            Assert.AreEqual(expected, actual);
        }
    }
}
```

ã€ŒArrange-Act-Assert ã£ã¦ä½•ï¼Ÿã€ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã®åŸºæœ¬ãƒ‘ã‚¿ãƒ¼ãƒ³ã§ã™ï¼š

- **Arrange**: ãƒ†ã‚¹ãƒˆã«å¿…è¦ãªæº–å‚™ã‚’ã™ã‚‹
- **Act**: å®Ÿéš›ã«ãƒ†ã‚¹ãƒˆå¯¾è±¡ã‚’å®Ÿè¡Œã™ã‚‹
- **Assert**: çµæœãŒæœŸå¾…é€šã‚Šã‹æ¤œè¨¼ã™ã‚‹

Test Runner ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§ã€ŒRun Allã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚ç·‘è‰²ã®ãƒã‚§ãƒƒã‚¯ãƒãƒ¼ã‚¯ãŒè¡¨ç¤ºã•ã‚Œã‚Œã°æˆåŠŸã§ã™ï¼

ã€Œã‚„ã£ãŸï¼ãƒ†ã‚¹ãƒˆãŒé€šã£ãŸï¼ã€ç´ æ™´ã‚‰ã—ã„ã§ã™ã­ã€‚ã“ã‚Œã§ TDD ã®æº–å‚™ãŒæ•´ã„ã¾ã—ãŸã€‚

```bash
git add .
git commit -m 'test: ãƒ†ã‚¹ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—'
```

### é™çš„ã‚³ãƒ¼ãƒ‰è§£æã®è¨­å®š

è‰¯ã„ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãç¶šã‘ã‚‹ãŸã‚ã«ã¯ã€ã‚³ãƒ¼ãƒ‰ã®å“è³ªã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹ä»•çµ„ã¿ãŒå¿…è¦ã§ã™ã€‚C# ã«ã¯ Roslyn Analyzers ã¨ã„ã†å¼·åŠ›ãªé™çš„ã‚³ãƒ¼ãƒ‰è§£æãƒ„ãƒ¼ãƒ«ãŒã‚ã‚Šã¾ã™ã€‚

1. **EditorConfig ã®ä½œæˆ**

   ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã« `.editorconfig` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ï¼š

   ```ini
   root = true

   [*]
   charset = utf-8
   indent_style = space
   indent_size = 4
   insert_final_newline = true
   trim_trailing_whitespace = true

   [*.cs]
   # C# ã®ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„
   dotnet_sort_system_directives_first = true
   csharp_new_line_before_open_brace = all
   csharp_prefer_braces = true:warning

   # å‘½åè¦å‰‡
   dotnet_naming_rule.interface_should_be_begins_with_i.severity = warning
   dotnet_naming_rule.interface_should_be_begins_with_i.symbols = interface
   dotnet_naming_rule.interface_should_be_begins_with_i.style = begins_with_i

   dotnet_naming_symbols.interface.applicable_kinds = interface
   dotnet_naming_symbols.interface.applicable_accessibilities = public, internal, private, protected, protected_internal

   dotnet_naming_style.begins_with_i.required_prefix = I
   dotnet_naming_style.begins_with_i.capitalization = pascal_case
   ```

   ã€Œãªã‚“ã ã‹é•·ã„è¨­å®šã ãª...ã€ã§ã‚‚ã€ã“ã‚Œã§ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¹ã‚¿ã‚¤ãƒ«ãŒçµ±ä¸€ã•ã‚Œã‚‹ã‚“ã§ã™ã€‚

2. **Roslyn Analyzers ã®æœ‰åŠ¹åŒ–**

   Unity 2020.2 ä»¥é™ã€Roslyn Analyzers ãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§æœ‰åŠ¹ã«ãªã£ã¦ã„ã¾ã™ã€‚ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãã¨ã€Visual Studio ã‚„ Rider ãŒãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§è­¦å‘Šã‚’è¡¨ç¤ºã—ã¦ãã‚Œã¾ã™ã€‚

   ```bash
   git add .
   git commit -m 'chore: é™çš„ã‚³ãƒ¼ãƒ‰è§£æã®è¨­å®š'
   ```

### ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³é–‹ç™ºç’°å¢ƒã®æ•´å‚™

æœ€å¾Œã«ã€Œè‡ªå‹•åŒ–ã€ã§ã™ã€‚Unity ã‚’ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã‹ã‚‰æ“ä½œã§ãã‚‹ã‚ˆã†ã«ã—ã¦ã€ãƒ†ã‚¹ãƒˆã€ãƒ“ãƒ«ãƒ‰ã€ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆãªã©ã‚’ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‹ã‚‰å®Ÿè¡Œã§ãã‚‹ç’°å¢ƒã‚’æ•´ãˆã¾ã—ã‚‡ã†ã€‚

#### Unity ã®ãƒ‘ã‚¹ã‚’è¨­å®š

ã¾ãšã€Unity ã®ãƒ‘ã‚¹ã‚’ç’°å¢ƒå¤‰æ•°ã¨ã—ã¦è¨­å®šã—ã¦ãŠãã¨ä¾¿åˆ©ã§ã™ã€‚ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã« `unity-config.sh` ã‚’ä½œæˆã—ã¾ã™ï¼š

```bash
#!/bin/bash
# Unity è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«

# Unity ã®ãƒ‘ã‚¹ï¼ˆOS ã¨ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«å¿œã˜ã¦å¤‰æ›´ã—ã¦ãã ã•ã„ï¼‰
# macOS ã®å ´åˆ
UNITY_PATH="/Applications/Unity/Hub/Editor/2022.3.0f1/Unity.app/Contents/MacOS/Unity"

# Linux ã®å ´åˆï¼ˆä¾‹ï¼‰
# UNITY_PATH="/usr/bin/unity-editor"

# Windows ã®å ´åˆï¼ˆGit Bashï¼‰
# UNITY_PATH="/c/Program Files/Unity/Hub/Editor/2022.3.0f1/Editor/Unity.exe"

export UNITY_PATH
export PROJECT_PATH="$(pwd)"
```

#### ãƒ†ã‚¹ãƒˆå®Ÿè¡Œã‚¹ã‚¯ãƒªãƒ—ãƒˆ

`scripts/test.sh` ã‚’ä½œæˆã—ã¾ã™ï¼š

```bash
#!/bin/bash
# Unity ãƒ†ã‚¹ãƒˆå®Ÿè¡Œã‚¹ã‚¯ãƒªãƒ—ãƒˆ

source ./unity-config.sh

echo "ğŸ§ª Unity ãƒ†ã‚¹ãƒˆå®Ÿè¡Œä¸­..."
"$UNITY_PATH" -batchmode -nographics \
  -projectPath "$PROJECT_PATH" \
  -runTests \
  -testPlatform EditMode \
  -testResults "$PROJECT_PATH/TestResults.xml" \
  -logFile "$PROJECT_PATH/test.log"

EXIT_CODE=$?

if [ $EXIT_CODE -eq 0 ]; then
    echo "âœ… ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆãŒæˆåŠŸã—ã¾ã—ãŸ"
else
    echo "âŒ ãƒ†ã‚¹ãƒˆãŒå¤±æ•—ã—ã¾ã—ãŸ"
    echo "è©³ç´°: test.log ã‚’ç¢ºèªã—ã¦ãã ã•ã„"
fi

exit $EXIT_CODE
```

#### ãƒ“ãƒ«ãƒ‰ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

`scripts/build.sh` ã‚’ä½œæˆã—ã¾ã™ï¼š

```bash
#!/bin/bash
# Unity ãƒ“ãƒ«ãƒ‰ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

source ./unity-config.sh

echo "ğŸ”¨ Unity ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ãƒ“ãƒ«ãƒ‰ä¸­..."
"$UNITY_PATH" -batchmode -nographics \
  -projectPath "$PROJECT_PATH" \
  -buildTarget StandaloneLinux64 \
  -quit \
  -logFile "$PROJECT_PATH/build.log"

EXIT_CODE=$?

if [ $EXIT_CODE -eq 0 ]; then
    echo "âœ… ãƒ“ãƒ«ãƒ‰ãŒæˆåŠŸã—ã¾ã—ãŸ"
else
    echo "âŒ ãƒ“ãƒ«ãƒ‰ãŒå¤±æ•—ã—ã¾ã—ãŸ"
    echo "è©³ç´°: build.log ã‚’ç¢ºèªã—ã¦ãã ã•ã„"
fi

exit $EXIT_CODE
```

#### ã‚³ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ

C# ã®ã‚³ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã«ã¯ `dotnet format` ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚`scripts/format.sh` ã‚’ä½œæˆï¼š

```bash
#!/bin/bash
# C# ã‚³ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ

echo "âœ¨ ã‚³ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆå®Ÿè¡Œä¸­..."

# .csproj ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¢ã™
CSPROJ_FILE=$(find . -name "*.csproj" | head -1)

if [ -z "$CSPROJ_FILE" ]; then
    echo "âŒ .csproj ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“"
    exit 1
fi

dotnet format "$CSPROJ_FILE" --verify-no-changes

if [ $? -eq 0 ]; then
    echo "âœ… ã‚³ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆOK"
else
    echo "ğŸ”„ ã‚³ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆé©ç”¨ä¸­..."
    dotnet format "$CSPROJ_FILE"
    echo "âœ… ã‚³ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆå®Œäº†"
fi
```

#### çµ±åˆãƒã‚§ãƒƒã‚¯ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

ã™ã¹ã¦ã®ãƒã‚§ãƒƒã‚¯ã‚’ä¸€æ‹¬ã§å®Ÿè¡Œã™ã‚‹ `scripts/check.sh` ã‚’ä½œæˆï¼š

```bash
#!/bin/bash
# çµ±åˆå“è³ªãƒã‚§ãƒƒã‚¯ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

set -e  # ã‚¨ãƒ©ãƒ¼ã§åœæ­¢

echo "=== å“è³ªãƒã‚§ãƒƒã‚¯é–‹å§‹ ==="
echo ""

# ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆãƒã‚§ãƒƒã‚¯
echo "1. ã‚³ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆãƒã‚§ãƒƒã‚¯"
./scripts/format.sh
echo ""

# ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
echo "2. ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ"
./scripts/test.sh
echo ""

echo "=== âœ… ã™ã¹ã¦ã®ãƒã‚§ãƒƒã‚¯ãŒå®Œäº†ã—ã¾ã—ãŸ ==="
```

#### ãƒ•ã‚¡ã‚¤ãƒ«ç›£è¦–ã¨è‡ªå‹•å®Ÿè¡Œã‚¹ã‚¯ãƒªãƒ—ãƒˆ

ãƒ•ã‚¡ã‚¤ãƒ«å¤‰æ›´ã‚’æ¤œçŸ¥ã—ã¦è‡ªå‹•çš„ã«ãƒã‚§ãƒƒã‚¯ã‚’å®Ÿè¡Œã™ã‚‹ `scripts/watch.sh` ã‚’ä½œæˆï¼š

```bash
#!/bin/bash
# Unity ãƒ†ã‚¹ãƒˆã®ç›£è¦–ã¨è‡ªå‹•å®Ÿè¡Œã‚¹ã‚¯ãƒªãƒ—ãƒˆ

source ./unity-config.sh

echo "=== Unity Test Watcher ==="
echo "ãƒ•ã‚¡ã‚¤ãƒ«å¤‰æ›´ã‚’ç›£è¦–ä¸­..."
echo "çµ‚äº†ã™ã‚‹ã«ã¯ Ctrl+C ã‚’æŠ¼ã—ã¦ãã ã•ã„"
echo ""

# åˆå›å®Ÿè¡Œ
echo "ğŸ”„ åˆå›ãƒã‚§ãƒƒã‚¯å®Ÿè¡Œ..."
./scripts/check.sh || true
echo ""

# ãƒ•ã‚¡ã‚¤ãƒ«ç›£è¦–
if command -v fswatch &> /dev/null; then
    # macOS
    fswatch -o -e ".*" -i "\\.cs$" Assets/ | while read; do
        echo "ğŸ“ å¤‰æ›´æ¤œå‡º: $(date '+%H:%M:%S')"
        ./scripts/check.sh || true
        echo ""
    done
elif command -v inotifywait &> /dev/null; then
    # Linux
    while true; do
        inotifywait -r -e modify,create,delete --include '\.cs$' Assets/
        echo "ğŸ“ å¤‰æ›´æ¤œå‡º: $(date '+%H:%M:%S')"
        ./scripts/check.sh || true
        echo ""
    done
else
    echo "âŒ ãƒ•ã‚¡ã‚¤ãƒ«ç›£è¦–ãƒ„ãƒ¼ãƒ«ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã¾ã›ã‚“"
    echo "macOS: brew install fswatch"
    echo "Linux: sudo apt-get install inotify-tools"
    exit 1
fi
```

#### Cake ã«ã‚ˆã‚‹ãƒ“ãƒ«ãƒ‰è‡ªå‹•åŒ–

ã€Œãƒ“ãƒ«ãƒ‰è‡ªå‹•åŒ–ãƒ„ãƒ¼ãƒ«ã¯ä½•ã‚’ä½¿ãˆã°ã„ã„ã§ã™ã‹ï¼Ÿã€.NET ã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ ã§ã¯ Cake ãŒã‚ˆãä½¿ã‚ã‚Œã¾ã™ã€‚Cake ã¯ C# ã§æ›¸ã‘ã‚‹ã‚¯ãƒ­ã‚¹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ãªãƒ“ãƒ«ãƒ‰è‡ªå‹•åŒ–ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚

##### Cakeã¨ã¯

Cakeï¼ˆC# Makeï¼‰ã¯ã€.NET é–‹ç™ºè€…å‘ã‘ã®ãƒ“ãƒ«ãƒ‰è‡ªå‹•åŒ–ã‚·ã‚¹ãƒ†ãƒ ã§ã™ï¼š

**ç‰¹å¾´**
- C# ã§æ›¸ã‘ã‚‹ãƒ“ãƒ«ãƒ‰ã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼ˆå‹å®‰å…¨ã€IntelliSense å¯¾å¿œï¼‰
- ã‚¯ãƒ­ã‚¹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ï¼ˆWindowsã€macOSã€Linuxï¼‰
- è±Šå¯Œãªã‚¢ãƒ‰ã‚¤ãƒ³ã¨ãƒ˜ãƒ«ãƒ‘ãƒ¼
- .NET ãƒ„ãƒ¼ãƒ«ã¨ã®çµ±åˆ

##### Cakeã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

ã¾ãšã€Cake ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ãƒ„ãƒ¼ãƒ«ã¨ã—ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ï¼š

```bash
# .NET ãƒ­ãƒ¼ã‚«ãƒ«ãƒ„ãƒ¼ãƒ«ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆã‚’ä½œæˆ
dotnet new tool-manifest

# Cake ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
dotnet tool install Cake.Tool
```

æ¬¡ã«ã€ãƒ“ãƒ«ãƒ‰ã‚¹ã‚¯ãƒªãƒ—ãƒˆ `build.cake` ã‚’ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã«ä½œæˆã—ã¾ã™ï¼š

```csharp
// build.cake

///////////////////////////////////////////////////////////////////////////////
// å¼•æ•°
///////////////////////////////////////////////////////////////////////////////

var target = Argument("target", "Default");
var configuration = Argument("configuration", "Release");

///////////////////////////////////////////////////////////////////////////////
// ã‚¿ã‚¹ã‚¯å®šç¾©
///////////////////////////////////////////////////////////////////////////////

Task("Test")
    .Description("Unity ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ")
    .Does(() =>
{
    var exitCode = StartProcess("./scripts/test.sh");
    if (exitCode != 0)
    {
        throw new Exception("ãƒ†ã‚¹ãƒˆãŒå¤±æ•—ã—ã¾ã—ãŸ");
    }
});

Task("Build")
    .Description("Unity ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ãƒ“ãƒ«ãƒ‰")
    .Does(() =>
{
    var exitCode = StartProcess("./scripts/build.sh");
    if (exitCode != 0)
    {
        throw new Exception("ãƒ“ãƒ«ãƒ‰ãŒå¤±æ•—ã—ã¾ã—ãŸ");
    }
});

Task("Format")
    .Description("ã‚³ãƒ¼ãƒ‰ã‚’è‡ªå‹•ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ")
    .Does(() =>
{
    StartProcess("./scripts/format.sh");
});

Task("Check")
    .Description("ã™ã¹ã¦ã®å“è³ªãƒã‚§ãƒƒã‚¯ã‚’å®Ÿè¡Œ")
    .IsDependentOn("Format")
    .IsDependentOn("Test");

Task("Watch")
    .Description("ãƒ•ã‚¡ã‚¤ãƒ«ç›£è¦–ãƒ¢ãƒ¼ãƒ‰ã§è‡ªå‹•ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ")
    .Does(() =>
{
    StartProcess("./scripts/watch.sh");
});

///////////////////////////////////////////////////////////////////////////////
// ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ
///////////////////////////////////////////////////////////////////////////////

Task("Default")
    .IsDependentOn("Check");

Task("CI")
    .Description("CIç’°å¢ƒã§ã®å®Œå…¨ãªãƒ“ãƒ«ãƒ‰ã¨ãƒ†ã‚¹ãƒˆ")
    .IsDependentOn("Check")
    .IsDependentOn("Build");

///////////////////////////////////////////////////////////////////////////////
// å®Ÿè¡Œ
///////////////////////////////////////////////////////////////////////////////

RunTarget(target);
```

##### Cakeã®å®Ÿè¡Œ

Cake ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã™ã‚‹ã«ã¯ã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¾ã™ï¼š

```bash
# ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚¿ã‚¹ã‚¯ï¼ˆCheckï¼‰ã‚’å®Ÿè¡Œ
dotnet cake

# ç‰¹å®šã®ã‚¿ã‚¹ã‚¯ã‚’å®Ÿè¡Œ
dotnet cake --target=Test
dotnet cake --target=Build
dotnet cake --target=Format
dotnet cake --target=Watch

# CIç’°å¢ƒã§ã®ãƒ“ãƒ«ãƒ‰
dotnet cake --target=CI
```

##### Cakeã®åˆ©ç‚¹

ã€Œãªãœ Cake ã‚’ä½¿ã†ã®ã§ã™ã‹ï¼Ÿã€Cake ã‚’ä½¿ã†åˆ©ç‚¹ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ï¼š

1. **å‹å®‰å…¨æ€§**ï¼šC# ã§æ›¸ãã®ã§ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ™‚ã«å‹ãƒã‚§ãƒƒã‚¯ã•ã‚Œã‚‹
2. **IntelliSense**ï¼šVisual Studio Code ã‚„ Rider ã§è£œå®ŒãŒåŠ¹ã
3. **å†åˆ©ç”¨æ€§**ï¼šNuGet ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨ã—ã¦ãƒ“ãƒ«ãƒ‰ãƒ­ã‚¸ãƒƒã‚¯ã‚’å…±æœ‰ã§ãã‚‹
4. **çµ±åˆæ€§**ï¼š.NET ãƒ„ãƒ¼ãƒ«ã¨ã‚·ãƒ¼ãƒ ãƒ¬ã‚¹ã«çµ±åˆ
5. **å¯èª­æ€§**ï¼šè¤‡é›‘ãªãƒ“ãƒ«ãƒ‰ãƒ­ã‚¸ãƒƒã‚¯ã‚‚æ§‹é€ åŒ–ã—ã¦æ›¸ã‘ã‚‹
6. **ã‚¯ãƒ­ã‚¹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ **ï¼šWindowsã€macOSã€Linux ã§åŒã˜ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒå‹•ã

#### ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å®Ÿè¡Œæ¨©é™ä»˜ä¸

ã™ã¹ã¦ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã«å®Ÿè¡Œæ¨©é™ã‚’ä»˜ä¸ã—ã¾ã™ï¼š

```bash
chmod +x unity-config.sh
chmod +x scripts/*.sh
```

#### ä½¿ã„æ–¹

ã“ã‚Œã§ã€ä»¥ä¸‹ã®ã‚ˆã†ã«ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã‹ã‚‰é–‹ç™ºã§ãã¾ã™ï¼š

```bash
# ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
dotnet cake --target=Test
# ã¾ãŸã¯ç›´æ¥ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œ
./scripts/test.sh

# ãƒ“ãƒ«ãƒ‰
dotnet cake --target=Build

# ã‚³ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
dotnet cake --target=Format

# ã™ã¹ã¦ã®ãƒã‚§ãƒƒã‚¯
dotnet cake --target=Check

# ãƒ•ã‚¡ã‚¤ãƒ«ç›£è¦–ãƒ¢ãƒ¼ãƒ‰ï¼ˆé–‹ç™ºä¸­ã¯ã“ã‚Œã‚’èµ·å‹•ï¼‰
dotnet cake --target=Watch
```

ã€Œã™ã”ã„ï¼Unity ãŒã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã§ä½¿ãˆã‚‹ã‚ˆã†ã«ãªã£ãŸï¼ã€ãã†ã§ã™ã€‚ã“ã‚Œã§ VS Code ã‚„ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã ã‘ã§é–‹ç™ºã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚

```bash
git add .
git commit -m 'chore: ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³é–‹ç™ºç’°å¢ƒã®æ•´å‚™'
```

### ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ 0 ã®ã¾ã¨ã‚

ãŠç–²ã‚Œæ§˜ã§ã—ãŸï¼ã“ã‚Œã§é–‹ç™ºç’°å¢ƒã®æº–å‚™ãŒæ•´ã„ã¾ã—ãŸã€‚æŒ¯ã‚Šè¿”ã£ã¦ã¿ã¾ã—ã‚‡ã†ï¼š

1. **ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†**: Git ãƒªãƒã‚¸ãƒˆãƒªã‚’åˆæœŸåŒ–ã—ã€`.gitignore` ã‚’è¨­å®š
2. **ãƒ†ã‚¹ãƒ†ã‚£ãƒ³ã‚°**: Unity Test Framework ã‚’ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã—ã€æœ€åˆã®ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ
3. **è‡ªå‹•åŒ–**: Cake ã«ã‚ˆã‚‹ãƒ“ãƒ«ãƒ‰è‡ªå‹•åŒ–ã¨ãƒ•ã‚¡ã‚¤ãƒ«ç›£è¦–ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§è‡ªå‹•ãƒ†ã‚¹ãƒˆå®Ÿè¡Œã‚’å®Ÿç¾

ã€Œã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢é–‹ç™ºã®ä¸‰ç¨®ã®ç¥å™¨ã€ãŒã™ã¹ã¦æƒã„ã¾ã—ãŸã­ï¼ã“ã‚Œã§æ¬¡ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‹ã‚‰ã€å®‰å¿ƒã—ã¦ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã‚’é€²ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

æ¬¡ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ã€ã„ã‚ˆã„ã‚ˆã·ã‚ˆã·ã‚ˆã®åŸºç›¤ã¨ãªã‚‹ãƒœãƒ¼ãƒ‰ã‚’å®Ÿè£…ã—ã¦ã„ãã¾ã™ã‚ˆã€‚æ¥½ã—ã¿ã§ã™ã­ï¼

```bash
git add .
git commit -m 'docs: ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ 0 å®Œäº†'
```

---

## ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ 1: ãƒœãƒ¼ãƒ‰ã®å®Ÿè£…

ã•ã‚ã€ã„ã‚ˆã„ã‚ˆã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãå§‹ã‚ã¾ã—ã‚‡ã†ï¼ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã§ã¯ã€å°ã•ãªã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆåå¾©ï¼‰ã§æ©Ÿèƒ½ã‚’å°‘ã—ãšã¤è¿½åŠ ã—ã¦ã„ãã¾ã™ã€‚æœ€åˆã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ã€ã·ã‚ˆã·ã‚ˆã®åŸºç›¤ã¨ãªã‚‹ãƒœãƒ¼ãƒ‰ï¼ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ï¼‰ã‚’å®Ÿè£…ã—ã¾ã™ã€‚

> ã‚·ã‚¹ãƒ†ãƒ æ§‹ç¯‰ã¯ã©ã“ã‹ã‚‰å§‹ã‚ã‚‹ã¹ãã ã‚ã†ã‹ã€‚ã‚·ã‚¹ãƒ†ãƒ æ§‹ç¯‰ãŒçµ‚ã‚ã£ãŸã‚‰ã“ã†ãªã‚‹ã€ã¨ã„ã†ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚’èªã‚‹ã¨ã“ã‚ã‹ã‚‰ã ã€‚
>
> â€” Kent Beck ã€ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã€

### ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼

ã¾ãšã¯ã€ã“ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§å®Ÿè£…ã™ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚’ç¢ºèªã—ã¾ã—ã‚‡ã†ï¼š

> ã‚·ã‚¹ãƒ†ãƒ ã¨ã—ã¦ã€6 åˆ—Ã—12 è¡Œã®ãƒœãƒ¼ãƒ‰ã‚’æŒã¤

ã€Œã‚·ã‚¹ãƒ†ãƒ ã¨ã—ã¦ã€ã¨ã„ã†ã®ã¯ã€ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã«ã¯ç›´æ¥è¦‹ãˆãªã„å†…éƒ¨çš„ãªæ©Ÿèƒ½ã¨ã„ã†æ„å‘³ã§ã™ã€‚ã“ã®ãƒœãƒ¼ãƒ‰ãŒã€ã“ã‚Œã‹ã‚‰å®Ÿè£…ã™ã‚‹ã™ã¹ã¦ã®æ©Ÿèƒ½ã®åœŸå°ã¨ãªã‚Šã¾ã™ã€‚

### TODOãƒªã‚¹ãƒˆ

ã•ã¦ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚’å®Ÿè£…ã™ã‚‹ãŸã‚ã«ã€ã¾ãšã¯ TODO ãƒªã‚¹ãƒˆã‚’ä½œæˆã—ã¾ã—ã‚‡ã†ã€‚TODO ãƒªã‚¹ãƒˆã¯ã€å¤§ããªæ©Ÿèƒ½ã‚’å°ã•ãªã‚¿ã‚¹ã‚¯ã«åˆ†è§£ã™ã‚‹ã®ã«å½¹ç«‹ã¡ã¾ã™ã€‚

> ä½•ã‚’ãƒ†ã‚¹ãƒˆã™ã¹ãã ã‚ã†ã‹ - ç€æ‰‹ã™ã‚‹å‰ã«ã€å¿…è¦ã«ãªã‚Šãã†ãªãƒ†ã‚¹ãƒˆã‚’ãƒªã‚¹ãƒˆã«æ›¸ãå‡ºã—ã¦ãŠã“ã†ã€‚
>
> â€” Kent Beck ã€ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã€

ãƒœãƒ¼ãƒ‰ã®å®Ÿè£…ã«å¿…è¦ãªã‚¿ã‚¹ã‚¯ã‚’è€ƒãˆã¦ã¿ã¾ã—ã‚‡ã†ï¼š

- ãƒœãƒ¼ãƒ‰ã‚’ä½œæˆã§ãã‚‹ï¼ˆ6 åˆ—Ã—12 è¡Œã®ã‚µã‚¤ã‚ºã§åˆæœŸåŒ–ï¼‰
- ãƒœãƒ¼ãƒ‰ã®ç‰¹å®šã®ä½ç½®ã«ã·ã‚ˆã‚’é…ç½®ã§ãã‚‹
- ãƒœãƒ¼ãƒ‰ã®ç‰¹å®šã®ä½ç½®ã®ã·ã‚ˆã‚’å–å¾—ã§ãã‚‹
- ãƒœãƒ¼ãƒ‰ã®ç¯„å›²å¤–ã®ãƒã‚§ãƒƒã‚¯ãŒã§ãã‚‹ï¼ˆå£åˆ¤å®šï¼‰
- ãƒœãƒ¼ãƒ‰ã‚’ã‚¯ãƒªã‚¢ã§ãã‚‹ï¼ˆã™ã¹ã¦ã®ã·ã‚ˆã‚’å‰Šé™¤ï¼‰

ã“ã‚Œã‚‰ã®ã‚¿ã‚¹ã‚¯ã‚’ä¸€ã¤ãšã¤ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã®ã‚µã‚¤ã‚¯ãƒ«ã§å®Ÿè£…ã—ã¦ã„ãã¾ã—ã‚‡ã†ï¼

### ãƒ†ã‚¹ãƒˆ: ãƒœãƒ¼ãƒ‰ã®ä½œæˆ

ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã§ã¯ã€ã¾ãšãƒ†ã‚¹ãƒˆã‚’æ›¸ãã“ã¨ã‹ã‚‰å§‹ã‚ã¾ã™ã€‚

> ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆ
>
> ã„ã¤ãƒ†ã‚¹ãƒˆã‚’æ›¸ãã¹ãã ã‚ã†ã‹â€”â€”ãã‚Œã¯ãƒ†ã‚¹ãƒˆå¯¾è±¡ã®ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãå‰ã ã€‚
>
> â€” Kent Beck ã€ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã€

`Assets/Tests/EditMode` ãƒ•ã‚©ãƒ«ãƒ€ã« `BoardTest.cs` ã‚’ä½œæˆã—ã¾ã™ï¼š

```csharp
using NUnit.Framework;
using PuyoPuyo.Core;

namespace PuyoPuyo.Tests
{
    public class BoardTest
    {
        [Test]
        public void ãƒœãƒ¼ãƒ‰ã‚’ä½œæˆã™ã‚‹ã¨6åˆ—12è¡Œã§åˆæœŸåŒ–ã•ã‚Œã‚‹()
        {
            // Arrange & Act
            Board board = new Board();

            // Assert
            Assert.AreEqual(6, board.Cols);
            Assert.AreEqual(12, board.Rows);
        }

        [Test]
        public void æ–°è¦ä½œæˆã—ãŸãƒœãƒ¼ãƒ‰ã¯ã™ã¹ã¦ã®ä½ç½®ãŒç©ºã§ã‚ã‚‹()
        {
            // Arrange
            Board board = new Board();

            // Act & Assert
            for (int row = 0; row < board.Rows; row++)
            {
                for (int col = 0; col < board.Cols; col++)
                {
                    Assert.AreEqual(PuyoColor.None, board.Get(row, col));
                }
            }
        }
    }
}
```

ã€ŒArrange-Act-Assert ã£ã¦ä½•ï¼Ÿã€è‰¯ã„è³ªå•ã§ã™ã­ï¼ã“ã‚Œã¯ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã®åŸºæœ¬ãƒ‘ã‚¿ãƒ¼ãƒ³ã§ã™ï¼š

- **Arrangeï¼ˆæº–å‚™ï¼‰**: ãƒ†ã‚¹ãƒˆã«å¿…è¦ãªæº–å‚™ã‚’ã™ã‚‹
- **Actï¼ˆå®Ÿè¡Œï¼‰**: å®Ÿéš›ã«ãƒ†ã‚¹ãƒˆå¯¾è±¡ã‚’å®Ÿè¡Œã™ã‚‹
- **Assertï¼ˆæ¤œè¨¼ï¼‰**: çµæœãŒæœŸå¾…é€šã‚Šã‹æ¤œè¨¼ã™ã‚‹

ã“ã®ãƒ†ã‚¹ãƒˆã§ã¯ã€`Board` ã‚¯ãƒ©ã‚¹ãŒæ­£ã—ãåˆæœŸåŒ–ã•ã‚Œã€ã™ã¹ã¦ã®ä½ç½®ãŒç©ºï¼ˆ`PuyoColor.None`ï¼‰ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ã„ã¾ã™ã€‚

### å®Ÿè£…: ãƒœãƒ¼ãƒ‰ã®ä½œæˆ

ãƒ†ã‚¹ãƒˆã‚’æ›¸ã„ãŸã‚‰ã€æ¬¡ã«å®Ÿè¡Œã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚ã©ã†ãªã‚‹ã§ã—ã‚‡ã†ã‹ï¼Ÿ

Test Runner ã§ã€ŒRun Allã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨...

```
error CS0246: The type or namespace name 'Board' could not be found
error CS0246: The type or namespace name 'PuyoColor' could not be found
```

ãŠã£ã¨ï¼ã¾ã  `Board` ã‚¯ãƒ©ã‚¹ã‚‚ `PuyoColor` ã‚‚å®Ÿè£…ã—ã¦ã„ãªã„ã®ã§ã€å½“ç„¶ã‚¨ãƒ©ãƒ¼ã«ãªã‚Šã¾ã™ã­ã€‚ã“ã‚ŒãŒãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã®ã€ŒRedï¼ˆèµ¤ï¼‰ã€ã®çŠ¶æ…‹ã§ã™ã€‚

> æ˜ç™½ãªå®Ÿè£…
>
> ã‚·ãƒ³ãƒ—ãƒ«ãªæ“ä½œã‚’ã©ã†å®Ÿè£…ã™ã‚Œã°ã„ã„ã ã‚ã†ã‹ã€‚ãŸã å®Ÿè£…ã™ã‚Œã°ã„ã„ã®ã ã€‚
>
> â€” Kent Beck ã€ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã€

ã§ã¯ã€ãƒ†ã‚¹ãƒˆãŒé€šã‚‹ã‚ˆã†ã«æœ€å°é™ã®ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè£…ã—ã¦ã„ãã¾ã—ã‚‡ã†ã€‚

ã¾ãšã€`Assets/Scripts/Core` ãƒ•ã‚©ãƒ«ãƒ€ã« `PuyoColor.cs` ã‚’ä½œæˆã—ã¾ã™ï¼š

```csharp
namespace PuyoPuyo.Core
{
    public enum PuyoColor
    {
        None = 0,   // ç©º
        Red,        // èµ¤
        Blue,       // é’
        Green,      // ç·‘
        Yellow      // é»„
    }
}
```

ã€Œãªã‚“ã§ enum ãªã®ï¼Ÿã€è‰¯ã„è³ªå•ã§ã™ã­ï¼enumï¼ˆåˆ—æŒ™å‹ï¼‰ã‚’ä½¿ã†ã“ã¨ã§ã€ã·ã‚ˆã®è‰²ã‚’å‹å®‰å…¨ã«æ‰±ãˆã‚‹ã‚“ã§ã™ã€‚`int` ã§ `1, 2, 3...` ã¨ç®¡ç†ã™ã‚‹ã‚ˆã‚Šã‚‚ã€`PuyoColor.Red` ã®ã‚ˆã†ã«æ„å‘³ãŒæ˜ç¢ºã«ãªã‚Šã¾ã™ã‚ˆã­ã€‚

æ¬¡ã«ã€`Assets/Scripts/Core` ãƒ•ã‚©ãƒ«ãƒ€ã« `Board.cs` ã‚’ä½œæˆã—ã¾ã™ï¼š

```csharp
namespace PuyoPuyo.Core
{
    public class Board
    {
        private const int COLS = 6;
        private const int ROWS = 12;
        
        private PuyoColor[,] cells;

        public int Cols => COLS;
        public int Rows => ROWS;

        public Board()
        {
            cells = new PuyoColor[ROWS, COLS];
            Clear();
        }

        public PuyoColor Get(int row, int col)
        {
            return cells[row, col];
        }

        public void Clear()
        {
            for (int row = 0; row < ROWS; row++)
            {
                for (int col = 0; col < COLS; col++)
                {
                    cells[row, col] = PuyoColor.None;
                }
            }
        }
    }
}
```

ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼š

```
âœ… ãƒœãƒ¼ãƒ‰ã‚’ä½œæˆã™ã‚‹ã¨6åˆ—12è¡Œã§åˆæœŸåŒ–ã•ã‚Œã‚‹
âœ… æ–°è¦ä½œæˆã—ãŸãƒœãƒ¼ãƒ‰ã¯ã™ã¹ã¦ã®ä½ç½®ãŒç©ºã§ã‚ã‚‹
```

ã‚„ã£ãŸï¼ãƒ†ã‚¹ãƒˆãŒé€šã‚Šã¾ã—ãŸã€‚ã“ã‚ŒãŒãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã®ã€ŒGreenï¼ˆç·‘ï¼‰ã€ã®çŠ¶æ…‹ã§ã™ã€‚

### è§£èª¬: ãƒœãƒ¼ãƒ‰ã®å®Ÿè£…

å®Ÿè£…ã—ãŸãƒœãƒ¼ãƒ‰ã«ã¤ã„ã¦ã€å°‘ã—è§£èª¬ã—ã¦ãŠãã¾ã—ã‚‡ã†ï¼š

1. **å®šæ•°ã®ä½¿ç”¨**: `COLS` ã¨ `ROWS` ã‚’å®šæ•°ã¨ã—ã¦å®šç¾©ã—ã¦ã„ã¾ã™ã€‚ã€Œãªãœï¼Ÿã€ã¨ã„ã†ã¨ã€ãƒã‚¸ãƒƒã‚¯ãƒŠãƒ³ãƒãƒ¼ï¼ˆçªç„¶ç¾ã‚Œã‚‹æ•°å­—ï¼‰ã‚’é¿ã‘ã‚‹ãŸã‚ã§ã™ã€‚

2. **2 æ¬¡å…ƒé…åˆ—**: `PuyoColor[,] cells` ã§ 2 æ¬¡å…ƒé…åˆ—ã‚’ä½¿ã£ã¦ã„ã¾ã™ã€‚C# ã§ã¯ `[row, col]` ã®é †åºã§ã‚¢ã‚¯ã‚»ã‚¹ã—ã¾ã™ã€‚

3. **ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£**: `public int Cols => COLS;` ã¯èª­ã¿å–ã‚Šå°‚ç”¨ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã§ã™ã€‚å¤–éƒ¨ã‹ã‚‰ã¯å€¤ã‚’èª­ã‚ã¾ã™ãŒã€å¤‰æ›´ã§ãã¾ã›ã‚“ã€‚

4. **Clear ãƒ¡ã‚½ãƒƒãƒ‰**: ã™ã¹ã¦ã®ä½ç½®ã‚’ `PuyoColor.None` ã§åŸ‹ã‚ã‚‹å‡¦ç†ã§ã™ã€‚ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‹ã‚‰ã‚‚å‘¼ã³å‡ºã—ã¦ã„ã¾ã™ã€‚

### ãƒ†ã‚¹ãƒˆ: ã·ã‚ˆã®é…ç½®ã¨å–å¾—

æ¬¡ã«ã€ãƒœãƒ¼ãƒ‰ã«ã·ã‚ˆã‚’é…ç½®ã—ã€å–å¾—ã§ãã‚‹ã“ã¨ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã—ã‚‡ã†ã€‚

```csharp
// BoardTest.cs ã«è¿½åŠ 
[Test]
public void ã·ã‚ˆã‚’é…ç½®ã—ã¦å–å¾—ã§ãã‚‹()
{
    // Arrange
    Board board = new Board();

    // Act
    board.Set(0, 2, PuyoColor.Red);

    // Assert
    Assert.AreEqual(PuyoColor.Red, board.Get(0, 2));
}

[Test]
public void ç•°ãªã‚‹ä½ç½®ã«ç•°ãªã‚‹è‰²ã®ã·ã‚ˆã‚’é…ç½®ã§ãã‚‹()
{
    // Arrange
    Board board = new Board();

    // Act
    board.Set(0, 1, PuyoColor.Blue);
    board.Set(1, 2, PuyoColor.Green);
    board.Set(2, 3, PuyoColor.Yellow);

    // Assert
    Assert.AreEqual(PuyoColor.Blue, board.Get(0, 1));
    Assert.AreEqual(PuyoColor.Green, board.Get(1, 2));
    Assert.AreEqual(PuyoColor.Yellow, board.Get(2, 3));
}
```

ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€`Set` ãƒ¡ã‚½ãƒƒãƒ‰ãŒæœªå®šç¾©ãªã®ã§ã‚¨ãƒ©ãƒ¼ã«ãªã‚Šã¾ã™ã€‚ã“ã‚ŒãŒã€ŒRedã€ã®çŠ¶æ…‹ã§ã™ã­ã€‚

### å®Ÿè£…: ã·ã‚ˆã®é…ç½®

`Board.cs` ã« `Set` ãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¿½åŠ ã—ã¾ã™ï¼š

```csharp
public void Set(int row, int col, PuyoColor color)
{
    cells[row, col] = color;
}
```

ã€Œã‚·ãƒ³ãƒ—ãƒ«ï¼ã€ãã†ã§ã™ã€æœ€å°é™ã®å®Ÿè£…ã‚’å¿ƒãŒã‘ã¾ã™ã€‚ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼š

```
âœ… ã·ã‚ˆã‚’é…ç½®ã—ã¦å–å¾—ã§ãã‚‹
âœ… ç•°ãªã‚‹ä½ç½®ã«ç•°ãªã‚‹è‰²ã®ã·ã‚ˆã‚’é…ç½®ã§ãã‚‹
```

ç´ æ™´ã‚‰ã—ã„ï¼Green ã«ãªã‚Šã¾ã—ãŸã€‚

### ãƒ†ã‚¹ãƒˆ: ç¯„å›²å¤–ãƒã‚§ãƒƒã‚¯

ãƒœãƒ¼ãƒ‰ã®å¤–ã«ã·ã‚ˆã‚’é…ç½®ã—ã‚ˆã†ã¨ã—ãŸã‚‰ã©ã†ãªã‚‹ã§ã—ã‚‡ã†ã‹ï¼Ÿå£ã‚„å¤©äº•ã«ã¶ã¤ã‹ã‚‹åˆ¤å®šãŒå¿…è¦ã§ã™ã­ã€‚

```csharp
// BoardTest.cs ã«è¿½åŠ 
[Test]
public void ç¯„å›²å†…ã®åº§æ¨™ã¯IsInBoundsãŒtrueã‚’è¿”ã™()
{
    // Arrange
    Board board = new Board();

    // Act & Assert
    Assert.IsTrue(board.IsInBounds(0, 0));
    Assert.IsTrue(board.IsInBounds(11, 5));
    Assert.IsTrue(board.IsInBounds(5, 3));
}

[Test]
public void ç¯„å›²å¤–ã®åº§æ¨™ã¯IsInBoundsãŒfalseã‚’è¿”ã™()
{
    // Arrange
    Board board = new Board();

    // Act & Assert
    Assert.IsFalse(board.IsInBounds(-1, 2)); // ä¸Šã«å‡ºã‚‹
    Assert.IsFalse(board.IsInBounds(12, 2)); // ä¸‹ã«å‡ºã‚‹
    Assert.IsFalse(board.IsInBounds(5, -1)); // å·¦ã«å‡ºã‚‹
    Assert.IsFalse(board.IsInBounds(5, 6));  // å³ã«å‡ºã‚‹
}
```

### å®Ÿè£…: ç¯„å›²å¤–ãƒã‚§ãƒƒã‚¯

`Board.cs` ã« `IsInBounds` ãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¿½åŠ ã—ã¾ã™ï¼š

```csharp
public bool IsInBounds(int row, int col)
{
    return row >= 0 && row < ROWS && col >= 0 && col < COLS;
}
```

ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œï¼š

```
âœ… ç¯„å›²å†…ã®åº§æ¨™ã¯IsInBoundsãŒtrueã‚’è¿”ã™
âœ… ç¯„å›²å¤–ã®åº§æ¨™ã¯IsInBoundsãŒfalseã‚’è¿”ã™
```

å®Œç’§ã§ã™ï¼

### ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°: ãƒœãƒ¼ãƒ‰ã®ã‚¯ãƒªã‚¢

ç¾åœ¨ã®ã‚³ãƒ¼ãƒ‰ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚`Clear` ãƒ¡ã‚½ãƒƒãƒ‰ã¯æ­£ã—ãå‹•ä½œã—ã¦ã„ã¾ã™ãŒã€ãƒ†ã‚¹ãƒˆãŒã¾ã ã‚ã‚Šã¾ã›ã‚“ã­ã€‚ã€Œãƒ†ã‚¹ãƒˆã®ãªã„ã‚³ãƒ¼ãƒ‰ã¯å‹•ã„ã¦ã„ãªã„ã‚³ãƒ¼ãƒ‰ã¨åŒã˜ã€ã¨ã„ã†è€ƒãˆæ–¹ã‚‚ã‚ã‚Šã¾ã™ã€‚

ãƒ†ã‚¹ãƒˆã‚’è¿½åŠ ã—ã¾ã—ã‚‡ã†ï¼š

```csharp
// BoardTest.cs ã«è¿½åŠ 
[Test]
public void Clearã‚’å‘¼ã¶ã¨ã™ã¹ã¦ã®ä½ç½®ãŒç©ºã«ãªã‚‹()
{
    // Arrange
    Board board = new Board();
    board.Set(0, 2, PuyoColor.Red);
    board.Set(1, 3, PuyoColor.Blue);
    board.Set(2, 4, PuyoColor.Green);

    // Act
    board.Clear();

    // Assert
    for (int row = 0; row < board.Rows; row++)
    {
        for (int col = 0; col < board.Cols; col++)
        {
            Assert.AreEqual(PuyoColor.None, board.Get(row, col));
        }
    }
}
```

ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€æ—¢å­˜ã®å®Ÿè£…ã§é€šã‚Šã¾ã™ã€‚ã“ã‚Œã§å®‰å¿ƒã—ã¦ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã§ãã¾ã™ã­ã€‚

### ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ 1 ã®ã¾ã¨ã‚

ãŠç–²ã‚Œæ§˜ã§ã—ãŸï¼ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ 1 ã§å®Ÿè£…ã—ãŸå†…å®¹ã‚’æŒ¯ã‚Šè¿”ã£ã¦ã¿ã¾ã—ã‚‡ã†ï¼š

1. **PuyoColor åˆ—æŒ™å‹**: ã·ã‚ˆã®è‰²ã‚’å‹å®‰å…¨ã«ç®¡ç†
2. **Board ã‚¯ãƒ©ã‚¹**: 6 åˆ—Ã—12 è¡Œã®ãƒœãƒ¼ãƒ‰ã‚’å®Ÿè£…
   - `Get(row, col)`: ã·ã‚ˆã®å–å¾—
   - `Set(row, col, color)`: ã·ã‚ˆã®é…ç½®
   - `IsInBounds(row, col)`: ç¯„å›²ãƒã‚§ãƒƒã‚¯
   - `Clear()`: ãƒœãƒ¼ãƒ‰ã®ã‚¯ãƒªã‚¢

ã™ã¹ã¦ã®æ©Ÿèƒ½ã«ãƒ†ã‚¹ãƒˆãŒã‚ã‚Šã€å®‰å¿ƒã—ã¦ã‚³ãƒ¼ãƒ‰ã‚’å¤‰æ›´ã§ãã‚‹çŠ¶æ…‹ã«ãªã‚Šã¾ã—ãŸã€‚ã“ã‚ŒãŒãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã®å¤§ããªãƒ¡ãƒªãƒƒãƒˆã§ã™ï¼

> ãƒ†ã‚¹ãƒˆã¯é–‹ç™ºè€…ã‚’è§£æ”¾ã™ã‚‹ã€‚ãƒ†ã‚¹ãƒˆã®ãŠã‹ã’ã§ã€æã‚Œã‚‹ã“ã¨ãªãã‚³ãƒ¼ãƒ‰ã‚’ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã§ãã‚‹ã€‚
>
> â€” Robert C. Martin ã€Clean Codeã€

æ¬¡ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ã€ã·ã‚ˆãƒšã‚¢ã‚’å®Ÿè£…ã—ã¦ã„ãã¾ã™ã€‚æ¥½ã—ã¿ã§ã™ã­ï¼

```bash
git add .
git commit -m 'feat: ãƒœãƒ¼ãƒ‰ã®åŸºæœ¬æ©Ÿèƒ½ã‚’å®Ÿè£…'
```

---

## ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ 2: ã·ã‚ˆãƒšã‚¢ã®å®Ÿè£…

å‰å›ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§ãƒœãƒ¼ãƒ‰ãŒã§ãã¾ã—ãŸã­ã€‚ã€Œã§ã‚‚ã€ã·ã‚ˆã·ã‚ˆã£ã¦ 2 ã¤ã®ã·ã‚ˆãŒãƒšã‚¢ã§è½ã¡ã¦ãã‚‹ã‚²ãƒ¼ãƒ ã˜ã‚ƒãªã„ã®ï¼Ÿã€ãã†ã§ã™ï¼ä»Šå›ã¯ã€è»¸ã·ã‚ˆã¨å­ã·ã‚ˆã‹ã‚‰ãªã‚‹ã€Œã·ã‚ˆãƒšã‚¢ã€ã‚’å®Ÿè£…ã—ã¦ã„ãã¾ã—ã‚‡ã†ã€‚

> ã‚·ã‚¹ãƒ†ãƒ æ§‹ç¯‰ã¯ã©ã“ã‹ã‚‰å§‹ã‚ã‚‹ã¹ãã ã‚ã†ã‹ã€‚ã‚·ã‚¹ãƒ†ãƒ æ§‹ç¯‰ãŒçµ‚ã‚ã£ãŸã‚‰ã“ã†ãªã‚‹ã€ã¨ã„ã†ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚’èªã‚‹ã¨ã“ã‚ã‹ã‚‰ã ã€‚
>
> â€” Kent Beck ã€ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã€

### ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼

ã¾ãšã¯ã€ã“ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§å®Ÿè£…ã™ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚’ç¢ºèªã—ã¾ã—ã‚‡ã†ï¼š

> ã‚·ã‚¹ãƒ†ãƒ ã¨ã—ã¦ã€è»¸ã·ã‚ˆã¨å­ã·ã‚ˆã‹ã‚‰ãªã‚‹ãƒšã‚¢ã‚’æŒã¤

ã€Œè»¸ã·ã‚ˆã¨å­ã·ã‚ˆï¼Ÿã€è‰¯ã„è³ªå•ã§ã™ã­ï¼ã·ã‚ˆã·ã‚ˆã§ã¯ã€2 ã¤ã®ã·ã‚ˆãŒãƒšã‚¢ã§è½ã¡ã¦ãã¾ã™ã€‚ä¸­å¿ƒã¨ãªã‚‹ã€Œè»¸ã·ã‚ˆã€ã¨ã€ãã®å‘¨ã‚Šã‚’å›è»¢ã™ã‚‹ã€Œå­ã·ã‚ˆã€ã§ã™ã€‚ã“ã®ãƒšã‚¢ã‚’å›è»¢ã•ã›ã‚‹ã“ã¨ã§ã€æˆ¦ç•¥çš„ã«ã·ã‚ˆã‚’é…ç½®ã§ãã‚‹ã‚“ã§ã™ã€‚

### TODOãƒªã‚¹ãƒˆ

ã·ã‚ˆãƒšã‚¢ã‚’å®Ÿè£…ã™ã‚‹ãŸã‚ã«å¿…è¦ãªã‚¿ã‚¹ã‚¯ã‚’è€ƒãˆã¦ã¿ã¾ã—ã‚‡ã†ï¼š

- ã·ã‚ˆãƒšã‚¢ã‚’ä½œæˆã§ãã‚‹ï¼ˆè»¸ã·ã‚ˆã¨å­ã·ã‚ˆã®ä½ç½®ã¨è‰²ã‚’æŒã¤ï¼‰
- ã·ã‚ˆãƒšã‚¢ã‚’å›è»¢ã§ãã‚‹ï¼ˆå³å›è»¢ãƒ»å·¦å›è»¢ï¼‰
- ã·ã‚ˆãƒšã‚¢ã®è¡çªåˆ¤å®šãŒã§ãã‚‹ï¼ˆãƒœãƒ¼ãƒ‰ã‚„ä»–ã®ã·ã‚ˆã¨ã®é‡ãªã‚Šã‚’ãƒã‚§ãƒƒã‚¯ï¼‰
- ã·ã‚ˆãƒšã‚¢ã‚’ãƒœãƒ¼ãƒ‰ã«é…ç½®ã§ãã‚‹ï¼ˆç€åœ°æ™‚ã«ãƒœãƒ¼ãƒ‰ã«å›ºå®šã™ã‚‹ï¼‰

ã“ã‚Œã‚‰ã®ã‚¿ã‚¹ã‚¯ã‚’ä¸€ã¤ãšã¤ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã§å®Ÿè£…ã—ã¦ã„ãã¾ã—ã‚‡ã†ï¼

### ãƒ†ã‚¹ãƒˆ: ã·ã‚ˆãƒšã‚¢ã®ä½œæˆ

ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã§ã¯ã€ã¾ãšãƒ†ã‚¹ãƒˆã‚’æ›¸ãã“ã¨ã‹ã‚‰å§‹ã‚ã¾ã™ã€‚

> ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆ
>
> ã„ã¤ãƒ†ã‚¹ãƒˆã‚’æ›¸ãã¹ãã ã‚ã†ã‹â€”â€”ãã‚Œã¯ãƒ†ã‚¹ãƒˆå¯¾è±¡ã®ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãå‰ã ã€‚
>
> â€” Kent Beck ã€ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã€

`Assets/Tests/EditMode` ãƒ•ã‚©ãƒ«ãƒ€ã« `PairTest.cs` ã‚’ä½œæˆã—ã¾ã™ï¼š

```csharp
using NUnit.Framework;
using PuyoPuyo.Core;

namespace PuyoPuyo.Tests
{
    public class PairTest
    {
        [Test]
        public void ã·ã‚ˆãƒšã‚¢ã‚’ä½œæˆã™ã‚‹ã¨è»¸ã·ã‚ˆã¨å­ã·ã‚ˆãŒè¨­å®šã•ã‚Œã‚‹()
        {
            // Arrange & Act
            Pair pair = new Pair(2, 0, PuyoColor.Red, PuyoColor.Blue);

            // Assert
            Assert.AreEqual(2, pair.AxisX);
            Assert.AreEqual(0, pair.AxisY);
            Assert.AreEqual(PuyoColor.Red, pair.AxisColor);
            Assert.AreEqual(PuyoColor.Blue, pair.ChildColor);
        }

        [Test]
        public void åˆæœŸçŠ¶æ…‹ã§ã¯å­ã·ã‚ˆã¯è»¸ã·ã‚ˆã®ä¸Šã«ã‚ã‚‹()
        {
            // Arrange & Act
            Pair pair = new Pair(2, 1, PuyoColor.Red, PuyoColor.Blue);

            // Assert
            Assert.AreEqual(2, pair.ChildX);
            Assert.AreEqual(0, pair.ChildY); // è»¸ã·ã‚ˆã®ä¸Šï¼ˆYåº§æ¨™ãŒ1å°ã•ã„ï¼‰
        }
    }
}
```

ã€Œãªãœå­ã·ã‚ˆãŒä¸Šã«ã‚ã‚‹ã®ï¼Ÿã€è‰¯ã„è³ªå•ã§ã™ã­ï¼ã·ã‚ˆã·ã‚ˆã§ã¯ã€ç”»é¢ã®ä¸Šã‹ã‚‰è½ã¡ã¦ãã‚‹ã®ã§ã€æœ€åˆã¯å­ã·ã‚ˆãŒè»¸ã·ã‚ˆã®ä¸Šã«ã‚ã‚Šã¾ã™ã€‚Y åº§æ¨™ã¯ä¸ŠãŒå°ã•ãã€ä¸‹ãŒå¤§ãã„ã®ã§ã€å­ã·ã‚ˆã® Y åº§æ¨™ã¯è»¸ã·ã‚ˆã‚ˆã‚Š 1 å°ã•ããªã‚Šã¾ã™ã€‚

### å®Ÿè£…: ã·ã‚ˆãƒšã‚¢ã®ä½œæˆ

ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€`Pair` ã‚¯ãƒ©ã‚¹ãŒæœªå®šç¾©ãªã®ã§ã‚¨ãƒ©ãƒ¼ã«ãªã‚Šã¾ã™ã€‚ã“ã‚ŒãŒã€ŒRedã€ã®çŠ¶æ…‹ã§ã™ã­ã€‚

> æ˜ç™½ãªå®Ÿè£…
>
> ã‚·ãƒ³ãƒ—ãƒ«ãªæ“ä½œã‚’ã©ã†å®Ÿè£…ã™ã‚Œã°ã„ã„ã ã‚ã†ã‹ã€‚ãŸã å®Ÿè£…ã™ã‚Œã°ã„ã„ã®ã ã€‚
>
> â€” Kent Beck ã€ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã€

`Assets/Scripts/Core` ãƒ•ã‚©ãƒ«ãƒ€ã« `Pair.cs` ã‚’ä½œæˆã—ã¾ã™ï¼š

```csharp
namespace PuyoPuyo.Core
{
    public class Pair
    {
        // è»¸ã·ã‚ˆã®ä½ç½®ã¨è‰²
        public int AxisX { get; private set; }
        public int AxisY { get; private set; }
        public PuyoColor AxisColor { get; private set; }

        // å­ã·ã‚ˆã®ä½ç½®ã¨è‰²
        public int ChildX { get; private set; }
        public int ChildY { get; private set; }
        public PuyoColor ChildColor { get; private set; }

        // å›è»¢çŠ¶æ…‹ï¼ˆ0: ä¸Š, 1: å³, 2: ä¸‹, 3: å·¦ï¼‰
        private int rotation;

        public Pair(int axisX, int axisY, PuyoColor axisColor, PuyoColor childColor)
        {
            AxisX = axisX;
            AxisY = axisY;
            AxisColor = axisColor;
            ChildColor = childColor;
            rotation = 0; // åˆæœŸçŠ¶æ…‹ã¯å­ã·ã‚ˆãŒä¸Š

            // åˆæœŸä½ç½®ã‚’è¨ˆç®—
            UpdateChildPosition();
        }

        private void UpdateChildPosition()
        {
            // å›è»¢çŠ¶æ…‹ã«å¿œã˜ã¦å­ã·ã‚ˆã®ä½ç½®ã‚’è¨ˆç®—
            switch (rotation)
            {
                case 0: // ä¸Š
                    ChildX = AxisX;
                    ChildY = AxisY - 1;
                    break;
                case 1: // å³
                    ChildX = AxisX + 1;
                    ChildY = AxisY;
                    break;
                case 2: // ä¸‹
                    ChildX = AxisX;
                    ChildY = AxisY + 1;
                    break;
                case 3: // å·¦
                    ChildX = AxisX - 1;
                    ChildY = AxisY;
                    break;
            }
        }
    }
}
```

ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼š

```bash
dotnet cake --target=Test
```

```
âœ… ã·ã‚ˆãƒšã‚¢ã‚’ä½œæˆã™ã‚‹ã¨è»¸ã·ã‚ˆã¨å­ã·ã‚ˆãŒè¨­å®šã•ã‚Œã‚‹
âœ… åˆæœŸçŠ¶æ…‹ã§ã¯å­ã·ã‚ˆã¯è»¸ã·ã‚ˆã®ä¸Šã«ã‚ã‚‹
```

ã‚„ã£ãŸï¼Green ã«ãªã‚Šã¾ã—ãŸã€‚

### è§£èª¬: ã·ã‚ˆãƒšã‚¢ã®å®Ÿè£…

å®Ÿè£…ã—ãŸã·ã‚ˆãƒšã‚¢ã«ã¤ã„ã¦è§£èª¬ã—ã¦ãŠãã¾ã—ã‚‡ã†ï¼š

1. **ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£**: è»¸ã·ã‚ˆã¨å­ã·ã‚ˆã®ä½ç½®ï¼ˆX, Yï¼‰ã¨è‰²ã‚’æŒã¡ã¾ã™ã€‚`private set` ã§å¤–éƒ¨ã‹ã‚‰å¤‰æ›´ã§ããªã„ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚

2. **å›è»¢çŠ¶æ…‹**: `rotation` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã§å›è»¢çŠ¶æ…‹ã‚’ç®¡ç†ã—ã¾ã™ã€‚0ã€œ3 ã®å€¤ã§ã€ä¸Šâ†’å³â†’ä¸‹â†’å·¦ã®é †ã«å›è»¢ã—ã¾ã™ã€‚

3. **å­ã·ã‚ˆã®ä½ç½®è¨ˆç®—**: `UpdateChildPosition` ãƒ¡ã‚½ãƒƒãƒ‰ã§ã€å›è»¢çŠ¶æ…‹ã«å¿œã˜ã¦å­ã·ã‚ˆã®ä½ç½®ã‚’è¨ˆç®—ã—ã¾ã™ã€‚

### ãƒ†ã‚¹ãƒˆ: ã·ã‚ˆãƒšã‚¢ã®å›è»¢

æ¬¡ã«ã€ã·ã‚ˆãƒšã‚¢ã‚’å›è»¢ã•ã›ã‚‹æ©Ÿèƒ½ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã™ã€‚

```csharp
// PairTest.cs ã«è¿½åŠ 
[Test]
public void å³å›è»¢ã™ã‚‹ã¨å­ã·ã‚ˆãŒæ™‚è¨ˆå›ã‚Šã«90åº¦å›è»¢ã™ã‚‹()
{
    // Arrange
    Pair pair = new Pair(2, 1, PuyoColor.Red, PuyoColor.Blue);
    // åˆæœŸçŠ¶æ…‹: å­ã·ã‚ˆã¯ä¸Š (2, 0)

    // Act
    pair.RotateRight();

    // Assert
    Assert.AreEqual(3, pair.ChildX); // å³ã«ç§»å‹•
    Assert.AreEqual(1, pair.ChildY); // åŒã˜é«˜ã•
}

[Test]
public void å³å›è»¢ã‚’4å›ã™ã‚‹ã¨å…ƒã®ä½ç½®ã«æˆ»ã‚‹()
{
    // Arrange
    Pair pair = new Pair(2, 1, PuyoColor.Red, PuyoColor.Blue);

    // Act
    pair.RotateRight();
    pair.RotateRight();
    pair.RotateRight();
    pair.RotateRight();

    // Assert
    Assert.AreEqual(2, pair.ChildX);
    Assert.AreEqual(0, pair.ChildY); // å…ƒã®ä½ç½®
}

[Test]
public void å·¦å›è»¢ã™ã‚‹ã¨å­ã·ã‚ˆãŒåæ™‚è¨ˆå›ã‚Šã«90åº¦å›è»¢ã™ã‚‹()
{
    // Arrange
    Pair pair = new Pair(2, 1, PuyoColor.Red, PuyoColor.Blue);
    // åˆæœŸçŠ¶æ…‹: å­ã·ã‚ˆã¯ä¸Š (2, 0)

    // Act
    pair.RotateLeft();

    // Assert
    Assert.AreEqual(1, pair.ChildX); // å·¦ã«ç§»å‹•
    Assert.AreEqual(1, pair.ChildY); // åŒã˜é«˜ã•
}
```

ã€Œå›è»¢ã‚’ 4 å›ã™ã‚‹ã¨å…ƒã«æˆ»ã‚‹ï¼Ÿã€ãã†ã§ã™ï¼360 åº¦å›è»¢ã™ã‚‹ã¨å…ƒã®ä½ç½®ã«æˆ»ã‚Šã¾ã™ã‹ã‚‰ã­ã€‚ã“ã®ãƒ†ã‚¹ãƒˆã§ã€å›è»¢ã®è¨ˆç®—ãŒæ­£ã—ã„ã“ã¨ã‚’ç¢ºèªã§ãã¾ã™ã€‚

### å®Ÿè£…: ã·ã‚ˆãƒšã‚¢ã®å›è»¢

`Pair.cs` ã«å›è»¢ãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¿½åŠ ã—ã¾ã™ï¼š

```csharp
public void RotateRight()
{
    rotation = (rotation + 1) % 4;
    UpdateChildPosition();
}

public void RotateLeft()
{
    rotation = (rotation + 3) % 4; // -1 ã¨åŒã˜ï¼ˆãƒ¢ã‚¸ãƒ¥ãƒ­æ¼”ç®—ï¼‰
    UpdateChildPosition();
}
```

ã€Œ`rotation + 3` ã§å·¦å›è»¢ï¼Ÿã€è‰¯ã„è³ªå•ã§ã™ã­ï¼`-1 % 4` ã¯ C# ã§ã¯è² ã®å€¤ã«ãªã‚‹ã“ã¨ãŒã‚ã‚‹ã®ã§ã€`+3` ã‚’ä½¿ã„ã¾ã™ã€‚ã“ã‚Œã¯ `-1` ã¨åŒã˜åŠ¹æœãŒã‚ã‚Šã¾ã™ï¼ˆ0â†’3ã€1â†’0ã€2â†’1ã€3â†’2ï¼‰ã€‚

ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œï¼š

```
âœ… å³å›è»¢ã™ã‚‹ã¨å­ã·ã‚ˆãŒæ™‚è¨ˆå›ã‚Šã«90åº¦å›è»¢ã™ã‚‹
âœ… å³å›è»¢ã‚’4å›ã™ã‚‹ã¨å…ƒã®ä½ç½®ã«æˆ»ã‚‹
âœ… å·¦å›è»¢ã™ã‚‹ã¨å­ã·ã‚ˆãŒåæ™‚è¨ˆå›ã‚Šã«90åº¦å›è»¢ã™ã‚‹
```

å®Œç’§ã§ã™ï¼

### ãƒ†ã‚¹ãƒˆ: è¡çªåˆ¤å®š

ã·ã‚ˆãƒšã‚¢ãŒãƒœãƒ¼ãƒ‰ã‚„ä»–ã®ã·ã‚ˆã¨é‡ãªã‚‰ãªã„ã‚ˆã†ã«ãƒã‚§ãƒƒã‚¯ã™ã‚‹æ©Ÿèƒ½ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã™ã€‚

```csharp
// PairTest.cs ã«è¿½åŠ 
[Test]
public void ãƒœãƒ¼ãƒ‰ç¯„å›²å†…ã«ã‚ã‚‹å ´åˆã¯è¡çªã—ãªã„()
{
    // Arrange
    Board board = new Board();
    Pair pair = new Pair(2, 1, PuyoColor.Red, PuyoColor.Blue);

    // Act
    bool collision = pair.IsCollision(board, 2, 1, 2, 0);

    // Assert
    Assert.IsFalse(collision);
}

[Test]
public void è»¸ã·ã‚ˆãŒãƒœãƒ¼ãƒ‰ç¯„å›²å¤–ã®å ´åˆã¯è¡çªã™ã‚‹()
{
    // Arrange
    Board board = new Board();
    Pair pair = new Pair(2, 1, PuyoColor.Red, PuyoColor.Blue);

    // Act
    bool collision = pair.IsCollision(board, -1, 1, 2, 0); // è»¸ã·ã‚ˆãŒå·¦ç«¯å¤–

    // Assert
    Assert.IsTrue(collision);
}

[Test]
public void å­ã·ã‚ˆãŒãƒœãƒ¼ãƒ‰ç¯„å›²å¤–ã®å ´åˆã¯è¡çªã™ã‚‹()
{
    // Arrange
    Board board = new Board();
    Pair pair = new Pair(0, 1, PuyoColor.Red, PuyoColor.Blue);

    // Act
    bool collision = pair.IsCollision(board, 0, 1, -1, 1); // å­ã·ã‚ˆãŒå·¦ç«¯å¤–

    // Assert
    Assert.IsTrue(collision);
}

[Test]
public void è»¸ã·ã‚ˆã®ä½ç½®ã«ã·ã‚ˆãŒã‚ã‚‹å ´åˆã¯è¡çªã™ã‚‹()
{
    // Arrange
    Board board = new Board();
    board.Set(1, 2, PuyoColor.Red); // (1, 2) ã«é…ç½®
    Pair pair = new Pair(2, 1, PuyoColor.Red, PuyoColor.Blue);

    // Act
    bool collision = pair.IsCollision(board, 2, 1, 2, 0); // è»¸ã·ã‚ˆãŒ (2, 1) ã«é…ç½®ã•ã‚Œã‚ˆã†ã¨ã™ã‚‹

    // Assert
    Assert.IsFalse(collision); // (2, 1) ã¯ç©ºãªã®ã§è¡çªã—ãªã„
    
    // è»¸ã·ã‚ˆã‚’æ—¢å­˜ã®ã·ã‚ˆã¨åŒã˜ä½ç½®ã«
    collision = pair.IsCollision(board, 2, 1, 2, 0);
    Assert.IsFalse(collision);

    // è»¸ã·ã‚ˆã‚’ (1, 2) ã«é…ç½®ã—ã‚ˆã†ã¨ã™ã‚‹
    collision = pair.IsCollision(board, 1, 2, 2, 0);
    Assert.IsTrue(collision); // è¡çªã™ã‚‹
}

[Test]
public void å­ã·ã‚ˆã®ä½ç½®ã«ã·ã‚ˆãŒã‚ã‚‹å ´åˆã¯è¡çªã™ã‚‹()
{
    // Arrange
    Board board = new Board();
    board.Set(0, 2, PuyoColor.Red); // (0, 2) ã«é…ç½®
    Pair pair = new Pair(2, 1, PuyoColor.Red, PuyoColor.Blue);

    // Act
    bool collision = pair.IsCollision(board, 2, 1, 0, 2); // å­ã·ã‚ˆãŒ (0, 2)

    // Assert
    Assert.IsTrue(collision); // è¡çªã™ã‚‹
}
```

### å®Ÿè£…: è¡çªåˆ¤å®š

`Pair.cs` ã«è¡çªåˆ¤å®šãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¿½åŠ ã—ã¾ã™ï¼š

```csharp
public bool IsCollision(Board board, int axisX, int axisY, int childX, int childY)
{
    // è»¸ã·ã‚ˆã®ç¯„å›²ãƒã‚§ãƒƒã‚¯
    if (!board.IsInBounds(axisY, axisX))
    {
        return true;
    }

    // å­ã·ã‚ˆã®ç¯„å›²ãƒã‚§ãƒƒã‚¯
    if (!board.IsInBounds(childY, childX))
    {
        return true;
    }

    // è»¸ã·ã‚ˆã®ä½ç½®ã«ã·ã‚ˆãŒã‚ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
    if (board.Get(axisY, axisX) != PuyoColor.None)
    {
        return true;
    }

    // å­ã·ã‚ˆã®ä½ç½®ã«ã·ã‚ˆãŒã‚ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
    if (board.Get(childY, childX) != PuyoColor.None)
    {
        return true;
    }

    return false; // è¡çªãªã—
}
```

ã€Œå¼•æ•°ã§ä½ç½®ã‚’æ¸¡ã™ã‚“ã§ã™ã­ï¼Ÿã€ãã†ã§ã™ï¼å›è»¢å¾Œã®ä½ç½®ã§ãƒã‚§ãƒƒã‚¯ã—ãŸã„å ´åˆã‚‚ã‚ã‚‹ã®ã§ã€å¼•æ•°ã§ä½ç½®ã‚’æŒ‡å®šã§ãã‚‹ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚

ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œï¼š

```
âœ… ãƒœãƒ¼ãƒ‰ç¯„å›²å†…ã«ã‚ã‚‹å ´åˆã¯è¡çªã—ãªã„
âœ… è»¸ã·ã‚ˆãŒãƒœãƒ¼ãƒ‰ç¯„å›²å¤–ã®å ´åˆã¯è¡çªã™ã‚‹
âœ… å­ã·ã‚ˆãŒãƒœãƒ¼ãƒ‰ç¯„å›²å¤–ã®å ´åˆã¯è¡çªã™ã‚‹
âœ… è»¸ã·ã‚ˆã®ä½ç½®ã«ã·ã‚ˆãŒã‚ã‚‹å ´åˆã¯è¡çªã™ã‚‹
âœ… å­ã·ã‚ˆã®ä½ç½®ã«ã·ã‚ˆãŒã‚ã‚‹å ´åˆã¯è¡çªã™ã‚‹
```

ç´ æ™´ã‚‰ã—ã„ï¼ã™ã¹ã¦ Green ã§ã™ã€‚

### ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°

ç¾åœ¨ã®ã‚³ãƒ¼ãƒ‰ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚è¡çªåˆ¤å®šã§å°‘ã—é‡è¤‡ãŒã‚ã‚Šã¾ã™ã­ã€‚ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

> ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°
>
> ã„ã¤ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã™ã¹ãã ã‚ã†ã‹ã€‚ãƒ†ã‚¹ãƒˆãŒã‚°ãƒªãƒ¼ãƒ³ã«ãªã£ãŸã¨ãã ã€‚
>
> â€” Kent Beck ã€ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã€

å®Ÿã¯ã€ç¾åœ¨ã®ã‚³ãƒ¼ãƒ‰ã¯æ—¢ã«ååˆ†ã‚·ãƒ³ãƒ—ãƒ«ã§ã€å¤§ããªæ”¹å–„ã®ä½™åœ°ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚å¼·ã„ã¦è¨€ãˆã°ã€è¡çªãƒã‚§ãƒƒã‚¯ã‚’å°ã•ãªãƒ¡ã‚½ãƒƒãƒ‰ã«åˆ†ã‘ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ãŒã€ç¾æ™‚ç‚¹ã§ã¯å¯èª­æ€§ãŒååˆ†ãªã®ã§ãã®ã¾ã¾ã«ã—ã¦ãŠãã¾ã—ã‚‡ã†ã€‚

### ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ 2 ã®ã¾ã¨ã‚

ãŠç–²ã‚Œæ§˜ã§ã—ãŸï¼ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ 2 ã§å®Ÿè£…ã—ãŸå†…å®¹ã‚’æŒ¯ã‚Šè¿”ã£ã¦ã¿ã¾ã—ã‚‡ã†ï¼š

1. **Pair ã‚¯ãƒ©ã‚¹**: ã·ã‚ˆãƒšã‚¢ã®å®Ÿè£…
   - è»¸ã·ã‚ˆã¨å­ã·ã‚ˆã®ä½ç½®ã¨è‰²
   - å›è»¢çŠ¶æ…‹ã®ç®¡ç†
   - `RotateRight()`, `RotateLeft()`: å›è»¢æ©Ÿèƒ½
   - `IsCollision()`: è¡çªåˆ¤å®š
   - `UpdateChildPosition()`: å­ã·ã‚ˆã®ä½ç½®è¨ˆç®—

2. **ãƒ†ã‚¹ãƒˆ**: ã™ã¹ã¦ã®æ©Ÿèƒ½ã«ãƒ†ã‚¹ãƒˆãŒã‚ã‚Šã€å®‰å¿ƒã—ã¦ã‚³ãƒ¼ãƒ‰ã‚’å¤‰æ›´ã§ãã‚‹çŠ¶æ…‹

ã·ã‚ˆãƒšã‚¢ãŒã§ããŸã®ã§ã€æ¬¡ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ã€ã“ã®ãƒšã‚¢ã‚’å®Ÿéš›ã«å‹•ã‹ã™æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¦ã„ãã¾ã™ï¼

```bash
git add .
git commit -m 'feat: ã·ã‚ˆãƒšã‚¢ã®å®Ÿè£…'
```

---

## ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ 3: ç§»å‹•ã¨å›è»¢

ã€Œã·ã‚ˆãƒšã‚¢ãŒã§ããŸã®ã§ã€æ¬¡ã¯ã“ã‚Œã‚’å®Ÿéš›ã«å‹•ã‹ã—ã¦ã„ããŸã„ã§ã™ã­ï¼ã€ãã†ã§ã™ã­ï¼ã“ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ã€ã·ã‚ˆãƒšã‚¢ã‚’å·¦å³ã«ç§»å‹•ã•ã›ãŸã‚Šã€ä¸‹ã«è½ã¨ã—ãŸã‚Šã€å›è»¢ã•ã›ãŸã‚Šã™ã‚‹æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¦ã„ãã¾ã™ã€‚

### ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼

ã¾ãšã¯ã€ã“ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§å®Ÿè£…ã™ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚’ç¢ºèªã—ã¾ã—ã‚‡ã†ï¼š

> ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¨ã—ã¦ã€è½ã¡ã¦ãã‚‹ã·ã‚ˆãƒšã‚¢ã‚’å·¦å³ã«ç§»å‹•ã§ãã‚‹
>
> ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¨ã—ã¦ã€è½ã¡ã¦ãã‚‹ã·ã‚ˆãƒšã‚¢ã‚’ä¸‹ã«ç§»å‹•ã§ãã‚‹
>
> ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¨ã—ã¦ã€è½ã¡ã¦ãã‚‹ã·ã‚ˆãƒšã‚¢ã‚’å›è»¢ã§ãã‚‹

ã€Œç§»å‹•ã¨å›è»¢ã£ã¦ã€ã‚²ãƒ¼ãƒ ã®åŸºæœ¬æ“ä½œã§ã™ã‚ˆã­ï¼ã€ãã†ã§ã™ï¼ã“ã‚Œã‚‰ã®æ“ä½œãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã¨ã€ã·ã‚ˆã·ã‚ˆã‚‰ã—ããªã£ã¦ãã¾ã™ã€‚

### TODO ãƒªã‚¹ãƒˆ

ã•ã¦ã€ã“ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚’å®Ÿç¾ã™ã‚‹ãŸã‚ã«ã€ã©ã‚“ãªã‚¿ã‚¹ã‚¯ãŒå¿…è¦ã§ã—ã‚‡ã†ã‹ï¼Ÿä¸€ç·’ã«è€ƒãˆã¦ã¿ã¾ã—ã‚‡ã†ï¼š

- å·¦ã«ç§»å‹•ã™ã‚‹æ©Ÿèƒ½ã‚’å®Ÿè£…ã™ã‚‹
- å³ã«ç§»å‹•ã™ã‚‹æ©Ÿèƒ½ã‚’å®Ÿè£…ã™ã‚‹
- ä¸‹ã«ç§»å‹•ã™ã‚‹æ©Ÿèƒ½ã‚’å®Ÿè£…ã™ã‚‹
- ç§»å‹•æ™‚ã®è¡çªåˆ¤å®šã‚’å®Ÿè£…ã™ã‚‹
- å›è»¢æ™‚ã®å£ã‚­ãƒƒã‚¯æ©Ÿèƒ½ã‚’å®Ÿè£…ã™ã‚‹

ã€Œãªã‚‹ã»ã©ã€é †ç•ªã«å®Ÿè£…ã—ã¦ã„ã‘ã°ã„ã„ã‚“ã§ã™ã­ï¼ã€ãã†ã§ã™ã€‚ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã®æµã‚Œã«æ²¿ã£ã¦ã€ã¾ãšã¯ãƒ†ã‚¹ãƒˆã‹ã‚‰æ›¸ã„ã¦ã„ãã¾ã—ã‚‡ã†ï¼

### ãƒ†ã‚¹ãƒˆ: å·¦å³ã¸ã®ç§»å‹•

ã€Œæœ€åˆã«ä½•ã‚’ãƒ†ã‚¹ãƒˆã™ã‚Œã°ã„ã„ã‚“ã§ã—ã‚‡ã†ã‹ï¼Ÿã€ã¾ãšã¯ã€ã·ã‚ˆãƒšã‚¢ãŒå·¦å³ã«ç§»å‹•ã§ãã‚‹ã“ã¨ã‚’ãƒ†ã‚¹ãƒˆã—ã¦ã„ãã¾ã—ã‚‡ã†ã€‚

> ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆ
>
> ã„ã¤ãƒ†ã‚¹ãƒˆã‚’æ›¸ãã¹ãã ã‚ã†ã‹â€”â€”ãã‚Œã¯ãƒ†ã‚¹ãƒˆå¯¾è±¡ã®ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãå‰ã ã€‚
>
> â€” Kent Beck ã€ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã€

```csharp
// Assets/Scripts/Tests/EditMode/PairTest.cs ã«è¿½åŠ 
[Test]
public void ã·ã‚ˆãƒšã‚¢ã¯å·¦ã«ç§»å‹•ã§ãã‚‹()
{
    // Arrange
    var board = new Board();
    var pair = new Pair(3, 5, PuyoColor.Red, PuyoColor.Blue);

    // Act
    pair.MoveLeft(board);

    // Assert
    Assert.AreEqual(2, pair.AxisX);
    Assert.AreEqual(5, pair.AxisY);
}

[Test]
public void ã·ã‚ˆãƒšã‚¢ã¯å³ã«ç§»å‹•ã§ãã‚‹()
{
    // Arrange
    var board = new Board();
    var pair = new Pair(3, 5, PuyoColor.Red, PuyoColor.Blue);

    // Act
    pair.MoveRight(board);

    // Assert
    Assert.AreEqual(4, pair.AxisX);
    Assert.AreEqual(5, pair.AxisY);
}

[Test]
public void å·¦ç«¯ã§ã¯å·¦ã«ç§»å‹•ã§ããªã„()
{
    // Arrange
    var board = new Board();
    var pair = new Pair(0, 5, PuyoColor.Red, PuyoColor.Blue);

    // Act
    pair.MoveLeft(board);

    // Assert - ä½ç½®ãŒå¤‰ã‚ã£ã¦ã„ãªã„ã“ã¨ã‚’ç¢ºèª
    Assert.AreEqual(0, pair.AxisX);
}

[Test]
public void å³ç«¯ã§ã¯å³ã«ç§»å‹•ã§ããªã„()
{
    // Arrange
    var board = new Board();
    var pair = new Pair(5, 5, PuyoColor.Red, PuyoColor.Blue);

    // Act
    pair.MoveRight(board);

    // Assert - ä½ç½®ãŒå¤‰ã‚ã£ã¦ã„ãªã„ã“ã¨ã‚’ç¢ºèª
    Assert.AreEqual(5, pair.AxisX);
}
```

ã€Œã“ã®ãƒ†ã‚¹ãƒˆã§ã¯ä½•ã‚’ç¢ºèªã—ã¦ã„ã‚‹ã‚“ã§ã™ã‹ï¼Ÿã€ã“ã®ãƒ†ã‚¹ãƒˆã§ã¯ã€ä»¥ä¸‹ã®4ã¤ã®ã‚±ãƒ¼ã‚¹ã‚’ç¢ºèªã—ã¦ã„ã¾ã™ï¼š

1. ã·ã‚ˆãƒšã‚¢ãŒå·¦ã«ç§»å‹•ã§ãã‚‹ã‹
2. ã·ã‚ˆãƒšã‚¢ãŒå³ã«ç§»å‹•ã§ãã‚‹ã‹
3. å·¦ç«¯ã§ã¯å·¦ã«ç§»å‹•ã§ããªã„ã‹ï¼ˆå¢ƒç•Œãƒã‚§ãƒƒã‚¯ï¼‰
4. å³ç«¯ã§ã¯å³ã«ç§»å‹•ã§ããªã„ã‹ï¼ˆå¢ƒç•Œãƒã‚§ãƒƒã‚¯ï¼‰

ã€Œå¢ƒç•Œãƒã‚§ãƒƒã‚¯ã£ã¦é‡è¦ãªã‚“ã§ã™ã­ï¼ã€ãã†ã§ã™ï¼ã‚²ãƒ¼ãƒ ã§ã¯ã€ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒç”»é¢ã®å¤–ã«è¡Œã‹ãªã„ã‚ˆã†ã«ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã‚’æ€ ã‚‹ã¨ã€ãƒã‚°ã®åŸå› ã«ãªã£ã¦ã—ã¾ã†ã‚“ã§ã™ã‚ˆã€‚

### å®Ÿè£…: å·¦å³ã¸ã®ç§»å‹•

ãƒ†ã‚¹ãƒˆã‚’æ›¸ã„ãŸã‚‰ã€æ¬¡ã«å®Ÿè£…ã—ã¾ã—ã‚‡ã†ã€‚ã©ã†ãªã‚‹ã§ã—ã‚‡ã†ã‹ï¼Ÿ

```bash
dotnet cake --target=Test
```

```
undefined: Pair.MoveLeft
undefined: Pair.MoveRight
```

ãŠã£ã¨ï¼`MoveLeft`ã¨`MoveRight`ãŒã¾ã å®šç¾©ã•ã‚Œã¦ã„ã¾ã›ã‚“ã­ã€‚ã“ã‚ŒãŒãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã®ã€ŒRedï¼ˆèµ¤ï¼‰ã€ã®çŠ¶æ…‹ã§ã™ã€‚

> æ˜ç™½ãªå®Ÿè£…
>
> ã‚·ãƒ³ãƒ—ãƒ«ãªæ“ä½œã‚’ã©ã†å®Ÿè£…ã™ã‚Œã°ã„ã„ã ã‚ã†ã‹ã€‚ãŸã å®Ÿè£…ã™ã‚Œã°ã„ã„ã®ã ã€‚
>
> â€” Kent Beck ã€ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã€

ã§ã¯ã€ãƒ†ã‚¹ãƒˆã‚’é€šã™ãŸã‚ã®å®Ÿè£…ã‚’æ›¸ã„ã¦ã„ãã¾ã—ã‚‡ã†ï¼š

```csharp
// Assets/Scripts/Core/Pair.cs ã«è¿½åŠ 
public void MoveLeft(Board board)
{
    // å·¦ã«ç§»å‹•ã§ãã‚‹ã‹ãƒã‚§ãƒƒã‚¯
    int newAxisX = AxisX - 1;
    int newChildX = ChildX - 1;

    if (!IsCollision(board, newAxisX, AxisY, newChildX, ChildY))
    {
        AxisX = newAxisX;
        UpdateChildPosition();
    }
}

public void MoveRight(Board board)
{
    // å³ã«ç§»å‹•ã§ãã‚‹ã‹ãƒã‚§ãƒƒã‚¯
    int newAxisX = AxisX + 1;
    int newChildX = ChildX + 1;

    if (!IsCollision(board, newAxisX, AxisY, newChildX, ChildY))
    {
        AxisX = newAxisX;
        UpdateChildPosition();
    }
}
```

ã€Œãªã‚‹ã»ã©ã€`IsCollision`ã‚’ä½¿ã£ã¦ç§»å‹•ã§ãã‚‹ã‹ãƒã‚§ãƒƒã‚¯ã™ã‚‹ã‚“ã§ã™ã­ï¼ã€ãã†ã§ã™ã€‚ç§»å‹•å…ˆã®åº§æ¨™ã§è¡çªåˆ¤å®šã‚’è¡Œã„ã€è¡çªã—ãªã„å ´åˆã®ã¿ç§»å‹•ã—ã¾ã™ã€‚

ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼š

```bash
dotnet cake --target=Test
```

```
âœ… ã·ã‚ˆãƒšã‚¢ã¯å·¦ã«ç§»å‹•ã§ãã‚‹
âœ… ã·ã‚ˆãƒšã‚¢ã¯å³ã«ç§»å‹•ã§ãã‚‹
âœ… å·¦ç«¯ã§ã¯å·¦ã«ç§»å‹•ã§ããªã„
âœ… å³ç«¯ã§ã¯å³ã«ç§»å‹•ã§ããªã„
```

ã‚„ã£ãŸï¼ãƒ†ã‚¹ãƒˆãŒé€šã‚Šã¾ã—ãŸã€‚ã“ã‚ŒãŒã€ŒGreenï¼ˆç·‘ï¼‰ã€ã®çŠ¶æ…‹ã§ã™ã€‚

### ãƒ†ã‚¹ãƒˆ: ä¸‹ã¸ã®ç§»å‹•

æ¬¡ã¯ã€ä¸‹ã«ç§»å‹•ã™ã‚‹æ©Ÿèƒ½ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã—ã‚‡ã†ã€‚

```csharp
// Assets/Scripts/Tests/EditMode/PairTest.cs ã«è¿½åŠ 
[Test]
public void ã·ã‚ˆãƒšã‚¢ã¯ä¸‹ã«ç§»å‹•ã§ãã‚‹()
{
    // Arrange
    var board = new Board();
    var pair = new Pair(3, 5, PuyoColor.Red, PuyoColor.Blue);

    // Act
    pair.MoveDown(board);

    // Assert
    Assert.AreEqual(3, pair.AxisX);
    Assert.AreEqual(6, pair.AxisY);
}

[Test]
public void ä¸‹ã«ã·ã‚ˆãŒã‚ã‚‹å ´åˆã¯ä¸‹ã«ç§»å‹•ã§ããªã„()
{
    // Arrange
    var board = new Board();
    board.Set(7, 3, PuyoColor.Green); // ä¸‹ã«ã·ã‚ˆã‚’é…ç½®
    var pair = new Pair(3, 5, PuyoColor.Red, PuyoColor.Blue);

    // Act
    pair.MoveDown(board);

    // Assert - ä½ç½®ãŒå¤‰ã‚ã£ã¦ã„ãªã„ã“ã¨ã‚’ç¢ºèª
    Assert.AreEqual(5, pair.AxisY);
}

[Test]
public void ä¸‹ã«ç§»å‹•ã§ãã‚‹ã‹ãƒã‚§ãƒƒã‚¯ã§ãã‚‹()
{
    // Arrange
    var board = new Board();
    var pair = new Pair(3, 5, PuyoColor.Red, PuyoColor.Blue);

    // Act
    bool canMove = pair.CanMoveDown(board);

    // Assert
    Assert.IsTrue(canMove);
}

[Test]
public void ä¸‹ã«ã·ã‚ˆãŒã‚ã‚‹å ´åˆã¯ç§»å‹•ã§ããªã„ã¨åˆ¤å®šã•ã‚Œã‚‹()
{
    // Arrange
    var board = new Board();
    board.Set(7, 3, PuyoColor.Green);
    var pair = new Pair(3, 5, PuyoColor.Red, PuyoColor.Blue);

    // Act
    bool canMove = pair.CanMoveDown(board);

    // Assert
    Assert.IsFalse(canMove);
}
```

ã€Œ`CanMoveDown`ãƒ¡ã‚½ãƒƒãƒ‰ã‚‚è¿½åŠ ã—ãŸã‚“ã§ã™ã­ï¼ã€ãã†ã§ã™ã€‚å¾Œã§ã‚²ãƒ¼ãƒ ãƒ­ã‚¸ãƒƒã‚¯ã‚’å®Ÿè£…ã™ã‚‹ã¨ãã«ã€ã€Œä¸‹ã«ç§»å‹•ã§ãã‚‹ã‹ã€ã‚’ç¢ºèªã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã®ã§ã€ãã®ãŸã‚ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç”¨æ„ã—ã¦ãŠãã¾ã™ã€‚

### å®Ÿè£…: ä¸‹ã¸ã®ç§»å‹•

ãƒ†ã‚¹ãƒˆã‚’é€šã™ãŸã‚ã®å®Ÿè£…ã‚’æ›¸ãã¾ã—ã‚‡ã†ï¼š

```csharp
// Assets/Scripts/Core/Pair.cs ã«è¿½åŠ 
public void MoveDown(Board board)
{
    // ä¸‹ã«ç§»å‹•ã§ãã‚‹ã‹ãƒã‚§ãƒƒã‚¯
    int newAxisY = AxisY + 1;
    int newChildY = ChildY + 1;

    if (!IsCollision(board, AxisX, newAxisY, ChildX, newChildY))
    {
        AxisY = newAxisY;
        UpdateChildPosition();
    }
}

public bool CanMoveDown(Board board)
{
    // ä¸‹ã«ç§»å‹•ã§ãã‚‹ã‹ãƒã‚§ãƒƒã‚¯
    int newAxisY = AxisY + 1;
    int newChildY = ChildY + 1;

    return !IsCollision(board, AxisX, newAxisY, ChildX, newChildY);
}
```

ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼š

```bash
dotnet cake --target=Test
```

```
âœ… ã·ã‚ˆãƒšã‚¢ã¯ä¸‹ã«ç§»å‹•ã§ãã‚‹
âœ… ä¸‹ã«ã·ã‚ˆãŒã‚ã‚‹å ´åˆã¯ä¸‹ã«ç§»å‹•ã§ããªã„
âœ… ä¸‹ã«ç§»å‹•ã§ãã‚‹ã‹ãƒã‚§ãƒƒã‚¯ã§ãã‚‹
âœ… ä¸‹ã«ã·ã‚ˆãŒã‚ã‚‹å ´åˆã¯ç§»å‹•ã§ããªã„ã¨åˆ¤å®šã•ã‚Œã‚‹
```

ç´ æ™´ã‚‰ã—ã„ï¼ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆãŒé€šã‚Šã¾ã—ãŸã€‚

### ãƒ†ã‚¹ãƒˆ: å£ã‚­ãƒƒã‚¯æ©Ÿèƒ½

ã€Œå£ã‚­ãƒƒã‚¯æ©Ÿèƒ½ã£ã¦ä½•ã§ã™ã‹ï¼Ÿã€è‰¯ã„è³ªå•ã§ã™ã­ï¼å£ã‚­ãƒƒã‚¯ã¨ã¯ã€å£éš›ã§ã·ã‚ˆãƒšã‚¢ã‚’å›è»¢ã•ã›ãŸã¨ãã€å£ã«ã‚ã‚Šè¾¼ã‚“ã§ã—ã¾ã†å ´åˆã«ã€è‡ªå‹•çš„ã«å°‘ã—ä½ç½®ã‚’ãšã‚‰ã—ã¦å›è»¢ã‚’å¯èƒ½ã«ã™ã‚‹æ©Ÿèƒ½ã§ã™ã€‚ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®æ“ä½œæ€§ã‚’å‘ä¸Šã•ã›ã‚‹ãŸã‚ã®å·¥å¤«ãªã‚“ã§ã™ã‚ˆã€‚

```csharp
// Assets/Scripts/Tests/EditMode/PairTest.cs ã«è¿½åŠ 
[Test]
public void å³ç«¯ã§å³å›è»¢ã™ã‚‹ã¨å£ã‚­ãƒƒã‚¯ã§å·¦ã«ç§»å‹•ã™ã‚‹()
{
    // Arrange
    var board = new Board();
    var pair = new Pair(5, 5, PuyoColor.Red, PuyoColor.Blue);
    // rotation = 0ï¼ˆå­ã·ã‚ˆãŒä¸Šï¼‰

    // Act
    pair.RotateRight(); // rotation = 1ï¼ˆå­ã·ã‚ˆãŒå³ï¼‰ã«ãªã‚‹ã¯ãš

    // Assert - å£ã‚­ãƒƒã‚¯ã§å·¦ã«ç§»å‹•ã—ã¦ã„ã‚‹
    Assert.AreEqual(4, pair.AxisX);
    Assert.AreEqual(5, pair.ChildX); // å­ã·ã‚ˆã¯å³éš£
}

[Test]
public void å·¦ç«¯ã§å·¦å›è»¢ã™ã‚‹ã¨å£ã‚­ãƒƒã‚¯ã§å³ã«ç§»å‹•ã™ã‚‹()
{
    // Arrange
    var board = new Board();
    var pair = new Pair(0, 5, PuyoColor.Red, PuyoColor.Blue);
    // rotation = 0ï¼ˆå­ã·ã‚ˆãŒä¸Šï¼‰

    // Act
    pair.RotateLeft(); // rotation = 3ï¼ˆå­ã·ã‚ˆãŒå·¦ï¼‰ã«ãªã‚‹ã¯ãš

    // Assert - å£ã‚­ãƒƒã‚¯ã§å³ã«ç§»å‹•ã—ã¦ã„ã‚‹
    Assert.AreEqual(1, pair.AxisX);
    Assert.AreEqual(0, pair.ChildX); // å­ã·ã‚ˆã¯å·¦éš£
}
```

ã€Œã“ã®ãƒ†ã‚¹ãƒˆã§ã¯ä½•ã‚’ç¢ºèªã—ã¦ã„ã‚‹ã‚“ã§ã™ã‹ï¼Ÿã€ã“ã®ãƒ†ã‚¹ãƒˆã§ã¯ã€ä»¥ä¸‹ã®2ã¤ã®ã‚±ãƒ¼ã‚¹ã‚’ç¢ºèªã—ã¦ã„ã¾ã™ï¼š

1. å³ç«¯ã§æ™‚è¨ˆå›ã‚Šã«å›è»¢ã™ã‚‹ã¨ã€å£ã‚­ãƒƒã‚¯ã§å·¦ã«1ãƒã‚¹ç§»å‹•ã—ã¦å›è»¢ã™ã‚‹ã‹
2. å·¦ç«¯ã§åæ™‚è¨ˆå›ã‚Šã«å›è»¢ã™ã‚‹ã¨ã€å£ã‚­ãƒƒã‚¯ã§å³ã«1ãƒã‚¹ç§»å‹•ã—ã¦å›è»¢ã™ã‚‹ã‹

### å®Ÿè£…: å£ã‚­ãƒƒã‚¯æ©Ÿèƒ½

ç¾åœ¨ã®`RotateRight`ã¨`RotateLeft`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å£ã‚­ãƒƒã‚¯æ©Ÿèƒ½ã«å¯¾å¿œã•ã›ã¾ã—ã‚‡ã†ï¼š

```csharp
// Assets/Scripts/Core/Pair.cs ã‚’ä¿®æ­£
public void RotateRight()
{
    rotation = (rotation + 1) % 4;
    UpdateChildPosition();

    // å£ã‚­ãƒƒã‚¯ã®ãƒã‚§ãƒƒã‚¯
    // å›è»¢å¾Œã€å­ã·ã‚ˆãŒç”»é¢å¤–ã«å‡ºã‚‹å ´åˆã¯è»¸ã·ã‚ˆã‚’èª¿æ•´
    if (ChildX < 0)
    {
        AxisX -= ChildX; // å³ã«ç§»å‹•
        UpdateChildPosition();
    }
    else if (ChildX >= Board.COLS)
    {
        AxisX -= (ChildX - Board.COLS + 1); // å·¦ã«ç§»å‹•
        UpdateChildPosition();
    }
}

public void RotateLeft()
{
    rotation = (rotation + 3) % 4; // -1 ã¨åŒã˜ï¼ˆãƒ¢ã‚¸ãƒ¥ãƒ­æ¼”ç®—ï¼‰
    UpdateChildPosition();

    // å£ã‚­ãƒƒã‚¯ã®ãƒã‚§ãƒƒã‚¯
    // å›è»¢å¾Œã€å­ã·ã‚ˆãŒç”»é¢å¤–ã«å‡ºã‚‹å ´åˆã¯è»¸ã·ã‚ˆã‚’èª¿æ•´
    if (ChildX < 0)
    {
        AxisX -= ChildX; // å³ã«ç§»å‹•
        UpdateChildPosition();
    }
    else if (ChildX >= Board.COLS)
    {
        AxisX -= (ChildX - Board.COLS + 1); // å·¦ã«ç§»å‹•
        UpdateChildPosition();
    }
}
```

ã€Œãªã‚‹ã»ã©ã€å›è»¢å¾Œã«å­ã·ã‚ˆã®ä½ç½®ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ã€ç”»é¢å¤–ã«å‡ºã¦ã„ãŸã‚‰è»¸ã·ã‚ˆã‚’ç§»å‹•ã•ã›ã‚‹ã‚“ã§ã™ã­ï¼ã€ãã†ã§ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒå£éš›ã§ã‚‚å›è»¢ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã€æ“ä½œæ€§ãŒå‘ä¸Šã—ã¾ã™ã€‚

ã—ã‹ã—ã€ã“ã“ã§å•é¡ŒãŒã‚ã‚Šã¾ã™ã€‚`Board.COLS`ã¨ã„ã†å®šæ•°ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã„ã¾ã™ãŒã€ã“ã‚Œã¯å¤–éƒ¨ã‹ã‚‰å‚ç…§ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

```csharp
// Assets/Scripts/Core/Board.cs ã‚’ä¿®æ­£
public class Board
{
    public const int COLS = 6;
    public const int ROWS = 12;

    private PuyoColor[,] cells;

    public int Cols => COLS;
    public int Rows => ROWS;

    // ä»¥ä¸‹çœç•¥...
}
```

ã€Œ`const`ã‚’`public`ã«ã—ãŸã‚“ã§ã™ã­ï¼ã€ãã†ã§ã™ã€‚ã“ã‚Œã§`Pair`ã‚¯ãƒ©ã‚¹ã‹ã‚‰`Board.COLS`ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼š

```bash
dotnet cake --target=Test
```

```
âœ… å³ç«¯ã§å³å›è»¢ã™ã‚‹ã¨å£ã‚­ãƒƒã‚¯ã§å·¦ã«ç§»å‹•ã™ã‚‹
âœ… å·¦ç«¯ã§å·¦å›è»¢ã™ã‚‹ã¨å£ã‚­ãƒƒã‚¯ã§å³ã«ç§»å‹•ã™ã‚‹
```

ã‚„ã£ãŸï¼å£ã‚­ãƒƒã‚¯æ©Ÿèƒ½ãŒå®Ÿè£…ã§ãã¾ã—ãŸï¼

### ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°

ãƒ†ã‚¹ãƒˆãŒé€šã£ãŸã®ã§ã€ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã®æ©Ÿä¼šã‚’æ¢ã—ã¾ã—ã‚‡ã†ã€‚`RotateRight`ã¨`RotateLeft`ã§å£ã‚­ãƒƒã‚¯ã®ãƒ­ã‚¸ãƒƒã‚¯ãŒé‡è¤‡ã—ã¦ã„ã¾ã™ã­ã€‚ã“ã‚Œã‚’å…±é€šåŒ–ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

> ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°
>
> ã„ã¤ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã™ã¹ãã ã‚ã†ã‹ã€‚ãƒ†ã‚¹ãƒˆãŒã‚°ãƒªãƒ¼ãƒ³ã«ãªã£ãŸã¨ãã ã€‚
>
> â€” Kent Beck ã€ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã€

```csharp
// Assets/Scripts/Core/Pair.cs ã‚’ä¿®æ­£
public void RotateRight()
{
    rotation = (rotation + 1) % 4;
    UpdateChildPosition();
    ApplyWallKick();
}

public void RotateLeft()
{
    rotation = (rotation + 3) % 4; // -1 ã¨åŒã˜ï¼ˆãƒ¢ã‚¸ãƒ¥ãƒ­æ¼”ç®—ï¼‰
    UpdateChildPosition();
    ApplyWallKick();
}

private void ApplyWallKick()
{
    // å£ã‚­ãƒƒã‚¯ã®ãƒã‚§ãƒƒã‚¯
    // å›è»¢å¾Œã€å­ã·ã‚ˆãŒç”»é¢å¤–ã«å‡ºã‚‹å ´åˆã¯è»¸ã·ã‚ˆã‚’èª¿æ•´
    if (ChildX < 0)
    {
        AxisX -= ChildX; // å³ã«ç§»å‹•
        UpdateChildPosition();
    }
    else if (ChildX >= Board.COLS)
    {
        AxisX -= (ChildX - Board.COLS + 1); // å·¦ã«ç§»å‹•
        UpdateChildPosition();
    }
}
```

ã€Œé‡è¤‡ãŒæ’é™¤ã•ã‚Œã¦ã‚¹ãƒƒã‚­ãƒªã—ã¾ã—ãŸã­ï¼ã€ãã†ã§ã™ã­ã€‚`ApplyWallKick`ã¨ã„ã†åå‰ã®ãƒ¡ã‚½ãƒƒãƒ‰ã«ã™ã‚‹ã“ã¨ã§ã€ä½•ã‚’ã—ã¦ã„ã‚‹ã®ã‹ã‚‚æ˜ç¢ºã«ãªã‚Šã¾ã—ãŸã€‚

ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦ã€ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ãŒæ­£ã—ãè¡Œã‚ã‚ŒãŸã‹ç¢ºèªã—ã¾ã—ã‚‡ã†ï¼š

```bash
dotnet cake --target=Test
```

```
All tests passed!
```

ç´ æ™´ã‚‰ã—ã„ï¼ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆãŒé€šã‚Šã¾ã—ãŸã€‚

### ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ 3 ã®ã¾ã¨ã‚

ãŠç–²ã‚Œæ§˜ã§ã—ãŸï¼ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ 3 ã§å®Ÿè£…ã—ãŸå†…å®¹ã‚’æŒ¯ã‚Šè¿”ã£ã¦ã¿ã¾ã—ã‚‡ã†ï¼š

1. **å·¦å³ã¸ã®ç§»å‹•æ©Ÿèƒ½**
   - `MoveLeft()`: å·¦ã«ç§»å‹•
   - `MoveRight()`: å³ã«ç§»å‹•
   - è¡çªåˆ¤å®šã«ã‚ˆã‚Šã€ç”»é¢å¤–ã‚„ä»–ã®ã·ã‚ˆã«ã¶ã¤ã‹ã‚‹å ´åˆã¯ç§»å‹•ã—ãªã„

2. **ä¸‹ã¸ã®ç§»å‹•æ©Ÿèƒ½**
   - `MoveDown()`: ä¸‹ã«ç§»å‹•
   - `CanMoveDown()`: ä¸‹ã«ç§»å‹•ã§ãã‚‹ã‹ãƒã‚§ãƒƒã‚¯
   - ç€åœ°åˆ¤å®šã«ä½¿ç”¨

3. **å£ã‚­ãƒƒã‚¯æ©Ÿèƒ½**
   - `ApplyWallKick()`: å›è»¢å¾Œã«å£ã«ã‚ã‚Šè¾¼ã‚€å ´åˆã¯è‡ªå‹•ã§ä½ç½®ã‚’èª¿æ•´
   - æ“ä½œæ€§ã®å‘ä¸Š

4. **Board ã‚¯ãƒ©ã‚¹ã®æ”¹å–„**
   - `COLS`ã¨`ROWS`ã‚’`public const`ã«ã—ã¦å¤–éƒ¨ã‹ã‚‰å‚ç…§å¯èƒ½ã«

5. **ãƒ†ã‚¹ãƒˆ**: 11 å€‹ã®æ–°ã—ã„ãƒ†ã‚¹ãƒˆã‚’è¿½åŠ 
   - å·¦å³ç§»å‹•ã®ãƒ†ã‚¹ãƒˆï¼ˆ4 ãƒ†ã‚¹ãƒˆï¼‰
   - ä¸‹ç§»å‹•ã®ãƒ†ã‚¹ãƒˆï¼ˆ4 ãƒ†ã‚¹ãƒˆï¼‰
   - å£ã‚­ãƒƒã‚¯ã®ãƒ†ã‚¹ãƒˆï¼ˆ2 ãƒ†ã‚¹ãƒˆï¼‰

6. **ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°**: å£ã‚­ãƒƒã‚¯ãƒ­ã‚¸ãƒƒã‚¯ã®å…±é€šåŒ–

ã“ã‚Œã§ã€ã·ã‚ˆãƒšã‚¢ã‚’è‡ªç”±ã«æ“ä½œã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸï¼æ¬¡ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ã€ã·ã‚ˆãƒšã‚¢ã‚’è‡ªå‹•çš„ã«è½ä¸‹ã•ã›ã‚‹æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¦ã„ãã¾ã™ã€‚

```bash
git add .
git commit -m 'feat: ç§»å‹•ã¨å›è»¢æ©Ÿèƒ½ã‚’å®Ÿè£…

- å·¦å³ã¸ã®ç§»å‹•æ©Ÿèƒ½
- ä¸‹ã¸ã®ç§»å‹•æ©Ÿèƒ½ã¨CanMoveDownãƒã‚§ãƒƒã‚¯
- å£ã‚­ãƒƒã‚¯æ©Ÿèƒ½ã®å®Ÿè£…
- 11å€‹ã®ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã‚’è¿½åŠ '
```

---

## ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ 4: ã·ã‚ˆã®è‡ªå‹•è½ä¸‹

ã€Œç§»å‹•ã¨å›è»¢ãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸãŒã€ã·ã‚ˆã·ã‚ˆã£ã¦è‡ªå‹•ã§è½ã¡ã¦ãã¾ã™ã‚ˆã­ï¼Ÿã€ãã†ã§ã™ã­ï¼ã·ã‚ˆã·ã‚ˆã§ã¯ã€ã·ã‚ˆãŒä¸€å®šé–“éš”ã§è‡ªå‹•çš„ã«ä¸‹ã«è½ã¡ã¦ã„ãã¾ã™ã€‚ä»Šå›ã¯ã€ãã®ã€Œè‡ªå‹•è½ä¸‹ã€æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¦ã„ãã¾ã—ã‚‡ã†ï¼

### ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼

ã¾ãšã¯ã€ã“ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§å®Ÿè£…ã™ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚’ç¢ºèªã—ã¾ã—ã‚‡ã†ï¼š

> ã‚·ã‚¹ãƒ†ãƒ ã¨ã—ã¦ã€ã·ã‚ˆãƒšã‚¢ã‚’è‡ªå‹•çš„ã«è½ä¸‹ã•ã›ã‚‹ã“ã¨ãŒã§ãã‚‹

ã€Œã·ã‚ˆãŒè‡ªå‹•çš„ã«è½ã¡ã¦ã„ãã€ã¨ã„ã†æ©Ÿèƒ½ã¯ã€ã·ã‚ˆã·ã‚ˆã®åŸºæœ¬ä¸­ã®åŸºæœ¬ã§ã™ã­ã€‚ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒä½•ã‚‚æ“ä½œã—ãªãã¦ã‚‚ã€æ™‚é–“ã¨ã¨ã‚‚ã«ã·ã‚ˆãŒä¸‹ã«è½ã¡ã¦ã„ãä»•çµ„ã¿ã‚’ä½œã‚Šã¾ã—ã‚‡ã†ã€‚

### TODO ãƒªã‚¹ãƒˆ

ã•ã¦ã€ã“ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚’å®Ÿç¾ã™ã‚‹ãŸã‚ã«ã€ã©ã‚“ãªã‚¿ã‚¹ã‚¯ãŒå¿…è¦ã§ã—ã‚‡ã†ã‹ï¼Ÿä¸€ç·’ã«è€ƒãˆã¦ã¿ã¾ã—ã‚‡ã†ï¼š

- Game ã‚¯ãƒ©ã‚¹ã‚’ä½œæˆã™ã‚‹
- è½ä¸‹ã‚¿ã‚¤ãƒãƒ¼ã®å®Ÿè£…ï¼ˆä¸€å®šæ™‚é–“ã”ã¨ã«è½ä¸‹å‡¦ç†ã‚’å®Ÿè¡Œã™ã‚‹ä»•çµ„ã¿ï¼‰
- è‡ªå‹•è½ä¸‹å‡¦ç†ã®å®Ÿè£…ï¼ˆã‚¿ã‚¤ãƒãƒ¼ãŒç™ºç«ã—ãŸã¨ãã«ã·ã‚ˆãƒšã‚¢ã‚’1ãƒã‚¹ä¸‹ã«ç§»å‹•ã™ã‚‹ï¼‰
- ç€åœ°å‡¦ç†ã®å®Ÿè£…ï¼ˆã·ã‚ˆãƒšã‚¢ãŒç€åœ°ã—ãŸã¨ãã«ãƒœãƒ¼ãƒ‰ã«å›ºå®šã™ã‚‹ï¼‰
- é‡åŠ›å‡¦ç†ã®å®Ÿè£…ï¼ˆç€åœ°å¾Œã€æµ®ã„ã¦ã„ã‚‹ã·ã‚ˆãŒè½ä¸‹ã™ã‚‹ï¼‰

ã€Œé †ç•ªã«å®Ÿè£…ã—ã¦ã„ã‘ã°ã„ã„ã‚“ã§ã™ã­ï¼ã€ãã†ã§ã™ã€‚ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã®æµã‚Œã«æ²¿ã£ã¦ã€ã¾ãšã¯ãƒ†ã‚¹ãƒˆã‹ã‚‰æ›¸ã„ã¦ã„ãã¾ã—ã‚‡ã†ï¼

### ãƒ†ã‚¹ãƒˆ: Game ã‚¯ãƒ©ã‚¹ã®åŸºæœ¬

ã€Œæœ€åˆã«ä½•ã‚’ãƒ†ã‚¹ãƒˆã™ã‚Œã°ã„ã„ã‚“ã§ã—ã‚‡ã†ã‹ï¼Ÿã€ã¾ãšã¯ã€ã‚²ãƒ¼ãƒ å…¨ä½“ã‚’ç®¡ç†ã™ã‚‹ `Game` ã‚¯ãƒ©ã‚¹ã‚’ä½œæˆã—ã€åŸºæœ¬çš„ãªæ©Ÿèƒ½ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã—ã‚‡ã†ã€‚

> ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆ
>
> ã„ã¤ãƒ†ã‚¹ãƒˆã‚’æ›¸ãã¹ãã ã‚ã†ã‹â€”â€”ãã‚Œã¯ãƒ†ã‚¹ãƒˆå¯¾è±¡ã®ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãå‰ã ã€‚
>
> â€” Kent Beck ã€ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã€

```csharp
// Assets/Scripts/Tests/EditMode/GameTest.cs
using NUnit.Framework;
using PuyoPuyo.Core;

public class GameTest
{
    private Game game;

    [SetUp]
    public void SetUp()
    {
        game = new Game();
    }

    [Test]
    public void ã‚²ãƒ¼ãƒ ãŒåˆæœŸåŒ–ã•ã‚Œã‚‹()
    {
        // Assert
        Assert.IsNotNull(game.Board);
        Assert.IsNotNull(game.CurrentPair);
    }

    [Test]
    public void åˆæœŸçŠ¶æ…‹ã§ã¯ç¾åœ¨ã®ã·ã‚ˆãƒšã‚¢ãŒå­˜åœ¨ã™ã‚‹()
    {
        // Assert
        Assert.IsNotNull(game.CurrentPair);
        Assert.AreEqual(2, game.CurrentPair.AxisX);
        Assert.AreEqual(0, game.CurrentPair.AxisY);
    }
}
```

### å®Ÿè£…: Game ã‚¯ãƒ©ã‚¹ã®åŸºæœ¬

ãƒ†ã‚¹ãƒˆã‚’é€šã™ãŸã‚ã®å®Ÿè£…ã‚’æ›¸ãã¾ã—ã‚‡ã†ï¼š

```csharp
// Assets/Scripts/Core/Game.cs
using System;

namespace PuyoPuyo.Core
{
    public class Game
    {
        public Board Board { get; private set; }
        public Pair CurrentPair { get; private set; }

        private readonly Random random;
        private const int SPAWN_X = 2; // å‡ºç¾ä½ç½® X
        private const int SPAWN_Y = 0; // å‡ºç¾ä½ç½® Y

        public Game()
        {
            Board = new Board();
            random = new Random();
            SpawnNewPair();
        }

        private void SpawnNewPair()
        {
            PuyoColor axisColor = GetRandomColor();
            PuyoColor childColor = GetRandomColor();
            CurrentPair = new Pair(SPAWN_X, SPAWN_Y, axisColor, childColor);
        }

        private PuyoColor GetRandomColor()
        {
            // 1ã€œ4 ã®ãƒ©ãƒ³ãƒ€ãƒ ãªè‰²ã‚’è¿”ã™ï¼ˆNone ã‚’é™¤ãï¼‰
            int colorIndex = random.Next(1, 5);
            return (PuyoColor)colorIndex;
        }
    }
}
```

ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼š

```bash
dotnet cake --target=Test
```

```
âœ… ã‚²ãƒ¼ãƒ ãŒåˆæœŸåŒ–ã•ã‚Œã‚‹
âœ… åˆæœŸçŠ¶æ…‹ã§ã¯ç¾åœ¨ã®ã·ã‚ˆãƒšã‚¢ãŒå­˜åœ¨ã™ã‚‹
```

ã‚„ã£ãŸï¼ãƒ†ã‚¹ãƒˆãŒé€šã‚Šã¾ã—ãŸã€‚

### ãƒ†ã‚¹ãƒˆ: è‡ªå‹•è½ä¸‹ã‚¿ã‚¤ãƒãƒ¼

æ¬¡ã¯ã€ä¸€å®šæ™‚é–“ã”ã¨ã«è½ä¸‹å‡¦ç†ãŒå®Ÿè¡Œã•ã‚Œã‚‹ä»•çµ„ã¿ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã—ã‚‡ã†ã€‚

```csharp
// Assets/Scripts/Tests/EditMode/GameTest.cs ã«è¿½åŠ 
[Test]
public void ä¸€å®šæ™‚é–“çµŒéã™ã‚‹ã¨ã·ã‚ˆãƒšã‚¢ãŒä¸‹ã«ç§»å‹•ã™ã‚‹()
{
    // Arrange
    int initialY = game.CurrentPair.AxisY;
    float fallInterval = 1.0f; // 1ç§’

    // Act - 1ç§’åˆ†ã®æ›´æ–°ã‚’å®Ÿè¡Œ
    game.Update(fallInterval);

    // Assert
    Assert.AreEqual(initialY + 1, game.CurrentPair.AxisY);
}

[Test]
public void æ™‚é–“ãŒçµŒéã—ã¦ã„ãªã„ã¨ã·ã‚ˆãƒšã‚¢ã¯ç§»å‹•ã—ãªã„()
{
    // Arrange
    int initialY = game.CurrentPair.AxisY;
    float halfInterval = 0.5f; // 0.5ç§’

    // Act
    game.Update(halfInterval);

    // Assert
    Assert.AreEqual(initialY, game.CurrentPair.AxisY);
}
```

### å®Ÿè£…: è‡ªå‹•è½ä¸‹ã‚¿ã‚¤ãƒãƒ¼

ãƒ†ã‚¹ãƒˆã‚’é€šã™ãŸã‚ã®å®Ÿè£…ã‚’æ›¸ãã¾ã—ã‚‡ã†ï¼š

```csharp
// Assets/Scripts/Core/Game.cs ã«è¿½åŠ 
public class Game
{
    private float fallTimer = 0f;
    private const float FALL_INTERVAL = 1.0f; // 1ç§’ã”ã¨ã«è½ä¸‹

    public void Update(float deltaTime)
    {
        fallTimer += deltaTime;

        if (fallTimer >= FALL_INTERVAL)
        {
            // ã·ã‚ˆãƒšã‚¢ã‚’1ãƒã‚¹ä¸‹ã«ç§»å‹•
            CurrentPair.MoveDown(Board);
            fallTimer = 0f;
        }
    }
}
```

ã€Œãªã‚‹ã»ã©ã€`deltaTime`ã§çµŒéæ™‚é–“ã‚’è“„ç©ã—ã¦ã€ä¸€å®šé–“éš”ã‚’è¶…ãˆãŸã‚‰è½ä¸‹ã•ã›ã‚‹ã‚“ã§ã™ã­ï¼ã€ãã†ã§ã™ã€‚ã“ã®å®Ÿè£…ã§ã¯ã€ä»¥ä¸‹ã®ã“ã¨ã‚’è¡Œã£ã¦ã„ã¾ã™ï¼š

1. `fallTimer` ã§ã‚¿ã‚¤ãƒãƒ¼ã‚’ç®¡ç†
2. `Update()` ãƒ¡ã‚½ãƒƒãƒ‰ã§çµŒéæ™‚é–“ã‚’åŠ ç®—
3. ä¸€å®šé–“éš”ï¼ˆ`FALL_INTERVAL`ï¼‰ã‚’è¶…ãˆãŸã‚‰ `MoveDown()` ã‚’å®Ÿè¡Œ
4. ã‚¿ã‚¤ãƒãƒ¼ã‚’ãƒªã‚»ãƒƒãƒˆ

ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼š

```bash
dotnet cake --target=Test
```

```
âœ… ä¸€å®šæ™‚é–“çµŒéã™ã‚‹ã¨ã·ã‚ˆãƒšã‚¢ãŒä¸‹ã«ç§»å‹•ã™ã‚‹
âœ… æ™‚é–“ãŒçµŒéã—ã¦ã„ãªã„ã¨ã·ã‚ˆãƒšã‚¢ã¯ç§»å‹•ã—ãªã„
```

ç´ æ™´ã‚‰ã—ã„ï¼ãƒ†ã‚¹ãƒˆãŒé€šã‚Šã¾ã—ãŸã€‚

### ãƒ†ã‚¹ãƒˆ: ç€åœ°å‡¦ç†

ã€Œã·ã‚ˆãƒšã‚¢ãŒä¸‹ã«ç§»å‹•ã§ããªããªã£ãŸã‚‰ã©ã†ãªã‚Šã¾ã™ã‹ï¼Ÿã€è‰¯ã„è³ªå•ã§ã™ã­ï¼ã·ã‚ˆãƒšã‚¢ãŒç€åœ°ã—ãŸã‚‰ã€ãƒœãƒ¼ãƒ‰ã«å›ºå®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

```csharp
// Assets/Scripts/Tests/EditMode/GameTest.cs ã«è¿½åŠ 
[Test]
public void ã·ã‚ˆãƒšã‚¢ãŒç€åœ°ã™ã‚‹ã¨ãƒœãƒ¼ãƒ‰ã«å›ºå®šã•ã‚Œã‚‹()
{
    // Arrange - ã·ã‚ˆãƒšã‚¢ã‚’ä¸‹ç«¯ã®1ã¤ä¸Šã«é…ç½®
    game.CurrentPair = new Pair(2, Board.ROWS - 2, PuyoColor.Red, PuyoColor.Blue);

    // Act - è½ä¸‹ã•ã›ã‚‹
    game.Update(1.0f);

    // Assert - ãƒœãƒ¼ãƒ‰ã«ã·ã‚ˆãŒé…ç½®ã•ã‚Œã¦ã„ã‚‹
    Assert.AreEqual(PuyoColor.Red, game.Board.Get(Board.ROWS - 1, 2));
}

[Test]
public void ã·ã‚ˆãƒšã‚¢ãŒç€åœ°ã™ã‚‹ã¨æ–°ã—ã„ã·ã‚ˆãƒšã‚¢ãŒç”Ÿæˆã•ã‚Œã‚‹()
{
    // Arrange - ã·ã‚ˆãƒšã‚¢ã‚’ä¸‹ç«¯ã®1ã¤ä¸Šã«é…ç½®
    Pair oldPair = game.CurrentPair;
    game.CurrentPair = new Pair(2, Board.ROWS - 2, PuyoColor.Red, PuyoColor.Blue);

    // Act - è½ä¸‹ã•ã›ã‚‹
    game.Update(1.0f);

    // Assert - æ–°ã—ã„ã·ã‚ˆãƒšã‚¢ãŒç”Ÿæˆã•ã‚Œã¦ã„ã‚‹
    Assert.AreNotSame(oldPair, game.CurrentPair);
    Assert.AreEqual(2, game.CurrentPair.AxisX);
    Assert.AreEqual(0, game.CurrentPair.AxisY);
}
```

### å®Ÿè£…: ç€åœ°å‡¦ç†

ãƒ†ã‚¹ãƒˆã‚’é€šã™ãŸã‚ã®å®Ÿè£…ã‚’æ›¸ãã¾ã—ã‚‡ã†ï¼š

```csharp
// Assets/Scripts/Core/Game.cs ã‚’ä¿®æ­£
public void Update(float deltaTime)
{
    fallTimer += deltaTime;

    if (fallTimer >= FALL_INTERVAL)
    {
        // ã·ã‚ˆãƒšã‚¢ãŒä¸‹ã«ç§»å‹•ã§ãã‚‹ã‹ãƒã‚§ãƒƒã‚¯
        if (CurrentPair.CanMoveDown(Board))
        {
            CurrentPair.MoveDown(Board);
        }
        else
        {
            // ç€åœ°ã—ãŸã®ã§ãƒœãƒ¼ãƒ‰ã«å›ºå®š
            FixPairToBoard();
            // æ–°ã—ã„ã·ã‚ˆãƒšã‚¢ã‚’ç”Ÿæˆ
            SpawnNewPair();
        }

        fallTimer = 0f;
    }
}

private void FixPairToBoard()
{
    // è»¸ã·ã‚ˆã‚’ãƒœãƒ¼ãƒ‰ã«é…ç½®
    Board.Set(CurrentPair.AxisY, CurrentPair.AxisX, CurrentPair.AxisColor);

    // å­ã·ã‚ˆã‚’ãƒœãƒ¼ãƒ‰ã«é…ç½®
    Board.Set(CurrentPair.ChildY, CurrentPair.ChildX, CurrentPair.ChildColor);
}
```

ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼š

```bash
dotnet cake --target=Test
```

```
âœ… ã·ã‚ˆãƒšã‚¢ãŒç€åœ°ã™ã‚‹ã¨ãƒœãƒ¼ãƒ‰ã«å›ºå®šã•ã‚Œã‚‹
âœ… ã·ã‚ˆãƒšã‚¢ãŒç€åœ°ã™ã‚‹ã¨æ–°ã—ã„ã·ã‚ˆãƒšã‚¢ãŒç”Ÿæˆã•ã‚Œã‚‹
```

ã‚„ã£ãŸï¼ç€åœ°å‡¦ç†ãŒå®Ÿè£…ã§ãã¾ã—ãŸï¼

### ãƒ†ã‚¹ãƒˆ: é‡åŠ›å‡¦ç†

ã€Œç€åœ°ã—ãŸã·ã‚ˆã®ä¸Šã«ã·ã‚ˆãŒã‚ã£ãŸã‚‰ã©ã†ãªã‚Šã¾ã™ã‹ï¼Ÿã€è‰¯ã„è³ªå•ã§ã™ã­ï¼ç€åœ°å¾Œã€æµ®ã„ã¦ã„ã‚‹ã·ã‚ˆã¯é‡åŠ›ã§ä¸‹ã«è½ã¡ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

```csharp
// Assets/Scripts/Tests/EditMode/BoardTest.cs ã«è¿½åŠ 
[Test]
public void æµ®ã„ã¦ã„ã‚‹ã·ã‚ˆãŒé‡åŠ›ã§è½ã¡ã‚‹()
{
    // Arrange
    var board = new Board();
    board.Set(11, 2, PuyoColor.Red); // æœ€ä¸‹æ®µã«ã·ã‚ˆ
    board.Set(9, 2, PuyoColor.Blue);  // æµ®ã„ã¦ã„ã‚‹ã·ã‚ˆ

    // Act
    board.ApplyGravity();

    // Assert - æµ®ã„ã¦ã„ã‚‹ã·ã‚ˆãŒ1ãƒã‚¹è½ã¡ã¦ã„ã‚‹
    Assert.AreEqual(PuyoColor.None, board.Get(9, 2));
    Assert.AreEqual(PuyoColor.Blue, board.Get(10, 2));
}

[Test]
public void è¤‡æ•°ã®æµ®ã„ã¦ã„ã‚‹ã·ã‚ˆãŒé‡åŠ›ã§è½ã¡ã‚‹()
{
    // Arrange
    var board = new Board();
    board.Set(11, 2, PuyoColor.Red);   // æœ€ä¸‹æ®µ
    board.Set(9, 2, PuyoColor.Blue);   // æµ®ã„ã¦ã„ã‚‹ã·ã‚ˆ
    board.Set(11, 3, PuyoColor.Green); // æœ€ä¸‹æ®µ
    board.Set(8, 3, PuyoColor.Yellow); // æµ®ã„ã¦ã„ã‚‹ã·ã‚ˆ

    // Act
    board.ApplyGravity();

    // Assert
    Assert.AreEqual(PuyoColor.None, board.Get(9, 2));
    Assert.AreEqual(PuyoColor.Blue, board.Get(10, 2));
    Assert.AreEqual(PuyoColor.None, board.Get(8, 3));
    Assert.AreEqual(PuyoColor.Yellow, board.Get(9, 3));
}

[Test]
public void æµ®ã„ã¦ã„ã‚‹ã·ã‚ˆãŒãªã„å ´åˆã¯ä½•ã‚‚å¤‰åŒ–ã—ãªã„()
{
    // Arrange
    var board = new Board();
    board.Set(11, 2, PuyoColor.Red);
    board.Set(10, 2, PuyoColor.Blue);

    // Act
    bool hasFloating = board.ApplyGravity();

    // Assert
    Assert.IsFalse(hasFloating);
    Assert.AreEqual(PuyoColor.Red, board.Get(11, 2));
    Assert.AreEqual(PuyoColor.Blue, board.Get(10, 2));
}
```

### å®Ÿè£…: é‡åŠ›å‡¦ç†

ãƒ†ã‚¹ãƒˆã‚’é€šã™ãŸã‚ã®å®Ÿè£…ã‚’æ›¸ãã¾ã—ã‚‡ã†ï¼š

```csharp
// Assets/Scripts/Core/Board.cs ã«è¿½åŠ 
public bool ApplyGravity()
{
    // ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ã‚³ãƒ”ãƒ¼ã‚’ä½œæˆï¼ˆç§»å‹•å‰ã®çŠ¶æ…‹ã‚’ä¿å­˜ï¼‰
    PuyoColor[,] original = new PuyoColor[ROWS, COLS];
    for (int row = 0; row < ROWS; row++)
    {
        for (int col = 0; col < COLS; col++)
        {
            original[row, col] = cells[row, col];
        }
    }

    bool hasFloating = false;

    // ä¸‹ã‹ã‚‰ä¸Šã«å‘ã‹ã£ã¦å„åˆ—ã‚’ã‚¹ã‚­ãƒ£ãƒ³ï¼ˆåˆ—ã”ã¨ã«å‡¦ç†ï¼‰
    for (int col = 0; col < COLS; col++)
    {
        for (int row = ROWS - 2; row >= 0; row--)
        {
            PuyoColor color = original[row, col];
            if (color != PuyoColor.None)
            {
                // å…ƒã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã§ä¸‹ã«ç©ºããŒã‚ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
                if (original[row + 1, col] == PuyoColor.None)
                {
                    // 1ãƒã‚¹ä¸‹ã«ç§»å‹•
                    cells[row + 1, col] = color;
                    cells[row, col] = PuyoColor.None;
                    hasFloating = true;
                }
            }
        }
    }

    return hasFloating;
}
```

ã€Œãªã‚‹ã»ã©ã€ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ã‚³ãƒ”ãƒ¼ã‚’ä½œã£ã¦ã€å…ƒã®çŠ¶æ…‹ã‚’å‚ç…§ã—ãªãŒã‚‰1ãƒã‚¹ãšã¤è½ã¨ã™ã‚“ã§ã™ã­ï¼ã€ãã†ã§ã™ã€‚ã‚³ãƒ”ãƒ¼ã‚’ä½œã‚‹ã“ã¨ã§ã€è¤‡æ•°ã®ã·ã‚ˆãŒåŒæ™‚ã«è½ã¡ã‚‹ã¨ãã«æ­£ã—ãå‡¦ç†ã§ãã¾ã™ã€‚

ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼š

```bash
dotnet cake --target=Test
```

```
âœ… æµ®ã„ã¦ã„ã‚‹ã·ã‚ˆãŒé‡åŠ›ã§è½ã¡ã‚‹
âœ… è¤‡æ•°ã®æµ®ã„ã¦ã„ã‚‹ã·ã‚ˆãŒé‡åŠ›ã§è½ã¡ã‚‹
âœ… æµ®ã„ã¦ã„ã‚‹ã·ã‚ˆãŒãªã„å ´åˆã¯ä½•ã‚‚å¤‰åŒ–ã—ãªã„
```

ç´ æ™´ã‚‰ã—ã„ï¼é‡åŠ›å‡¦ç†ãŒå®Ÿè£…ã§ãã¾ã—ãŸã€‚

### ã‚²ãƒ¼ãƒ ãƒ¢ãƒ¼ãƒ‰ã®å°å…¥

ã€Œç€åœ°ã—ãŸå¾Œã€é‡åŠ›å‡¦ç†ã‚’ç¹°ã‚Šè¿”ã—ã¦æµ®ã„ã¦ã„ã‚‹ã·ã‚ˆãŒãªããªã‚‹ã¾ã§å‡¦ç†ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã­ï¼Ÿã€é‹­ã„æŒ‡æ‘˜ã§ã™ï¼ã‚²ãƒ¼ãƒ ã®çŠ¶æ…‹ã‚’ç®¡ç†ã™ã‚‹ãŸã‚ã«ã€ã‚²ãƒ¼ãƒ ãƒ¢ãƒ¼ãƒ‰ã‚’å°å…¥ã—ã¾ã—ã‚‡ã†ã€‚

```csharp
// Assets/Scripts/Core/Game.cs ã‚’ä¿®æ­£
public enum GameMode
{
    Playing,    // ã·ã‚ˆãƒšã‚¢æ“ä½œä¸­
    Falling,    // é‡åŠ›å‡¦ç†ä¸­
    Checking    // æ¶ˆå»ãƒã‚§ãƒƒã‚¯ä¸­ï¼ˆå¾Œã§å®Ÿè£…ï¼‰
}

public class Game
{
    public GameMode Mode { get; private set; }

    public Game()
    {
        Board = new Board();
        random = new Random();
        Mode = GameMode.Playing;
        SpawnNewPair();
    }

    public void Update(float deltaTime)
    {
        switch (Mode)
        {
            case GameMode.Playing:
                UpdatePlaying(deltaTime);
                break;

            case GameMode.Falling:
                UpdateFalling();
                break;
        }
    }

    private void UpdatePlaying(float deltaTime)
    {
        fallTimer += deltaTime;

        if (fallTimer >= FALL_INTERVAL)
        {
            if (CurrentPair.CanMoveDown(Board))
            {
                CurrentPair.MoveDown(Board);
            }
            else
            {
                // ç€åœ°ã—ãŸã®ã§ãƒœãƒ¼ãƒ‰ã«å›ºå®š
                FixPairToBoard();
                // é‡åŠ›å‡¦ç†ãƒ¢ãƒ¼ãƒ‰ã«ç§»è¡Œ
                Mode = GameMode.Falling;
            }

            fallTimer = 0f;
        }
    }

    private void UpdateFalling()
    {
        // é‡åŠ›ã‚’é©ç”¨
        bool hasFloating = Board.ApplyGravity();

        if (!hasFloating)
        {
            // æµ®ã„ã¦ã„ã‚‹ã·ã‚ˆãŒãªããªã£ãŸã‚‰æ–°ã—ã„ã·ã‚ˆãƒšã‚¢ã‚’ç”Ÿæˆ
            SpawnNewPair();
            Mode = GameMode.Playing;
        }
    }
}
```

ã€Œã‚²ãƒ¼ãƒ ãƒ¢ãƒ¼ãƒ‰ã§çŠ¶æ…‹ã‚’ç®¡ç†ã™ã‚‹ã“ã¨ã§ã€å‡¦ç†ã®æµã‚ŒãŒæ˜ç¢ºã«ãªã‚Šã¾ã™ã­ï¼ã€ãã†ã§ã™ã€‚`Playing` â†’ ç€åœ° â†’ `Falling` â†’ é‡åŠ›å‡¦ç†å®Œäº† â†’ `Playing` ã¨ã„ã†ã‚µã‚¤ã‚¯ãƒ«ãŒå®Ÿç¾ã§ãã¾ã—ãŸã€‚

### ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ 4 ã®ã¾ã¨ã‚

ãŠç–²ã‚Œæ§˜ã§ã—ãŸï¼ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ 4 ã§å®Ÿè£…ã—ãŸå†…å®¹ã‚’æŒ¯ã‚Šè¿”ã£ã¦ã¿ã¾ã—ã‚‡ã†ï¼š

1. **Game ã‚¯ãƒ©ã‚¹ã®ä½œæˆ**
   - ã‚²ãƒ¼ãƒ å…¨ä½“ã‚’ç®¡ç†ã™ã‚‹ã‚¯ãƒ©ã‚¹
   - `Board` ã¨ `CurrentPair` ã‚’ä¿æŒ
   - ãƒ©ãƒ³ãƒ€ãƒ ãªè‰²ã®ã·ã‚ˆãƒšã‚¢ã‚’ç”Ÿæˆ

2. **è‡ªå‹•è½ä¸‹ã‚¿ã‚¤ãƒãƒ¼**
   - `fallTimer` ã¨ `FALL_INTERVAL` ã§ã‚¿ã‚¤ãƒŸãƒ³ã‚°ç®¡ç†
   - `Update()` ãƒ¡ã‚½ãƒƒãƒ‰ã§çµŒéæ™‚é–“ã‚’åŠ ç®—
   - 1 ç§’é–“éš”ã§ 1 ãƒã‚¹ãšã¤è½ä¸‹

3. **ç€åœ°å‡¦ç†**
   - `FixPairToBoard()`: ã·ã‚ˆãƒšã‚¢ã‚’ãƒœãƒ¼ãƒ‰ã«å›ºå®š
   - è»¸ã·ã‚ˆã¨å­ã·ã‚ˆã‚’ä¸¡æ–¹é…ç½®
   - ç€åœ°å¾Œã¯æ–°ã—ã„ã·ã‚ˆãƒšã‚¢ã‚’ç”Ÿæˆ

4. **é‡åŠ›å‡¦ç†**
   - `Board.ApplyGravity()`: æµ®ã„ã¦ã„ã‚‹ã·ã‚ˆã‚’ 1 ãƒã‚¹ãšã¤è½ã¨ã™
   - ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ã‚³ãƒ”ãƒ¼ã‚’ä½œæˆã—ã¦å®‰å…¨ã«å‡¦ç†
   - è½ä¸‹ã—ãŸã·ã‚ˆãŒã‚ã‚‹ã‹ã©ã†ã‹ã‚’è¿”ã™

5. **ã‚²ãƒ¼ãƒ ãƒ¢ãƒ¼ãƒ‰ã®å°å…¥**
   - `GameMode` enum: `Playing`, `Falling`, `Checking`
   - çŠ¶æ…‹ã«å¿œã˜ãŸå‡¦ç†ã®åˆ‡ã‚Šæ›¿ãˆ
   - `Playing` â†’ ç€åœ° â†’ `Falling` â†’ `Playing` ã®ã‚µã‚¤ã‚¯ãƒ«

6. **ãƒ†ã‚¹ãƒˆ**: 10 å€‹ã®æ–°ã—ã„ãƒ†ã‚¹ãƒˆã‚’è¿½åŠ 
   - Game ã‚¯ãƒ©ã‚¹ã®åˆæœŸåŒ–ãƒ†ã‚¹ãƒˆï¼ˆ2 ãƒ†ã‚¹ãƒˆï¼‰
   - è‡ªå‹•è½ä¸‹ã‚¿ã‚¤ãƒãƒ¼ã®ãƒ†ã‚¹ãƒˆï¼ˆ2 ãƒ†ã‚¹ãƒˆï¼‰
   - ç€åœ°å‡¦ç†ã®ãƒ†ã‚¹ãƒˆï¼ˆ2 ãƒ†ã‚¹ãƒˆï¼‰
   - é‡åŠ›å‡¦ç†ã®ãƒ†ã‚¹ãƒˆï¼ˆ3 ãƒ†ã‚¹ãƒˆï¼‰

ã“ã‚Œã§ã€ã·ã‚ˆãƒšã‚¢ãŒè‡ªå‹•çš„ã«è½ä¸‹ã—ã€ç€åœ°å¾Œã«æµ®ã„ã¦ã„ã‚‹ã·ã‚ˆã‚‚è½ã¡ã¦ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸï¼æ¬¡ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ã€ã·ã‚ˆã®æ¶ˆå»åˆ¤å®šã‚’å®Ÿè£…ã—ã¦ã„ãã¾ã™ã€‚

```bash
git add .
git commit -m 'feat: ã·ã‚ˆã®è‡ªå‹•è½ä¸‹ã‚’å®Ÿè£…

- Game ã‚¯ãƒ©ã‚¹ã®ä½œæˆã¨ã·ã‚ˆãƒšã‚¢ç”Ÿæˆ
- è‡ªå‹•è½ä¸‹ã‚¿ã‚¤ãƒãƒ¼ã®å®Ÿè£…
- ç€åœ°å‡¦ç†ã¨ãƒœãƒ¼ãƒ‰ã¸ã®å›ºå®š
- é‡åŠ›å‡¦ç†ã®å®Ÿè£…
- ã‚²ãƒ¼ãƒ ãƒ¢ãƒ¼ãƒ‰ã«ã‚ˆã‚‹çŠ¶æ…‹ç®¡ç†
- 10å€‹ã®ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã‚’è¿½åŠ '
```

---

## ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ 5: ã·ã‚ˆã®æ¶ˆå»åˆ¤å®š

ã€Œã·ã‚ˆãŒè½ã¡ã¦ãã‚‹ã‚ˆã†ã«ãªã£ãŸã‘ã©ã€ã·ã‚ˆã·ã‚ˆã®é†é†å‘³ã¯ã·ã‚ˆã‚’æ¶ˆã™ã“ã¨ã§ã™ã‚ˆã­ï¼Ÿã€ãã†ã§ã™ã­ï¼ã·ã‚ˆã·ã‚ˆã®æœ€ã‚‚é‡è¦ãªè¦ç´ ã®ä¸€ã¤ã¯ã€åŒã˜è‰²ã®ã·ã‚ˆã‚’ 4 ã¤ä»¥ä¸Šã¤ãªã’ã‚‹ã¨æ¶ˆå»ã§ãã‚‹æ©Ÿèƒ½ã§ã™ã€‚ä»Šå›ã¯ã€ãã®ã€Œã·ã‚ˆã®æ¶ˆå»åˆ¤å®šã€æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¦ã„ãã¾ã—ã‚‡ã†ï¼

### ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼

ã¾ãšã¯ã€ã“ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§å®Ÿè£…ã™ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚’ç¢ºèªã—ã¾ã—ã‚‡ã†ï¼š

> ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¨ã—ã¦ã€åŒã˜è‰²ã®ã·ã‚ˆã‚’ 4 ã¤ä»¥ä¸Šã¤ãªã’ã‚‹ã¨æ¶ˆå»ã§ãã‚‹

ã€Œã“ã‚ŒãŒã·ã‚ˆã·ã‚ˆã®åŸºæœ¬ãƒ«ãƒ¼ãƒ«ã§ã™ã­ï¼ã€ãã†ã§ã™ï¼åŒã˜è‰²ã®ã·ã‚ˆã‚’ 4 ã¤ä»¥ä¸Šã¤ãªã’ã‚‹ã¨æ¶ˆå»ã§ãã‚‹ã¨ã„ã†ã®ãŒã€ã·ã‚ˆã·ã‚ˆã®åŸºæœ¬çš„ãªãƒ«ãƒ¼ãƒ«ã§ã™ã€‚

### TODO ãƒªã‚¹ãƒˆ

ã•ã¦ã€ã“ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚’å®Ÿç¾ã™ã‚‹ãŸã‚ã«ã€ã©ã‚“ãªã‚¿ã‚¹ã‚¯ãŒå¿…è¦ã§ã—ã‚‡ã†ã‹ï¼Ÿä¸€ç·’ã«è€ƒãˆã¦ã¿ã¾ã—ã‚‡ã†ï¼š

- ã·ã‚ˆã®æ¥ç¶šåˆ¤å®šã‚’å®Ÿè£…ã™ã‚‹ï¼ˆéš£æ¥ã™ã‚‹åŒã˜è‰²ã®ã·ã‚ˆã‚’æ¤œå‡ºã™ã‚‹ï¼‰
- 4 ã¤ä»¥ä¸Šã¤ãªãŒã£ãŸã·ã‚ˆã®æ¤œå‡ºã‚’å®Ÿè£…ã™ã‚‹ï¼ˆæ¶ˆå»å¯¾è±¡ã¨ãªã‚‹ã·ã‚ˆã®ã‚°ãƒ«ãƒ¼ãƒ—ã‚’ç‰¹å®šã™ã‚‹ï¼‰
- ã·ã‚ˆã®æ¶ˆå»å‡¦ç†ã‚’å®Ÿè£…ã™ã‚‹ï¼ˆæ¶ˆå»å¯¾è±¡ã®ã·ã‚ˆã‚’å®Ÿéš›ã«æ¶ˆã™ï¼‰
- æ¶ˆå»å¾Œã®é‡åŠ›å‡¦ç†ã¨çµ±åˆã™ã‚‹

ã€Œãªã‚‹ã»ã©ã€é †ç•ªã«å®Ÿè£…ã—ã¦ã„ã‘ã°ã„ã„ã‚“ã§ã™ã­ï¼ã€ãã†ã§ã™ã€‚ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã®æµã‚Œã«æ²¿ã£ã¦ã€ã¾ãšã¯ãƒ†ã‚¹ãƒˆã‹ã‚‰æ›¸ã„ã¦ã„ãã¾ã—ã‚‡ã†ï¼

### ãƒ†ã‚¹ãƒˆ: ã·ã‚ˆã®æ¥ç¶šåˆ¤å®š

ã€Œæœ€åˆã«ä½•ã‚’ãƒ†ã‚¹ãƒˆã™ã‚Œã°ã„ã„ã‚“ã§ã—ã‚‡ã†ã‹ï¼Ÿã€ã¾ãšã¯ã€åŒã˜è‰²ã®ã·ã‚ˆãŒ 4 ã¤ä»¥ä¸Šã¤ãªãŒã£ã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’åˆ¤å®šã™ã‚‹æ©Ÿèƒ½ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã—ã‚‡ã†ã€‚

> ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆ
>
> ã„ã¤ãƒ†ã‚¹ãƒˆã‚’æ›¸ãã¹ãã ã‚ã†ã‹â€”â€”ãã‚Œã¯ãƒ†ã‚¹ãƒˆå¯¾è±¡ã®ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãå‰ã ã€‚
>
> â€” Kent Beck ã€ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã€

```csharp
// Assets/Scripts/Tests/EditMode/BoardTest.cs ã«è¿½åŠ 
[Test]
public void åŒã˜è‰²ã®ã·ã‚ˆãŒ4ã¤ç¸¦ã«ã¤ãªãŒã£ã¦ã„ã‚‹ã¨æ¶ˆå»å¯¾è±¡ã«ãªã‚‹()
{
    // Arrange
    var board = new Board();
    // ç¸¦ã«4ã¤èµ¤ã·ã‚ˆã‚’é…ç½®
    board.Set(11, 2, PuyoColor.Red);
    board.Set(10, 2, PuyoColor.Red);
    board.Set(9, 2, PuyoColor.Red);
    board.Set(8, 2, PuyoColor.Red);

    // Act
    var positions = board.CheckErase();

    // Assert - 4ã¤ã®ã·ã‚ˆãŒæ¶ˆå»å¯¾è±¡ã«ãªã£ã¦ã„ã‚‹
    Assert.AreEqual(4, positions.Count);
}

[Test]
public void åŒã˜è‰²ã®ã·ã‚ˆãŒ4ã¤æ¨ªã«ã¤ãªãŒã£ã¦ã„ã‚‹ã¨æ¶ˆå»å¯¾è±¡ã«ãªã‚‹()
{
    // Arrange
    var board = new Board();
    // æ¨ªã«4ã¤é’ã·ã‚ˆã‚’é…ç½®
    board.Set(11, 0, PuyoColor.Blue);
    board.Set(11, 1, PuyoColor.Blue);
    board.Set(11, 2, PuyoColor.Blue);
    board.Set(11, 3, PuyoColor.Blue);

    // Act
    var positions = board.CheckErase();

    // Assert - 4ã¤ã®ã·ã‚ˆãŒæ¶ˆå»å¯¾è±¡ã«ãªã£ã¦ã„ã‚‹
    Assert.AreEqual(4, positions.Count);
}

[Test]
public void åŒã˜è‰²ã®ã·ã‚ˆãŒ3ã¤ä»¥ä¸‹ã ã¨æ¶ˆå»å¯¾è±¡ã«ãªã‚‰ãªã„()
{
    // Arrange
    var board = new Board();
    // ç¸¦ã«3ã¤èµ¤ã·ã‚ˆã‚’é…ç½®
    board.Set(11, 2, PuyoColor.Red);
    board.Set(10, 2, PuyoColor.Red);
    board.Set(9, 2, PuyoColor.Red);

    // Act
    var positions = board.CheckErase();

    // Assert - æ¶ˆå»å¯¾è±¡ãŒãªã„
    Assert.AreEqual(0, positions.Count);
}

[Test]
public void ç•°ãªã‚‹è‰²ã®ã·ã‚ˆã¯æ¶ˆå»å¯¾è±¡ã«ãªã‚‰ãªã„()
{
    // Arrange
    var board = new Board();
    board.Set(11, 2, PuyoColor.Red);
    board.Set(10, 2, PuyoColor.Blue);
    board.Set(9, 2, PuyoColor.Red);
    board.Set(8, 2, PuyoColor.Blue);

    // Act
    var positions = board.CheckErase();

    // Assert - æ¶ˆå»å¯¾è±¡ãŒãªã„
    Assert.AreEqual(0, positions.Count);
}

[Test]
public void Lå­—å‹ã«ã¤ãªãŒã£ãŸ4ã¤ã®ã·ã‚ˆã‚‚æ¶ˆå»å¯¾è±¡ã«ãªã‚‹()
{
    // Arrange
    var board = new Board();
    // Lå­—å‹ã«é…ç½®
    board.Set(11, 2, PuyoColor.Green);
    board.Set(10, 2, PuyoColor.Green);
    board.Set(9, 2, PuyoColor.Green);
    board.Set(9, 3, PuyoColor.Green);

    // Act
    var positions = board.CheckErase();

    // Assert - 4ã¤ã®ã·ã‚ˆãŒæ¶ˆå»å¯¾è±¡ã«ãªã£ã¦ã„ã‚‹
    Assert.AreEqual(4, positions.Count);
}
```

ã€Œã“ã®ãƒ†ã‚¹ãƒˆã§ã¯ä½•ã‚’ç¢ºèªã—ã¦ã„ã‚‹ã‚“ã§ã™ã‹ï¼Ÿã€ã“ã®ãƒ†ã‚¹ãƒˆã§ã¯ã€ä»¥ä¸‹ã® 5 ã¤ã®ã‚±ãƒ¼ã‚¹ã‚’ç¢ºèªã—ã¦ã„ã¾ã™ï¼š

1. ç¸¦ã« 4 ã¤ã¤ãªãŒã£ã¦ã„ã‚‹å ´åˆã¯æ¶ˆå»å¯¾è±¡ã«ãªã‚‹ã‹
2. æ¨ªã« 4 ã¤ã¤ãªãŒã£ã¦ã„ã‚‹å ´åˆã¯æ¶ˆå»å¯¾è±¡ã«ãªã‚‹ã‹
3. 3 ã¤ä»¥ä¸‹ã®å ´åˆã¯æ¶ˆå»å¯¾è±¡ã«ãªã‚‰ãªã„ã‹
4. ç•°ãªã‚‹è‰²ãŒæ··ã–ã£ã¦ã„ã‚‹å ´åˆã¯æ¶ˆå»å¯¾è±¡ã«ãªã‚‰ãªã„ã‹
5. L å­—å‹ã®ã‚ˆã†ãªå½¢ã§ã‚‚ 4 ã¤ã¤ãªãŒã£ã¦ã„ã‚Œã°æ¶ˆå»å¯¾è±¡ã«ãªã‚‹ã‹

ã€Œãªã‚‹ã»ã©ã€ã„ã‚ã„ã‚ãªãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹ã‚“ã§ã™ã­ï¼ã€ãã†ã§ã™ã€‚ã§ã¯ã€ã“ã®ãƒ†ã‚¹ãƒˆãŒé€šã‚‹ã‚ˆã†ã«å®Ÿè£…ã—ã¦ã„ãã¾ã—ã‚‡ã†ã€‚

### å®Ÿè£…: ã·ã‚ˆã®æ¥ç¶šåˆ¤å®š

ãƒ†ã‚¹ãƒˆã‚’æ›¸ã„ãŸã‚‰ã€æ¬¡ã«å®Ÿè£…ã—ã¾ã—ã‚‡ã†ã€‚ã©ã†ãªã‚‹ã§ã—ã‚‡ã†ã‹ï¼Ÿ

```bash
dotnet cake --target=Test
```

```
undefined: Board.CheckErase
```

ãŠã£ã¨ï¼`CheckErase` ãŒã¾ã å®šç¾©ã•ã‚Œã¦ã„ã¾ã›ã‚“ã­ã€‚ã“ã‚ŒãŒãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã®ã€ŒRedï¼ˆèµ¤ï¼‰ã€ã®çŠ¶æ…‹ã§ã™ã€‚

æ¥ç¶šåˆ¤å®šã«ã¯ã€Œæ·±ã•å„ªå…ˆæ¢ç´¢ï¼ˆDFS: Depth-First Searchï¼‰ã€ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

> æ˜ç™½ãªå®Ÿè£…
>
> ã‚·ãƒ³ãƒ—ãƒ«ãªæ“ä½œã‚’ã©ã†å®Ÿè£…ã™ã‚Œã°ã„ã„ã ã‚ã†ã‹ã€‚ãŸã å®Ÿè£…ã™ã‚Œã°ã„ã„ã®ã ã€‚
>
> â€” Kent Beck ã€ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã€

```csharp
// Assets/Scripts/Core/Board.cs ã«è¿½åŠ 
using System.Collections.Generic;

public class Board
{
    public List<(int row, int col)> CheckErase()
    {
        List<(int row, int col)> erasePositions = new List<(int row, int col)>();
        bool[,] checked = new bool[ROWS, COLS];

        // å…¨ãƒã‚¹ã‚’ãƒã‚§ãƒƒã‚¯
        for (int row = 0; row < ROWS; row++)
        {
            for (int col = 0; col < COLS; col++)
            {
                // ã·ã‚ˆãŒã‚ã‚Šã€ã¾ã ãƒã‚§ãƒƒã‚¯ã—ã¦ã„ãªã„å ´åˆ
                if (cells[row, col] != PuyoColor.None && !checked[row, col])
                {
                    // æ¥ç¶šã—ã¦ã„ã‚‹ã·ã‚ˆã‚’æ¢ç´¢
                    PuyoColor color = cells[row, col];
                    List<(int row, int col)> connected = new List<(int row, int col)>();
                    SearchConnectedPuyo(row, col, color, checked, connected);

                    // 4ã¤ä»¥ä¸Šã¤ãªãŒã£ã¦ã„ã‚‹å ´åˆã¯æ¶ˆå»å¯¾è±¡
                    if (connected.Count >= 4)
                    {
                        erasePositions.AddRange(connected);
                    }
                }
            }
        }

        return erasePositions;
    }

    private void SearchConnectedPuyo(
        int row,
        int col,
        PuyoColor color,
        bool[,] checked,
        List<(int row, int col)> connected)
    {
        // æ¢ç´¢æ¸ˆã¿ã«ã™ã‚‹
        checked[row, col] = true;
        connected.Add((row, col));

        // 4æ–¹å‘ã‚’æ¢ç´¢ï¼ˆä¸Šä¸‹å·¦å³ï¼‰
        int[] dRow = { -1, 1, 0, 0 };
        int[] dCol = { 0, 0, -1, 1 };

        for (int i = 0; i < 4; i++)
        {
            int nextRow = row + dRow[i];
            int nextCol = col + dCol[i];

            // ãƒœãƒ¼ãƒ‰å†…ã‹ã¤åŒã˜è‰²ã®ã·ã‚ˆãŒã‚ã‚Šã€ã¾ã ãƒã‚§ãƒƒã‚¯ã—ã¦ã„ãªã„å ´åˆ
            if (IsInBounds(nextRow, nextCol) &&
                cells[nextRow, nextCol] == color &&
                !checked[nextRow, nextCol])
            {
                // å†å¸°çš„ã«æ¢ç´¢
                SearchConnectedPuyo(nextRow, nextCol, color, checked, connected);
            }
        }
    }
}
```

ã€Œæ·±ã•å„ªå…ˆæ¢ç´¢ã£ã¦ä½•ã§ã™ã‹ï¼Ÿã€è‰¯ã„è³ªå•ã§ã™ã­ï¼æ·±ã•å„ªå…ˆæ¢ç´¢ï¼ˆDFSï¼‰ã¯ã€ã‚°ãƒ©ãƒ•ã‚„æœ¨æ§‹é€ ã‚’æ¢ç´¢ã™ã‚‹ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã§ã™ã€‚ã‚ã‚‹ãƒãƒ¼ãƒ‰ã‹ã‚‰å§‹ã‚ã¦ã€å¯èƒ½ãªé™ã‚Šæ·±ãé€²ã¿ã€è¡Œãæ­¢ã¾ã‚Šã«ãªã£ãŸã‚‰æˆ»ã£ã¦åˆ¥ã®é“ã‚’æ¢ç´¢ã—ã¾ã™ã€‚

ã“ã®å®Ÿè£…ã§ã¯ã€ä»¥ä¸‹ã®ã“ã¨ã‚’è¡Œã£ã¦ã„ã¾ã™ï¼š

1. ãƒœãƒ¼ãƒ‰ä¸Šã®å…¨ãƒã‚¹ã‚’é †ç•ªã«ãƒã‚§ãƒƒã‚¯
2. ã¾ã ãƒã‚§ãƒƒã‚¯ã—ã¦ã„ãªã„ã·ã‚ˆãŒã‚ã‚‹å ´åˆã€ãã®ã·ã‚ˆã¨åŒã˜è‰²ã§æ¥ç¶šã—ã¦ã„ã‚‹ã·ã‚ˆã‚’ `SearchConnectedPuyo` ã§æ¢ç´¢
3. æ¥ç¶šã—ã¦ã„ã‚‹ã·ã‚ˆãŒ 4 ã¤ä»¥ä¸Šã‚ã‚‹å ´åˆã€ãã‚Œã‚‰ã‚’æ¶ˆå»å¯¾è±¡ã¨ã—ã¦è¨˜éŒ²

`SearchConnectedPuyo` ãƒ¡ã‚½ãƒƒãƒ‰ã§ã¯ã€å†å¸°çš„ã«éš£æ¥ã™ã‚‹åŒã˜è‰²ã®ã·ã‚ˆã‚’æ¢ç´¢ã—ã¦ã„ãã¾ã™ã€‚æ¢ç´¢æ¸ˆã¿ã®ã·ã‚ˆã¯ `checked` é…åˆ—ã§ãƒãƒ¼ã‚¯ã—ã€é‡è¤‡ã—ã¦ã‚«ã‚¦ãƒ³ãƒˆã—ãªã„ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚

ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼š

```bash
dotnet cake --target=Test
```

```
âœ… åŒã˜è‰²ã®ã·ã‚ˆãŒ4ã¤ç¸¦ã«ã¤ãªãŒã£ã¦ã„ã‚‹ã¨æ¶ˆå»å¯¾è±¡ã«ãªã‚‹
âœ… åŒã˜è‰²ã®ã·ã‚ˆãŒ4ã¤æ¨ªã«ã¤ãªãŒã£ã¦ã„ã‚‹ã¨æ¶ˆå»å¯¾è±¡ã«ãªã‚‹
âœ… åŒã˜è‰²ã®ã·ã‚ˆãŒ3ã¤ä»¥ä¸‹ã ã¨æ¶ˆå»å¯¾è±¡ã«ãªã‚‰ãªã„
âœ… ç•°ãªã‚‹è‰²ã®ã·ã‚ˆã¯æ¶ˆå»å¯¾è±¡ã«ãªã‚‰ãªã„
âœ… Lå­—å‹ã«ã¤ãªãŒã£ãŸ4ã¤ã®ã·ã‚ˆã‚‚æ¶ˆå»å¯¾è±¡ã«ãªã‚‹
```

ã‚„ã£ãŸï¼ãƒ†ã‚¹ãƒˆãŒé€šã‚Šã¾ã—ãŸã€‚ã“ã‚ŒãŒã€ŒGreenï¼ˆç·‘ï¼‰ã€ã®çŠ¶æ…‹ã§ã™ã€‚

### ãƒ†ã‚¹ãƒˆ: ã·ã‚ˆã®æ¶ˆå»

æ¬¡ã¯ã€æ¶ˆå»å¯¾è±¡ã®ã·ã‚ˆã‚’å®Ÿéš›ã«æ¶ˆã™æ©Ÿèƒ½ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã—ã‚‡ã†ã€‚

```csharp
// Assets/Scripts/Tests/EditMode/BoardTest.cs ã«è¿½åŠ 
[Test]
public void æ¶ˆå»å¯¾è±¡ã®ã·ã‚ˆã‚’æ¶ˆå»ã§ãã‚‹()
{
    // Arrange
    var board = new Board();
    board.Set(11, 2, PuyoColor.Red);
    board.Set(10, 2, PuyoColor.Red);
    board.Set(9, 2, PuyoColor.Red);
    board.Set(8, 2, PuyoColor.Red);

    var positions = board.CheckErase();

    // Act
    board.Erase(positions);

    // Assert - ã·ã‚ˆãŒæ¶ˆå»ã•ã‚Œã¦ã„ã‚‹
    Assert.AreEqual(PuyoColor.None, board.Get(11, 2));
    Assert.AreEqual(PuyoColor.None, board.Get(10, 2));
    Assert.AreEqual(PuyoColor.None, board.Get(9, 2));
    Assert.AreEqual(PuyoColor.None, board.Get(8, 2));
}
```

### å®Ÿè£…: ã·ã‚ˆã®æ¶ˆå»

ãƒ†ã‚¹ãƒˆã‚’é€šã™ãŸã‚ã®å®Ÿè£…ã‚’æ›¸ãã¾ã—ã‚‡ã†ï¼š

```csharp
// Assets/Scripts/Core/Board.cs ã«è¿½åŠ 
public void Erase(List<(int row, int col)> positions)
{
    foreach (var pos in positions)
    {
        cells[pos.row, pos.col] = PuyoColor.None;
    }
}
```

ã€Œã‚·ãƒ³ãƒ—ãƒ«ã§ã™ã­ï¼ã€ãã†ã§ã™ã­ã€‚æ¶ˆå»å‡¦ç†è‡ªä½“ã¯ã€æŒ‡å®šã•ã‚ŒãŸä½ç½®ã®ã·ã‚ˆã‚’ `None` ã«ã™ã‚‹ã ã‘ã§ã™ã€‚

ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼š

```bash
dotnet cake --target=Test
```

```
âœ… æ¶ˆå»å¯¾è±¡ã®ã·ã‚ˆã‚’æ¶ˆå»ã§ãã‚‹
```

ç´ æ™´ã‚‰ã—ã„ï¼ãƒ†ã‚¹ãƒˆãŒé€šã‚Šã¾ã—ãŸã€‚

### ã‚²ãƒ¼ãƒ ãƒ¢ãƒ¼ãƒ‰ã¸ã®çµ±åˆ

ã€Œæ¶ˆå»åˆ¤å®šãŒã§ããŸã®ã§ã€ã‚²ãƒ¼ãƒ ã«çµ„ã¿è¾¼ã¿ã¾ã—ã‚‡ã†ï¼ã€ãã†ã§ã™ã­ã€‚`Game` ã‚¯ãƒ©ã‚¹ã«æ¶ˆå»ãƒã‚§ãƒƒã‚¯ã®ãƒ¢ãƒ¼ãƒ‰ã‚’è¿½åŠ ã—ã¾ã™ã€‚

```csharp
// Assets/Scripts/Core/Game.cs ã‚’ä¿®æ­£
public enum GameMode
{
    Playing,    // ã·ã‚ˆãƒšã‚¢æ“ä½œä¸­
    Falling,    // é‡åŠ›å‡¦ç†ä¸­
    Checking    // æ¶ˆå»ãƒã‚§ãƒƒã‚¯ä¸­
}

public void Update(float deltaTime)
{
    switch (Mode)
    {
        case GameMode.Playing:
            UpdatePlaying(deltaTime);
            break;

        case GameMode.Falling:
            UpdateFalling();
            break;

        case GameMode.Checking:
            UpdateChecking();
            break;
    }
}

private void UpdateFalling()
{
    // é‡åŠ›ã‚’é©ç”¨
    bool hasFloating = Board.ApplyGravity();

    if (!hasFloating)
    {
        // æµ®ã„ã¦ã„ã‚‹ã·ã‚ˆãŒãªããªã£ãŸã‚‰æ¶ˆå»ãƒã‚§ãƒƒã‚¯ã¸
        Mode = GameMode.Checking;
    }
}

private void UpdateChecking()
{
    // æ¶ˆå»åˆ¤å®š
    var positions = Board.CheckErase();

    if (positions.Count > 0)
    {
        // æ¶ˆå»å¯¾è±¡ãŒã‚ã‚‹å ´åˆã€æ¶ˆå»ã—ã¦é‡åŠ›å‡¦ç†ã¸
        Board.Erase(positions);
        Mode = GameMode.Falling;
    }
    else
    {
        // æ¶ˆå»å¯¾è±¡ãŒãªã„å ´åˆã€æ–°ã—ã„ã·ã‚ˆãƒšã‚¢ã‚’ç”Ÿæˆ
        SpawnNewPair();
        Mode = GameMode.Playing;
    }
}
```

ã€Œã‚²ãƒ¼ãƒ ã®æµã‚ŒãŒã©ã†å¤‰ã‚ã£ãŸã‚“ã§ã™ã‹ï¼Ÿã€è‰¯ã„è³ªå•ã§ã™ã­ï¼ã‚²ãƒ¼ãƒ ãƒ•ãƒ­ãƒ¼ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«æ‹¡å¼µã•ã‚Œã¾ã—ãŸï¼š

**æ–°ã—ã„ã‚²ãƒ¼ãƒ ãƒ•ãƒ­ãƒ¼**:
```
Playing â†’ ç€åœ° â†’ Falling â†’ é‡åŠ›é©ç”¨ â†’
  â”œâ”€ æµ®ã„ã¦ã„ã‚‹ã·ã‚ˆã‚ã‚Š â†’ Fallingï¼ˆç¹°ã‚Šè¿”ã—ï¼‰
  â””â”€ æµ®ã„ã¦ã„ã‚‹ã·ã‚ˆãªã— â†’ Checking â†’ æ¶ˆå»åˆ¤å®š â†’
      â”œâ”€ æ¶ˆå»ã‚ã‚Š â†’ æ¶ˆå»å®Ÿè¡Œ â†’ Fallingï¼ˆé‡åŠ›é©ç”¨ï¼‰
      â””â”€ æ¶ˆå»ãªã— â†’ Playingï¼ˆæ–°ã—ã„ã·ã‚ˆãƒšã‚¢ç”Ÿæˆï¼‰
```

ã“ã®ãƒ•ãƒ­ãƒ¼ã«ã‚ˆã‚Šã€ä»¥ä¸‹ãŒå®Ÿç¾ã•ã‚Œã¾ã™ï¼š

1. **ç€åœ°å¾Œã®é‡åŠ›é©ç”¨**: ã·ã‚ˆãƒšã‚¢ãŒç€åœ°ã—ãŸã‚‰ã€ã¾ãšé‡åŠ›ã‚’é©ç”¨ã—ã¦æµ®ã„ã¦ã„ã‚‹ã·ã‚ˆã‚’è½ã¨ã™
2. **æ¶ˆå»åˆ¤å®š**: é‡åŠ›é©ç”¨å¾Œã€è½ä¸‹ã™ã‚‹ã·ã‚ˆãŒãªããªã£ãŸã‚‰æ¶ˆå»åˆ¤å®š
3. **æ¶ˆå»å‡¦ç†**: 4 ã¤ä»¥ä¸Šã¤ãªãŒã£ãŸã·ã‚ˆãŒã‚ã‚Œã°æ¶ˆå»
4. **æ¶ˆå»å¾Œã®é‡åŠ›é©ç”¨**: æ¶ˆå»å¾Œã€å†ã³é‡åŠ›ã‚’é©ç”¨ï¼ˆã“ã‚ŒãŒé€£é–ã®åŸºç¤ã«ãªã‚‹ï¼‰

### ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ 5 ã®ã¾ã¨ã‚

ãŠç–²ã‚Œæ§˜ã§ã—ãŸï¼ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ 5 ã§å®Ÿè£…ã—ãŸå†…å®¹ã‚’æŒ¯ã‚Šè¿”ã£ã¦ã¿ã¾ã—ã‚‡ã†ï¼š

1. **æ¥ç¶šåˆ¤å®šæ©Ÿèƒ½**
   - `CheckErase()`: 4 ã¤ä»¥ä¸Šã¤ãªãŒã£ãŸã·ã‚ˆã‚’æ¤œå‡º
   - `SearchConnectedPuyo()`: æ·±ã•å„ªå…ˆæ¢ç´¢ã§æ¥ç¶šã·ã‚ˆã‚’æ¢ç´¢
   - å†å¸°çš„ãªæ¢ç´¢å‡¦ç†

2. **æ¶ˆå»å‡¦ç†æ©Ÿèƒ½**
   - `Erase()`: æ¶ˆå»å¯¾è±¡ã®ã·ã‚ˆã‚’å‰Šé™¤

3. **ã‚²ãƒ¼ãƒ ãƒ¢ãƒ¼ãƒ‰ã®æ‹¡å¼µ**
   - `GameMode.Checking`: æ¶ˆå»åˆ¤å®šã‚’å®Ÿè¡Œ
   - ã‚²ãƒ¼ãƒ ãƒ•ãƒ­ãƒ¼ã®æ‹¡å¼µï¼šç€åœ° â†’ é‡åŠ› â†’ æ¶ˆå» â†’ é‡åŠ› â†’ æ¬¡ã®ã·ã‚ˆ

4. **ãƒ†ã‚¹ãƒˆ**: 6 å€‹ã®æ–°ã—ã„ãƒ†ã‚¹ãƒˆã‚’è¿½åŠ 
   - ç¸¦ã« 4 ã¤ã¤ãªãŒã£ãŸã·ã‚ˆã®æ¶ˆå»åˆ¤å®š
   - æ¨ªã« 4 ã¤ã¤ãªãŒã£ãŸã·ã‚ˆã®æ¶ˆå»åˆ¤å®š
   - 3 ã¤ä»¥ä¸‹ã®ã·ã‚ˆã¯æ¶ˆå»ã•ã‚Œãªã„
   - ç•°ãªã‚‹è‰²ã®ã·ã‚ˆã¯æ¶ˆå»ã•ã‚Œãªã„
   - L å­—å‹ã«ã¤ãªãŒã£ãŸã·ã‚ˆã®æ¶ˆå»åˆ¤å®š
   - æ¶ˆå»å‡¦ç†ã®å®Ÿè¡Œ

5. **å­¦ã‚“ã é‡è¦ãªæ¦‚å¿µ**
   - æ·±ã•å„ªå…ˆæ¢ç´¢ï¼ˆDFSï¼‰ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 
   - å†å¸°çš„ãªæ¢ç´¢å‡¦ç†
   - ã‚²ãƒ¼ãƒ ãƒ¢ãƒ¼ãƒ‰ã«ã‚ˆã‚‹çŠ¶æ…‹ç®¡ç†
   - æ¶ˆå»ã¨é‡åŠ›ã®é€£æºå‡¦ç†

ã“ã‚Œã§ã€åŒã˜è‰²ã®ã·ã‚ˆã‚’ 4 ã¤ä»¥ä¸Šã¤ãªã’ã‚‹ã¨æ¶ˆå»ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸï¼æ¬¡ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ã€é€£é–åå¿œã¨ã‚¹ã‚³ã‚¢æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¦ã„ãã¾ã™ã€‚

```bash
git add .
git commit -m 'feat: ã·ã‚ˆã®æ¶ˆå»åˆ¤å®šã‚’å®Ÿè£…

- æ·±ã•å„ªå…ˆæ¢ç´¢ã«ã‚ˆã‚‹æ¥ç¶šåˆ¤å®š
- 4ã¤ä»¥ä¸Šã¤ãªãŒã£ãŸã·ã‚ˆã®æ¤œå‡º
- æ¶ˆå»å‡¦ç†ã®å®Ÿè£…
- ã‚²ãƒ¼ãƒ ãƒ¢ãƒ¼ãƒ‰ã¸ã®çµ±åˆï¼ˆChecking ãƒ¢ãƒ¼ãƒ‰ï¼‰
- 6å€‹ã®ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã‚’è¿½åŠ '
```

---

## ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ 6: é€£é–åå¿œã¨ã‚¹ã‚³ã‚¢

ã€Œã·ã‚ˆã‚’æ¶ˆã›ã‚‹ã‚ˆã†ã«ãªã£ãŸã‘ã©ã€ã·ã‚ˆã·ã‚ˆã®é†é†å‘³ã¯é€£é–ã˜ã‚ƒãªã„ã§ã™ã‹ï¼Ÿã€ãã†ã§ã™ã­ï¼ã·ã‚ˆã·ã‚ˆã®æœ€ã‚‚é­…åŠ›çš„ãªè¦ç´ ã®ä¸€ã¤ã¯ã€é€£é–åå¿œã§ã™ã€‚ã·ã‚ˆãŒæ¶ˆãˆã¦è½ä¸‹ã—ãŸçµæœã€æ–°ãŸãªæ¶ˆå»ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒç”Ÿã¾ã‚Œã€é€£ç¶šã—ã¦æ¶ˆå»ãŒç™ºç”Ÿã™ã‚‹ã€Œé€£é–ã€ã¨ã€ãã‚Œã«å¿œã˜ãŸã€Œã‚¹ã‚³ã‚¢ã€ã‚’å®Ÿè£…ã—ã¦ã„ãã¾ã—ã‚‡ã†ï¼

### ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼

ã¾ãšã¯ã€ã“ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§å®Ÿè£…ã™ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚’ç¢ºèªã—ã¾ã—ã‚‡ã†ï¼š

> ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¨ã—ã¦ã€é€£é–åå¿œã‚’èµ·ã“ã—ã¦ã‚ˆã‚Šé«˜ã„ã‚¹ã‚³ã‚¢ã‚’ç²å¾—ã§ãã‚‹

ã€Œã‚Œã€œã‚“ã•ã€œã‚“ï¼ã€ã¨å«ã³ãŸããªã‚‹ã‚ˆã†ãªé€£é–åå¿œã‚’å®Ÿè£…ã—ã¦ã€ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒã‚ˆã‚Šé«˜ã„ã‚¹ã‚³ã‚¢ã‚’ç›®æŒ‡ã›ã‚‹ã‚ˆã†ã«ã—ã¾ã—ã‚‡ã†ã€‚

### TODO ãƒªã‚¹ãƒˆ

ã•ã¦ã€ã“ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚’å®Ÿç¾ã™ã‚‹ãŸã‚ã«ã€ã©ã‚“ãªã‚¿ã‚¹ã‚¯ãŒå¿…è¦ã§ã—ã‚‡ã†ã‹ï¼Ÿä¸€ç·’ã«è€ƒãˆã¦ã¿ã¾ã—ã‚‡ã†ï¼š

- ã‚¹ã‚³ã‚¢ã‚¯ãƒ©ã‚¹ã‚’ä½œæˆã™ã‚‹
- é€£é–ã‚«ã‚¦ãƒ³ãƒˆã‚’å®Ÿè£…ã™ã‚‹ï¼ˆä½•é€£é–ç›®ã‹ã‚’ã‚«ã‚¦ãƒ³ãƒˆã™ã‚‹ï¼‰
- é€£é–ãƒœãƒ¼ãƒŠã‚¹ã®è¨ˆç®—ã‚’å®Ÿè£…ã™ã‚‹ï¼ˆé€£é–æ•°ã«å¿œã˜ãŸãƒœãƒ¼ãƒŠã‚¹ç‚¹ã‚’è¨ˆç®—ã™ã‚‹ï¼‰
- æ¶ˆå»æ™‚ã®ã‚¹ã‚³ã‚¢åŠ ç®—ã‚’å®Ÿè£…ã™ã‚‹
- é€£é–ãŒçµ‚äº†ã—ãŸã¨ãã®å‡¦ç†ã‚’å®Ÿè£…ã™ã‚‹

ã€Œãªã‚‹ã»ã©ã€é †ç•ªã«å®Ÿè£…ã—ã¦ã„ã‘ã°ã„ã„ã‚“ã§ã™ã­ï¼ã€ãã†ã§ã™ã€‚ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã®æµã‚Œã«æ²¿ã£ã¦ã€ã¾ãšã¯ãƒ†ã‚¹ãƒˆã‹ã‚‰æ›¸ã„ã¦ã„ãã¾ã—ã‚‡ã†ï¼

### ãƒ†ã‚¹ãƒˆ: ã‚¹ã‚³ã‚¢ã‚¯ãƒ©ã‚¹

ã€Œæœ€åˆã«ä½•ã‚’ãƒ†ã‚¹ãƒˆã™ã‚Œã°ã„ã„ã‚“ã§ã—ã‚‡ã†ã‹ï¼Ÿã€ã¾ãšã¯ã€ã‚¹ã‚³ã‚¢ã‚’ç®¡ç†ã™ã‚‹ `Score` ã‚¯ãƒ©ã‚¹ã‚’ä½œæˆã—ã€åŸºæœ¬çš„ãªæ©Ÿèƒ½ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã—ã‚‡ã†ã€‚

> ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆ
>
> ã„ã¤ãƒ†ã‚¹ãƒˆã‚’æ›¸ãã¹ãã ã‚ã†ã‹â€”â€”ãã‚Œã¯ãƒ†ã‚¹ãƒˆå¯¾è±¡ã®ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãå‰ã ã€‚
>
> â€” Kent Beck ã€ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã€

```csharp
// Assets/Scripts/Tests/EditMode/ScoreTest.cs
using NUnit.Framework;
using PuyoPuyo.Core;

public class ScoreTest
{
    private Score score;

    [SetUp]
    public void SetUp()
    {
        score = new Score();
    }

    [Test]
    public void ã‚¹ã‚³ã‚¢ãŒåˆæœŸåŒ–ã•ã‚Œã‚‹()
    {
        // Assert
        Assert.AreEqual(0, score.Total);
        Assert.AreEqual(0, score.Chain);
    }

    [Test]
    public void é€£é–æ•°ã‚’ã‚¤ãƒ³ã‚¯ãƒªãƒ¡ãƒ³ãƒˆã§ãã‚‹()
    {
        // Act
        score.IncrementChain();

        // Assert
        Assert.AreEqual(1, score.Chain);
    }

    [Test]
    public void é€£é–æ•°ã‚’ãƒªã‚»ãƒƒãƒˆã§ãã‚‹()
    {
        // Arrange
        score.IncrementChain();
        score.IncrementChain();

        // Act
        score.ResetChain();

        // Assert
        Assert.AreEqual(0, score.Chain);
    }

    [Test]
    public void ã·ã‚ˆæ¶ˆå»æ™‚ã«ã‚¹ã‚³ã‚¢ãŒåŠ ç®—ã•ã‚Œã‚‹()
    {
        // Arrange
        int puyoCount = 4;
        int chain = 1;

        // Act
        score.Add(puyoCount, chain);

        // Assert - åŸºæœ¬ã‚¹ã‚³ã‚¢ = æ¶ˆã—ãŸæ•° Ã— 10
        Assert.AreEqual(40, score.Total);
    }

    [Test]
    public void é€£é–æ•°ã«å¿œã˜ã¦ãƒœãƒ¼ãƒŠã‚¹ãŒåŠ ç®—ã•ã‚Œã‚‹()
    {
        // Arrange
        int puyoCount = 4;

        // Act - 1é€£é–ç›®
        score.IncrementChain();
        score.Add(puyoCount, score.Chain);

        int score1 = score.Total; // 4 Ã— 10 Ã— 1 = 40

        // 2é€£é–ç›®
        score.IncrementChain();
        score.Add(puyoCount, score.Chain);

        // Assert - 2é€£é–ç›®ã®ãƒœãƒ¼ãƒŠã‚¹å€ç‡ã¯2å€
        // 1é€£é–: 4 Ã— 10 Ã— 1 = 40
        // 2é€£é–: 4 Ã— 10 Ã— 2 = 80
        // åˆè¨ˆ: 120
        Assert.AreEqual(120, score.Total);
    }
}
```

### å®Ÿè£…: ã‚¹ã‚³ã‚¢ã‚¯ãƒ©ã‚¹

ãƒ†ã‚¹ãƒˆã‚’é€šã™ãŸã‚ã®å®Ÿè£…ã‚’æ›¸ãã¾ã—ã‚‡ã†ï¼š

```csharp
// Assets/Scripts/Core/Score.cs
namespace PuyoPuyo.Core
{
    public class Score
    {
        public int Total { get; private set; }
        public int Chain { get; private set; }

        public Score()
        {
            Total = 0;
            Chain = 0;
        }

        public void IncrementChain()
        {
            Chain++;
        }

        public void ResetChain()
        {
            Chain = 0;
        }

        public void Add(int puyoCount, int chain)
        {
            // åŸºæœ¬ã‚¹ã‚³ã‚¢ = æ¶ˆã—ãŸæ•° Ã— 10
            // é€£é–ãƒœãƒ¼ãƒŠã‚¹ = é€£é–æ•°
            int baseScore = puyoCount * 10;
            int chainBonus = chain;

            Total += baseScore * chainBonus;
        }
    }
}
```

ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼š

```bash
dotnet cake --target=Test
```

```
âœ… ã‚¹ã‚³ã‚¢ãŒåˆæœŸåŒ–ã•ã‚Œã‚‹
âœ… é€£é–æ•°ã‚’ã‚¤ãƒ³ã‚¯ãƒªãƒ¡ãƒ³ãƒˆã§ãã‚‹
âœ… é€£é–æ•°ã‚’ãƒªã‚»ãƒƒãƒˆã§ãã‚‹
âœ… ã·ã‚ˆæ¶ˆå»æ™‚ã«ã‚¹ã‚³ã‚¢ãŒåŠ ç®—ã•ã‚Œã‚‹
âœ… é€£é–æ•°ã«å¿œã˜ã¦ãƒœãƒ¼ãƒŠã‚¹ãŒåŠ ç®—ã•ã‚Œã‚‹
```

ã‚„ã£ãŸï¼ãƒ†ã‚¹ãƒˆãŒé€šã‚Šã¾ã—ãŸã€‚

### ã‚²ãƒ¼ãƒ ã¸ã®çµ±åˆ

ã€Œã‚¹ã‚³ã‚¢ã‚¯ãƒ©ã‚¹ãŒã§ããŸã®ã§ã€ã‚²ãƒ¼ãƒ ã«çµ„ã¿è¾¼ã¿ã¾ã—ã‚‡ã†ï¼ã€ãã†ã§ã™ã­ã€‚`Game` ã‚¯ãƒ©ã‚¹ã«ã‚¹ã‚³ã‚¢ç®¡ç†æ©Ÿèƒ½ã‚’è¿½åŠ ã—ã¾ã™ã€‚

```csharp
// Assets/Scripts/Core/Game.cs ã‚’ä¿®æ­£
public class Game
{
    public Board Board { get; private set; }
    public Pair CurrentPair { get; private set; }
    public GameMode Mode { get; private set; }
    public Score Score { get; private set; }

    public Game()
    {
        Board = new Board();
        Score = new Score();
        random = new Random();
        Mode = GameMode.Playing;
        SpawnNewPair();
    }

    private void UpdateChecking()
    {
        // æ¶ˆå»åˆ¤å®š
        var positions = Board.CheckErase();

        if (positions.Count > 0)
        {
            // é€£é–æ•°ã‚’ã‚¤ãƒ³ã‚¯ãƒªãƒ¡ãƒ³ãƒˆ
            Score.IncrementChain();

            // ã‚¹ã‚³ã‚¢ã‚’åŠ ç®—
            Score.Add(positions.Count, Score.Chain);

            // æ¶ˆå»å¯¾è±¡ãŒã‚ã‚‹å ´åˆã€æ¶ˆå»ã—ã¦é‡åŠ›å‡¦ç†ã¸
            Board.Erase(positions);
            Mode = GameMode.Falling;
        }
        else
        {
            // æ¶ˆå»å¯¾è±¡ãŒãªã„å ´åˆã€é€£é–çµ‚äº†
            Score.ResetChain();

            // æ–°ã—ã„ã·ã‚ˆãƒšã‚¢ã‚’ç”Ÿæˆ
            SpawnNewPair();
            Mode = GameMode.Playing;
        }
    }
}
```

ã€Œãªã‚‹ã»ã©ã€æ¶ˆå»åˆ¤å®šã§æ¶ˆå»å¯¾è±¡ãŒè¦‹ã¤ã‹ã£ãŸã¨ãã«é€£é–æ•°ã‚’ã‚¤ãƒ³ã‚¯ãƒªãƒ¡ãƒ³ãƒˆã—ã¦ã€ã‚¹ã‚³ã‚¢ã‚’åŠ ç®—ã™ã‚‹ã‚“ã§ã™ã­ï¼ã€ãã†ã§ã™ã€‚ã“ã®å®Ÿè£…ã§ã¯ã€ä»¥ä¸‹ã®ã“ã¨ã‚’è¡Œã£ã¦ã„ã¾ã™ï¼š

1. æ¶ˆå»å¯¾è±¡ãŒè¦‹ã¤ã‹ã£ãŸã‚‰é€£é–æ•°ã‚’ã‚¤ãƒ³ã‚¯ãƒªãƒ¡ãƒ³ãƒˆ
2. æ¶ˆå»ã—ãŸã·ã‚ˆã®æ•°ã¨é€£é–æ•°ã«å¿œã˜ã¦ã‚¹ã‚³ã‚¢ã‚’åŠ ç®—
3. æ¶ˆå»å¾Œã€é‡åŠ›å‡¦ç†ãƒ¢ãƒ¼ãƒ‰ã¸ç§»è¡Œï¼ˆã“ã“ã§é€£é–ãŒç™ºç”Ÿã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ï¼‰
4. æ¶ˆå»å¯¾è±¡ãŒãªã„å ´åˆã¯é€£é–çµ‚äº†ã€é€£é–æ•°ã‚’ãƒªã‚»ãƒƒãƒˆ

### ãƒ†ã‚¹ãƒˆ: é€£é–åå¿œ

ã€Œé€£é–ãŒæœ¬å½“ã«å‹•ä½œã™ã‚‹ã‹ãƒ†ã‚¹ãƒˆã—ãŸã„ã§ã™ï¼ã€ã„ã„ã§ã™ã­ï¼é€£é–åå¿œã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã—ã‚‡ã†ã€‚

```csharp
// Assets/Scripts/Tests/EditMode/GameTest.cs ã«è¿½åŠ 
[Test]
public void ã·ã‚ˆã®æ¶ˆå»ã¨è½ä¸‹å¾Œã«æ–°ãŸãªæ¶ˆå»ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒã‚ã‚Œã°é€£é–ãŒç™ºç”Ÿã™ã‚‹()
{
    // Arrange - é€£é–ã™ã‚‹ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’é…ç½®
    // ä¸‹ã«èµ¤ã·ã‚ˆ4ã¤ï¼ˆæ¨ªä¸€åˆ—ï¼‰
    // ãã®ä¸Šã«é’ã·ã‚ˆãŒç¸¦ã«3ã¤
    // é’ã·ã‚ˆã®éš£ã«é’ã·ã‚ˆ1ã¤
    game.Board.Set(11, 1, PuyoColor.Red);
    game.Board.Set(11, 2, PuyoColor.Red);
    game.Board.Set(11, 3, PuyoColor.Red);
    game.Board.Set(11, 4, PuyoColor.Red);

    game.Board.Set(10, 2, PuyoColor.Blue);
    game.Board.Set(9, 2, PuyoColor.Blue);
    game.Board.Set(8, 2, PuyoColor.Blue);

    game.Board.Set(10, 3, PuyoColor.Blue);

    // Act - ã‚²ãƒ¼ãƒ ã®æ›´æ–°å‡¦ç†ã‚’å®Ÿè¡Œï¼ˆæ¶ˆå»â†’é‡åŠ›â†’æ¶ˆå»ï¼‰
    // 1. èµ¤ã·ã‚ˆãŒæ¶ˆå»ã•ã‚Œã‚‹ï¼ˆ1é€£é–ï¼‰
    game.Mode = GameMode.Checking;
    game.Update(0f); // Checking -> Falling

    // 2. é‡åŠ›é©ç”¨ï¼ˆé’ã·ã‚ˆãŒè½ä¸‹ï¼‰
    game.Update(0f); // Falling -> Checking

    // 3. é’ã·ã‚ˆãŒæ¶ˆå»ã•ã‚Œã‚‹ï¼ˆ2é€£é–ï¼‰
    int chainBefore = game.Score.Chain;
    game.Update(0f); // Checking -> Falling

    // Assert
    Assert.AreEqual(2, chainBefore); // 2é€£é–ã¾ã§åˆ°é”
    Assert.Greater(game.Score.Total, 40); // ã‚¹ã‚³ã‚¢ãŒåŠ ç®—ã•ã‚Œã¦ã„ã‚‹
}
```

ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼š

```bash
dotnet cake --target=Test
```

```
âœ… ã·ã‚ˆã®æ¶ˆå»ã¨è½ä¸‹å¾Œã«æ–°ãŸãªæ¶ˆå»ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒã‚ã‚Œã°é€£é–ãŒç™ºç”Ÿã™ã‚‹
```

ç´ æ™´ã‚‰ã—ã„ï¼é€£é–ãŒæ­£ã—ãå‹•ä½œã—ã¦ã„ã¾ã™ï¼

### ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ 6 ã®ã¾ã¨ã‚

ãŠç–²ã‚Œæ§˜ã§ã—ãŸï¼ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ 6 ã§å®Ÿè£…ã—ãŸå†…å®¹ã‚’æŒ¯ã‚Šè¿”ã£ã¦ã¿ã¾ã—ã‚‡ã†ï¼š

1. **Score ã‚¯ãƒ©ã‚¹ã®ä½œæˆ**
   - `Total`: åˆè¨ˆã‚¹ã‚³ã‚¢
   - `Chain`: ç¾åœ¨ã®é€£é–æ•°
   - `IncrementChain()`: é€£é–æ•°ã‚’ã‚¤ãƒ³ã‚¯ãƒªãƒ¡ãƒ³ãƒˆ
   - `ResetChain()`: é€£é–æ•°ã‚’ãƒªã‚»ãƒƒãƒˆ
   - `Add()`: ã‚¹ã‚³ã‚¢ã‚’åŠ ç®—

2. **ã‚¹ã‚³ã‚¢è¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯**
   - åŸºæœ¬ã‚¹ã‚³ã‚¢ = æ¶ˆã—ãŸæ•° Ã— 10
   - é€£é–ãƒœãƒ¼ãƒŠã‚¹ = é€£é–æ•°
   - æœ€çµ‚ã‚¹ã‚³ã‚¢ = åŸºæœ¬ã‚¹ã‚³ã‚¢ Ã— é€£é–ãƒœãƒ¼ãƒŠã‚¹

3. **é€£é–åå¿œã®å®Ÿè£…**
   - æ¶ˆå»åˆ¤å®šã§æ¶ˆå»å¯¾è±¡ãŒè¦‹ã¤ã‹ã£ãŸã‚‰é€£é–æ•°ã‚’ã‚¤ãƒ³ã‚¯ãƒªãƒ¡ãƒ³ãƒˆ
   - æ¶ˆå»å¾Œã€é‡åŠ›å‡¦ç†ã¸ç§»è¡Œ
   - é‡åŠ›å‡¦ç†å¾Œã€å†åº¦æ¶ˆå»åˆ¤å®šï¼ˆã“ã“ã§é€£é–ãŒç™ºç”Ÿï¼‰
   - æ¶ˆå»å¯¾è±¡ãŒãªã„å ´åˆã€é€£é–çµ‚äº†

4. **ã‚²ãƒ¼ãƒ ã¸ã®çµ±åˆ**
   - `Game` ã‚¯ãƒ©ã‚¹ã« `Score` ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’è¿½åŠ 
   - `UpdateChecking()` ã§é€£é–æ•°ç®¡ç†ã¨ã‚¹ã‚³ã‚¢åŠ ç®—

5. **ãƒ†ã‚¹ãƒˆ**: 6 å€‹ã®æ–°ã—ã„ãƒ†ã‚¹ãƒˆã‚’è¿½åŠ 
   - ã‚¹ã‚³ã‚¢ã®åˆæœŸåŒ–
   - é€£é–æ•°ã®ã‚¤ãƒ³ã‚¯ãƒªãƒ¡ãƒ³ãƒˆ
   - é€£é–æ•°ã®ãƒªã‚»ãƒƒãƒˆ
   - åŸºæœ¬ã‚¹ã‚³ã‚¢ã®åŠ ç®—
   - é€£é–ãƒœãƒ¼ãƒŠã‚¹ã®åŠ ç®—
   - é€£é–åå¿œã®å‹•ä½œç¢ºèª

6. **å­¦ã‚“ã é‡è¦ãªæ¦‚å¿µ**
   - é€£é–åå¿œã®ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ï¼ˆæ¶ˆå» â†’ é‡åŠ› â†’ æ¶ˆå» â†’ é‡åŠ›...ï¼‰
   - ã‚¹ã‚³ã‚¢è¨ˆç®—å¼ã®è¨­è¨ˆ
   - ã‚²ãƒ¼ãƒ çŠ¶æ…‹ã®ç®¡ç†

ã“ã‚Œã§ã€é€£é–åå¿œãŒå‹•ä½œã™ã‚‹ã‚ˆã†ã«ãªã‚Šã€é€£é–æ•°ã«å¿œã˜ãŸãƒœãƒ¼ãƒŠã‚¹ã‚¹ã‚³ã‚¢ãŒåŠ ç®—ã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸï¼æ¬¡ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ã€ã‚¹ã‚³ã‚¢ã®è¡¨ç¤ºæ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¦ã„ãã¾ã™ã€‚

```bash
git add .
git commit -m 'feat: é€£é–åå¿œã¨ã‚¹ã‚³ã‚¢æ©Ÿèƒ½ã‚’å®Ÿè£…

- Score ã‚¯ãƒ©ã‚¹ã®ä½œæˆ
- é€£é–æ•°ã®ã‚«ã‚¦ãƒ³ãƒˆæ©Ÿèƒ½
- é€£é–ãƒœãƒ¼ãƒŠã‚¹ã®è¨ˆç®—
- æ¶ˆå»æ™‚ã®ã‚¹ã‚³ã‚¢åŠ ç®—
- é€£é–åå¿œã®å‹•ä½œç¢ºèª
- 6å€‹ã®ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã‚’è¿½åŠ '
```

---
## ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ 7: ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼åˆ¤å®š

ã€Œé€£é–ã¨ã‚¹ã‚³ã‚¢ãŒã§ãã¾ã—ãŸãŒã€ã·ã‚ˆãŒç©ã¿é‡ãªã£ã¦ç”»é¢ã®ä¸Šã¾ã§è¡Œã£ãŸã‚‰ã©ã†ãªã‚‹ã‚“ã§ã™ã‹ï¼Ÿã€ãã‚ŒãŒã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ã§ã™ï¼ä»Šå›ã¯ã€ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ã®åˆ¤å®šã¨è¡¨ç¤ºã€ãã—ã¦ãƒªã‚¹ã‚¿ãƒ¼ãƒˆæ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¦ã„ãã¾ã—ã‚‡ã†ã€‚

### ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼

ã¾ãšã¯ã€ã“ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§å®Ÿè£…ã™ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚’ç¢ºèªã—ã¾ã—ã‚‡ã†ï¼š

> ã‚·ã‚¹ãƒ†ãƒ ã¨ã—ã¦ã€ã·ã‚ˆãŒç”»é¢ä¸Šç«¯ã«åˆ°é”ã—ãŸã‚‰ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ã«ãªã‚‹
>
> ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¨ã—ã¦ã€ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼å¾Œã«ãƒªã‚¹ã‚¿ãƒ¼ãƒˆã§ãã‚‹

ã€Œã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ã«ãªã£ãŸã‚‰ã€ã‚‚ã†ä¸€åº¦éŠã¹ãªã„ã¨å›°ã‚Šã¾ã™ã‚ˆã­ï¼Ÿã€ãã†ã§ã™ï¼ã ã‹ã‚‰ã€ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ã®åˆ¤å®šã ã‘ã§ãªãã€ãƒªã‚¹ã‚¿ãƒ¼ãƒˆæ©Ÿèƒ½ã‚‚ä¸€ç·’ã«å®Ÿè£…ã—ã¾ã™ã‚ˆã€‚

### TODO ãƒªã‚¹ãƒˆ

ã•ã¦ã€ã“ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚’å®Ÿç¾ã™ã‚‹ãŸã‚ã«ã€ã©ã‚“ãªã‚¿ã‚¹ã‚¯ãŒå¿…è¦ã§ã—ã‚‡ã†ã‹ï¼Ÿä¸€ç·’ã«è€ƒãˆã¦ã¿ã¾ã—ã‚‡ã†ï¼š

- ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ã®ã‚²ãƒ¼ãƒ ãƒ¢ãƒ¼ãƒ‰ã‚’è¿½åŠ ã™ã‚‹
- æ–°ã—ã„ã·ã‚ˆãƒšã‚¢ã‚’ç”Ÿæˆã§ããªã„å ´åˆã«ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ã¨åˆ¤å®šã™ã‚‹
- ãƒªã‚¹ã‚¿ãƒ¼ãƒˆæ©Ÿèƒ½ã‚’å®Ÿè£…ã™ã‚‹

ã€Œãªã‚‹ã»ã©ã€é †ç•ªã«å®Ÿè£…ã—ã¦ã„ã‘ã°ã„ã„ã‚“ã§ã™ã­ï¼ã€ãã†ã§ã™ã€‚ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã®æµã‚Œã«æ²¿ã£ã¦ã€ã¾ãšã¯ãƒ†ã‚¹ãƒˆã‹ã‚‰æ›¸ã„ã¦ã„ãã¾ã—ã‚‡ã†ï¼

### ãƒ†ã‚¹ãƒˆ: ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼åˆ¤å®š

ã€Œæœ€åˆã«ä½•ã‚’ãƒ†ã‚¹ãƒˆã™ã‚Œã°ã„ã„ã‚“ã§ã—ã‚‡ã†ã‹ï¼Ÿã€ã¾ãšã¯ã€ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ã®åˆ¤å®šãƒ­ã‚¸ãƒƒã‚¯ã‹ã‚‰ãƒ†ã‚¹ãƒˆã—ã¦ã„ãã¾ã—ã‚‡ã†ã€‚æ–°ã—ã„ã·ã‚ˆãƒšã‚¢ãŒé…ç½®ã§ããªã„å ´åˆã«ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ã«ãªã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã™ã€‚

> ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆ
>
> ã„ã¤ãƒ†ã‚¹ãƒˆã‚’æ›¸ãã¹ãã ã‚ã†ã‹â€”â€”ãã‚Œã¯ãƒ†ã‚¹ãƒˆå¯¾è±¡ã®ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãå‰ã ã€‚
>
> â€” Kent Beck ã€ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã€

```csharp
// Assets/Scripts/Tests/EditMode/GameTest.cs ã«è¿½åŠ 
[Test]
public void å‡ºç¾ä½ç½®ãŒåŸ‹ã¾ã£ã¦ã„ã‚‹ã¨ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ã«ãªã‚‹()
{
    // Arrange
    // å‡ºç¾ä½ç½® (2, 0) ã«ã·ã‚ˆã‚’é…ç½®
    game.Board.Set(0, 2, PuyoColor.Red);

    // Act - æ–°ã—ã„ã·ã‚ˆãƒšã‚¢ã‚’ç”Ÿæˆã—ã‚ˆã†ã¨ã™ã‚‹
    // å†…éƒ¨çš„ã« SpawnNewPair ãŒå‘¼ã°ã‚Œã‚‹
    game.Mode = GameMode.Checking;
    game.Update(0f); // Checking -> Playing (SpawnNewPairãŒå‘¼ã°ã‚Œã‚‹)

    // Assert - ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ãƒ¢ãƒ¼ãƒ‰ã«ãªã£ã¦ã„ã‚‹
    Assert.AreEqual(GameMode.GameOver, game.Mode);
    Assert.IsNull(game.CurrentPair);
}

[Test]
public void å‡ºç¾ä½ç½®ãŒç©ºã„ã¦ã„ã‚‹ã¨ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ã«ãªã‚‰ãªã„()
{
    // Arrange - å‡ºç¾ä½ç½®ã‚’ç©ºã‘ã¦ãŠãï¼ˆä½•ã‚‚é…ç½®ã—ãªã„ï¼‰

    // Act - æ–°ã—ã„ã·ã‚ˆãƒšã‚¢ã‚’ç”Ÿæˆ
    game.Mode = GameMode.Checking;
    game.Update(0f);

    // Assert - ãƒ—ãƒ¬ã‚¤ãƒ¢ãƒ¼ãƒ‰ã®ã¾ã¾ã§ã‚ã‚‹
    Assert.AreNotEqual(GameMode.GameOver, game.Mode);
    Assert.IsNotNull(game.CurrentPair);
}
```

ã€Œã“ã®ãƒ†ã‚¹ãƒˆã§ã¯ä½•ã‚’ç¢ºèªã—ã¦ã„ã‚‹ã‚“ã§ã™ã‹ï¼Ÿã€ã“ã®ãƒ†ã‚¹ãƒˆã§ã¯ã€ä»¥ä¸‹ã® 2 ã¤ã®ã‚±ãƒ¼ã‚¹ã‚’ç¢ºèªã—ã¦ã„ã¾ã™ï¼š

1. å‡ºç¾ä½ç½®ã«ã·ã‚ˆãŒã‚ã‚‹å ´åˆã€ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ã«ãªã‚‹ã‹
2. å‡ºç¾ä½ç½®ãŒç©ºã„ã¦ã„ã‚‹å ´åˆã€ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ã«ãªã‚‰ãªã„ã‹

ã€Œå‡ºç¾ä½ç½®ã£ã¦ã€ã©ã“ã§ã™ã‹ï¼Ÿã€è‰¯ã„è³ªå•ã§ã™ã­ï¼ã·ã‚ˆãƒšã‚¢ã¯ç”»é¢ä¸Šéƒ¨ã®ä¸­å¤®ï¼ˆX åº§æ¨™ 2ã€Y åº§æ¨™ 0ï¼‰ã«å‡ºç¾ã—ã¾ã™ã€‚ãã“ã«æ—¢ã«ã·ã‚ˆãŒã‚ã‚‹ã¨ã€æ–°ã—ã„ã·ã‚ˆãƒšã‚¢ã‚’é…ç½®ã§ããªã„ã®ã§ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ã«ãªã‚‹ã‚“ã§ã™ã€‚

### å®Ÿè£…: ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼åˆ¤å®š

ãƒ†ã‚¹ãƒˆã‚’æ›¸ã„ãŸã‚‰ã€æ¬¡ã«å®Ÿè£…ã—ã¾ã—ã‚‡ã†ã€‚ã©ã†ãªã‚‹ã§ã—ã‚‡ã†ã‹ï¼Ÿ

```bash
dotnet cake --target=Test
```

```
undefined: GameMode.GameOver
```

ãŠã£ã¨ï¼`GameMode.GameOver` ãŒã¾ã å®šç¾©ã•ã‚Œã¦ã„ã¾ã›ã‚“ã­ã€‚ã“ã‚ŒãŒãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã®ã€ŒRedï¼ˆèµ¤ï¼‰ã€ã®çŠ¶æ…‹ã§ã™ã€‚

> æ˜ç™½ãªå®Ÿè£…
>
> ã‚·ãƒ³ãƒ—ãƒ«ãªæ“ä½œã‚’ã©ã†å®Ÿè£…ã™ã‚Œã°ã„ã„ã ã‚ã†ã‹ã€‚ãŸã å®Ÿè£…ã™ã‚Œã°ã„ã„ã®ã ã€‚
>
> â€” Kent Beck ã€ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã€

ã§ã¯ã€ãƒ†ã‚¹ãƒˆã‚’é€šã™ãŸã‚ã®å®Ÿè£…ã‚’æ›¸ã„ã¦ã„ãã¾ã—ã‚‡ã†ï¼š

```csharp
// Assets/Scripts/Core/Game.cs ã‚’ä¿®æ­£
public enum GameMode
{
    Playing,    // ã·ã‚ˆãƒšã‚¢æ“ä½œä¸­
    Falling,    // é‡åŠ›å‡¦ç†ä¸­
    Checking,   // æ¶ˆå»ãƒã‚§ãƒƒã‚¯ä¸­
    GameOver    // ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼
}

private void SpawnNewPair()
{
    PuyoColor axisColor = GetRandomColor();
    PuyoColor childColor = GetRandomColor();

    Pair newPair = new Pair(SPAWN_X, SPAWN_Y, axisColor, childColor);

    // ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼åˆ¤å®šï¼šæ–°ã—ã„ã·ã‚ˆãƒšã‚¢ãŒé…ç½®ã§ãã‚‹ã‹ãƒã‚§ãƒƒã‚¯
    if (newPair.IsCollision(Board, newPair.AxisX, newPair.AxisY,
        newPair.ChildX, newPair.ChildY))
    {
        // é…ç½®ã§ããªã„å ´åˆã¯ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼
        Mode = GameMode.GameOver;
        CurrentPair = null;
        return;
    }

    // é…ç½®ã§ãã‚‹å ´åˆã¯é€šå¸¸é€šã‚Šã‚»ãƒƒãƒˆ
    CurrentPair = newPair;
    fallTimer = 0f;
}
```

ã€Œãªã‚‹ã»ã©ã€`SpawnNewPair` ã§è¡çªåˆ¤å®šã‚’ã—ã¦ã€é…ç½®ã§ããªã„å ´åˆã¯ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ã«ã™ã‚‹ã‚“ã§ã™ã­ï¼ã€ãã†ã§ã™ã€‚æ–°ã—ã„ã·ã‚ˆãƒšã‚¢ã‚’ä½œæˆã—ã¦ã‹ã‚‰ã€å®Ÿéš›ã«é…ç½®ã™ã‚‹å‰ã«è¡çªåˆ¤å®šã‚’è¡Œã„ã¾ã™ã€‚é…ç½®ã§ããªã‘ã‚Œã°ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ã€é…ç½®ã§ãã‚Œã°é€šå¸¸é€šã‚Šã‚²ãƒ¼ãƒ ã‚’ç¶šã‘ã¾ã™ã€‚

ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼š

```bash
dotnet cake --target=Test
```

```
âœ… å‡ºç¾ä½ç½®ãŒåŸ‹ã¾ã£ã¦ã„ã‚‹ã¨ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ã«ãªã‚‹
âœ… å‡ºç¾ä½ç½®ãŒç©ºã„ã¦ã„ã‚‹ã¨ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ã«ãªã‚‰ãªã„
```

ã‚„ã£ãŸï¼ãƒ†ã‚¹ãƒˆãŒé€šã‚Šã¾ã—ãŸã€‚ã“ã‚ŒãŒã€ŒGreenï¼ˆç·‘ï¼‰ã€ã®çŠ¶æ…‹ã§ã™ã€‚

### ãƒ†ã‚¹ãƒˆ: ãƒªã‚¹ã‚¿ãƒ¼ãƒˆæ©Ÿèƒ½

æ¬¡ã¯ã€ãƒªã‚¹ã‚¿ãƒ¼ãƒˆæ©Ÿèƒ½ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã—ã‚‡ã†ã€‚

```csharp
// Assets/Scripts/Tests/EditMode/GameTest.cs ã«è¿½åŠ 
[Test]
public void ãƒªã‚¹ã‚¿ãƒ¼ãƒˆã™ã‚‹ã¨ã‚²ãƒ¼ãƒ ãŒåˆæœŸçŠ¶æ…‹ã«æˆ»ã‚‹()
{
    // Arrange - ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼çŠ¶æ…‹ã«ã™ã‚‹
    game.Board.Set(0, 2, PuyoColor.Red);
    game.Mode = GameMode.Checking;
    game.Update(0f); // ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ã«ãªã‚‹

    // ã‚¹ã‚³ã‚¢ã‚‚åŠ ç®—ã—ã¦ãŠã
    game.Score.Add(100, 1);

    // Act - ãƒªã‚¹ã‚¿ãƒ¼ãƒˆ
    game.Restart();

    // Assert
    Assert.AreEqual(GameMode.Playing, game.Mode);
    Assert.IsNotNull(game.CurrentPair);
    Assert.AreEqual(0, game.Score.Total);
    Assert.AreEqual(0, game.Score.Chain);
    // ãƒœãƒ¼ãƒ‰ãŒã‚¯ãƒªã‚¢ã•ã‚Œã¦ã„ã‚‹
    Assert.AreEqual(PuyoColor.None, game.Board.Get(0, 2));
}
```

### å®Ÿè£…: ãƒªã‚¹ã‚¿ãƒ¼ãƒˆæ©Ÿèƒ½

ãƒ†ã‚¹ãƒˆã‚’é€šã™ãŸã‚ã®å®Ÿè£…ã‚’æ›¸ãã¾ã—ã‚‡ã†ï¼š

```csharp
// Assets/Scripts/Core/Game.cs ã«è¿½åŠ 
public void Restart()
{
    // ãƒœãƒ¼ãƒ‰ã‚’ã‚¯ãƒªã‚¢
    Board = new Board();

    // ã‚¹ã‚³ã‚¢ã‚’ãƒªã‚»ãƒƒãƒˆ
    Score = new Score();

    // ãƒ¢ãƒ¼ãƒ‰ã‚’ãƒ—ãƒ¬ã‚¤ãƒ¢ãƒ¼ãƒ‰ã«
    Mode = GameMode.Playing;

    // æ–°ã—ã„ã·ã‚ˆãƒšã‚¢ã‚’ç”Ÿæˆ
    SpawnNewPair();

    // ã‚¿ã‚¤ãƒãƒ¼ã‚’ãƒªã‚»ãƒƒãƒˆ
    fallTimer = 0f;
}
```

ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼š

```bash
dotnet cake --target=Test
```

```
âœ… ãƒªã‚¹ã‚¿ãƒ¼ãƒˆã™ã‚‹ã¨ã‚²ãƒ¼ãƒ ãŒåˆæœŸçŠ¶æ…‹ã«æˆ»ã‚‹
```

ç´ æ™´ã‚‰ã—ã„ï¼ãƒ†ã‚¹ãƒˆãŒé€šã‚Šã¾ã—ãŸã€‚

### ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼æ™‚ã®æ›´æ–°å‡¦ç†

ã€Œã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼æ™‚ã¯ã€é€šå¸¸ã®æ›´æ–°å‡¦ç†ã‚’ã‚¹ã‚­ãƒƒãƒ—ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã­ï¼Ÿã€ãã†ã§ã™ã€‚`Update` ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä¿®æ­£ã—ã¾ã—ã‚‡ã†ã€‚

```csharp
// Assets/Scripts/Core/Game.cs ã‚’ä¿®æ­£
public void Update(float deltaTime)
{
    // ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ä¸­ã¯ä½•ã‚‚ã—ãªã„
    if (Mode == GameMode.GameOver)
    {
        return;
    }

    switch (Mode)
    {
        case GameMode.Playing:
            UpdatePlaying(deltaTime);
            break;

        case GameMode.Falling:
            UpdateFalling();
            break;

        case GameMode.Checking:
            UpdateChecking();
            break;
    }
}
```

### ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ 7 ã®ã¾ã¨ã‚

ãŠç–²ã‚Œæ§˜ã§ã—ãŸï¼ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ 7 ã§å®Ÿè£…ã—ãŸå†…å®¹ã‚’æŒ¯ã‚Šè¿”ã£ã¦ã¿ã¾ã—ã‚‡ã†ï¼š

1. **ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼åˆ¤å®š**
   - æ–°ã—ã„ã·ã‚ˆãƒšã‚¢ãŒé…ç½®ã§ããªã„å ´åˆã«ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼
   - `GameMode.GameOver` ã®è¿½åŠ 
   - `SpawnNewPair` ã§ã®è¡çªãƒã‚§ãƒƒã‚¯

2. **ãƒªã‚¹ã‚¿ãƒ¼ãƒˆæ©Ÿèƒ½**
   - `Restart()` ãƒ¡ã‚½ãƒƒãƒ‰ã«ã‚ˆã‚‹ã‚²ãƒ¼ãƒ åˆæœŸåŒ–
   - ãƒœãƒ¼ãƒ‰ã€ã‚¹ã‚³ã‚¢ã€ãƒ¢ãƒ¼ãƒ‰ã€ã‚¿ã‚¤ãƒãƒ¼ã®ãƒªã‚»ãƒƒãƒˆ

3. **ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼æ™‚ã®æ›´æ–°å‡¦ç†**
   - ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ä¸­ã¯é€šå¸¸ã®æ›´æ–°å‡¦ç†ã‚’ã‚¹ã‚­ãƒƒãƒ—

4. **ãƒ†ã‚¹ãƒˆ**: 3 å€‹ã®æ–°ã—ã„ãƒ†ã‚¹ãƒˆã‚’è¿½åŠ 
   - å‡ºç¾ä½ç½®ãŒåŸ‹ã¾ã£ã¦ã„ã‚‹ã¨ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ã«ãªã‚‹
   - å‡ºç¾ä½ç½®ãŒç©ºã„ã¦ã„ã‚‹ã¨ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ã«ãªã‚‰ãªã„
   - ãƒªã‚¹ã‚¿ãƒ¼ãƒˆã™ã‚‹ã¨ã‚²ãƒ¼ãƒ ãŒåˆæœŸçŠ¶æ…‹ã«æˆ»ã‚‹

ã“ã‚Œã§ã€ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ã®åˆ¤å®šã¨ãƒªã‚¹ã‚¿ãƒ¼ãƒˆæ©Ÿèƒ½ãŒå®Ÿè£…ã§ãã¾ã—ãŸï¼æ¬¡ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ã€å…¨æ¶ˆã—ãƒœãƒ¼ãƒŠã‚¹ã‚’å®Ÿè£…ã—ã¦ã„ãã¾ã™ã€‚

```bash
git add .
git commit -m 'feat: ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼åˆ¤å®šã¨ãƒªã‚¹ã‚¿ãƒ¼ãƒˆæ©Ÿèƒ½ã‚’å®Ÿè£…

- é…ç½®ä¸å¯èƒ½æ™‚ã®ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼åˆ¤å®š
- Restart ãƒ¡ã‚½ãƒƒãƒ‰ã®å®Ÿè£…
- ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼æ™‚ã®æ›´æ–°å‡¦ç†ã‚¹ã‚­ãƒƒãƒ—
- 3å€‹ã®ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã‚’è¿½åŠ '
```

---
## ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ 8: å…¨æ¶ˆã—ãƒœãƒ¼ãƒŠã‚¹

ã€Œã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ãŒå®Ÿè£…ã§ãã¾ã—ãŸã­ï¼æ¬¡ã¯ä½•ã‚’ã—ã¾ã™ã‹ï¼Ÿã€æ¬¡ã¯ã€ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®è…•å‰ã‚’è¤’ã‚ã‚‹ã€Œå…¨æ¶ˆã—ãƒœãƒ¼ãƒŠã‚¹ã€ã‚’å®Ÿè£…ã—ã¾ã—ã‚‡ã†ï¼ã™ã¹ã¦ã®ã·ã‚ˆã‚’æ¶ˆã—ãŸã¨ãã«ç‰¹åˆ¥ãªãƒœãƒ¼ãƒŠã‚¹ç‚¹ã‚’ä¸ãˆã‚‹æ©Ÿèƒ½ã§ã™ã€‚

### ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼

ã¾ãšã¯ã€ã“ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§å®Ÿè£…ã™ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚’ç¢ºèªã—ã¾ã—ã‚‡ã†ï¼š

> ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¨ã—ã¦ã€ã™ã¹ã¦ã®ã·ã‚ˆã‚’æ¶ˆã—ãŸã¨ãã«å…¨æ¶ˆã—ãƒœãƒ¼ãƒŠã‚¹ã‚’å¾—ã‚‰ã‚Œã‚‹

ã€Œå…¨éƒ¨æ¶ˆã—ãŸã¨ãã£ã¦ã€ã™ã”ã„é”æˆæ„ŸãŒã‚ã‚Šã¾ã™ã‚ˆã­ï¼ã€ãã†ã§ã™ã­ï¼ãã‚Œã«è¦‹åˆã£ãŸãƒœãƒ¼ãƒŠã‚¹ã‚’ä¸ãˆã‚‹ã“ã¨ã§ã€ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®ãƒ¢ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é«˜ã‚ã¾ã™ã€‚

### TODO ãƒªã‚¹ãƒˆ

ã•ã¦ã€ã“ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚’å®Ÿç¾ã™ã‚‹ãŸã‚ã«ã€ã©ã‚“ãªã‚¿ã‚¹ã‚¯ãŒå¿…è¦ã§ã—ã‚‡ã†ã‹ï¼Ÿä¸€ç·’ã«è€ƒãˆã¦ã¿ã¾ã—ã‚‡ã†ï¼š

- ãƒœãƒ¼ãƒ‰ãŒç©ºã‹ã©ã†ã‹åˆ¤å®šã™ã‚‹æ©Ÿèƒ½ã‚’å®Ÿè£…ã™ã‚‹
- å…¨æ¶ˆã—ãƒœãƒ¼ãƒŠã‚¹ã‚’ã‚¹ã‚³ã‚¢ã«åŠ ç®—ã™ã‚‹æ©Ÿèƒ½ã‚’å®Ÿè£…ã™ã‚‹
- æ¶ˆå»å¾Œã«å…¨æ¶ˆã—ãƒã‚§ãƒƒã‚¯ã‚’è¡Œã†

ã€Œãªã‚‹ã»ã©ã€é †ç•ªã«å®Ÿè£…ã—ã¦ã„ã‘ã°ã„ã„ã‚“ã§ã™ã­ï¼ã€ãã†ã§ã™ã€‚ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã®æµã‚Œã«æ²¿ã£ã¦ã€ã¾ãšã¯ãƒ†ã‚¹ãƒˆã‹ã‚‰æ›¸ã„ã¦ã„ãã¾ã—ã‚‡ã†ï¼

### ãƒ†ã‚¹ãƒˆ: ãƒœãƒ¼ãƒ‰ã®å…¨æ¶ˆã—åˆ¤å®š

ã€Œæœ€åˆã«ä½•ã‚’ãƒ†ã‚¹ãƒˆã™ã‚Œã°ã„ã„ã‚“ã§ã—ã‚‡ã†ã‹ï¼Ÿã€ã¾ãšã¯ã€ãƒœãƒ¼ãƒ‰ãŒç©ºã‹ã©ã†ã‹ã‚’åˆ¤å®šã™ã‚‹æ©Ÿèƒ½ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã—ã‚‡ã†ã€‚

> ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆ
>
> ã„ã¤ãƒ†ã‚¹ãƒˆã‚’æ›¸ãã¹ãã ã‚ã†ã‹â€”â€”ãã‚Œã¯ãƒ†ã‚¹ãƒˆå¯¾è±¡ã®ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãå‰ã ã€‚
>
> â€” Kent Beck ã€ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã€

```csharp
// Assets/Scripts/Tests/EditMode/BoardTest.cs ã«è¿½åŠ 
[Test]
public void ãƒœãƒ¼ãƒ‰ãŒç©ºã®å ´åˆã¯å…¨æ¶ˆã—ã¨åˆ¤å®šã•ã‚Œã‚‹()
{
    // Arrange
    var board = new Board();
    // ä½•ã‚‚é…ç½®ã—ãªã„

    // Act
    bool isAllClear = board.IsAllClear();

    // Assert
    Assert.IsTrue(isAllClear);
}

[Test]
public void ãƒœãƒ¼ãƒ‰ã«ã·ã‚ˆãŒã‚ã‚‹å ´åˆã¯å…¨æ¶ˆã—ã¨åˆ¤å®šã•ã‚Œãªã„()
{
    // Arrange
    var board = new Board();
    board.Set(11, 2, PuyoColor.Red);

    // Act
    bool isAllClear = board.IsAllClear();

    // Assert
    Assert.IsFalse(isAllClear);
}
```

### å®Ÿè£…: ãƒœãƒ¼ãƒ‰ã®å…¨æ¶ˆã—åˆ¤å®š

ãƒ†ã‚¹ãƒˆã‚’é€šã™ãŸã‚ã®å®Ÿè£…ã‚’æ›¸ãã¾ã—ã‚‡ã†ï¼š

```csharp
// Assets/Scripts/Core/Board.cs ã«è¿½åŠ 
public bool IsAllClear()
{
    for (int row = 0; row < ROWS; row++)
    {
        for (int col = 0; col < COLS; col++)
        {
            if (cells[row, col] != PuyoColor.None)
            {
                return false;
            }
        }
    }
    return true;
}
```

ã€Œã‚·ãƒ³ãƒ—ãƒ«ã§ã™ã­ï¼ã€ãã†ã§ã™ã­ã€‚å…¨ãƒã‚¹ã‚’èµ°æŸ»ã—ã¦ã€1 ã¤ã§ã‚‚ã·ã‚ˆãŒã‚ã‚Œã° `false` ã‚’è¿”ã—ã¾ã™ã€‚

ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼š

```bash
dotnet cake --target=Test
```

```
âœ… ãƒœãƒ¼ãƒ‰ãŒç©ºã®å ´åˆã¯å…¨æ¶ˆã—ã¨åˆ¤å®šã•ã‚Œã‚‹
âœ… ãƒœãƒ¼ãƒ‰ã«ã·ã‚ˆãŒã‚ã‚‹å ´åˆã¯å…¨æ¶ˆã—ã¨åˆ¤å®šã•ã‚Œãªã„
```

ã‚„ã£ãŸï¼ãƒ†ã‚¹ãƒˆãŒé€šã‚Šã¾ã—ãŸã€‚

### ãƒ†ã‚¹ãƒˆ: å…¨æ¶ˆã—ãƒœãƒ¼ãƒŠã‚¹ã®åŠ ç®—

æ¬¡ã¯ã€å…¨æ¶ˆã—ãƒœãƒ¼ãƒŠã‚¹ã‚’ã‚¹ã‚³ã‚¢ã«åŠ ç®—ã™ã‚‹æ©Ÿèƒ½ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã—ã‚‡ã†ã€‚

```csharp
// Assets/Scripts/Tests/EditMode/ScoreTest.cs ã«è¿½åŠ 
[Test]
public void å…¨æ¶ˆã—ãƒœãƒ¼ãƒŠã‚¹ã‚’åŠ ç®—ã§ãã‚‹()
{
    // Arrange
    int initialScore = score.Total;

    // Act
    score.AddAllClearBonus();

    // Assert - 5000ç‚¹ã®ãƒœãƒ¼ãƒŠã‚¹ãŒåŠ ç®—ã•ã‚Œã‚‹
    Assert.AreEqual(initialScore + 5000, score.Total);
}
```

### å®Ÿè£…: å…¨æ¶ˆã—ãƒœãƒ¼ãƒŠã‚¹ã®åŠ ç®—

ãƒ†ã‚¹ãƒˆã‚’é€šã™ãŸã‚ã®å®Ÿè£…ã‚’æ›¸ãã¾ã—ã‚‡ã†ï¼š

```csharp
// Assets/Scripts/Core/Score.cs ã«è¿½åŠ 
public void AddAllClearBonus()
{
    Total += 5000;
}
```

ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼š

```bash
dotnet cake --target=Test
```

```
âœ… å…¨æ¶ˆã—ãƒœãƒ¼ãƒŠã‚¹ã‚’åŠ ç®—ã§ãã‚‹
```

ç´ æ™´ã‚‰ã—ã„ï¼ãƒ†ã‚¹ãƒˆãŒé€šã‚Šã¾ã—ãŸã€‚

### ã‚²ãƒ¼ãƒ ã¸ã®çµ±åˆ

ã€Œå…¨æ¶ˆã—åˆ¤å®šã¨ãƒœãƒ¼ãƒŠã‚¹åŠ ç®—ãŒã§ããŸã®ã§ã€ã‚²ãƒ¼ãƒ ã«çµ„ã¿è¾¼ã¿ã¾ã—ã‚‡ã†ï¼ã€ãã†ã§ã™ã­ã€‚`Game` ã‚¯ãƒ©ã‚¹ã®æ¶ˆå»å‡¦ç†ã«å…¨æ¶ˆã—ãƒã‚§ãƒƒã‚¯ã‚’è¿½åŠ ã—ã¾ã™ã€‚

```csharp
// Assets/Scripts/Core/Game.cs ã‚’ä¿®æ­£
private void UpdateChecking()
{
    // æ¶ˆå»åˆ¤å®š
    var positions = Board.CheckErase();

    if (positions.Count > 0)
    {
        // é€£é–æ•°ã‚’ã‚¤ãƒ³ã‚¯ãƒªãƒ¡ãƒ³ãƒˆ
        Score.IncrementChain();

        // ã‚¹ã‚³ã‚¢ã‚’åŠ ç®—
        Score.Add(positions.Count, Score.Chain);

        // æ¶ˆå»å¯¾è±¡ãŒã‚ã‚‹å ´åˆã€æ¶ˆå»ã—ã¦é‡åŠ›å‡¦ç†ã¸
        Board.Erase(positions);

        // å…¨æ¶ˆã—ãƒã‚§ãƒƒã‚¯
        if (Board.IsAllClear())
        {
            Score.AddAllClearBonus();
        }

        Mode = GameMode.Falling;
    }
    else
    {
        // æ¶ˆå»å¯¾è±¡ãŒãªã„å ´åˆã€é€£é–çµ‚äº†
        Score.ResetChain();

        // æ–°ã—ã„ã·ã‚ˆãƒšã‚¢ã‚’ç”Ÿæˆ
        SpawnNewPair();
        Mode = GameMode.Playing;
    }
}
```

ã€Œãªã‚‹ã»ã©ã€ã·ã‚ˆã‚’æ¶ˆå»ã—ãŸå¾Œã«å…¨æ¶ˆã—ãƒã‚§ãƒƒã‚¯ã‚’è¡Œã£ã¦ã€å…¨æ¶ˆã—ã®å ´åˆã¯ãƒœãƒ¼ãƒŠã‚¹ã‚’åŠ ç®—ã™ã‚‹ã‚“ã§ã™ã­ï¼ã€ãã†ã§ã™ã€‚ã“ã®å®Ÿè£…ã§ã¯ã€ä»¥ä¸‹ã®ã“ã¨ã‚’è¡Œã£ã¦ã„ã¾ã™ï¼š

1. ã·ã‚ˆã‚’æ¶ˆå»
2. ãƒœãƒ¼ãƒ‰ãŒç©ºã«ãªã£ã¦ã„ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
3. å…¨æ¶ˆã—ã®å ´åˆã€5000 ç‚¹ã®ãƒœãƒ¼ãƒŠã‚¹ã‚’åŠ ç®—

### ãƒ†ã‚¹ãƒˆ: å…¨æ¶ˆã—ãƒœãƒ¼ãƒŠã‚¹ã®å‹•ä½œç¢ºèª

ã€Œå…¨æ¶ˆã—ãƒœãƒ¼ãƒŠã‚¹ãŒæœ¬å½“ã«å‹•ä½œã™ã‚‹ã‹ãƒ†ã‚¹ãƒˆã—ãŸã„ã§ã™ï¼ã€ã„ã„ã§ã™ã­ï¼å…¨æ¶ˆã—ãƒœãƒ¼ãƒŠã‚¹ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã—ã‚‡ã†ã€‚

```csharp
// Assets/Scripts/Tests/EditMode/GameTest.cs ã«è¿½åŠ 
[Test]
public void ã™ã¹ã¦ã®ã·ã‚ˆã‚’æ¶ˆã—ãŸã¨ãã«å…¨æ¶ˆã—ãƒœãƒ¼ãƒŠã‚¹ãŒåŠ ç®—ã•ã‚Œã‚‹()
{
    // Arrange - ãƒœãƒ¼ãƒ‰ã«ã·ã‚ˆã‚’4ã¤ã ã‘é…ç½®
    game.Board.Set(11, 2, PuyoColor.Red);
    game.Board.Set(10, 2, PuyoColor.Red);
    game.Board.Set(9, 2, PuyoColor.Red);
    game.Board.Set(8, 2, PuyoColor.Red);

    // Act - æ¶ˆå»å‡¦ç†ã‚’å®Ÿè¡Œ
    game.Mode = GameMode.Checking;
    game.Update(0f);

    // Assert - åŸºæœ¬ã‚¹ã‚³ã‚¢ + å…¨æ¶ˆã—ãƒœãƒ¼ãƒŠã‚¹
    // åŸºæœ¬ã‚¹ã‚³ã‚¢: 4 Ã— 10 Ã— 1 = 40
    // å…¨æ¶ˆã—ãƒœãƒ¼ãƒŠã‚¹: 5000
    // åˆè¨ˆ: 5040
    Assert.AreEqual(5040, game.Score.Total);
    Assert.IsTrue(game.Board.IsAllClear());
}
```

ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼š

```bash
dotnet cake --target=Test
```

```
âœ… ã™ã¹ã¦ã®ã·ã‚ˆã‚’æ¶ˆã—ãŸã¨ãã«å…¨æ¶ˆã—ãƒœãƒ¼ãƒŠã‚¹ãŒåŠ ç®—ã•ã‚Œã‚‹
```

ç´ æ™´ã‚‰ã—ã„ï¼å…¨æ¶ˆã—ãƒœãƒ¼ãƒŠã‚¹ãŒæ­£ã—ãå‹•ä½œã—ã¦ã„ã¾ã™ï¼

### ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ 8 ã®ã¾ã¨ã‚

ãŠç–²ã‚Œæ§˜ã§ã—ãŸï¼ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ 8 ã§å®Ÿè£…ã—ãŸå†…å®¹ã‚’æŒ¯ã‚Šè¿”ã£ã¦ã¿ã¾ã—ã‚‡ã†ï¼š

1. **ãƒœãƒ¼ãƒ‰ã®å…¨æ¶ˆã—åˆ¤å®š**
   - `IsAllClear()`: ãƒœãƒ¼ãƒ‰ãŒç©ºã‹ã©ã†ã‹åˆ¤å®š
   - å…¨ãƒã‚¹ã‚’èµ°æŸ»ã—ã¦ã·ã‚ˆã®æœ‰ç„¡ã‚’ãƒã‚§ãƒƒã‚¯

2. **å…¨æ¶ˆã—ãƒœãƒ¼ãƒŠã‚¹ã®åŠ ç®—**
   - `AddAllClearBonus()`: 5000 ç‚¹ã®ãƒœãƒ¼ãƒŠã‚¹ã‚’åŠ ç®—
   - `Score` ã‚¯ãƒ©ã‚¹ã«è¿½åŠ 

3. **ã‚²ãƒ¼ãƒ ã¸ã®çµ±åˆ**
   - `UpdateChecking()` ã§æ¶ˆå»å¾Œã«å…¨æ¶ˆã—ãƒã‚§ãƒƒã‚¯
   - å…¨æ¶ˆã—ã®å ´åˆã¯ãƒœãƒ¼ãƒŠã‚¹ã‚’åŠ ç®—

4. **ãƒ†ã‚¹ãƒˆ**: 3 å€‹ã®æ–°ã—ã„ãƒ†ã‚¹ãƒˆã‚’è¿½åŠ 
   - ãƒœãƒ¼ãƒ‰ãŒç©ºã®å ´åˆã¯å…¨æ¶ˆã—ã¨åˆ¤å®šã•ã‚Œã‚‹
   - ãƒœãƒ¼ãƒ‰ã«ã·ã‚ˆãŒã‚ã‚‹å ´åˆã¯å…¨æ¶ˆã—ã¨åˆ¤å®šã•ã‚Œãªã„
   - å…¨æ¶ˆã—ãƒœãƒ¼ãƒŠã‚¹ã‚’åŠ ç®—ã§ãã‚‹
   - ã™ã¹ã¦ã®ã·ã‚ˆã‚’æ¶ˆã—ãŸã¨ãã«å…¨æ¶ˆã—ãƒœãƒ¼ãƒŠã‚¹ãŒåŠ ç®—ã•ã‚Œã‚‹

ã“ã‚Œã§ã€å…¨æ¶ˆã—ãƒœãƒ¼ãƒŠã‚¹æ©Ÿèƒ½ãŒå®Ÿè£…ã§ãã¾ã—ãŸï¼æ¬¡ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ã€æœ€çµ‚èª¿æ•´ã‚’è¡Œã„ã¾ã™ã€‚

```bash
git add .
git commit -m 'feat: å…¨æ¶ˆã—ãƒœãƒ¼ãƒŠã‚¹ã‚’å®Ÿè£…

- ãƒœãƒ¼ãƒ‰ã®å…¨æ¶ˆã—åˆ¤å®šæ©Ÿèƒ½
- å…¨æ¶ˆã—ãƒœãƒ¼ãƒŠã‚¹ï¼ˆ5000ç‚¹ï¼‰ã®åŠ ç®—
- æ¶ˆå»å¾Œã®å…¨æ¶ˆã—ãƒã‚§ãƒƒã‚¯
- 4å€‹ã®ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã‚’è¿½åŠ '
```

---

## ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ 9: æœ€çµ‚èª¿æ•´ã¨å®Œæˆ

ã•ã¦ã€ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼åˆ¤å®šã¨å…¨æ¶ˆã—ãƒœãƒ¼ãƒŠã‚¹ã‚‚å®Ÿè£…ã§ãã¾ã—ãŸã­ï¼ã€Œã“ã‚Œã§ã·ã‚ˆã·ã‚ˆã‚²ãƒ¼ãƒ ãŒå®Œæˆã—ãŸã‚“ã§ã™ã‹ï¼Ÿã€åŸºæœ¬çš„ãªæ©Ÿèƒ½ã¯æƒã„ã¾ã—ãŸãŒã€ã‚‚ã†å°‘ã—ä½¿ã„ã‚„ã™ã•ã‚’å‘ä¸Šã•ã›ã‚‹èª¿æ•´ã‚’ã—ã¾ã—ã‚‡ã†ã€‚ã“ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ã€é«˜é€Ÿè½ä¸‹æ©Ÿèƒ½ã®è¿½åŠ ã€ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®æ”¹å–„ã€ãã—ã¦æœ€çµ‚çš„ãªä»•ä¸Šã’ã‚’è¡Œã„ã¾ã™ã€‚

### ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼

æœ€å¾Œã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§å®Ÿè£…ã™ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚’ç¢ºèªã—ã¾ã—ã‚‡ã†ï¼š

> ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¨ã—ã¦ã€ä¸‹ã‚­ãƒ¼ã‚’æŠ¼ã—ã¦ã·ã‚ˆã‚’é«˜é€Ÿè½ä¸‹ã•ã›ãŸã„
>
> é–‹ç™ºè€…ã¨ã—ã¦ã€ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆã«é©åˆ‡ã«å‡¦ç†ã—ãŸã„

ã€Œé«˜é€Ÿè½ä¸‹ã£ã¦ä½•ã§ã™ã‹ï¼Ÿã€è‰¯ã„è³ªå•ã§ã™ã­ï¼é€šå¸¸ã€ã·ã‚ˆã¯è‡ªå‹•çš„ã«1ç§’ã«1ãƒã‚¹è½ä¸‹ã—ã¾ã™ãŒã€ä¸‹ã‚­ãƒ¼ã‚’æŠ¼ã—ã¦ã„ã‚‹é–“ã¯ã‚‚ã£ã¨é€Ÿãè½ä¸‹ã•ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®æ“ä½œæ€§ãŒå¤§å¹…ã«å‘ä¸Šã—ã¾ã™ã‚ˆã€‚

### TODOãƒªã‚¹ãƒˆ

ã“ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§è¡Œã†ã‚¿ã‚¹ã‚¯ã‚’æ•´ç†ã—ã¾ã—ã‚‡ã†ï¼š

- é«˜é€Ÿè½ä¸‹æ©Ÿèƒ½ã‚’è¿½åŠ ã™ã‚‹ï¼ˆä¸‹ã‚­ãƒ¼ã§å³åº§ã«1ãƒã‚¹è½ä¸‹ï¼‰
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚’è¿½åŠ ã™ã‚‹
- ãƒ­ã‚°å‡ºåŠ›ã‚’è¿½åŠ ã™ã‚‹ï¼ˆãƒ‡ãƒãƒƒã‚°ç”¨ï¼‰
- ã‚³ãƒ¼ãƒ‰å…¨ä½“ã®ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°
- æœ€çµ‚çš„ãªãƒ†ã‚¹ãƒˆå®Ÿè¡Œã¨ãƒ“ãƒ«ãƒ‰ç¢ºèª

ã€Œæœ€å¾Œã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãªã®ã§ã€ä¸å¯§ã«ä»•ä¸Šã’ã¦ã„ãã¾ã—ã‚‡ã†ï¼ã€ãã†ã§ã™ã­ã€‚ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã®ã‚µã‚¤ã‚¯ãƒ«ã«å¾“ã£ã¦ã€æœ€å¾Œã¾ã§å“è³ªã‚’ä¿ã¡ãªãŒã‚‰é€²ã‚ã¾ã™ã€‚

### ãƒ†ã‚¹ãƒˆ: é«˜é€Ÿè½ä¸‹æ©Ÿèƒ½

ã¾ãšã¯é«˜é€Ÿè½ä¸‹æ©Ÿèƒ½ã®ãƒ†ã‚¹ãƒˆã‹ã‚‰æ›¸ãã¾ã—ã‚‡ã†ï¼š

```csharp
// Assets/Tests/EditMode/GameTest.cs ã«è¿½åŠ 

[Test]
public void HandleInput_ä¸‹ã‚­ãƒ¼ã§ã·ã‚ˆãŒå³åº§ã«è½ä¸‹ã™ã‚‹()
{
    // Arrange
    Game game = new Game();
    game.Mode = GameMode.Playing;
    int initialY = game.CurrentPair.AxisY;

    // Act - Updateã‚’å‘¼ã¶ã¨é«˜é€Ÿè½ä¸‹ãŒå‡¦ç†ã•ã‚Œã‚‹
    // æ³¨: å®Ÿéš›ã®ã‚­ãƒ¼å…¥åŠ›ã¯UnityInputSystemã®ãƒ†ã‚¹ãƒˆã§æ‰±ã†ãŸã‚ã€
    // ã“ã“ã§ã¯HandleFastFallãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç›´æ¥ãƒ†ã‚¹ãƒˆã™ã‚‹
    if (game.CurrentPair.CanMoveDown(game.Board))
    {
        game.CurrentPair.MoveDown();
    }

    // Assert
    Assert.AreEqual(initialY + 1, game.CurrentPair.AxisY);
}

[Test]
public void HandleInput_é«˜é€Ÿè½ä¸‹ã§ç€åœ°ã™ã‚‹()
{
    // Arrange
    Game game = new Game();
    game.Mode = GameMode.Playing;

    // ä¸‹ã‹ã‚‰2ç•ªç›®ã¾ã§ç§»å‹•
    while (game.CurrentPair.CanMoveDown(game.Board))
    {
        game.CurrentPair.MoveDown();
    }
    int finalY = game.CurrentPair.AxisY;

    // Act - ã“ã‚Œä»¥ä¸Šä¸‹ã«ç§»å‹•ã§ããªã„
    bool canMove = game.CurrentPair.CanMoveDown(game.Board);

    // Assert
    Assert.IsFalse(canMove);
    Assert.AreEqual(finalY, game.CurrentPair.AxisY);
}
```

ã€Œå®Ÿéš›ã®ã‚­ãƒ¼å…¥åŠ›ã®ãƒ†ã‚¹ãƒˆã¯ã©ã†ã™ã‚‹ã‚“ã§ã™ã‹ï¼Ÿã€è‰¯ã„è³ªå•ã§ã™ã­ï¼Unity ã® Input System ã¯çµ±åˆãƒ†ã‚¹ãƒˆã§æ¤œè¨¼ã™ã‚‹ã®ãŒä¸€èˆ¬çš„ã§ã™ã€‚å˜ä½“ãƒ†ã‚¹ãƒˆã§ã¯ã€ã‚­ãƒ¼å…¥åŠ›ã‚’å—ã‘å–ã£ãŸå¾Œã®**ãƒ­ã‚¸ãƒƒã‚¯**ã ã‘ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã™ã€‚

> å˜ç´”ãªè¨­è¨ˆ
>
> ä»Šã†ã¾ãå‹•ãã‚‚ã£ã¨ã‚‚å˜ç´”ãªã‚‚ã®ã¯ä½•ã ã‚ã†ã‹ã€‚
>
> â€” Kent Beck ã€ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã€

#### å®Ÿè£…: é«˜é€Ÿè½ä¸‹æ©Ÿèƒ½

ãƒ†ã‚¹ãƒˆã‚’æ›¸ã„ãŸã‚‰ã€å®Ÿè£…ã—ã¾ã—ã‚‡ã†ï¼š

```csharp
// Assets/Scripts/Core/Game.cs ã® Update ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä¿®æ­£

public void Update(float deltaTime)
{
    // ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ä¸­ã®å‡¦ç†ã¯åˆ¥é€” UI ã§æ‰±ã†
    if (Mode == GameMode.GameOver)
    {
        return;
    }

    switch (Mode)
    {
        case GameMode.Playing:
            HandleInput();
            UpdateFall(deltaTime);
            break;

        case GameMode.Falling:
            Board.ApplyGravity();
            if (!HasFloatingPuyo())
            {
                Mode = GameMode.Checking;
            }
            break;

        case GameMode.Checking:
            UpdateChecking();
            break;
    }
}

// é«˜é€Ÿè½ä¸‹å‡¦ç†ã‚’è¿½åŠ 
private void HandleInput()
{
    if (CurrentPair == null) return;

    // å·¦å³ç§»å‹•
    if (Input.GetKeyDown(KeyCode.LeftArrow))
    {
        if (CurrentPair.CanMoveLeft(Board))
        {
            CurrentPair.MoveLeft();
        }
    }

    if (Input.GetKeyDown(KeyCode.RightArrow))
    {
        if (CurrentPair.CanMoveRight(Board))
        {
            CurrentPair.MoveRight();
        }
    }

    // å›è»¢
    if (Input.GetKeyDown(KeyCode.UpArrow))
    {
        CurrentPair.Rotate(Board);
    }

    // é«˜é€Ÿè½ä¸‹ï¼ˆä¸‹ã‚­ãƒ¼ã‚’æŠ¼ã—ã¦ã„ã‚‹é–“ã€é€£ç¶šã§è½ä¸‹ï¼‰
    if (Input.GetKey(KeyCode.DownArrow))
    {
        if (CurrentPair.CanMoveDown(Board))
        {
            CurrentPair.MoveDown();
        }
    }
}
```

ã€Œ`GetKeyDown`ã¨`GetKey`ã®é•ã„ã¯ä½•ã§ã™ã‹ï¼Ÿã€é‡è¦ãªé•ã„ãŒã‚ã‚Šã¾ã™ï¼š

- `GetKeyDown`: ã‚­ãƒ¼ãŒ**æŠ¼ã•ã‚ŒãŸç¬é–“**ã ã‘trueã‚’è¿”ã™ï¼ˆ1ãƒ•ãƒ¬ãƒ¼ãƒ ã ã‘ï¼‰
- `GetKey`: ã‚­ãƒ¼ãŒ**æŠ¼ã•ã‚Œã¦ã„ã‚‹é–“**ãšã£ã¨trueã‚’è¿”ã™

é«˜é€Ÿè½ä¸‹ã¯æŠ¼ã—ã¦ã„ã‚‹é–“ãšã£ã¨å‡¦ç†ã—ãŸã„ã®ã§ã€`GetKey`ã‚’ä½¿ã„ã¾ã™ã€‚å·¦å³ç§»å‹•ã‚„å›è»¢ã¯1å›ã ã‘å‡¦ç†ã—ãŸã„ã®ã§ã€`GetKeyDown`ã‚’ä½¿ã„ã¾ã™ã€‚

#### ãƒ†ã‚¹ãƒˆ: ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

æ¬¡ã«ã€ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®ãƒ†ã‚¹ãƒˆã‚’è¿½åŠ ã—ã¾ã—ã‚‡ã†ï¼š

```csharp
// Assets/Tests/EditMode/GameTest.cs ã«è¿½åŠ 

[Test]
public void Update_Nullã®CurrentPairã§ã‚‚ã‚¨ãƒ©ãƒ¼ã«ãªã‚‰ãªã„()
{
    // Arrange
    Game game = new Game();
    game.CurrentPair = null;

    // Act & Assert - ä¾‹å¤–ãŒç™ºç”Ÿã—ãªã„ã“ã¨ã‚’ç¢ºèª
    Assert.DoesNotThrow(() => game.Update(1.0f / 60.0f));
}

[Test]
public void FixPairToBoard_ç€åœ°æ™‚ã«CurrentPairãŒnullã«ãªã‚‹()
{
    // Arrange
    Game game = new Game();
    PuyoColor axisColor = game.CurrentPair.AxisColor;

    // ã·ã‚ˆã‚’ä¸‹ã¾ã§ç§»å‹•
    while (game.CurrentPair.CanMoveDown(game.Board))
    {
        game.CurrentPair.MoveDown();
    }

    int finalY = game.CurrentPair.AxisY;
    int finalX = game.CurrentPair.AxisX;

    // Act - ç€åœ°å‡¦ç†
    game.Update(0); // fallTimer = FALL_INTERVALã«ãªã‚‹ã‚ˆã†ã«è¤‡æ•°å›å‘¼ã¶ä»£ã‚ã‚Šã«
    // ç›´æ¥ç€åœ°å‡¦ç†ã‚’å‘¼ã¶ï¼ˆprivateãƒ¡ã‚½ãƒƒãƒ‰ãªã®ã§æœ¬æ¥ã¯Updateã‚’é€šã™ï¼‰
    // ã“ã“ã§ã¯ç°¡æ˜“çš„ã«Updateã‚’ä½•åº¦ã‚‚å‘¼ã¶
    for (int i = 0; i < 120; i++)
    {
        game.Update(1.0f / 60.0f);
    }

    // Assert - ãƒœãƒ¼ãƒ‰ã«ã·ã‚ˆãŒå›ºå®šã•ã‚Œã€æ–°ã—ã„ãƒšã‚¢ãŒç”Ÿæˆã•ã‚Œã‚‹
    Assert.AreEqual(axisColor, game.Board.Get(finalY, finalX));
    Assert.IsNotNull(game.CurrentPair); // æ–°ã—ã„ãƒšã‚¢ãŒç”Ÿæˆã•ã‚Œã¦ã„ã‚‹
}
```

#### å®Ÿè£…: ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¨ãƒ­ã‚°

ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¨ãƒ‡ãƒãƒƒã‚°ç”¨ã®ãƒ­ã‚°ã‚’è¿½åŠ ã—ã¾ã—ã‚‡ã†ï¼š

```csharp
// Assets/Scripts/Core/Game.cs ã«ãƒ­ã‚°è¿½åŠ 

using UnityEngine;

public class Game
{
    // ... æ—¢å­˜ã®ã‚³ãƒ¼ãƒ‰ ...

    private void UpdateChecking()
    {
        var positions = Board.CheckErase();
        if (positions.Count > 0)
        {
            Score.IncrementChain();
            Score.Add(positions.Count, Score.Chain);

            // ãƒ­ã‚°å‡ºåŠ›ï¼ˆãƒ‡ãƒãƒƒã‚°ç”¨ï¼‰
            Debug.Log($"æ¶ˆå»: {positions.Count}å€‹ã®ã·ã‚ˆ, é€£é–: {Score.Chain}");

            Board.Erase(positions);

            // å…¨æ¶ˆã—ãƒã‚§ãƒƒã‚¯
            if (Board.IsAllClear())
            {
                Score.AddAllClearBonus();
                Debug.Log("å…¨æ¶ˆã—ãƒœãƒ¼ãƒŠã‚¹! +5000ç‚¹");
            }

            Mode = GameMode.Falling;
        }
        else
        {
            Score.ResetChain();
            SpawnNewPair();
            Mode = GameMode.Playing;
        }
    }

    private void SpawnNewPair()
    {
        PuyoColor axisColor = GetRandomColor();
        PuyoColor childColor = GetRandomColor();

        Pair newPair = new Pair(SPAWN_X, SPAWN_Y, axisColor, childColor);

        // ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼åˆ¤å®š
        if (newPair.IsCollision(Board, newPair.AxisX, newPair.AxisY,
            newPair.ChildX, newPair.ChildY))
        {
            Mode = GameMode.GameOver;
            CurrentPair = null;
            Debug.Log("ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼!");
            return;
        }

        CurrentPair = newPair;
        fallTimer = 0f;
    }

    private void HandleInput()
    {
        // CurrentPairãŒnullã®å ´åˆã¯æ—©æœŸãƒªã‚¿ãƒ¼ãƒ³ï¼ˆã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ï¼‰
        if (CurrentPair == null)
        {
            return;
        }

        // ... æ—¢å­˜ã®å…¥åŠ›å‡¦ç† ...
    }
}
```

ã€Œ`Debug.Log`ã£ã¦ä½•ã§ã™ã‹ï¼Ÿã€Unity ã®ãƒ­ã‚°å‡ºåŠ›æ©Ÿèƒ½ã§ã™ã€‚é–‹ç™ºä¸­ã«ã‚²ãƒ¼ãƒ ã®å‹•ä½œã‚’ç¢ºèªã™ã‚‹ã®ã«ä¾¿åˆ©ã§ã™ã‚ˆã€‚ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

### ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°: å®šæ•°ã®æ•´ç†

ã‚³ãƒ¼ãƒ‰å…¨ä½“ã‚’è¦‹ç›´ã—ã¦ã€å®šæ•°ã‚’æ•´ç†ã—ã¾ã—ã‚‡ã†ï¼š

```csharp
// Assets/Scripts/Core/Game.cs ã®å®šæ•°ã‚’æ•´ç†

public class Game
{
    // ãƒœãƒ¼ãƒ‰é–¢é€£ã®å®šæ•°
    private const int SPAWN_X = 2;
    private const int SPAWN_Y = 0;

    // ã‚²ãƒ¼ãƒ ãƒãƒ©ãƒ³ã‚¹èª¿æ•´ç”¨ã®å®šæ•°
    private const float FALL_INTERVAL = 1.0f; // è½ä¸‹é–“éš”ï¼ˆç§’ï¼‰

    // ... æ—¢å­˜ã®ã‚³ãƒ¼ãƒ‰ ...
}
```

ã€Œå®šæ•°ã‚’ä½¿ã†ãƒ¡ãƒªãƒƒãƒˆã¯ä½•ã§ã™ã‹ï¼Ÿã€è‰¯ã„è³ªå•ã§ã™ã­ï¼å®šæ•°ã‚’ä½¿ã†ã¨ï¼š

1. **å€¤ã®æ„å‘³ãŒæ˜ç¢ºã«ãªã‚‹**: `2`ã‚ˆã‚Š`SPAWN_X`ã®æ–¹ãŒæ„å›³ãŒåˆ†ã‹ã‚Šã‚„ã™ã„
2. **å¤‰æ›´ãŒå®¹æ˜“**: 1ç®‡æ‰€å¤‰ãˆã‚Œã°å…¨ä½“ã«åæ˜ ã•ã‚Œã‚‹
3. **ã‚¿ã‚¤ãƒ—ãƒŸã‚¹é˜²æ­¢**: ãƒã‚¸ãƒƒã‚¯ãƒŠãƒ³ãƒãƒ¼ã®é‡è¤‡å…¥åŠ›ã‚’é¿ã‘ã‚‰ã‚Œã‚‹

> æ„å›³ã‚’è¡¨ç¾ã—ã‚ˆã†
>
> ã‚·ã‚¹ãƒ†ãƒ ã®ä¸»ãªã‚³ã‚¹ãƒˆã¯é•·æœŸçš„ãªãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã«ã‚ã‚‹ã€‚
>
> â€” Kent Beck ã€ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã€

### ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œã¨ç¢ºèª

ã™ã¹ã¦ã®å®Ÿè£…ãŒå®Œäº†ã—ãŸã‚‰ã€ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¾ã—ã‚‡ã†ï¼š

```bash
dotnet cake --target=Test
```

ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆãŒãƒ‘ã‚¹ã™ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚ã‚‚ã—ãƒ†ã‚¹ãƒˆãŒå¤±æ•—ã™ã‚‹å ´åˆã¯ã€ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç¢ºèªã—ã¦ä¿®æ­£ã—ã¾ã—ã‚‡ã†ã€‚

```bash
# ã‚³ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚‚ç¢ºèª
dotnet cake --target=Format

# ãƒ“ãƒ«ãƒ‰ã‚‚ç¢ºèª
dotnet cake --target=Build
```

ã€Œå…¨éƒ¨é€šã‚Šã¾ã—ãŸï¼ã€ç´ æ™´ã‚‰ã—ã„ï¼ã“ã‚Œã§ã·ã‚ˆã·ã‚ˆã‚²ãƒ¼ãƒ ã®å®Ÿè£…ãŒå®Œæˆã—ã¾ã—ãŸï¼

### ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ 9 ã®ã¾ã¨ã‚

ã“ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§å®Ÿè£…ã—ãŸå†…å®¹ï¼š

1. **é«˜é€Ÿè½ä¸‹æ©Ÿèƒ½**
   - `GetKey(KeyCode.DownArrow)`ã§æŠ¼ã—ã¦ã„ã‚‹é–“è½ä¸‹
   - `CanMoveDown`ã§ç€åœ°åˆ¤å®š
   - ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ä½“é¨“ã®å‘ä¸Š

2. **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**
   - `CurrentPair`ã®nullãƒã‚§ãƒƒã‚¯
   - æ—©æœŸãƒªã‚¿ãƒ¼ãƒ³ã«ã‚ˆã‚‹å®‰å…¨æ€§å‘ä¸Š

3. **ãƒ­ã‚°å‡ºåŠ›**
   - `Debug.Log`ã«ã‚ˆã‚‹æ¶ˆå»æƒ…å ±ã®è¡¨ç¤º
   - å…¨æ¶ˆã—ãƒœãƒ¼ãƒŠã‚¹ã®é€šçŸ¥
   - ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ã®é€šçŸ¥

4. **å®šæ•°ã®æ•´ç†**
   - `SPAWN_X`ã€`SPAWN_Y`ã€`FALL_INTERVAL`ã®å®šç¾©
   - ãƒã‚¸ãƒƒã‚¯ãƒŠãƒ³ãƒãƒ¼ã®æ’é™¤

5. **æœ€çµ‚ç¢ºèª**
   - ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆãŒãƒ‘ã‚¹
   - ã‚³ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã®é©ç”¨
   - ãƒ“ãƒ«ãƒ‰ã®æˆåŠŸç¢ºèª

## å®Œæˆã—ãŸã‚²ãƒ¼ãƒ ã®å…¨æ©Ÿèƒ½

ã“ã“ã¾ã§ã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã§å®Ÿè£…ã—ãŸæ©Ÿèƒ½ã‚’ã¾ã¨ã‚ã¾ã—ã‚‡ã†ï¼š

**åŸºæœ¬æ“ä½œ**
- ã·ã‚ˆãƒšã‚¢ã®å·¦å³ç§»å‹•ï¼ˆâ†â†’ã‚­ãƒ¼ï¼‰
- ã·ã‚ˆãƒšã‚¢ã®å›è»¢ï¼ˆâ†‘ã‚­ãƒ¼ã€å£ã‚­ãƒƒã‚¯ä»˜ãï¼‰
- é«˜é€Ÿè½ä¸‹ï¼ˆâ†“ã‚­ãƒ¼ï¼‰

**ã‚²ãƒ¼ãƒ ãƒ­ã‚¸ãƒƒã‚¯**
- è‡ªå‹•è½ä¸‹ã¨ã‚¿ã‚¤ãƒãƒ¼å‡¦ç†
- ç€åœ°åˆ¤å®šã¨ãƒœãƒ¼ãƒ‰å›ºå®š
- æ¶ˆå»åˆ¤å®šï¼ˆDFSã«ã‚ˆã‚‹4ã¤ä»¥ä¸Šã®æ¤œå‡ºï¼‰
- é‡åŠ›å‡¦ç†ï¼ˆæµ®ã„ã¦ã„ã‚‹ã·ã‚ˆã®è½ä¸‹ï¼‰
- é€£é–ã‚·ã‚¹ãƒ†ãƒ 

**ã‚¹ã‚³ã‚¢ã‚·ã‚¹ãƒ†ãƒ **
- åŸºæœ¬ã‚¹ã‚³ã‚¢ï¼ˆæ¶ˆã—ãŸæ•° Ã— 10ï¼‰
- é€£é–ãƒœãƒ¼ãƒŠã‚¹ï¼ˆ2^(é€£é–æ•°-1)å€ï¼‰
- å…¨æ¶ˆã—ãƒœãƒ¼ãƒŠã‚¹ï¼ˆ5000ç‚¹ï¼‰

**ã‚²ãƒ¼ãƒ ç®¡ç†**
- ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼åˆ¤å®š
- ãƒªã‚¹ã‚¿ãƒ¼ãƒˆæ©Ÿèƒ½
- ã‚²ãƒ¼ãƒ ãƒ¢ãƒ¼ãƒ‰çŠ¶æ…‹é·ç§»ï¼ˆPlaying â†’ Falling â†’ Checkingï¼‰

### ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã§å­¦ã‚“ã ã“ã¨

ã“ã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã‚’é€šã˜ã¦ã€å¤šãã®é‡è¦ãªæ¦‚å¿µã‚’å­¦ã³ã¾ã—ãŸã­ï¼š

**1. Red-Green-Refactor ã‚µã‚¤ã‚¯ãƒ«**

> ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã®ãƒãƒ³ãƒˆãƒ©
>
> å‹•ä½œã—ãªã„å¤±æ•—ã™ã‚‹ãƒ†ã‚¹ãƒˆã‚’æ›¸ãã¾ã§ã¯ã€æ±ºã—ã¦ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ã¯ãªã‚‰ãªã„ã€‚
>
> â€” Kent Beck ã€ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã€

- **Redï¼ˆèµ¤ï¼‰**: ã¾ãšå¤±æ•—ã™ã‚‹ãƒ†ã‚¹ãƒˆã‚’æ›¸ã
- **Greenï¼ˆç·‘ï¼‰**: ãƒ†ã‚¹ãƒˆã‚’é€šã™æœ€å°é™ã®ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã
- **Refactorï¼ˆãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ï¼‰**: ã‚³ãƒ¼ãƒ‰ã‚’æ”¹å–„ã™ã‚‹

ã“ã®ã‚µã‚¤ã‚¯ãƒ«ã‚’ç¹°ã‚Šè¿”ã™ã“ã¨ã§ã€å“è³ªã®é«˜ã„ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãã“ã¨ãŒã§ãã¾ã—ãŸã€‚

**2. C# ã®é‡è¦ãªæ¦‚å¿µ**

- **ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£**: `public int Total { get; private set; }`
- **Enum**: å‹å®‰å…¨ãªå®šæ•°ï¼ˆ`PuyoColor`ã€`GameMode`ï¼‰
- **ã‚¿ãƒ—ãƒ«**: `List<(int row, int col)>`ã§è¤‡æ•°ã®å€¤ã‚’è¿”ã™
- **2æ¬¡å…ƒé…åˆ—**: `PuyoColor[,] cells`ã§ãƒœãƒ¼ãƒ‰è¡¨ç¾
- **Nullå®‰å…¨æ€§**: nullãƒã‚§ãƒƒã‚¯ã¨æ—©æœŸãƒªã‚¿ãƒ¼ãƒ³

**3. ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ **

- **æ·±ã•å„ªå…ˆæ¢ç´¢ï¼ˆDFSï¼‰**: å†å¸°ã«ã‚ˆã‚‹é€£çµã·ã‚ˆã®æ¤œå‡º
- **è¡çªåˆ¤å®š**: ç§»å‹•å¯èƒ½æ€§ã®ãƒã‚§ãƒƒã‚¯
- **å›è»¢è¨ˆç®—**: å‰°ä½™æ¼”ç®—`(rotation + 3) % 4`ã«ã‚ˆã‚‹å¾ªç’°
- **é‡åŠ›å‡¦ç†**: ä¸‹ã‹ã‚‰é †ã«å‡¦ç†ã—ã¦ã·ã‚ˆã‚’è½ã¨ã™

**4. ã‚²ãƒ¼ãƒ é–‹ç™ºãƒ‘ã‚¿ãƒ¼ãƒ³**

- **ã‚²ãƒ¼ãƒ ãƒ«ãƒ¼ãƒ—**: `Update(deltaTime)`ã«ã‚ˆã‚‹æ¯ãƒ•ãƒ¬ãƒ¼ãƒ æ›´æ–°
- **çŠ¶æ…‹é·ç§»**: GameModeã«ã‚ˆã‚‹æ˜ç¢ºãªçŠ¶æ…‹ç®¡ç†
- **ã‚¿ã‚¤ãƒãƒ¼ç®¡ç†**: deltaTimeã«ã‚ˆã‚‹ãƒ•ãƒ¬ãƒ¼ãƒ ç‹¬ç«‹ãªæ™‚é–“å‡¦ç†
- **å…¥åŠ›å‡¦ç†**: `GetKeyDown` vs `GetKey`ã®ä½¿ã„åˆ†ã‘

### Unity ã¨ C# ã®ç‰¹å¾´ã‚’æ´»ã‹ã—ãŸå®Ÿè£…

ã“ã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã§ã€Unity ã¨ C# ã®ç‰¹å¾´ã‚’æ´»ã‹ã—ãŸå®Ÿè£…ã‚’è¡Œã„ã¾ã—ãŸï¼š

**C# ã®å¼·ã¿**
- **å‹å®‰å…¨æ€§**: Enumã¨ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«ã‚ˆã‚‹å …ç‰¢ãªã‚³ãƒ¼ãƒ‰
- **æ˜ç¤ºæ€§**: ã‚¢ã‚¯ã‚»ã‚¹ä¿®é£¾å­ã¨ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«ã‚ˆã‚‹æ„å›³ã®æ˜ç¢ºåŒ–
- **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹**: ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«å‹è¨€èªã®é«˜é€Ÿæ€§
- **é–‹ç™ºåŠ¹ç‡**: IDEã‚µãƒãƒ¼ãƒˆã¨ã‚¤ãƒ³ãƒ†ãƒªã‚»ãƒ³ã‚¹

**Unity ã®å¼·ã¿**
- **ã‚¯ãƒ­ã‚¹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ **: Windowsã€Macã€Linuxã€ãƒ¢ãƒã‚¤ãƒ«å¯¾å¿œ
- **ãƒ†ã‚¹ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯**: NUnitçµ±åˆã«ã‚ˆã‚‹å……å®Ÿã—ãŸãƒ†ã‚¹ãƒˆç’°å¢ƒ
- **ãƒãƒƒãƒãƒ¢ãƒ¼ãƒ‰**: CI/CDã«é©ã—ãŸã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³å®Ÿè¡Œ
- **æ‹¡å¼µæ€§**: å°†æ¥çš„ã«ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ã‚„ã‚µã‚¦ãƒ³ãƒ‰ã‚’ç°¡å˜ã«è¿½åŠ å¯èƒ½

### æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

ã€Œå®Œæˆã—ãŸã‚²ãƒ¼ãƒ ã‚’ã•ã‚‰ã«ç™ºå±•ã•ã›ã‚‹ã«ã¯ã€ã©ã†ã™ã‚Œã°ã„ã„ã§ã™ã‹ï¼Ÿã€ç´ æ™´ã‚‰ã—ã„è³ªå•ã§ã™ã­ï¼ã“ã“ã‹ã‚‰ã•ã‚‰ã«æ©Ÿèƒ½ã‚’è¿½åŠ ã™ã‚‹ã‚¢ã‚¤ãƒ‡ã‚¢ã‚’ç´¹ä»‹ã—ã¾ã™ï¼š

**1. ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ã®æ”¹å–„**

```csharp
// Spriteã‚’ä½¿ã£ãŸæç”»
public class PuyoRenderer : MonoBehaviour
{
    public Sprite redPuyoSprite;
    public Sprite bluePuyoSprite;
    // ...

    public void RenderPuyo(PuyoColor color, Vector2 position)
    {
        Sprite sprite = GetSpriteForColor(color);
        // SpriteRendererã§æç”»
    }
}
```

- ç”»åƒã‚¢ã‚»ãƒƒãƒˆã®ä½¿ç”¨ï¼ˆã‹ã‚ã„ã„ã·ã‚ˆã®çµµï¼‰
- ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³åŠ¹æœï¼ˆæ¶ˆãˆã‚‹ã¨ãã®ã‚¨ãƒ•ã‚§ã‚¯ãƒˆï¼‰
- ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¯ãƒ«ã‚·ã‚¹ãƒ†ãƒ ï¼ˆé€£é–ã®æ¼”å‡ºï¼‰

**2. ã‚µã‚¦ãƒ³ãƒ‰ã®è¿½åŠ **

```csharp
// AudioSourceã‚’ä½¿ã£ãŸéŸ³å£°å†ç”Ÿ
public class SoundManager : MonoBehaviour
{
    public AudioClip rotateSound;
    public AudioClip eraseSound;
    public AudioClip chainSound;

    public void PlayRotateSound()
    {
        AudioSource.PlayClipAtPoint(rotateSound, Camera.main.transform.position);
    }
}
```

- BGMå†ç”Ÿ
- åŠ¹æœéŸ³ï¼ˆå›è»¢ã€æ¶ˆå»ã€é€£é–ï¼‰
- éŸ³é‡èª¿æ•´æ©Ÿèƒ½

**3. è¿½åŠ æ©Ÿèƒ½**

- **ãƒã‚¯ã‚¹ãƒˆã·ã‚ˆã®è¡¨ç¤º**: æ¬¡ã«æ¥ã‚‹ã·ã‚ˆãƒšã‚¢ã‚’è¡¨ç¤º

```csharp
public class Game
{
    public Pair NextPair { get; private set; }

    private void SpawnNewPair()
    {
        CurrentPair = NextPair;
        NextPair = GenerateRandomPair();
        // ...
    }
}
```

- **ãƒã‚¤ã‚¹ã‚³ã‚¢è¨˜éŒ²**: JsonUtilityã§ãƒ•ã‚¡ã‚¤ãƒ«ä¿å­˜

```csharp
[System.Serializable]
public class SaveData
{
    public int highScore;
}

public void SaveHighScore(int score)
{
    SaveData data = new SaveData { highScore = score };
    string json = JsonUtility.ToJson(data);
    File.WriteAllText(Application.persistentDataPath + "/save.json", json);
}
```

- **é›£æ˜“åº¦èª¿æ•´**: è½ä¸‹é€Ÿåº¦ã®å¤‰æ›´

```csharp
public enum Difficulty
{
    Easy,
    Normal,
    Hard
}

private float GetFallInterval(Difficulty difficulty)
{
    return difficulty switch
    {
        Difficulty.Easy => 1.5f,
        Difficulty.Normal => 1.0f,
        Difficulty.Hard => 0.5f,
        _ => 1.0f
    };
}
```

- **ãŠã˜ã‚ƒã¾ã·ã‚ˆ**: å¯¾æˆ¦æ™‚ã®ã‚®ãƒŸãƒƒã‚¯

**4. ãƒãƒ«ãƒãƒ—ãƒ¬ã‚¤**

- **2Pãƒ¢ãƒ¼ãƒ‰**: åŒä¸€ç”»é¢ã§å¯¾æˆ¦

```csharp
public class TwoPlayerGame : MonoBehaviour
{
    public Game player1Game;
    public Game player2Game;

    void Update()
    {
        // Player 1: WASD
        // Player 2: Arrow Keys
    }
}
```

- **ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å¯¾æˆ¦**: Unity Netcodeã‚’ä½¿ç”¨

### æœ€çµ‚ã‚³ãƒŸãƒƒãƒˆ

ã™ã¹ã¦ã®å®Ÿè£…ãŒå®Œäº†ã—ãŸã®ã§ã€æœ€çµ‚çš„ãªã‚³ãƒŸãƒƒãƒˆã‚’è¡Œã„ã¾ã—ã‚‡ã†ï¼š

```bash
git add .
git commit -m "feat: ã‚²ãƒ¼ãƒ å®Œæˆï¼é«˜é€Ÿè½ä¸‹ã¨ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚’å®Ÿè£…

- ä¸‹ã‚­ãƒ¼ã§ã®é«˜é€Ÿè½ä¸‹æ©Ÿèƒ½
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ï¼ˆnullãƒã‚§ãƒƒã‚¯ï¼‰
- Debug.Logã«ã‚ˆã‚‹ãƒ­ã‚°å‡ºåŠ›
- å®šæ•°ã®æ•´ç†ã¨ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°
- ã‚²ãƒ¼ãƒ å®Œæˆï¼"

# ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¿ã‚°ã‚’ä»˜ã‘ã‚‹
git tag -a v1.0.0 -m "ã·ã‚ˆã·ã‚ˆã‚²ãƒ¼ãƒ  v1.0.0 å®Œæˆ"
```

ã€Œã‚¿ã‚°ã£ã¦ä½•ã§ã™ã‹ï¼Ÿã€Gitã®ã‚¿ã‚°ã¯ã€ç‰¹å®šã®ã‚³ãƒŸãƒƒãƒˆã«åå‰ã‚’ä»˜ã‘ã‚‹æ©Ÿèƒ½ã§ã™ã€‚`v1.0.0`ã®ã‚ˆã†ã«ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç•ªå·ã‚’ä»˜ã‘ã‚‹ã“ã¨ã§ã€å¾Œã‹ã‚‰ã€Œã“ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ã‚³ãƒ¼ãƒ‰ã¯ã©ã‚Œã ã£ãŸã‹ãªï¼Ÿã€ã¨ç°¡å˜ã«è¦‹ã¤ã‘ã‚‰ã‚Œã¾ã™ã€‚

ãƒªãƒ¢ãƒ¼ãƒˆãƒªãƒã‚¸ãƒˆãƒªã«ãƒ—ãƒƒã‚·ãƒ¥ã™ã‚‹å ´åˆã¯ï¼š

```bash
git push origin main
git push origin v1.0.0
```

### çµ‚ã‚ã‚Šã«

ã€Œãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã§ã‚²ãƒ¼ãƒ ã‚’ä½œã‚‹ã®ã¯ã€ã¨ã¦ã‚‚æ¥½ã—ã‹ã£ãŸã§ã™ï¼ã€ãã†ã§ã™ã­ï¼TDDã¯æœ€åˆã¯é¢å€’ã«æ„Ÿã˜ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒã€ç¢ºå®Ÿã«å“è³ªã®é«˜ã„ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãã“ã¨ãŒã§ãã¾ã™ã€‚

ã€ŒC# ã¨ Unity ã¯ã‚·ãƒ³ãƒ—ãƒ«ã§å¼·åŠ›ã§ã™ã­ï¼ã€ã¯ã„ã€C# ã®å‹å®‰å…¨æ€§ã¨ Unity ã®ã‚¯ãƒ­ã‚¹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ å¯¾å¿œã¯ã€ä¿å®ˆã—ã‚„ã™ãç§»æ¤æ€§ã®é«˜ã„ã‚²ãƒ¼ãƒ ã‚’ä½œã‚‹ã®ã«æœ€é©ã§ã™ã€‚

> Simple made easy.
>
> â€” Rich Hickeyï¼ˆClojureé–‹ç™ºè€…ï¼‰

ã“ã®è¨€è‘‰ã¯ã€ã€Œã‚·ãƒ³ãƒ—ãƒ«ã•ã¯ç°¡å˜ã§ã¯ãªã„ãŒã€ç°¡å˜ã•ã‚’ã‚‚ãŸã‚‰ã™ã€ã¨ã„ã†æ„å‘³ã§ã™ã€‚ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã‚‚åŒã˜ã§ã™ã€‚æœ€åˆã¯æ‰‹é–“ãŒã‹ã‹ã‚Šã¾ã™ãŒã€ãã®è¦å¾‹ã«å¾“ã†ã“ã¨ã§ã€å¾Œã®é–‹ç™ºãŒæ¥½ã«ãªã‚Šã¾ã™ã€‚

ã€Œæ¬¡ã¯ä½•ã‚’ä½œã‚Šã¾ã—ã‚‡ã†ã‹ï¼Ÿã€è‰¯ã„è³ªå•ã§ã™ã­ï¼å­¦ã‚“ã TDDã®æŠ€è¡“ã‚’ä½¿ã£ã¦ã€è‡ªåˆ†ã®ã‚ªãƒªã‚¸ãƒŠãƒ«ãªã‚²ãƒ¼ãƒ ã‚„ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œã£ã¦ã¿ã¦ãã ã•ã„ã€‚C# ã®ã‚·ãƒ³ãƒ—ãƒ«ã•ã¨ãƒ†ã‚¹ãƒˆã®åŠ›ã‚’å€Ÿã‚Šã‚Œã°ã€å®‰å…¨ã§é«˜å“è³ªãªã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚’ä½œã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ã·ã‚ˆã·ã‚ˆã‚’é€šã˜ã¦ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã¨ C#/Unity ã®åŸºç¤ã‚’å­¦ã¹ãŸã“ã¨ã‚’é¡˜ã£ã¦ã„ã¾ã™ã€‚Happy Coding!

```csharp
using UnityEngine;

public class Completion : MonoBehaviour
{
    void Start()
    {
        Debug.Log("ã·ã‚ˆã·ã‚ˆã‚²ãƒ¼ãƒ ã€å®Œæˆï¼ğŸ‰");
        Debug.Log("Simple made easy.");
    }
}
```

---

## ä»˜éŒ²: ã‚³ãƒãƒ³ãƒ‰ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹

ã“ã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã§ä½¿ç”¨ã—ãŸã‚³ãƒãƒ³ãƒ‰ã®ä¸€è¦§ã§ã™ï¼š

### é–‹ç™ºã‚³ãƒãƒ³ãƒ‰

```bash
# ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œ
dotnet cake --target=Test
# ã¾ãŸã¯
./scripts/test.sh

# ã‚³ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
dotnet cake --target=Format
# ã¾ãŸã¯
./scripts/format.sh

# ã‚³ãƒ¼ãƒ‰ãƒã‚§ãƒƒã‚¯ï¼ˆãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆç¢ºèªã®ã¿ï¼‰
dotnet cake --target=Check
# ã¾ãŸã¯
./scripts/check.sh

# ãƒ•ã‚¡ã‚¤ãƒ«ç›£è¦–ã¨è‡ªå‹•ãƒ†ã‚¹ãƒˆ
dotnet cake --target=Watch
# ã¾ãŸã¯
./scripts/watch.sh

# ãƒ“ãƒ«ãƒ‰
dotnet cake --target=Build
# ã¾ãŸã¯
./scripts/build.sh
```

### Git ã‚³ãƒãƒ³ãƒ‰

```bash
# å¤‰æ›´ã‚’ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°
git add .

# ã‚³ãƒŸãƒƒãƒˆ
git commit -m "feat: æ–°æ©Ÿèƒ½ã®èª¬æ˜"

# ãƒ­ã‚°ç¢ºèª
git log --oneline

# ã‚¿ã‚°ä½œæˆ
git tag -a v1.0.0 -m "ãƒãƒ¼ã‚¸ãƒ§ãƒ³1.0.0"

# ãƒªãƒ¢ãƒ¼ãƒˆã«ãƒ—ãƒƒã‚·ãƒ¥
git push origin main
git push origin v1.0.0
```

### Unity CLI ã‚³ãƒãƒ³ãƒ‰

```bash
# ãƒ†ã‚¹ãƒˆå®Ÿè¡Œï¼ˆç›´æ¥ï¼‰
/Applications/Unity/Hub/Editor/2022.3.27f1/Unity.app/Contents/MacOS/Unity \
  -batchmode \
  -nographics \
  -projectPath . \
  -runTests \
  -testPlatform EditMode \
  -testResults results.xml

# ãƒ“ãƒ«ãƒ‰ï¼ˆç›´æ¥ï¼‰
/Applications/Unity/Hub/Editor/2022.3.27f1/Unity.app/Contents/MacOS/Unity \
  -batchmode \
  -nographics \
  -projectPath . \
  -buildTarget StandaloneOSX \
  -quit
```

---

## ä»˜éŒ²: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆ

æœ€çµ‚çš„ãªãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆï¼š

```
puyo-puyo-unity/
â”œâ”€â”€ Assets/
â”‚   â”œâ”€â”€ Scripts/
â”‚   â”‚   â””â”€â”€ Core/
â”‚   â”‚       â”œâ”€â”€ Board.cs          # ãƒœãƒ¼ãƒ‰ï¼ˆ6Ã—12ã‚°ãƒªãƒƒãƒ‰ï¼‰
â”‚   â”‚       â”œâ”€â”€ Pair.cs           # ã·ã‚ˆãƒšã‚¢ï¼ˆå›è»¢ã€ç§»å‹•ã€è¡çªåˆ¤å®šï¼‰
â”‚   â”‚       â”œâ”€â”€ PuyoColor.cs      # ã·ã‚ˆã®è‰²ï¼ˆEnumï¼‰
â”‚   â”‚       â”œâ”€â”€ Game.cs           # ã‚²ãƒ¼ãƒ åˆ¶å¾¡ï¼ˆçŠ¶æ…‹é·ç§»ã€å…¥åŠ›ï¼‰
â”‚   â”‚       â””â”€â”€ Score.cs          # ã‚¹ã‚³ã‚¢ç®¡ç†ï¼ˆé€£é–ã€å…¨æ¶ˆã—ï¼‰
â”‚   â””â”€â”€ Tests/
â”‚       â””â”€â”€ EditMode/
â”‚           â”œâ”€â”€ BoardTest.cs      # ãƒœãƒ¼ãƒ‰ã®ãƒ†ã‚¹ãƒˆ
â”‚           â”œâ”€â”€ PairTest.cs       # ã·ã‚ˆãƒšã‚¢ã®ãƒ†ã‚¹ãƒˆ
â”‚           â”œâ”€â”€ GameTest.cs       # ã‚²ãƒ¼ãƒ ã®ãƒ†ã‚¹ãƒˆ
â”‚           â””â”€â”€ ScoreTest.cs      # ã‚¹ã‚³ã‚¢ã®ãƒ†ã‚¹ãƒˆ
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ test.sh                   # ãƒ†ã‚¹ãƒˆå®Ÿè¡Œã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”‚   â”œâ”€â”€ build.sh                  # ãƒ“ãƒ«ãƒ‰ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”‚   â”œâ”€â”€ format.sh                 # ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”‚   â”œâ”€â”€ check.sh                  # ãƒã‚§ãƒƒã‚¯ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”‚   â””â”€â”€ watch.sh                  # ãƒ•ã‚¡ã‚¤ãƒ«ç›£è¦–ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”œâ”€â”€ unity-config.sh               # Unity ãƒ‘ã‚¹è¨­å®š
â”œâ”€â”€ build.cake                    # Cake ãƒ“ãƒ«ãƒ‰è‡ªå‹•åŒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”œâ”€â”€ .config/
â”‚   â””â”€â”€ dotnet-tools.json         # .NET ãƒ­ãƒ¼ã‚«ãƒ«ãƒ„ãƒ¼ãƒ«è¨­å®š
â”œâ”€â”€ .editorconfig                 # ã‚¨ãƒ‡ã‚£ã‚¿è¨­å®š
â””â”€â”€ .gitignore                    # Gité™¤å¤–è¨­å®š
```

---

## ä»˜éŒ²: å‚è€ƒè³‡æ–™

ã“ã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã‚’ä½œæˆã™ã‚‹ã«ã‚ãŸã£ã¦å‚è€ƒã«ã—ãŸè³‡æ–™ï¼š

**æ›¸ç±**
- ã€ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã€Kent Beck è‘—ã€å’Œç”°å“äºº è¨³ï¼ˆã‚ªãƒ¼ãƒ ç¤¾ï¼‰
- ã€Clean Craftsmanship è¦å¾‹ã€åŸºæº–ã€å€«ç†ã€Robert C. Martin è‘—ï¼ˆã‚¢ã‚¹ã‚­ãƒ¼ãƒ‰ãƒ¯ãƒ³ã‚´ï¼‰
- ã€ã‚¨ã‚¯ã‚¹ãƒˆãƒªãƒ¼ãƒ ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã€Kent Beck è‘—ï¼ˆã‚ªãƒ¼ãƒ ç¤¾ï¼‰

**å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**
- [Unity Documentation](https://docs.unity3d.com/)
- [Unity Test Framework](https://docs.unity3d.com/Packages/com.unity.test-framework@latest/)
- [C# Programming Guide](https://docs.microsoft.com/dotnet/csharp/)

**é–¢é€£æŠ€è¡“**
- [NUnit](https://nunit.org/) - ãƒ†ã‚¹ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯
- [Git](https://git-scm.com/) - ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†
- [EditorConfig](https://editorconfig.org/) - ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„

---

ã“ã‚Œã§ã·ã‚ˆã·ã‚ˆã‚²ãƒ¼ãƒ ã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã¯å®Œçµã§ã™ã€‚ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™ºã®æ—…ã‚’æ¥½ã—ã‚“ã§ã„ãŸã ã‘ãŸã‚‰å¹¸ã„ã§ã™ï¼
