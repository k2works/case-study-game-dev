# デプロイ

## 概要

Vercelを使用したぷよぷよゲームアプリケーションのデプロイ手順を説明します。

## 前提条件

- Vercel CLI がインストールされている
- GitHubリポジトリにコードがプッシュされている
- Vercelアカウントを持っている

## デプロイ設定

### vercel.json

プロジェクトルートに以下の設定ファイルを配置：

```json
{
  "outputDirectory": "app",
  "routes": [
    {
      "src": "/",
      "dest": "/index.html"
    }
  ]
}
```

### package.json

Vercel用のスクリプトを追加：

```json
{
  "scripts": {
    "vercel-build": "echo 'Build completed'",
    "dev": "cd app && python -m http.server 3000",
    "start": "cd app && python -m http.server 3000"
  }
}
```

## デプロイ手順

### 1. Vercel CLIを使用した自動デプロイ

```bash
# プロダクションデプロイ
npx vercel --prod --yes

# プレビューデプロイ
npx vercel --yes
```

### 2. GitHubと連携した自動デプロイ

1. **Vercelダッシュボード**にアクセス
2. **New Project**をクリック
3. **GitHubリポジトリを選択**
4. **プロジェクト設定**:
   - Framework Preset: Other
   - Root Directory: `./`
   - Output Directory: `app`
   - Install Command: `npm install`
   - Build Command: `npm run vercel-build`

## デプロイ後の確認

### アプリケーションの動作確認

デプロイ完了後、以下を確認：

- [ ] ゲーム画面が正常に表示される
- [ ] ぷよの操作（移動・回転）が動作する
- [ ] スコア・レベル表示が機能する
- [ ] ゲームオーバー処理が正常に動作する
- [ ] レスポンシブデザインが適用されている

### パフォーマンス確認

- [ ] 初回読み込み時間
- [ ] ゲーム操作のレスポンス
- [ ] モバイルデバイスでの動作

## 現在のデプロイ情報

### プロダクション環境

- **URL**: https://case-study-game-ei37z6k4q-k2works-projects.vercel.app
- **リポジトリ**: k2works/case-study-game-dev
- **ブランチ**: case-0
- **最終デプロイ**: 2025-07-31

### 管理画面

- **プロジェクト管理**: https://vercel.com/k2works-projects/case-study-game-dev
- **デプロイ履歴**: Vercelダッシュボードで確認可能
- **ログ確認**: 各デプロイの詳細ログを参照可能

## トラブルシューティング

### よくある問題

#### 1. アプリケーションが表示されない

**原因**: outputDirectoryの設定が間違っている

**解決方法**:
```json
{
  "outputDirectory": "app"
}
```

#### 2. 静的ファイルが見つからない

**原因**: ルーティング設定が不適切

**解決方法**:
```json
{
  "routes": [
    {
      "src": "/",
      "dest": "/index.html"
    }
  ]
}
```

#### 3. デプロイが失敗する

**確認事項**:
- package.jsonの構文エラー
- vercel.jsonの設定ミス
- Git操作の完了状況

## デプロイの最適化

### パフォーマンス向上

- 画像ファイルの最適化
- CSS/JSファイルの圧縮
- キャッシュ設定の調整

### セキュリティ強化

```json
{
  "headers": [
    {
      "source": "/(.*)",
      "headers": [
        {
          "key": "X-Content-Type-Options",
          "value": "nosniff"
        },
        {
          "key": "X-Frame-Options",
          "value": "DENY"
        },
        {
          "key": "X-XSS-Protection",
          "value": "1; mode=block"
        }
      ]
    }
  ]
}
```

## 関連ドキュメント

- [セットアップ](./セットアップ.md) - 開発環境の構築
- [運用ドキュメント](./index.md) - 運用全般の情報
- [Vercel公式ドキュメント](https://vercel.com/docs)